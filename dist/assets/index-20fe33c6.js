var z4=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var hne=z4((xr,_r)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function jP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var wf={},N4={get exports(){return wf},set exports(t){wf=t}},Cv={},Ce={},k4={get exports(){return Ce},set exports(t){Ce=t}},Rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dp=Symbol.for("react.element"),B4=Symbol.for("react.portal"),U4=Symbol.for("react.fragment"),F4=Symbol.for("react.strict_mode"),V4=Symbol.for("react.profiler"),G4=Symbol.for("react.provider"),H4=Symbol.for("react.context"),W4=Symbol.for("react.forward_ref"),j4=Symbol.for("react.suspense"),$4=Symbol.for("react.memo"),q4=Symbol.for("react.lazy"),X3=Symbol.iterator;function X4(t){return t===null||typeof t!="object"?null:(t=X3&&t[X3]||t["@@iterator"],typeof t=="function"?t:null)}var $P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qP=Object.assign,XP={};function Th(t,e,n){this.props=t,this.context=e,this.refs=XP,this.updater=n||$P}Th.prototype.isReactComponent={};Th.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Th.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function YP(){}YP.prototype=Th.prototype;function BS(t,e,n){this.props=t,this.context=e,this.refs=XP,this.updater=n||$P}var US=BS.prototype=new YP;US.constructor=BS;qP(US,Th.prototype);US.isPureReactComponent=!0;var Y3=Array.isArray,ZP=Object.prototype.hasOwnProperty,FS={current:null},JP={key:!0,ref:!0,__self:!0,__source:!0};function KP(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)ZP.call(e,i)&&!JP.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:dp,type:t,key:s,ref:o,props:r,_owner:FS.current}}function Y4(t,e){return{$$typeof:dp,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function VS(t){return typeof t=="object"&&t!==null&&t.$$typeof===dp}function Z4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Z3=/\/+/g;function E1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Z4(""+t.key):e.toString(36)}function t0(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case dp:case B4:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+E1(o,0):i,Y3(r)?(n="",t!=null&&(n=t.replace(Z3,"$&/")+"/"),t0(r,e,n,"",function(u){return u})):r!=null&&(VS(r)&&(r=Y4(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(Z3,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",Y3(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+E1(s,a);o+=t0(s,e,n,l,r)}else if(l=X4(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+E1(s,a++),o+=t0(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Dm(t,e,n){if(t==null)return t;var i=[],r=0;return t0(t,i,"","",function(s){return e.call(n,s,r++)}),i}function J4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Gi={current:null},n0={transition:null},K4={ReactCurrentDispatcher:Gi,ReactCurrentBatchConfig:n0,ReactCurrentOwner:FS};Rt.Children={map:Dm,forEach:function(t,e,n){Dm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Dm(t,function(){e++}),e},toArray:function(t){return Dm(t,function(e){return e})||[]},only:function(t){if(!VS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Rt.Component=Th;Rt.Fragment=U4;Rt.Profiler=V4;Rt.PureComponent=BS;Rt.StrictMode=F4;Rt.Suspense=j4;Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K4;Rt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=qP({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=FS.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)ZP.call(e,l)&&!JP.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:dp,type:t.type,key:r,ref:s,props:i,_owner:o}};Rt.createContext=function(t){return t={$$typeof:H4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:G4,_context:t},t.Consumer=t};Rt.createElement=KP;Rt.createFactory=function(t){var e=KP.bind(null,t);return e.type=t,e};Rt.createRef=function(){return{current:null}};Rt.forwardRef=function(t){return{$$typeof:W4,render:t}};Rt.isValidElement=VS;Rt.lazy=function(t){return{$$typeof:q4,_payload:{_status:-1,_result:t},_init:J4}};Rt.memo=function(t,e){return{$$typeof:$4,type:t,compare:e===void 0?null:e}};Rt.startTransition=function(t){var e=n0.transition;n0.transition={};try{t()}finally{n0.transition=e}};Rt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Rt.useCallback=function(t,e){return Gi.current.useCallback(t,e)};Rt.useContext=function(t){return Gi.current.useContext(t)};Rt.useDebugValue=function(){};Rt.useDeferredValue=function(t){return Gi.current.useDeferredValue(t)};Rt.useEffect=function(t,e){return Gi.current.useEffect(t,e)};Rt.useId=function(){return Gi.current.useId()};Rt.useImperativeHandle=function(t,e,n){return Gi.current.useImperativeHandle(t,e,n)};Rt.useInsertionEffect=function(t,e){return Gi.current.useInsertionEffect(t,e)};Rt.useLayoutEffect=function(t,e){return Gi.current.useLayoutEffect(t,e)};Rt.useMemo=function(t,e){return Gi.current.useMemo(t,e)};Rt.useReducer=function(t,e,n){return Gi.current.useReducer(t,e,n)};Rt.useRef=function(t){return Gi.current.useRef(t)};Rt.useState=function(t){return Gi.current.useState(t)};Rt.useSyncExternalStore=function(t,e,n){return Gi.current.useSyncExternalStore(t,e,n)};Rt.useTransition=function(){return Gi.current.useTransition()};Rt.version="18.2.0";(function(t){t.exports=Rt})(k4);const nu=jP(Ce);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q4=Ce,ek=Symbol.for("react.element"),tk=Symbol.for("react.fragment"),nk=Object.prototype.hasOwnProperty,ik=Q4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rk={key:!0,ref:!0,__self:!0,__source:!0};function QP(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)nk.call(e,i)&&!rk.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:ek,type:t,key:s,ref:o,props:r,_owner:ik.current}}Cv.Fragment=tk;Cv.jsx=QP;Cv.jsxs=QP;(function(t){t.exports=Cv})(N4);const sk=wf.Fragment,Ve=wf.jsx,Fr=wf.jsxs;var m_={},ok={get exports(){return m_},set exports(t){m_=t}},Er={},g_={},ak={get exports(){return g_},set exports(t){g_=t}},eL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,V){var U=z.length;z.push(V);e:for(;0<U;){var X=U-1>>>1,N=z[X];if(0<r(N,V))z[X]=V,z[U]=N,U=X;else break e}}function n(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var V=z[0],U=z.pop();if(U!==V){z[0]=U;e:for(var X=0,N=z.length,q=N>>>1;X<q;){var Y=2*(X+1)-1,ee=z[Y],W=Y+1,se=z[W];if(0>r(ee,U))W<N&&0>r(se,ee)?(z[X]=se,z[W]=U,X=W):(z[X]=ee,z[Y]=U,X=Y);else if(W<N&&0>r(se,U))z[X]=se,z[W]=U,X=W;else break e}}return V}function r(z,V){var U=z.sortIndex-V.sortIndex;return U!==0?U:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,m=!1,g=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(z){for(var V=n(u);V!==null;){if(V.callback===null)i(u);else if(V.startTime<=z)i(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(z){if(v=!1,S(z),!g)if(n(l)!==null)g=!0,ne(T);else{var V=n(u);V!==null&&J(b,V.startTime-z)}}function T(z,V){g=!1,v&&(v=!1,y(A),A=-1),m=!0;var U=h;try{for(S(V),c=n(l);c!==null&&(!(c.expirationTime>V)||z&&!O());){var X=c.callback;if(typeof X=="function"){c.callback=null,h=c.priorityLevel;var N=X(c.expirationTime<=V);V=t.unstable_now(),typeof N=="function"?c.callback=N:c===n(l)&&i(l),S(V)}else i(l);c=n(l)}if(c!==null)var q=!0;else{var Y=n(u);Y!==null&&J(b,Y.startTime-V),q=!1}return q}finally{c=null,h=U,m=!1}}var E=!1,L=null,A=-1,I=5,P=-1;function O(){return!(t.unstable_now()-P<I)}function k(){if(L!==null){var z=t.unstable_now();P=z;var V=!0;try{V=L(!0,z)}finally{V?F():(E=!1,L=null)}}else E=!1}var F;if(typeof _=="function")F=function(){_(k)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=k,F=function(){Z.postMessage(null)}}else F=function(){x(k,0)};function ne(z){L=z,E||(E=!0,F())}function J(z,V){A=x(function(){z(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,ne(T))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var U=h;h=V;try{return z()}finally{h=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var U=h;h=z;try{return V()}finally{h=U}},t.unstable_scheduleCallback=function(z,V,U){var X=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?X+U:X):U=X,z){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=U+N,z={id:d++,callback:V,priorityLevel:z,startTime:U,expirationTime:N,sortIndex:-1},U>X?(z.sortIndex=U,e(u,z),n(l)===null&&z===n(u)&&(v?(y(A),A=-1):v=!0,J(b,U-X))):(z.sortIndex=N,e(l,z),g||m||(g=!0,ne(T))),z},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(z){var V=h;return function(){var U=h;h=V;try{return z.apply(this,arguments)}finally{h=U}}}})(eL);(function(t){t.exports=eL})(ak);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tL=Ce,br=g_;function Re(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nL=new Set,Sf={};function Au(t,e){ah(t,e),ah(t+"Capture",e)}function ah(t,e){for(Sf[t]=e,t=0;t<e.length;t++)nL.add(e[t])}var Yo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),v_=Object.prototype.hasOwnProperty,lk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,J3={},K3={};function uk(t){return v_.call(K3,t)?!0:v_.call(J3,t)?!1:lk.test(t)?K3[t]=!0:(J3[t]=!0,!1)}function ck(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hk(t,e,n,i){if(e===null||typeof e>"u"||ck(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hi(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var mi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mi[t]=new Hi(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mi[e]=new Hi(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mi[t]=new Hi(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mi[t]=new Hi(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mi[t]=new Hi(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mi[t]=new Hi(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mi[t]=new Hi(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mi[t]=new Hi(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mi[t]=new Hi(t,5,!1,t.toLowerCase(),null,!1,!1)});var GS=/[\-:]([a-z])/g;function HS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(GS,HS);mi[e]=new Hi(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(GS,HS);mi[e]=new Hi(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(GS,HS);mi[e]=new Hi(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mi[t]=new Hi(t,1,!1,t.toLowerCase(),null,!1,!1)});mi.xlinkHref=new Hi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mi[t]=new Hi(t,1,!1,t.toLowerCase(),null,!0,!0)});function WS(t,e,n,i){var r=mi.hasOwnProperty(e)?mi[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hk(e,n,r,i)&&(n=null),i||r===null?uk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var oa=tL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rm=Symbol.for("react.element"),Tc=Symbol.for("react.portal"),Cc=Symbol.for("react.fragment"),jS=Symbol.for("react.strict_mode"),y_=Symbol.for("react.profiler"),iL=Symbol.for("react.provider"),rL=Symbol.for("react.context"),$S=Symbol.for("react.forward_ref"),x_=Symbol.for("react.suspense"),__=Symbol.for("react.suspense_list"),qS=Symbol.for("react.memo"),Ea=Symbol.for("react.lazy"),sL=Symbol.for("react.offscreen"),Q3=Symbol.iterator;function hd(t){return t===null||typeof t!="object"?null:(t=Q3&&t[Q3]||t["@@iterator"],typeof t=="function"?t:null)}var bn=Object.assign,A1;function $d(t){if(A1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);A1=e&&e[1]||""}return`
`+A1+t}var T1=!1;function C1(t,e){if(!t||T1)return"";T1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){i=u}t.call(e.prototype)}else{try{throw Error()}catch(u){i=u}t()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{T1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$d(t):""}function dk(t){switch(t.tag){case 5:return $d(t.type);case 16:return $d("Lazy");case 13:return $d("Suspense");case 19:return $d("SuspenseList");case 0:case 2:case 15:return t=C1(t.type,!1),t;case 11:return t=C1(t.type.render,!1),t;case 1:return t=C1(t.type,!0),t;default:return""}}function w_(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cc:return"Fragment";case Tc:return"Portal";case y_:return"Profiler";case jS:return"StrictMode";case x_:return"Suspense";case __:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rL:return(t.displayName||"Context")+".Consumer";case iL:return(t._context.displayName||"Context")+".Provider";case $S:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qS:return e=t.displayName||null,e!==null?e:w_(t.type)||"Memo";case Ea:e=t._payload,t=t._init;try{return w_(t(e))}catch{}}return null}function fk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return w_(e);case 8:return e===jS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function el(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oL(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function pk(t){var e=oL(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Om(t){t._valueTracker||(t._valueTracker=pk(t))}function aL(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=oL(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function C0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function S_(t,e){var n=e.checked;return bn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function eE(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=el(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lL(t,e){e=e.checked,e!=null&&WS(t,"checked",e,!1)}function b_(t,e){lL(t,e);var n=el(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?M_(t,e.type,n):e.hasOwnProperty("defaultValue")&&M_(t,e.type,el(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function tE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function M_(t,e,n){(e!=="number"||C0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var qd=Array.isArray;function Wc(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+el(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function E_(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Re(91));return bn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function nE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Re(92));if(qd(n)){if(1<n.length)throw Error(Re(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:el(n)}}function uL(t,e){var n=el(e.value),i=el(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function iE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cL(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function A_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cL(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var zm,hL=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(zm=zm||document.createElement("div"),zm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=zm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bf(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var tf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},mk=["Webkit","ms","Moz","O"];Object.keys(tf).forEach(function(t){mk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tf[e]=tf[t]})});function dL(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||tf.hasOwnProperty(t)&&tf[t]?(""+e).trim():e+"px"}function fL(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=dL(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var gk=bn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function T_(t,e){if(e){if(gk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Re(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Re(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Re(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Re(62))}}function C_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var P_=null;function XS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var L_=null,jc=null,$c=null;function rE(t){if(t=mp(t)){if(typeof L_!="function")throw Error(Re(280));var e=t.stateNode;e&&(e=Rv(e),L_(t.stateNode,t.type,e))}}function pL(t){jc?$c?$c.push(t):$c=[t]:jc=t}function mL(){if(jc){var t=jc,e=$c;if($c=jc=null,rE(t),e)for(t=0;t<e.length;t++)rE(e[t])}}function gL(t,e){return t(e)}function vL(){}var P1=!1;function yL(t,e,n){if(P1)return t(e,n);P1=!0;try{return gL(t,e,n)}finally{P1=!1,(jc!==null||$c!==null)&&(vL(),mL())}}function Mf(t,e){var n=t.stateNode;if(n===null)return null;var i=Rv(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Re(231,e,typeof n));return n}var I_=!1;if(Yo)try{var dd={};Object.defineProperty(dd,"passive",{get:function(){I_=!0}}),window.addEventListener("test",dd,dd),window.removeEventListener("test",dd,dd)}catch{I_=!1}function vk(t,e,n,i,r,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var nf=!1,P0=null,L0=!1,D_=null,yk={onError:function(t){nf=!0,P0=t}};function xk(t,e,n,i,r,s,o,a,l){nf=!1,P0=null,vk.apply(yk,arguments)}function _k(t,e,n,i,r,s,o,a,l){if(xk.apply(this,arguments),nf){if(nf){var u=P0;nf=!1,P0=null}else throw Error(Re(198));L0||(L0=!0,D_=u)}}function Tu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function xL(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function sE(t){if(Tu(t)!==t)throw Error(Re(188))}function wk(t){var e=t.alternate;if(!e){if(e=Tu(t),e===null)throw Error(Re(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return sE(r),t;if(s===i)return sE(r),e;s=s.sibling}throw Error(Re(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(Re(189))}}if(n.alternate!==i)throw Error(Re(190))}if(n.tag!==3)throw Error(Re(188));return n.stateNode.current===n?t:e}function _L(t){return t=wk(t),t!==null?wL(t):null}function wL(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=wL(t);if(e!==null)return e;t=t.sibling}return null}var SL=br.unstable_scheduleCallback,oE=br.unstable_cancelCallback,Sk=br.unstable_shouldYield,bk=br.unstable_requestPaint,kn=br.unstable_now,Mk=br.unstable_getCurrentPriorityLevel,YS=br.unstable_ImmediatePriority,bL=br.unstable_UserBlockingPriority,I0=br.unstable_NormalPriority,Ek=br.unstable_LowPriority,ML=br.unstable_IdlePriority,Pv=null,uo=null;function Ak(t){if(uo&&typeof uo.onCommitFiberRoot=="function")try{uo.onCommitFiberRoot(Pv,t,void 0,(t.current.flags&128)===128)}catch{}}var Ts=Math.clz32?Math.clz32:Pk,Tk=Math.log,Ck=Math.LN2;function Pk(t){return t>>>=0,t===0?32:31-(Tk(t)/Ck|0)|0}var Nm=64,km=4194304;function Xd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function D0(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=Xd(a):(s&=o,s!==0&&(i=Xd(s)))}else o=n&~r,o!==0?i=Xd(o):s!==0&&(i=Xd(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ts(e),r=1<<n,i|=t[n],e&=~r;return i}function Lk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ik(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ts(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=Lk(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function R_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function EL(){var t=Nm;return Nm<<=1,!(Nm&4194240)&&(Nm=64),t}function L1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function fp(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ts(e),t[e]=n}function Dk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ts(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function ZS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ts(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Zt=0;function AL(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var TL,JS,CL,PL,LL,O_=!1,Bm=[],Ha=null,Wa=null,ja=null,Ef=new Map,Af=new Map,Ca=[],Rk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aE(t,e){switch(t){case"focusin":case"focusout":Ha=null;break;case"dragenter":case"dragleave":Wa=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":Ef.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Af.delete(e.pointerId)}}function fd(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=mp(e),e!==null&&JS(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Ok(t,e,n,i,r){switch(e){case"focusin":return Ha=fd(Ha,t,e,n,i,r),!0;case"dragenter":return Wa=fd(Wa,t,e,n,i,r),!0;case"mouseover":return ja=fd(ja,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Ef.set(s,fd(Ef.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Af.set(s,fd(Af.get(s)||null,t,e,n,i,r)),!0}return!1}function IL(t){var e=ql(t.target);if(e!==null){var n=Tu(e);if(n!==null){if(e=n.tag,e===13){if(e=xL(n),e!==null){t.blockedOn=e,LL(t.priority,function(){CL(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function i0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=z_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);P_=i,n.target.dispatchEvent(i),P_=null}else return e=mp(n),e!==null&&JS(e),t.blockedOn=n,!1;e.shift()}return!0}function lE(t,e,n){i0(t)&&n.delete(e)}function zk(){O_=!1,Ha!==null&&i0(Ha)&&(Ha=null),Wa!==null&&i0(Wa)&&(Wa=null),ja!==null&&i0(ja)&&(ja=null),Ef.forEach(lE),Af.forEach(lE)}function pd(t,e){t.blockedOn===e&&(t.blockedOn=null,O_||(O_=!0,br.unstable_scheduleCallback(br.unstable_NormalPriority,zk)))}function Tf(t){function e(r){return pd(r,t)}if(0<Bm.length){pd(Bm[0],t);for(var n=1;n<Bm.length;n++){var i=Bm[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Ha!==null&&pd(Ha,t),Wa!==null&&pd(Wa,t),ja!==null&&pd(ja,t),Ef.forEach(e),Af.forEach(e),n=0;n<Ca.length;n++)i=Ca[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Ca.length&&(n=Ca[0],n.blockedOn===null);)IL(n),n.blockedOn===null&&Ca.shift()}var qc=oa.ReactCurrentBatchConfig,R0=!0;function Nk(t,e,n,i){var r=Zt,s=qc.transition;qc.transition=null;try{Zt=1,KS(t,e,n,i)}finally{Zt=r,qc.transition=s}}function kk(t,e,n,i){var r=Zt,s=qc.transition;qc.transition=null;try{Zt=4,KS(t,e,n,i)}finally{Zt=r,qc.transition=s}}function KS(t,e,n,i){if(R0){var r=z_(t,e,n,i);if(r===null)F1(t,e,i,O0,n),aE(t,i);else if(Ok(r,t,e,n,i))i.stopPropagation();else if(aE(t,i),e&4&&-1<Rk.indexOf(t)){for(;r!==null;){var s=mp(r);if(s!==null&&TL(s),s=z_(t,e,n,i),s===null&&F1(t,e,i,O0,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else F1(t,e,i,null,n)}}var O0=null;function z_(t,e,n,i){if(O0=null,t=XS(i),t=ql(t),t!==null)if(e=Tu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=xL(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return O0=t,null}function DL(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Mk()){case YS:return 1;case bL:return 4;case I0:case Ek:return 16;case ML:return 536870912;default:return 16}default:return 16}}var Ia=null,QS=null,r0=null;function RL(){if(r0)return r0;var t,e=QS,n=e.length,i,r="value"in Ia?Ia.value:Ia.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return r0=r.slice(t,1<i?1-i:void 0)}function s0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Um(){return!0}function uE(){return!1}function Ar(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Um:uE,this.isPropagationStopped=uE,this}return bn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Um)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Um)},persist:function(){},isPersistent:Um}),e}var Ch={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eb=Ar(Ch),pp=bn({},Ch,{view:0,detail:0}),Bk=Ar(pp),I1,D1,md,Lv=bn({},pp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==md&&(md&&t.type==="mousemove"?(I1=t.screenX-md.screenX,D1=t.screenY-md.screenY):D1=I1=0,md=t),I1)},movementY:function(t){return"movementY"in t?t.movementY:D1}}),cE=Ar(Lv),Uk=bn({},Lv,{dataTransfer:0}),Fk=Ar(Uk),Vk=bn({},pp,{relatedTarget:0}),R1=Ar(Vk),Gk=bn({},Ch,{animationName:0,elapsedTime:0,pseudoElement:0}),Hk=Ar(Gk),Wk=bn({},Ch,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jk=Ar(Wk),$k=bn({},Ch,{data:0}),hE=Ar($k),qk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Yk[t])?!!e[t]:!1}function tb(){return Zk}var Jk=bn({},pp,{key:function(t){if(t.key){var e=qk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=s0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Xk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tb,charCode:function(t){return t.type==="keypress"?s0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?s0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Kk=Ar(Jk),Qk=bn({},Lv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dE=Ar(Qk),eB=bn({},pp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tb}),tB=Ar(eB),nB=bn({},Ch,{propertyName:0,elapsedTime:0,pseudoElement:0}),iB=Ar(nB),rB=bn({},Lv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sB=Ar(rB),oB=[9,13,27,32],nb=Yo&&"CompositionEvent"in window,rf=null;Yo&&"documentMode"in document&&(rf=document.documentMode);var aB=Yo&&"TextEvent"in window&&!rf,OL=Yo&&(!nb||rf&&8<rf&&11>=rf),fE=String.fromCharCode(32),pE=!1;function zL(t,e){switch(t){case"keyup":return oB.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function NL(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pc=!1;function lB(t,e){switch(t){case"compositionend":return NL(e);case"keypress":return e.which!==32?null:(pE=!0,fE);case"textInput":return t=e.data,t===fE&&pE?null:t;default:return null}}function uB(t,e){if(Pc)return t==="compositionend"||!nb&&zL(t,e)?(t=RL(),r0=QS=Ia=null,Pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return OL&&e.locale!=="ko"?null:e.data;default:return null}}var cB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cB[t.type]:e==="textarea"}function kL(t,e,n,i){pL(i),e=z0(e,"onChange"),0<e.length&&(n=new eb("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var sf=null,Cf=null;function hB(t){XL(t,0)}function Iv(t){var e=Dc(t);if(aL(e))return t}function dB(t,e){if(t==="change")return e}var BL=!1;if(Yo){var O1;if(Yo){var z1="oninput"in document;if(!z1){var gE=document.createElement("div");gE.setAttribute("oninput","return;"),z1=typeof gE.oninput=="function"}O1=z1}else O1=!1;BL=O1&&(!document.documentMode||9<document.documentMode)}function vE(){sf&&(sf.detachEvent("onpropertychange",UL),Cf=sf=null)}function UL(t){if(t.propertyName==="value"&&Iv(Cf)){var e=[];kL(e,Cf,t,XS(t)),yL(hB,e)}}function fB(t,e,n){t==="focusin"?(vE(),sf=e,Cf=n,sf.attachEvent("onpropertychange",UL)):t==="focusout"&&vE()}function pB(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Iv(Cf)}function mB(t,e){if(t==="click")return Iv(e)}function gB(t,e){if(t==="input"||t==="change")return Iv(e)}function vB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Os=typeof Object.is=="function"?Object.is:vB;function Pf(t,e){if(Os(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!v_.call(e,r)||!Os(t[r],e[r]))return!1}return!0}function yE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xE(t,e){var n=yE(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yE(n)}}function FL(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?FL(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function VL(){for(var t=window,e=C0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=C0(t.document)}return e}function ib(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yB(t){var e=VL(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&FL(n.ownerDocument.documentElement,n)){if(i!==null&&ib(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=xE(n,s);var o=xE(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xB=Yo&&"documentMode"in document&&11>=document.documentMode,Lc=null,N_=null,of=null,k_=!1;function _E(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;k_||Lc==null||Lc!==C0(i)||(i=Lc,"selectionStart"in i&&ib(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),of&&Pf(of,i)||(of=i,i=z0(N_,"onSelect"),0<i.length&&(e=new eb("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Lc)))}function Fm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ic={animationend:Fm("Animation","AnimationEnd"),animationiteration:Fm("Animation","AnimationIteration"),animationstart:Fm("Animation","AnimationStart"),transitionend:Fm("Transition","TransitionEnd")},N1={},GL={};Yo&&(GL=document.createElement("div").style,"AnimationEvent"in window||(delete Ic.animationend.animation,delete Ic.animationiteration.animation,delete Ic.animationstart.animation),"TransitionEvent"in window||delete Ic.transitionend.transition);function Dv(t){if(N1[t])return N1[t];if(!Ic[t])return t;var e=Ic[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in GL)return N1[t]=e[n];return t}var HL=Dv("animationend"),WL=Dv("animationiteration"),jL=Dv("animationstart"),$L=Dv("transitionend"),qL=new Map,wE="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function al(t,e){qL.set(t,e),Au(e,[t])}for(var k1=0;k1<wE.length;k1++){var B1=wE[k1],_B=B1.toLowerCase(),wB=B1[0].toUpperCase()+B1.slice(1);al(_B,"on"+wB)}al(HL,"onAnimationEnd");al(WL,"onAnimationIteration");al(jL,"onAnimationStart");al("dblclick","onDoubleClick");al("focusin","onFocus");al("focusout","onBlur");al($L,"onTransitionEnd");ah("onMouseEnter",["mouseout","mouseover"]);ah("onMouseLeave",["mouseout","mouseover"]);ah("onPointerEnter",["pointerout","pointerover"]);ah("onPointerLeave",["pointerout","pointerover"]);Au("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Au("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Au("onBeforeInput",["compositionend","keypress","textInput","paste"]);Au("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Au("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Au("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yd));function SE(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,_k(i,e,void 0,t),t.currentTarget=null}function XL(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;SE(r,a,u),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;SE(r,a,u),s=l}}}if(L0)throw t=D_,L0=!1,D_=null,t}function an(t,e){var n=e[G_];n===void 0&&(n=e[G_]=new Set);var i=t+"__bubble";n.has(i)||(YL(e,t,2,!1),n.add(i))}function U1(t,e,n){var i=0;e&&(i|=4),YL(n,t,i,e)}var Vm="_reactListening"+Math.random().toString(36).slice(2);function Lf(t){if(!t[Vm]){t[Vm]=!0,nL.forEach(function(n){n!=="selectionchange"&&(SB.has(n)||U1(n,!1,t),U1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vm]||(e[Vm]=!0,U1("selectionchange",!1,e))}}function YL(t,e,n,i){switch(DL(e)){case 1:var r=Nk;break;case 4:r=kk;break;default:r=KS}n=r.bind(null,e,n,t),r=void 0,!I_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function F1(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=ql(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}yL(function(){var u=s,d=XS(n),c=[];e:{var h=qL.get(t);if(h!==void 0){var m=eb,g=t;switch(t){case"keypress":if(s0(n)===0)break e;case"keydown":case"keyup":m=Kk;break;case"focusin":g="focus",m=R1;break;case"focusout":g="blur",m=R1;break;case"beforeblur":case"afterblur":m=R1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=cE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Fk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=tB;break;case HL:case WL:case jL:m=Hk;break;case $L:m=iB;break;case"scroll":m=Bk;break;case"wheel":m=sB;break;case"copy":case"cut":case"paste":m=jk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=dE}var v=(e&4)!==0,x=!v&&t==="scroll",y=v?h!==null?h+"Capture":null:h;v=[];for(var _=u,S;_!==null;){S=_;var b=S.stateNode;if(S.tag===5&&b!==null&&(S=b,y!==null&&(b=Mf(_,y),b!=null&&v.push(If(_,b,S)))),x)break;_=_.return}0<v.length&&(h=new m(h,g,null,n,d),c.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==P_&&(g=n.relatedTarget||n.fromElement)&&(ql(g)||g[Zo]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?ql(g):null,g!==null&&(x=Tu(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(v=cE,b="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(v=dE,b="onPointerLeave",y="onPointerEnter",_="pointer"),x=m==null?h:Dc(m),S=g==null?h:Dc(g),h=new v(b,_+"leave",m,n,d),h.target=x,h.relatedTarget=S,b=null,ql(d)===u&&(v=new v(y,_+"enter",g,n,d),v.target=S,v.relatedTarget=x,b=v),x=b,m&&g)t:{for(v=m,y=g,_=0,S=v;S;S=Qu(S))_++;for(S=0,b=y;b;b=Qu(b))S++;for(;0<_-S;)v=Qu(v),_--;for(;0<S-_;)y=Qu(y),S--;for(;_--;){if(v===y||y!==null&&v===y.alternate)break t;v=Qu(v),y=Qu(y)}v=null}else v=null;m!==null&&bE(c,h,m,v,!1),g!==null&&x!==null&&bE(c,x,g,v,!0)}}e:{if(h=u?Dc(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var T=dB;else if(mE(h))if(BL)T=gB;else{T=pB;var E=fB}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=mB);if(T&&(T=T(t,u))){kL(c,T,n,d);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&M_(h,"number",h.value)}switch(E=u?Dc(u):window,t){case"focusin":(mE(E)||E.contentEditable==="true")&&(Lc=E,N_=u,of=null);break;case"focusout":of=N_=Lc=null;break;case"mousedown":k_=!0;break;case"contextmenu":case"mouseup":case"dragend":k_=!1,_E(c,n,d);break;case"selectionchange":if(xB)break;case"keydown":case"keyup":_E(c,n,d)}var L;if(nb)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else Pc?zL(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(OL&&n.locale!=="ko"&&(Pc||A!=="onCompositionStart"?A==="onCompositionEnd"&&Pc&&(L=RL()):(Ia=d,QS="value"in Ia?Ia.value:Ia.textContent,Pc=!0)),E=z0(u,A),0<E.length&&(A=new hE(A,t,null,n,d),c.push({event:A,listeners:E}),L?A.data=L:(L=NL(n),L!==null&&(A.data=L)))),(L=aB?lB(t,n):uB(t,n))&&(u=z0(u,"onBeforeInput"),0<u.length&&(d=new hE("onBeforeInput","beforeinput",null,n,d),c.push({event:d,listeners:u}),d.data=L))}XL(c,e)})}function If(t,e,n){return{instance:t,listener:e,currentTarget:n}}function z0(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Mf(t,n),s!=null&&i.unshift(If(t,s,r)),s=Mf(t,e),s!=null&&i.push(If(t,s,r))),t=t.return}return i}function Qu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bE(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,r?(l=Mf(n,s),l!=null&&o.unshift(If(n,l,a))):r||(l=Mf(n,s),l!=null&&o.push(If(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bB=/\r\n?/g,MB=/\u0000|\uFFFD/g;function ME(t){return(typeof t=="string"?t:""+t).replace(bB,`
`).replace(MB,"")}function Gm(t,e,n){if(e=ME(e),ME(t)!==e&&n)throw Error(Re(425))}function N0(){}var B_=null,U_=null;function F_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var V_=typeof setTimeout=="function"?setTimeout:void 0,EB=typeof clearTimeout=="function"?clearTimeout:void 0,EE=typeof Promise=="function"?Promise:void 0,AB=typeof queueMicrotask=="function"?queueMicrotask:typeof EE<"u"?function(t){return EE.resolve(null).then(t).catch(TB)}:V_;function TB(t){setTimeout(function(){throw t})}function V1(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Tf(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Tf(e)}function $a(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function AE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ph=Math.random().toString(36).slice(2),io="__reactFiber$"+Ph,Df="__reactProps$"+Ph,Zo="__reactContainer$"+Ph,G_="__reactEvents$"+Ph,CB="__reactListeners$"+Ph,PB="__reactHandles$"+Ph;function ql(t){var e=t[io];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zo]||n[io]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=AE(t);t!==null;){if(n=t[io])return n;t=AE(t)}return e}t=n,n=t.parentNode}return null}function mp(t){return t=t[io]||t[Zo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Dc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Re(33))}function Rv(t){return t[Df]||null}var H_=[],Rc=-1;function ll(t){return{current:t}}function dn(t){0>Rc||(t.current=H_[Rc],H_[Rc]=null,Rc--)}function on(t,e){Rc++,H_[Rc]=t.current,t.current=e}var tl={},Pi=ll(tl),nr=ll(!1),fu=tl;function lh(t,e){var n=t.type.contextTypes;if(!n)return tl;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ir(t){return t=t.childContextTypes,t!=null}function k0(){dn(nr),dn(Pi)}function TE(t,e,n){if(Pi.current!==tl)throw Error(Re(168));on(Pi,e),on(nr,n)}function ZL(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Re(108,fk(t)||"Unknown",r));return bn({},n,i)}function B0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||tl,fu=Pi.current,on(Pi,t),on(nr,nr.current),!0}function CE(t,e,n){var i=t.stateNode;if(!i)throw Error(Re(169));n?(t=ZL(t,e,fu),i.__reactInternalMemoizedMergedChildContext=t,dn(nr),dn(Pi),on(Pi,t)):dn(nr),on(nr,n)}var ko=null,Ov=!1,G1=!1;function JL(t){ko===null?ko=[t]:ko.push(t)}function LB(t){Ov=!0,JL(t)}function ul(){if(!G1&&ko!==null){G1=!0;var t=0,e=Zt;try{var n=ko;for(Zt=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}ko=null,Ov=!1}catch(r){throw ko!==null&&(ko=ko.slice(t+1)),SL(YS,ul),r}finally{Zt=e,G1=!1}}return null}var Oc=[],zc=0,U0=null,F0=0,Xr=[],Yr=0,pu=null,Vo=1,Go="";function zl(t,e){Oc[zc++]=F0,Oc[zc++]=U0,U0=t,F0=e}function KL(t,e,n){Xr[Yr++]=Vo,Xr[Yr++]=Go,Xr[Yr++]=pu,pu=t;var i=Vo;t=Go;var r=32-Ts(i)-1;i&=~(1<<r),n+=1;var s=32-Ts(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Vo=1<<32-Ts(e)+r|n<<r|i,Go=s+t}else Vo=1<<s|n<<r|i,Go=t}function rb(t){t.return!==null&&(zl(t,1),KL(t,1,0))}function sb(t){for(;t===U0;)U0=Oc[--zc],Oc[zc]=null,F0=Oc[--zc],Oc[zc]=null;for(;t===pu;)pu=Xr[--Yr],Xr[Yr]=null,Go=Xr[--Yr],Xr[Yr]=null,Vo=Xr[--Yr],Xr[Yr]=null}var wr=null,gr=null,mn=!1,Es=null;function QL(t,e){var n=ts(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function PE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,wr=t,gr=$a(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,wr=t,gr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=pu!==null?{id:Vo,overflow:Go}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ts(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,wr=t,gr=null,!0):!1;default:return!1}}function W_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function j_(t){if(mn){var e=gr;if(e){var n=e;if(!PE(t,e)){if(W_(t))throw Error(Re(418));e=$a(n.nextSibling);var i=wr;e&&PE(t,e)?QL(i,n):(t.flags=t.flags&-4097|2,mn=!1,wr=t)}}else{if(W_(t))throw Error(Re(418));t.flags=t.flags&-4097|2,mn=!1,wr=t}}}function LE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;wr=t}function Hm(t){if(t!==wr)return!1;if(!mn)return LE(t),mn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!F_(t.type,t.memoizedProps)),e&&(e=gr)){if(W_(t))throw eI(),Error(Re(418));for(;e;)QL(t,e),e=$a(e.nextSibling)}if(LE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Re(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){gr=$a(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}gr=null}}else gr=wr?$a(t.stateNode.nextSibling):null;return!0}function eI(){for(var t=gr;t;)t=$a(t.nextSibling)}function uh(){gr=wr=null,mn=!1}function ob(t){Es===null?Es=[t]:Es.push(t)}var IB=oa.ReactCurrentBatchConfig;function Ss(t,e){if(t&&t.defaultProps){e=bn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var V0=ll(null),G0=null,Nc=null,ab=null;function lb(){ab=Nc=G0=null}function ub(t){var e=V0.current;dn(V0),t._currentValue=e}function $_(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Xc(t,e){G0=t,ab=Nc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(er=!0),t.firstContext=null)}function os(t){var e=t._currentValue;if(ab!==t)if(t={context:t,memoizedValue:e,next:null},Nc===null){if(G0===null)throw Error(Re(308));Nc=t,G0.dependencies={lanes:0,firstContext:t}}else Nc=Nc.next=t;return e}var Xl=null;function cb(t){Xl===null?Xl=[t]:Xl.push(t)}function tI(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,cb(e)):(n.next=r.next,r.next=n),e.interleaved=n,Jo(t,i)}function Jo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Aa=!1;function hb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qa(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Bt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Jo(t,n)}return r=i.interleaved,r===null?(e.next=e,cb(i)):(e.next=r.next,r.next=e),i.interleaved=e,Jo(t,n)}function o0(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZS(t,n)}}function IE(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function H0(t,e,n,i){var r=t.updateQueue;Aa=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var c=r.baseState;o=0,d=u=l=null,a=s;do{var h=a.lane,m=a.eventTime;if((i&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,v=a;switch(h=e,m=n,v.tag){case 1:if(g=v.payload,typeof g=="function"){c=g.call(m,c,h);break e}c=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,h=typeof g=="function"?g.call(m,c,h):g,h==null)break e;c=bn({},c,h);break e;case 2:Aa=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else m={eventTime:m,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,l=c):d=d.next=m,o|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(1);if(d===null&&(l=c),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);gu|=o,t.lanes=o,t.memoizedState=c}}function DE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Re(191,r));r.call(i)}}}var iI=new tL.Component().refs;function q_(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:bn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zv={isMounted:function(t){return(t=t._reactInternals)?Tu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Fi(),r=Ya(t),s=jo(i,r);s.payload=e,n!=null&&(s.callback=n),e=qa(t,s,r),e!==null&&(Cs(e,t,r,i),o0(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Fi(),r=Ya(t),s=jo(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=qa(t,s,r),e!==null&&(Cs(e,t,r,i),o0(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Fi(),i=Ya(t),r=jo(n,i);r.tag=2,e!=null&&(r.callback=e),e=qa(t,r,i),e!==null&&(Cs(e,t,i,n),o0(e,t,i))}};function RE(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Pf(n,i)||!Pf(r,s):!0}function rI(t,e,n){var i=!1,r=tl,s=e.contextType;return typeof s=="object"&&s!==null?s=os(s):(r=ir(e)?fu:Pi.current,i=e.contextTypes,s=(i=i!=null)?lh(t,r):tl),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zv,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function OE(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&zv.enqueueReplaceState(e,e.state,null)}function X_(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=iI,hb(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=os(s):(s=ir(e)?fu:Pi.current,r.context=lh(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(q_(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&zv.enqueueReplaceState(r,r.state,null),H0(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function gd(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Re(309));var i=n.stateNode}if(!i)throw Error(Re(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===iI&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Re(284));if(!n._owner)throw Error(Re(290,t))}return t}function Wm(t,e){throw t=Object.prototype.toString.call(e),Error(Re(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zE(t){var e=t._init;return e(t._payload)}function sI(t){function e(y,_){if(t){var S=y.deletions;S===null?(y.deletions=[_],y.flags|=16):S.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function i(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function r(y,_){return y=Za(y,_),y.index=0,y.sibling=null,y}function s(y,_,S){return y.index=S,t?(S=y.alternate,S!==null?(S=S.index,S<_?(y.flags|=2,_):S):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,_,S,b){return _===null||_.tag!==6?(_=Y1(S,y.mode,b),_.return=y,_):(_=r(_,S),_.return=y,_)}function l(y,_,S,b){var T=S.type;return T===Cc?d(y,_,S.props.children,b,S.key):_!==null&&(_.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ea&&zE(T)===_.type)?(b=r(_,S.props),b.ref=gd(y,_,S),b.return=y,b):(b=d0(S.type,S.key,S.props,null,y.mode,b),b.ref=gd(y,_,S),b.return=y,b)}function u(y,_,S,b){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=Z1(S,y.mode,b),_.return=y,_):(_=r(_,S.children||[]),_.return=y,_)}function d(y,_,S,b,T){return _===null||_.tag!==7?(_=ru(S,y.mode,b,T),_.return=y,_):(_=r(_,S),_.return=y,_)}function c(y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Y1(""+_,y.mode,S),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Rm:return S=d0(_.type,_.key,_.props,null,y.mode,S),S.ref=gd(y,null,_),S.return=y,S;case Tc:return _=Z1(_,y.mode,S),_.return=y,_;case Ea:var b=_._init;return c(y,b(_._payload),S)}if(qd(_)||hd(_))return _=ru(_,y.mode,S,null),_.return=y,_;Wm(y,_)}return null}function h(y,_,S,b){var T=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return T!==null?null:a(y,_,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Rm:return S.key===T?l(y,_,S,b):null;case Tc:return S.key===T?u(y,_,S,b):null;case Ea:return T=S._init,h(y,_,T(S._payload),b)}if(qd(S)||hd(S))return T!==null?null:d(y,_,S,b,null);Wm(y,S)}return null}function m(y,_,S,b,T){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(S)||null,a(_,y,""+b,T);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Rm:return y=y.get(b.key===null?S:b.key)||null,l(_,y,b,T);case Tc:return y=y.get(b.key===null?S:b.key)||null,u(_,y,b,T);case Ea:var E=b._init;return m(y,_,S,E(b._payload),T)}if(qd(b)||hd(b))return y=y.get(S)||null,d(_,y,b,T,null);Wm(_,b)}return null}function g(y,_,S,b){for(var T=null,E=null,L=_,A=_=0,I=null;L!==null&&A<S.length;A++){L.index>A?(I=L,L=null):I=L.sibling;var P=h(y,L,S[A],b);if(P===null){L===null&&(L=I);break}t&&L&&P.alternate===null&&e(y,L),_=s(P,_,A),E===null?T=P:E.sibling=P,E=P,L=I}if(A===S.length)return n(y,L),mn&&zl(y,A),T;if(L===null){for(;A<S.length;A++)L=c(y,S[A],b),L!==null&&(_=s(L,_,A),E===null?T=L:E.sibling=L,E=L);return mn&&zl(y,A),T}for(L=i(y,L);A<S.length;A++)I=m(L,y,A,S[A],b),I!==null&&(t&&I.alternate!==null&&L.delete(I.key===null?A:I.key),_=s(I,_,A),E===null?T=I:E.sibling=I,E=I);return t&&L.forEach(function(O){return e(y,O)}),mn&&zl(y,A),T}function v(y,_,S,b){var T=hd(S);if(typeof T!="function")throw Error(Re(150));if(S=T.call(S),S==null)throw Error(Re(151));for(var E=T=null,L=_,A=_=0,I=null,P=S.next();L!==null&&!P.done;A++,P=S.next()){L.index>A?(I=L,L=null):I=L.sibling;var O=h(y,L,P.value,b);if(O===null){L===null&&(L=I);break}t&&L&&O.alternate===null&&e(y,L),_=s(O,_,A),E===null?T=O:E.sibling=O,E=O,L=I}if(P.done)return n(y,L),mn&&zl(y,A),T;if(L===null){for(;!P.done;A++,P=S.next())P=c(y,P.value,b),P!==null&&(_=s(P,_,A),E===null?T=P:E.sibling=P,E=P);return mn&&zl(y,A),T}for(L=i(y,L);!P.done;A++,P=S.next())P=m(L,y,A,P.value,b),P!==null&&(t&&P.alternate!==null&&L.delete(P.key===null?A:P.key),_=s(P,_,A),E===null?T=P:E.sibling=P,E=P);return t&&L.forEach(function(k){return e(y,k)}),mn&&zl(y,A),T}function x(y,_,S,b){if(typeof S=="object"&&S!==null&&S.type===Cc&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Rm:e:{for(var T=S.key,E=_;E!==null;){if(E.key===T){if(T=S.type,T===Cc){if(E.tag===7){n(y,E.sibling),_=r(E,S.props.children),_.return=y,y=_;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Ea&&zE(T)===E.type){n(y,E.sibling),_=r(E,S.props),_.ref=gd(y,E,S),_.return=y,y=_;break e}n(y,E);break}else e(y,E);E=E.sibling}S.type===Cc?(_=ru(S.props.children,y.mode,b,S.key),_.return=y,y=_):(b=d0(S.type,S.key,S.props,null,y.mode,b),b.ref=gd(y,_,S),b.return=y,y=b)}return o(y);case Tc:e:{for(E=S.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(y,_.sibling),_=r(_,S.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=Z1(S,y.mode,b),_.return=y,y=_}return o(y);case Ea:return E=S._init,x(y,_,E(S._payload),b)}if(qd(S))return g(y,_,S,b);if(hd(S))return v(y,_,S,b);Wm(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(y,_.sibling),_=r(_,S),_.return=y,y=_):(n(y,_),_=Y1(S,y.mode,b),_.return=y,y=_),o(y)):n(y,_)}return x}var ch=sI(!0),oI=sI(!1),gp={},co=ll(gp),Rf=ll(gp),Of=ll(gp);function Yl(t){if(t===gp)throw Error(Re(174));return t}function db(t,e){switch(on(Of,e),on(Rf,t),on(co,gp),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:A_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=A_(e,t)}dn(co),on(co,e)}function hh(){dn(co),dn(Rf),dn(Of)}function aI(t){Yl(Of.current);var e=Yl(co.current),n=A_(e,t.type);e!==n&&(on(Rf,t),on(co,n))}function fb(t){Rf.current===t&&(dn(co),dn(Rf))}var yn=ll(0);function W0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var H1=[];function pb(){for(var t=0;t<H1.length;t++)H1[t]._workInProgressVersionPrimary=null;H1.length=0}var a0=oa.ReactCurrentDispatcher,W1=oa.ReactCurrentBatchConfig,mu=0,wn=null,Yn=null,ai=null,j0=!1,af=!1,zf=0,DB=0;function wi(){throw Error(Re(321))}function mb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Os(t[n],e[n]))return!1;return!0}function gb(t,e,n,i,r,s){if(mu=s,wn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,a0.current=t===null||t.memoizedState===null?NB:kB,t=n(i,r),af){s=0;do{if(af=!1,zf=0,25<=s)throw Error(Re(301));s+=1,ai=Yn=null,e.updateQueue=null,a0.current=BB,t=n(i,r)}while(af)}if(a0.current=$0,e=Yn!==null&&Yn.next!==null,mu=0,ai=Yn=wn=null,j0=!1,e)throw Error(Re(300));return t}function vb(){var t=zf!==0;return zf=0,t}function no(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ai===null?wn.memoizedState=ai=t:ai=ai.next=t,ai}function as(){if(Yn===null){var t=wn.alternate;t=t!==null?t.memoizedState:null}else t=Yn.next;var e=ai===null?wn.memoizedState:ai.next;if(e!==null)ai=e,Yn=t;else{if(t===null)throw Error(Re(310));Yn=t,t={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},ai===null?wn.memoizedState=ai=t:ai=ai.next=t}return ai}function Nf(t,e){return typeof e=="function"?e(t):e}function j1(t){var e=as(),n=e.queue;if(n===null)throw Error(Re(311));n.lastRenderedReducer=t;var i=Yn,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((mu&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:t(i,u.action);else{var c={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=c,o=i):l=l.next=c,wn.lanes|=d,gu|=d}u=u.next}while(u!==null&&u!==s);l===null?o=i:l.next=a,Os(i,e.memoizedState)||(er=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,wn.lanes|=s,gu|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $1(t){var e=as(),n=e.queue;if(n===null)throw Error(Re(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Os(s,e.memoizedState)||(er=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function lI(){}function uI(t,e){var n=wn,i=as(),r=e(),s=!Os(i.memoizedState,r);if(s&&(i.memoizedState=r,er=!0),i=i.queue,yb(dI.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||ai!==null&&ai.memoizedState.tag&1){if(n.flags|=2048,kf(9,hI.bind(null,n,i,r,e),void 0,null),ui===null)throw Error(Re(349));mu&30||cI(n,e,r)}return r}function cI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wn.updateQueue,e===null?(e={lastEffect:null,stores:null},wn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hI(t,e,n,i){e.value=n,e.getSnapshot=i,fI(e)&&pI(t)}function dI(t,e,n){return n(function(){fI(e)&&pI(t)})}function fI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Os(t,n)}catch{return!0}}function pI(t){var e=Jo(t,1);e!==null&&Cs(e,t,1,-1)}function NE(t){var e=no();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nf,lastRenderedState:t},e.queue=t,t=t.dispatch=zB.bind(null,wn,t),[e.memoizedState,t]}function kf(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=wn.updateQueue,e===null?(e={lastEffect:null,stores:null},wn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function mI(){return as().memoizedState}function l0(t,e,n,i){var r=no();wn.flags|=t,r.memoizedState=kf(1|e,n,void 0,i===void 0?null:i)}function Nv(t,e,n,i){var r=as();i=i===void 0?null:i;var s=void 0;if(Yn!==null){var o=Yn.memoizedState;if(s=o.destroy,i!==null&&mb(i,o.deps)){r.memoizedState=kf(e,n,s,i);return}}wn.flags|=t,r.memoizedState=kf(1|e,n,s,i)}function kE(t,e){return l0(8390656,8,t,e)}function yb(t,e){return Nv(2048,8,t,e)}function gI(t,e){return Nv(4,2,t,e)}function vI(t,e){return Nv(4,4,t,e)}function yI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xI(t,e,n){return n=n!=null?n.concat([t]):null,Nv(4,4,yI.bind(null,e,t),n)}function xb(){}function _I(t,e){var n=as();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&mb(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function wI(t,e){var n=as();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&mb(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function SI(t,e,n){return mu&21?(Os(n,e)||(n=EL(),wn.lanes|=n,gu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,er=!0),t.memoizedState=n)}function RB(t,e){var n=Zt;Zt=n!==0&&4>n?n:4,t(!0);var i=W1.transition;W1.transition={};try{t(!1),e()}finally{Zt=n,W1.transition=i}}function bI(){return as().memoizedState}function OB(t,e,n){var i=Ya(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},MI(t))EI(e,n);else if(n=tI(t,e,n,i),n!==null){var r=Fi();Cs(n,t,i,r),AI(n,e,i)}}function zB(t,e,n){var i=Ya(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(MI(t))EI(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Os(a,o)){var l=e.interleaved;l===null?(r.next=r,cb(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=tI(t,e,r,i),n!==null&&(r=Fi(),Cs(n,t,i,r),AI(n,e,i))}}function MI(t){var e=t.alternate;return t===wn||e!==null&&e===wn}function EI(t,e){af=j0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function AI(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,ZS(t,n)}}var $0={readContext:os,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useInsertionEffect:wi,useLayoutEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useMutableSource:wi,useSyncExternalStore:wi,useId:wi,unstable_isNewReconciler:!1},NB={readContext:os,useCallback:function(t,e){return no().memoizedState=[t,e===void 0?null:e],t},useContext:os,useEffect:kE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,l0(4194308,4,yI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return l0(4194308,4,t,e)},useInsertionEffect:function(t,e){return l0(4,2,t,e)},useMemo:function(t,e){var n=no();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=no();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=OB.bind(null,wn,t),[i.memoizedState,t]},useRef:function(t){var e=no();return t={current:t},e.memoizedState=t},useState:NE,useDebugValue:xb,useDeferredValue:function(t){return no().memoizedState=t},useTransition:function(){var t=NE(!1),e=t[0];return t=RB.bind(null,t[1]),no().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=wn,r=no();if(mn){if(n===void 0)throw Error(Re(407));n=n()}else{if(n=e(),ui===null)throw Error(Re(349));mu&30||cI(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,kE(dI.bind(null,i,s,t),[t]),i.flags|=2048,kf(9,hI.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=no(),e=ui.identifierPrefix;if(mn){var n=Go,i=Vo;n=(i&~(1<<32-Ts(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=zf++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=DB++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},kB={readContext:os,useCallback:_I,useContext:os,useEffect:yb,useImperativeHandle:xI,useInsertionEffect:gI,useLayoutEffect:vI,useMemo:wI,useReducer:j1,useRef:mI,useState:function(){return j1(Nf)},useDebugValue:xb,useDeferredValue:function(t){var e=as();return SI(e,Yn.memoizedState,t)},useTransition:function(){var t=j1(Nf)[0],e=as().memoizedState;return[t,e]},useMutableSource:lI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1},BB={readContext:os,useCallback:_I,useContext:os,useEffect:yb,useImperativeHandle:xI,useInsertionEffect:gI,useLayoutEffect:vI,useMemo:wI,useReducer:$1,useRef:mI,useState:function(){return $1(Nf)},useDebugValue:xb,useDeferredValue:function(t){var e=as();return Yn===null?e.memoizedState=t:SI(e,Yn.memoizedState,t)},useTransition:function(){var t=$1(Nf)[0],e=as().memoizedState;return[t,e]},useMutableSource:lI,useSyncExternalStore:uI,useId:bI,unstable_isNewReconciler:!1};function dh(t,e){try{var n="",i=e;do n+=dk(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function q1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Y_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var UB=typeof WeakMap=="function"?WeakMap:Map;function TI(t,e,n){n=jo(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){X0||(X0=!0,sw=i),Y_(t,e)},n}function CI(t,e,n){n=jo(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){Y_(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Y_(t,e),typeof i!="function"&&(Xa===null?Xa=new Set([this]):Xa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function BE(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new UB;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=QB.bind(null,t,e,n),e.then(t,t))}function UE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function FE(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=jo(-1,1),e.tag=2,qa(n,e,1))),n.lanes|=1),t)}var FB=oa.ReactCurrentOwner,er=!1;function ki(t,e,n,i){e.child=t===null?oI(e,null,n,i):ch(e,t.child,n,i)}function VE(t,e,n,i,r){n=n.render;var s=e.ref;return Xc(e,r),i=gb(t,e,n,i,s,r),n=vb(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ko(t,e,r)):(mn&&n&&rb(e),e.flags|=1,ki(t,e,i,r),e.child)}function GE(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!Tb(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,PI(t,e,s,i,r)):(t=d0(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Pf,n(o,i)&&t.ref===e.ref)return Ko(t,e,r)}return e.flags|=1,t=Za(s,i),t.ref=e.ref,t.return=e,e.child=t}function PI(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Pf(s,i)&&t.ref===e.ref)if(er=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(er=!0);else return e.lanes=t.lanes,Ko(t,e,r)}return Z_(t,e,n,i,r)}function LI(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},on(Bc,pr),pr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,on(Bc,pr),pr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,on(Bc,pr),pr|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,on(Bc,pr),pr|=i;return ki(t,e,r,n),e.child}function II(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Z_(t,e,n,i,r){var s=ir(n)?fu:Pi.current;return s=lh(e,s),Xc(e,r),n=gb(t,e,n,i,s,r),i=vb(),t!==null&&!er?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ko(t,e,r)):(mn&&i&&rb(e),e.flags|=1,ki(t,e,n,r),e.child)}function HE(t,e,n,i,r){if(ir(n)){var s=!0;B0(e)}else s=!1;if(Xc(e,r),e.stateNode===null)u0(t,e),rI(e,n,i),X_(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=os(u):(u=ir(n)?fu:Pi.current,u=lh(e,u));var d=n.getDerivedStateFromProps,c=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";c||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&OE(e,o,i,u),Aa=!1;var h=e.memoizedState;o.state=h,H0(e,i,o,r),l=e.memoizedState,a!==i||h!==l||nr.current||Aa?(typeof d=="function"&&(q_(e,n,d,i),l=e.memoizedState),(a=Aa||RE(e,n,a,i,h,l,u))?(c||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,nI(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ss(e.type,a),o.props=u,c=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=os(l):(l=ir(n)?fu:Pi.current,l=lh(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==c||h!==l)&&OE(e,o,i,l),Aa=!1,h=e.memoizedState,o.state=h,H0(e,i,o,r);var g=e.memoizedState;a!==c||h!==g||nr.current||Aa?(typeof m=="function"&&(q_(e,n,m,i),g=e.memoizedState),(u=Aa||RE(e,n,u,i,h,g,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=g),o.props=i,o.state=g,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),i=!1)}return J_(t,e,n,i,s,r)}function J_(t,e,n,i,r,s){II(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&CE(e,n,!1),Ko(t,e,s);i=e.stateNode,FB.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=ch(e,t.child,null,s),e.child=ch(e,null,a,s)):ki(t,e,a,s),e.memoizedState=i.state,r&&CE(e,n,!0),e.child}function DI(t){var e=t.stateNode;e.pendingContext?TE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&TE(t,e.context,!1),db(t,e.containerInfo)}function WE(t,e,n,i,r){return uh(),ob(r),e.flags|=256,ki(t,e,n,i),e.child}var K_={dehydrated:null,treeContext:null,retryLane:0};function Q_(t){return{baseLanes:t,cachePool:null,transitions:null}}function RI(t,e,n){var i=e.pendingProps,r=yn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),on(yn,r&1),t===null)return j_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Uv(o,i,0,null),t=ru(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Q_(n),e.memoizedState=K_,t):_b(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return VB(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Za(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Za(a,s):(s=ru(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?Q_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=K_,i}return s=t.child,t=s.sibling,i=Za(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function _b(t,e){return e=Uv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function jm(t,e,n,i){return i!==null&&ob(i),ch(e,t.child,null,n),t=_b(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function VB(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=q1(Error(Re(422))),jm(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Uv({mode:"visible",children:i.children},r,0,null),s=ru(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&ch(e,t.child,null,o),e.child.memoizedState=Q_(o),e.memoizedState=K_,s);if(!(e.mode&1))return jm(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(Re(419)),i=q1(s,i,void 0),jm(t,e,o,i)}if(a=(o&t.childLanes)!==0,er||a){if(i=ui,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Jo(t,r),Cs(i,t,r,-1))}return Ab(),i=q1(Error(Re(421))),jm(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=eU.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,gr=$a(r.nextSibling),wr=e,mn=!0,Es=null,t!==null&&(Xr[Yr++]=Vo,Xr[Yr++]=Go,Xr[Yr++]=pu,Vo=t.id,Go=t.overflow,pu=e),e=_b(e,i.children),e.flags|=4096,e)}function jE(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),$_(t.return,e,n)}function X1(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function OI(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ki(t,e,i.children,n),i=yn.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&jE(t,n,e);else if(t.tag===19)jE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(on(yn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&W0(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),X1(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&W0(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}X1(e,!0,n,null,s);break;case"together":X1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function u0(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ko(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Re(153));if(e.child!==null){for(t=e.child,n=Za(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Za(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GB(t,e,n){switch(e.tag){case 3:DI(e),uh();break;case 5:aI(e);break;case 1:ir(e.type)&&B0(e);break;case 4:db(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;on(V0,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(on(yn,yn.current&1),e.flags|=128,null):n&e.child.childLanes?RI(t,e,n):(on(yn,yn.current&1),t=Ko(t,e,n),t!==null?t.sibling:null);on(yn,yn.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return OI(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),on(yn,yn.current),i)break;return null;case 22:case 23:return e.lanes=0,LI(t,e,n)}return Ko(t,e,n)}var zI,ew,NI,kI;zI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ew=function(){};NI=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Yl(co.current);var s=null;switch(n){case"input":r=S_(t,r),i=S_(t,i),s=[];break;case"select":r=bn({},r,{value:void 0}),i=bn({},i,{value:void 0}),s=[];break;case"textarea":r=E_(t,r),i=E_(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=N0)}T_(n,i);var o;n=null;for(u in r)if(!i.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var a=r[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Sf.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in i){var l=i[u];if(a=r!=null?r[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Sf.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&an("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};kI=function(t,e,n,i){n!==i&&(e.flags|=4)};function vd(t,e){if(!mn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Si(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function HB(t,e,n){var i=e.pendingProps;switch(sb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Si(e),null;case 1:return ir(e.type)&&k0(),Si(e),null;case 3:return i=e.stateNode,hh(),dn(nr),dn(Pi),pb(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Hm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Es!==null&&(lw(Es),Es=null))),ew(t,e),Si(e),null;case 5:fb(e);var r=Yl(Of.current);if(n=e.type,t!==null&&e.stateNode!=null)NI(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Re(166));return Si(e),null}if(t=Yl(co.current),Hm(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[io]=e,i[Df]=s,t=(e.mode&1)!==0,n){case"dialog":an("cancel",i),an("close",i);break;case"iframe":case"object":case"embed":an("load",i);break;case"video":case"audio":for(r=0;r<Yd.length;r++)an(Yd[r],i);break;case"source":an("error",i);break;case"img":case"image":case"link":an("error",i),an("load",i);break;case"details":an("toggle",i);break;case"input":eE(i,s),an("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},an("invalid",i);break;case"textarea":nE(i,s),an("invalid",i)}T_(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Gm(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Gm(i.textContent,a,t),r=["children",""+a]):Sf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&an("scroll",i)}switch(n){case"input":Om(i),tE(i,s,!0);break;case"textarea":Om(i),iE(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=N0)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cL(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[io]=e,t[Df]=i,zI(t,e,!1,!1),e.stateNode=t;e:{switch(o=C_(n,i),n){case"dialog":an("cancel",t),an("close",t),r=i;break;case"iframe":case"object":case"embed":an("load",t),r=i;break;case"video":case"audio":for(r=0;r<Yd.length;r++)an(Yd[r],t);r=i;break;case"source":an("error",t),r=i;break;case"img":case"image":case"link":an("error",t),an("load",t),r=i;break;case"details":an("toggle",t),r=i;break;case"input":eE(t,i),r=S_(t,i),an("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=bn({},i,{value:void 0}),an("invalid",t);break;case"textarea":nE(t,i),r=E_(t,i),an("invalid",t);break;default:r=i}T_(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?fL(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hL(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&bf(t,l):typeof l=="number"&&bf(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Sf.hasOwnProperty(s)?l!=null&&s==="onScroll"&&an("scroll",t):l!=null&&WS(t,s,l,o))}switch(n){case"input":Om(t),tE(t,i,!1);break;case"textarea":Om(t),iE(t);break;case"option":i.value!=null&&t.setAttribute("value",""+el(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?Wc(t,!!i.multiple,s,!1):i.defaultValue!=null&&Wc(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=N0)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Si(e),null;case 6:if(t&&e.stateNode!=null)kI(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Re(166));if(n=Yl(Of.current),Yl(co.current),Hm(e)){if(i=e.stateNode,n=e.memoizedProps,i[io]=e,(s=i.nodeValue!==n)&&(t=wr,t!==null))switch(t.tag){case 3:Gm(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gm(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[io]=e,e.stateNode=i}return Si(e),null;case 13:if(dn(yn),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(mn&&gr!==null&&e.mode&1&&!(e.flags&128))eI(),uh(),e.flags|=98560,s=!1;else if(s=Hm(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(Re(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Re(317));s[io]=e}else uh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Si(e),s=!1}else Es!==null&&(lw(Es),Es=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||yn.current&1?Zn===0&&(Zn=3):Ab())),e.updateQueue!==null&&(e.flags|=4),Si(e),null);case 4:return hh(),ew(t,e),t===null&&Lf(e.stateNode.containerInfo),Si(e),null;case 10:return ub(e.type._context),Si(e),null;case 17:return ir(e.type)&&k0(),Si(e),null;case 19:if(dn(yn),s=e.memoizedState,s===null)return Si(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)vd(s,!1);else{if(Zn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=W0(t),o!==null){for(e.flags|=128,vd(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return on(yn,yn.current&1|2),e.child}t=t.sibling}s.tail!==null&&kn()>fh&&(e.flags|=128,i=!0,vd(s,!1),e.lanes=4194304)}else{if(!i)if(t=W0(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vd(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!mn)return Si(e),null}else 2*kn()-s.renderingStartTime>fh&&n!==1073741824&&(e.flags|=128,i=!0,vd(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=kn(),e.sibling=null,n=yn.current,on(yn,i?n&1|2:n&1),e):(Si(e),null);case 22:case 23:return Eb(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?pr&1073741824&&(Si(e),e.subtreeFlags&6&&(e.flags|=8192)):Si(e),null;case 24:return null;case 25:return null}throw Error(Re(156,e.tag))}function WB(t,e){switch(sb(e),e.tag){case 1:return ir(e.type)&&k0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return hh(),dn(nr),dn(Pi),pb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return fb(e),null;case 13:if(dn(yn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Re(340));uh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dn(yn),null;case 4:return hh(),null;case 10:return ub(e.type._context),null;case 22:case 23:return Eb(),null;case 24:return null;default:return null}}var $m=!1,Ei=!1,jB=typeof WeakSet=="function"?WeakSet:Set,Je=null;function kc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Pn(t,e,i)}else n.current=null}function tw(t,e,n){try{n()}catch(i){Pn(t,e,i)}}var $E=!1;function $B(t,e){if(B_=R0,t=VL(),ib(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,c=t,h=null;t:for(;;){for(var m;c!==n||r!==0&&c.nodeType!==3||(a=o+r),c!==s||i!==0&&c.nodeType!==3||(l=o+i),c.nodeType===3&&(o+=c.nodeValue.length),(m=c.firstChild)!==null;)h=c,c=m;for(;;){if(c===t)break t;if(h===n&&++u===r&&(a=o),h===s&&++d===i&&(l=o),(m=c.nextSibling)!==null)break;c=h,h=c.parentNode}c=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(U_={focusedElem:t,selectionRange:n},R0=!1,Je=e;Je!==null;)if(e=Je,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Je=t;else for(;Je!==null;){e=Je;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,x=g.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?v:Ss(e.type,v),x);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Re(163))}}catch(b){Pn(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,Je=t;break}Je=e.return}return g=$E,$E=!1,g}function lf(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&tw(e,n,s)}r=r.next}while(r!==i)}}function kv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function nw(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function BI(t){var e=t.alternate;e!==null&&(t.alternate=null,BI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[io],delete e[Df],delete e[G_],delete e[CB],delete e[PB])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UI(t){return t.tag===5||t.tag===3||t.tag===4}function qE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function iw(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=N0));else if(i!==4&&(t=t.child,t!==null))for(iw(t,e,n),t=t.sibling;t!==null;)iw(t,e,n),t=t.sibling}function rw(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(rw(t,e,n),t=t.sibling;t!==null;)rw(t,e,n),t=t.sibling}var hi=null,bs=!1;function va(t,e,n){for(n=n.child;n!==null;)FI(t,e,n),n=n.sibling}function FI(t,e,n){if(uo&&typeof uo.onCommitFiberUnmount=="function")try{uo.onCommitFiberUnmount(Pv,n)}catch{}switch(n.tag){case 5:Ei||kc(n,e);case 6:var i=hi,r=bs;hi=null,va(t,e,n),hi=i,bs=r,hi!==null&&(bs?(t=hi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):hi.removeChild(n.stateNode));break;case 18:hi!==null&&(bs?(t=hi,n=n.stateNode,t.nodeType===8?V1(t.parentNode,n):t.nodeType===1&&V1(t,n),Tf(t)):V1(hi,n.stateNode));break;case 4:i=hi,r=bs,hi=n.stateNode.containerInfo,bs=!0,va(t,e,n),hi=i,bs=r;break;case 0:case 11:case 14:case 15:if(!Ei&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&tw(n,e,o),r=r.next}while(r!==i)}va(t,e,n);break;case 1:if(!Ei&&(kc(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Pn(n,e,a)}va(t,e,n);break;case 21:va(t,e,n);break;case 22:n.mode&1?(Ei=(i=Ei)||n.memoizedState!==null,va(t,e,n),Ei=i):va(t,e,n);break;default:va(t,e,n)}}function XE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jB),e.forEach(function(i){var r=tU.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function gs(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:hi=a.stateNode,bs=!1;break e;case 3:hi=a.stateNode.containerInfo,bs=!0;break e;case 4:hi=a.stateNode.containerInfo,bs=!0;break e}a=a.return}if(hi===null)throw Error(Re(160));FI(s,o,r),hi=null,bs=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Pn(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)VI(e,t),e=e.sibling}function VI(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gs(e,t),Xs(t),i&4){try{lf(3,t,t.return),kv(3,t)}catch(v){Pn(t,t.return,v)}try{lf(5,t,t.return)}catch(v){Pn(t,t.return,v)}}break;case 1:gs(e,t),Xs(t),i&512&&n!==null&&kc(n,n.return);break;case 5:if(gs(e,t),Xs(t),i&512&&n!==null&&kc(n,n.return),t.flags&32){var r=t.stateNode;try{bf(r,"")}catch(v){Pn(t,t.return,v)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&lL(r,s),C_(a,o);var u=C_(a,s);for(o=0;o<l.length;o+=2){var d=l[o],c=l[o+1];d==="style"?fL(r,c):d==="dangerouslySetInnerHTML"?hL(r,c):d==="children"?bf(r,c):WS(r,d,c,u)}switch(a){case"input":b_(r,s);break;case"textarea":uL(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Wc(r,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?Wc(r,!!s.multiple,s.defaultValue,!0):Wc(r,!!s.multiple,s.multiple?[]:"",!1))}r[Df]=s}catch(v){Pn(t,t.return,v)}}break;case 6:if(gs(e,t),Xs(t),i&4){if(t.stateNode===null)throw Error(Re(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(v){Pn(t,t.return,v)}}break;case 3:if(gs(e,t),Xs(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Tf(e.containerInfo)}catch(v){Pn(t,t.return,v)}break;case 4:gs(e,t),Xs(t);break;case 13:gs(e,t),Xs(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(bb=kn())),i&4&&XE(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ei=(u=Ei)||d,gs(e,t),Ei=u):gs(e,t),Xs(t),i&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Je=t,d=t.child;d!==null;){for(c=Je=d;Je!==null;){switch(h=Je,m=h.child,h.tag){case 0:case 11:case 14:case 15:lf(4,h,h.return);break;case 1:kc(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){i=h,n=h.return;try{e=i,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(v){Pn(i,n,v)}}break;case 5:kc(h,h.return);break;case 22:if(h.memoizedState!==null){ZE(c);continue}}m!==null?(m.return=h,Je=m):ZE(c)}d=d.sibling}e:for(d=null,c=t;;){if(c.tag===5){if(d===null){d=c;try{r=c.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=c.stateNode,l=c.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=dL("display",o))}catch(v){Pn(t,t.return,v)}}}else if(c.tag===6){if(d===null)try{c.stateNode.nodeValue=u?"":c.memoizedProps}catch(v){Pn(t,t.return,v)}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===t)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===t)break e;for(;c.sibling===null;){if(c.return===null||c.return===t)break e;d===c&&(d=null),c=c.return}d===c&&(d=null),c.sibling.return=c.return,c=c.sibling}}break;case 19:gs(e,t),Xs(t),i&4&&XE(t);break;case 21:break;default:gs(e,t),Xs(t)}}function Xs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(UI(n)){var i=n;break e}n=n.return}throw Error(Re(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(bf(r,""),i.flags&=-33);var s=qE(t);rw(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=qE(t);iw(t,a,o);break;default:throw Error(Re(161))}}catch(l){Pn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function qB(t,e,n){Je=t,GI(t)}function GI(t,e,n){for(var i=(t.mode&1)!==0;Je!==null;){var r=Je,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||$m;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Ei;a=$m;var u=Ei;if($m=o,(Ei=l)&&!u)for(Je=r;Je!==null;)o=Je,l=o.child,o.tag===22&&o.memoizedState!==null?JE(r):l!==null?(l.return=o,Je=l):JE(r);for(;s!==null;)Je=s,GI(s),s=s.sibling;Je=r,$m=a,Ei=u}YE(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,Je=s):YE(t)}}function YE(t){for(;Je!==null;){var e=Je;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ei||kv(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Ei)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ss(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&DE(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}DE(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var c=d.dehydrated;c!==null&&Tf(c)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Re(163))}Ei||e.flags&512&&nw(e)}catch(h){Pn(e,e.return,h)}}if(e===t){Je=null;break}if(n=e.sibling,n!==null){n.return=e.return,Je=n;break}Je=e.return}}function ZE(t){for(;Je!==null;){var e=Je;if(e===t){Je=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Je=n;break}Je=e.return}}function JE(t){for(;Je!==null;){var e=Je;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{kv(4,e)}catch(l){Pn(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){Pn(e,r,l)}}var s=e.return;try{nw(e)}catch(l){Pn(e,s,l)}break;case 5:var o=e.return;try{nw(e)}catch(l){Pn(e,o,l)}}}catch(l){Pn(e,e.return,l)}if(e===t){Je=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Je=a;break}Je=e.return}}var XB=Math.ceil,q0=oa.ReactCurrentDispatcher,wb=oa.ReactCurrentOwner,is=oa.ReactCurrentBatchConfig,Bt=0,ui=null,Wn=null,fi=0,pr=0,Bc=ll(0),Zn=0,Bf=null,gu=0,Bv=0,Sb=0,uf=null,Zi=null,bb=0,fh=1/0,No=null,X0=!1,sw=null,Xa=null,qm=!1,Da=null,Y0=0,cf=0,ow=null,c0=-1,h0=0;function Fi(){return Bt&6?kn():c0!==-1?c0:c0=kn()}function Ya(t){return t.mode&1?Bt&2&&fi!==0?fi&-fi:IB.transition!==null?(h0===0&&(h0=EL()),h0):(t=Zt,t!==0||(t=window.event,t=t===void 0?16:DL(t.type)),t):1}function Cs(t,e,n,i){if(50<cf)throw cf=0,ow=null,Error(Re(185));fp(t,n,i),(!(Bt&2)||t!==ui)&&(t===ui&&(!(Bt&2)&&(Bv|=n),Zn===4&&Pa(t,fi)),rr(t,i),n===1&&Bt===0&&!(e.mode&1)&&(fh=kn()+500,Ov&&ul()))}function rr(t,e){var n=t.callbackNode;Ik(t,e);var i=D0(t,t===ui?fi:0);if(i===0)n!==null&&oE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&oE(n),e===1)t.tag===0?LB(KE.bind(null,t)):JL(KE.bind(null,t)),AB(function(){!(Bt&6)&&ul()}),n=null;else{switch(AL(i)){case 1:n=YS;break;case 4:n=bL;break;case 16:n=I0;break;case 536870912:n=ML;break;default:n=I0}n=ZI(n,HI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function HI(t,e){if(c0=-1,h0=0,Bt&6)throw Error(Re(327));var n=t.callbackNode;if(Yc()&&t.callbackNode!==n)return null;var i=D0(t,t===ui?fi:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Z0(t,i);else{e=i;var r=Bt;Bt|=2;var s=jI();(ui!==t||fi!==e)&&(No=null,fh=kn()+500,iu(t,e));do try{JB();break}catch(a){WI(t,a)}while(1);lb(),q0.current=s,Bt=r,Wn!==null?e=0:(ui=null,fi=0,e=Zn)}if(e!==0){if(e===2&&(r=R_(t),r!==0&&(i=r,e=aw(t,r))),e===1)throw n=Bf,iu(t,0),Pa(t,i),rr(t,kn()),n;if(e===6)Pa(t,i);else{if(r=t.current.alternate,!(i&30)&&!YB(r)&&(e=Z0(t,i),e===2&&(s=R_(t),s!==0&&(i=s,e=aw(t,s))),e===1))throw n=Bf,iu(t,0),Pa(t,i),rr(t,kn()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Re(345));case 2:Nl(t,Zi,No);break;case 3:if(Pa(t,i),(i&130023424)===i&&(e=bb+500-kn(),10<e)){if(D0(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Fi(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=V_(Nl.bind(null,t,Zi,No),e);break}Nl(t,Zi,No);break;case 4:if(Pa(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Ts(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=kn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*XB(i/1960))-i,10<i){t.timeoutHandle=V_(Nl.bind(null,t,Zi,No),i);break}Nl(t,Zi,No);break;case 5:Nl(t,Zi,No);break;default:throw Error(Re(329))}}}return rr(t,kn()),t.callbackNode===n?HI.bind(null,t):null}function aw(t,e){var n=uf;return t.current.memoizedState.isDehydrated&&(iu(t,e).flags|=256),t=Z0(t,e),t!==2&&(e=Zi,Zi=n,e!==null&&lw(e)),t}function lw(t){Zi===null?Zi=t:Zi.push.apply(Zi,t)}function YB(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Os(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pa(t,e){for(e&=~Sb,e&=~Bv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ts(e),i=1<<n;t[n]=-1,e&=~i}}function KE(t){if(Bt&6)throw Error(Re(327));Yc();var e=D0(t,0);if(!(e&1))return rr(t,kn()),null;var n=Z0(t,e);if(t.tag!==0&&n===2){var i=R_(t);i!==0&&(e=i,n=aw(t,i))}if(n===1)throw n=Bf,iu(t,0),Pa(t,e),rr(t,kn()),n;if(n===6)throw Error(Re(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Nl(t,Zi,No),rr(t,kn()),null}function Mb(t,e){var n=Bt;Bt|=1;try{return t(e)}finally{Bt=n,Bt===0&&(fh=kn()+500,Ov&&ul())}}function vu(t){Da!==null&&Da.tag===0&&!(Bt&6)&&Yc();var e=Bt;Bt|=1;var n=is.transition,i=Zt;try{if(is.transition=null,Zt=1,t)return t()}finally{Zt=i,is.transition=n,Bt=e,!(Bt&6)&&ul()}}function Eb(){pr=Bc.current,dn(Bc)}function iu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,EB(n)),Wn!==null)for(n=Wn.return;n!==null;){var i=n;switch(sb(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&k0();break;case 3:hh(),dn(nr),dn(Pi),pb();break;case 5:fb(i);break;case 4:hh();break;case 13:dn(yn);break;case 19:dn(yn);break;case 10:ub(i.type._context);break;case 22:case 23:Eb()}n=n.return}if(ui=t,Wn=t=Za(t.current,null),fi=pr=e,Zn=0,Bf=null,Sb=Bv=gu=0,Zi=uf=null,Xl!==null){for(e=0;e<Xl.length;e++)if(n=Xl[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}Xl=null}return t}function WI(t,e){do{var n=Wn;try{if(lb(),a0.current=$0,j0){for(var i=wn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}j0=!1}if(mu=0,ai=Yn=wn=null,af=!1,zf=0,wb.current=null,n===null||n.return===null){Zn=1,Bf=e,Wn=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=fi,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,c=d.tag;if(!(d.mode&1)&&(c===0||c===11||c===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=UE(o);if(m!==null){m.flags&=-257,FE(m,o,a,s,e),m.mode&1&&BE(s,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var v=new Set;v.add(l),e.updateQueue=v}else g.add(l);break e}else{if(!(e&1)){BE(s,u,e),Ab();break e}l=Error(Re(426))}}else if(mn&&a.mode&1){var x=UE(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),FE(x,o,a,s,e),ob(dh(l,a));break e}}s=l=dh(l,a),Zn!==4&&(Zn=2),uf===null?uf=[s]:uf.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=TI(s,l,e);IE(s,y);break e;case 1:a=l;var _=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Xa===null||!Xa.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=CI(s,a,e);IE(s,b);break e}}s=s.return}while(s!==null)}qI(n)}catch(T){e=T,Wn===n&&n!==null&&(Wn=n=n.return);continue}break}while(1)}function jI(){var t=q0.current;return q0.current=$0,t===null?$0:t}function Ab(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),ui===null||!(gu&268435455)&&!(Bv&268435455)||Pa(ui,fi)}function Z0(t,e){var n=Bt;Bt|=2;var i=jI();(ui!==t||fi!==e)&&(No=null,iu(t,e));do try{ZB();break}catch(r){WI(t,r)}while(1);if(lb(),Bt=n,q0.current=i,Wn!==null)throw Error(Re(261));return ui=null,fi=0,Zn}function ZB(){for(;Wn!==null;)$I(Wn)}function JB(){for(;Wn!==null&&!Sk();)$I(Wn)}function $I(t){var e=YI(t.alternate,t,pr);t.memoizedProps=t.pendingProps,e===null?qI(t):Wn=e,wb.current=null}function qI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=WB(n,e),n!==null){n.flags&=32767,Wn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Zn=6,Wn=null;return}}else if(n=HB(n,e,pr),n!==null){Wn=n;return}if(e=e.sibling,e!==null){Wn=e;return}Wn=e=t}while(e!==null);Zn===0&&(Zn=5)}function Nl(t,e,n){var i=Zt,r=is.transition;try{is.transition=null,Zt=1,KB(t,e,n,i)}finally{is.transition=r,Zt=i}return null}function KB(t,e,n,i){do Yc();while(Da!==null);if(Bt&6)throw Error(Re(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Re(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Dk(t,s),t===ui&&(Wn=ui=null,fi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qm||(qm=!0,ZI(I0,function(){return Yc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=is.transition,is.transition=null;var o=Zt;Zt=1;var a=Bt;Bt|=4,wb.current=null,$B(t,n),VI(n,t),yB(U_),R0=!!B_,U_=B_=null,t.current=n,qB(n),bk(),Bt=a,Zt=o,is.transition=s}else t.current=n;if(qm&&(qm=!1,Da=t,Y0=r),s=t.pendingLanes,s===0&&(Xa=null),Ak(n.stateNode),rr(t,kn()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(X0)throw X0=!1,t=sw,sw=null,t;return Y0&1&&t.tag!==0&&Yc(),s=t.pendingLanes,s&1?t===ow?cf++:(cf=0,ow=t):cf=0,ul(),null}function Yc(){if(Da!==null){var t=AL(Y0),e=is.transition,n=Zt;try{if(is.transition=null,Zt=16>t?16:t,Da===null)var i=!1;else{if(t=Da,Da=null,Y0=0,Bt&6)throw Error(Re(331));var r=Bt;for(Bt|=4,Je=t.current;Je!==null;){var s=Je,o=s.child;if(Je.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(Je=u;Je!==null;){var d=Je;switch(d.tag){case 0:case 11:case 15:lf(8,d,s)}var c=d.child;if(c!==null)c.return=d,Je=c;else for(;Je!==null;){d=Je;var h=d.sibling,m=d.return;if(BI(d),d===u){Je=null;break}if(h!==null){h.return=m,Je=h;break}Je=m}}}var g=s.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}Je=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Je=o;else e:for(;Je!==null;){if(s=Je,s.flags&2048)switch(s.tag){case 0:case 11:case 15:lf(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,Je=y;break e}Je=s.return}}var _=t.current;for(Je=_;Je!==null;){o=Je;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,Je=S;else e:for(o=_;Je!==null;){if(a=Je,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:kv(9,a)}}catch(T){Pn(a,a.return,T)}if(a===o){Je=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,Je=b;break e}Je=a.return}}if(Bt=r,ul(),uo&&typeof uo.onPostCommitFiberRoot=="function")try{uo.onPostCommitFiberRoot(Pv,t)}catch{}i=!0}return i}finally{Zt=n,is.transition=e}}return!1}function QE(t,e,n){e=dh(n,e),e=TI(t,e,1),t=qa(t,e,1),e=Fi(),t!==null&&(fp(t,1,e),rr(t,e))}function Pn(t,e,n){if(t.tag===3)QE(t,t,n);else for(;e!==null;){if(e.tag===3){QE(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Xa===null||!Xa.has(i))){t=dh(n,t),t=CI(e,t,1),e=qa(e,t,1),t=Fi(),e!==null&&(fp(e,1,t),rr(e,t));break}}e=e.return}}function QB(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Fi(),t.pingedLanes|=t.suspendedLanes&n,ui===t&&(fi&n)===n&&(Zn===4||Zn===3&&(fi&130023424)===fi&&500>kn()-bb?iu(t,0):Sb|=n),rr(t,e)}function XI(t,e){e===0&&(t.mode&1?(e=km,km<<=1,!(km&130023424)&&(km=4194304)):e=1);var n=Fi();t=Jo(t,e),t!==null&&(fp(t,e,n),rr(t,n))}function eU(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),XI(t,n)}function tU(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Re(314))}i!==null&&i.delete(e),XI(t,n)}var YI;YI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nr.current)er=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return er=!1,GB(t,e,n);er=!!(t.flags&131072)}else er=!1,mn&&e.flags&1048576&&KL(e,F0,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;u0(t,e),t=e.pendingProps;var r=lh(e,Pi.current);Xc(e,n),r=gb(null,e,i,t,r,n);var s=vb();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ir(i)?(s=!0,B0(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,hb(e),r.updater=zv,e.stateNode=r,r._reactInternals=e,X_(e,i,t,n),e=J_(null,e,i,!0,s,n)):(e.tag=0,mn&&s&&rb(e),ki(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(u0(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=iU(i),t=Ss(i,t),r){case 0:e=Z_(null,e,i,t,n);break e;case 1:e=HE(null,e,i,t,n);break e;case 11:e=VE(null,e,i,t,n);break e;case 14:e=GE(null,e,i,Ss(i.type,t),n);break e}throw Error(Re(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ss(i,r),Z_(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ss(i,r),HE(t,e,i,r,n);case 3:e:{if(DI(e),t===null)throw Error(Re(387));i=e.pendingProps,s=e.memoizedState,r=s.element,nI(t,e),H0(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=dh(Error(Re(423)),e),e=WE(t,e,i,n,r);break e}else if(i!==r){r=dh(Error(Re(424)),e),e=WE(t,e,i,n,r);break e}else for(gr=$a(e.stateNode.containerInfo.firstChild),wr=e,mn=!0,Es=null,n=oI(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(uh(),i===r){e=Ko(t,e,n);break e}ki(t,e,i,n)}e=e.child}return e;case 5:return aI(e),t===null&&j_(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,F_(i,r)?o=null:s!==null&&F_(i,s)&&(e.flags|=32),II(t,e),ki(t,e,o,n),e.child;case 6:return t===null&&j_(e),null;case 13:return RI(t,e,n);case 4:return db(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=ch(e,null,i,n):ki(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ss(i,r),VE(t,e,i,r,n);case 7:return ki(t,e,e.pendingProps,n),e.child;case 8:return ki(t,e,e.pendingProps.children,n),e.child;case 12:return ki(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,on(V0,i._currentValue),i._currentValue=o,s!==null)if(Os(s.value,o)){if(s.children===r.children&&!nr.current){e=Ko(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=jo(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),$_(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Re(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),$_(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ki(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Xc(e,n),r=os(r),i=i(r),e.flags|=1,ki(t,e,i,n),e.child;case 14:return i=e.type,r=Ss(i,e.pendingProps),r=Ss(i.type,r),GE(t,e,i,r,n);case 15:return PI(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ss(i,r),u0(t,e),e.tag=1,ir(i)?(t=!0,B0(e)):t=!1,Xc(e,n),rI(e,i,r),X_(e,i,r,n),J_(null,e,i,!0,t,n);case 19:return OI(t,e,n);case 22:return LI(t,e,n)}throw Error(Re(156,e.tag))};function ZI(t,e){return SL(t,e)}function nU(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(t,e,n,i){return new nU(t,e,n,i)}function Tb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iU(t){if(typeof t=="function")return Tb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$S)return 11;if(t===qS)return 14}return 2}function Za(t,e){var n=t.alternate;return n===null?(n=ts(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function d0(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")Tb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Cc:return ru(n.children,r,s,e);case jS:o=8,r|=8;break;case y_:return t=ts(12,n,e,r|2),t.elementType=y_,t.lanes=s,t;case x_:return t=ts(13,n,e,r),t.elementType=x_,t.lanes=s,t;case __:return t=ts(19,n,e,r),t.elementType=__,t.lanes=s,t;case sL:return Uv(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case iL:o=10;break e;case rL:o=9;break e;case $S:o=11;break e;case qS:o=14;break e;case Ea:o=16,i=null;break e}throw Error(Re(130,t==null?t:typeof t,""))}return e=ts(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function ru(t,e,n,i){return t=ts(7,t,i,e),t.lanes=n,t}function Uv(t,e,n,i){return t=ts(22,t,i,e),t.elementType=sL,t.lanes=n,t.stateNode={isHidden:!1},t}function Y1(t,e,n){return t=ts(6,t,null,e),t.lanes=n,t}function Z1(t,e,n){return e=ts(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rU(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=L1(0),this.expirationTimes=L1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=L1(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Cb(t,e,n,i,r,s,o,a,l){return t=new rU(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ts(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hb(s),t}function sU(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tc,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function JI(t){if(!t)return tl;t=t._reactInternals;e:{if(Tu(t)!==t||t.tag!==1)throw Error(Re(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ir(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Re(171))}if(t.tag===1){var n=t.type;if(ir(n))return ZL(t,n,e)}return e}function KI(t,e,n,i,r,s,o,a,l){return t=Cb(n,i,!0,t,r,s,o,a,l),t.context=JI(null),n=t.current,i=Fi(),r=Ya(n),s=jo(i,r),s.callback=e??null,qa(n,s,r),t.current.lanes=r,fp(t,r,i),rr(t,i),t}function Fv(t,e,n,i){var r=e.current,s=Fi(),o=Ya(r);return n=JI(n),e.context===null?e.context=n:e.pendingContext=n,e=jo(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=qa(r,e,o),t!==null&&(Cs(t,r,o,s),o0(t,r,o)),o}function J0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function eA(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Pb(t,e){eA(t,e),(t=t.alternate)&&eA(t,e)}function oU(){return null}var QI=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lb(t){this._internalRoot=t}Vv.prototype.render=Lb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Re(409));Fv(t,e,null,null)};Vv.prototype.unmount=Lb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vu(function(){Fv(null,t,null,null)}),e[Zo]=null}};function Vv(t){this._internalRoot=t}Vv.prototype.unstable_scheduleHydration=function(t){if(t){var e=PL();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ca.length&&e!==0&&e<Ca[n].priority;n++);Ca.splice(n,0,t),n===0&&IL(t)}};function Ib(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Gv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function tA(){}function aU(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var u=J0(o);s.call(u)}}var o=KI(e,i,t,0,null,!1,!1,"",tA);return t._reactRootContainer=o,t[Zo]=o.current,Lf(t.nodeType===8?t.parentNode:t),vu(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var u=J0(l);a.call(u)}}var l=Cb(t,0,!1,null,null,!1,!1,"",tA);return t._reactRootContainer=l,t[Zo]=l.current,Lf(t.nodeType===8?t.parentNode:t),vu(function(){Fv(e,l,n,i)}),l}function Hv(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=J0(o);a.call(l)}}Fv(e,o,t,r)}else o=aU(n,e,t,r,i);return J0(o)}TL=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Xd(e.pendingLanes);n!==0&&(ZS(e,n|1),rr(e,kn()),!(Bt&6)&&(fh=kn()+500,ul()))}break;case 13:vu(function(){var i=Jo(t,1);if(i!==null){var r=Fi();Cs(i,t,1,r)}}),Pb(t,1)}};JS=function(t){if(t.tag===13){var e=Jo(t,134217728);if(e!==null){var n=Fi();Cs(e,t,134217728,n)}Pb(t,134217728)}};CL=function(t){if(t.tag===13){var e=Ya(t),n=Jo(t,e);if(n!==null){var i=Fi();Cs(n,t,e,i)}Pb(t,e)}};PL=function(){return Zt};LL=function(t,e){var n=Zt;try{return Zt=t,e()}finally{Zt=n}};L_=function(t,e,n){switch(e){case"input":if(b_(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=Rv(i);if(!r)throw Error(Re(90));aL(i),b_(i,r)}}}break;case"textarea":uL(t,n);break;case"select":e=n.value,e!=null&&Wc(t,!!n.multiple,e,!1)}};gL=Mb;vL=vu;var lU={usingClientEntryPoint:!1,Events:[mp,Dc,Rv,pL,mL,Mb]},yd={findFiberByHostInstance:ql,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},uU={bundleType:yd.bundleType,version:yd.version,rendererPackageName:yd.rendererPackageName,rendererConfig:yd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oa.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_L(t),t===null?null:t.stateNode},findFiberByHostInstance:yd.findFiberByHostInstance||oU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xm.isDisabled&&Xm.supportsFiber)try{Pv=Xm.inject(uU),uo=Xm}catch{}}Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lU;Er.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ib(e))throw Error(Re(200));return sU(t,e,null,n)};Er.createRoot=function(t,e){if(!Ib(t))throw Error(Re(299));var n=!1,i="",r=QI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Cb(t,1,!1,null,null,n,!1,i,r),t[Zo]=e.current,Lf(t.nodeType===8?t.parentNode:t),new Lb(e)};Er.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Re(188)):(t=Object.keys(t).join(","),Error(Re(268,t)));return t=_L(e),t=t===null?null:t.stateNode,t};Er.flushSync=function(t){return vu(t)};Er.hydrate=function(t,e,n){if(!Gv(e))throw Error(Re(200));return Hv(null,t,e,!0,n)};Er.hydrateRoot=function(t,e,n){if(!Ib(t))throw Error(Re(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=QI;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=KI(e,null,t,1,n??null,r,!1,s,o),t[Zo]=e.current,Lf(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Vv(e)};Er.render=function(t,e,n){if(!Gv(e))throw Error(Re(200));return Hv(null,t,e,!1,n)};Er.unmountComponentAtNode=function(t){if(!Gv(t))throw Error(Re(40));return t._reactRootContainer?(vu(function(){Hv(null,null,t,!1,function(){t._reactRootContainer=null,t[Zo]=null})}),!0):!1};Er.unstable_batchedUpdates=Mb;Er.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Gv(n))throw Error(Re(200));if(t==null||t._reactInternals===void 0)throw Error(Re(38));return Hv(t,e,n,!1,i)};Er.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Er})(ok);var Db,nA=m_;Db=nA.createRoot,nA.hydrateRoot;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Wv="149",cU={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},hU={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},eD=0,uw=1,tD=2,dU=3,nD=0,jv=1,hf=2,Zl=3,Qo=0,sr=1,so=2,fU=2,$o=0,su=1,cw=2,hw=3,dw=4,iD=5,Vl=100,rD=101,sD=102,fw=103,pw=104,oD=200,aD=201,lD=202,uD=203,Rb=204,Ob=205,cD=206,hD=207,dD=208,fD=209,pD=210,mD=0,gD=1,vD=2,K0=3,yD=4,xD=5,_D=6,wD=7,vp=0,SD=1,bD=2,Ps=0,MD=1,ED=2,AD=3,zb=4,TD=5,$v=300,ea=301,ta=302,Uf=303,Ff=304,Cu=306,Vf=1e3,Ai=1001,Gf=1002,Nn=1003,Q0=1004,pU=1004,df=1005,mU=1005,xn=1006,Nb=1007,gU=1007,nl=1008,vU=1008,na=1009,CD=1010,PD=1011,kb=1012,LD=1013,Ra=1014,oo=1015,yu=1016,ID=1017,DD=1018,ou=1020,RD=1021,Ji=1023,OD=1024,zD=1025,Ja=1026,xu=1027,ND=1028,kD=1029,BD=1030,UD=1031,FD=1033,f0=33776,p0=33777,m0=33778,g0=33779,mw=35840,gw=35841,vw=35842,yw=35843,VD=36196,xw=37492,_w=37496,ww=37808,Sw=37809,bw=37810,Mw=37811,Ew=37812,Aw=37813,Tw=37814,Cw=37815,Pw=37816,Lw=37817,Iw=37818,Dw=37819,Rw=37820,Ow=37821,v0=36492,GD=36283,zw=36284,Nw=36285,kw=36286,HD=2200,WD=2201,jD=2202,Hf=2300,Wf=2301,y0=2302,Jl=2400,Kl=2401,jf=2402,qv=2500,Bb=2501,yU=0,xU=1,_U=2,ls=3e3,jt=3001,$D=3200,qD=3201,cl=0,XD=1,wU="",Ms="srgb",ph="srgb-linear",SU=0,x0=7680,bU=7681,MU=7682,EU=7683,AU=34055,TU=34056,CU=5386,PU=512,LU=513,IU=514,DU=515,RU=516,OU=517,zU=518,YD=519,$f=35044,NU=35048,kU=35040,BU=35045,UU=35049,FU=35041,VU=35046,GU=35050,HU=35042,WU="100",Bw="300 es",ev=1035;class po{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const bi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let iA=1234567;const au=Math.PI/180,qf=180/Math.PI;function Sr(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(bi[t&255]+bi[t>>8&255]+bi[t>>16&255]+bi[t>>24&255]+"-"+bi[e&255]+bi[e>>8&255]+"-"+bi[e>>16&15|64]+bi[e>>24&255]+"-"+bi[n&63|128]+bi[n>>8&255]+"-"+bi[n>>16&255]+bi[n>>24&255]+bi[i&255]+bi[i>>8&255]+bi[i>>16&255]+bi[i>>24&255]).toLowerCase()}function Bn(t,e,n){return Math.max(e,Math.min(n,t))}function Ub(t,e){return(t%e+e)%e}function jU(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function $U(t,e,n){return t!==e?(n-t)/(e-t):0}function ff(t,e,n){return(1-n)*t+n*e}function qU(t,e,n,i){return ff(t,e,1-Math.exp(-n*i))}function XU(t,e=1){return e-Math.abs(Ub(t,e*2)-e)}function YU(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function ZU(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function JU(t,e){return t+Math.floor(Math.random()*(e-t+1))}function KU(t,e){return t+Math.random()*(e-t)}function QU(t){return t*(.5-Math.random())}function eF(t){t!==void 0&&(iA=t);let e=iA+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function tF(t){return t*au}function nF(t){return t*qf}function Uw(t){return(t&t-1)===0&&t!==0}function ZD(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function tv(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function iF(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),u=s((e+i)/2),d=o((e+i)/2),c=s((e-i)/2),h=o((e-i)/2),m=s((i-e)/2),g=o((i-e)/2);switch(r){case"XYX":t.set(a*d,l*c,l*h,a*u);break;case"YZY":t.set(l*h,a*d,l*c,a*u);break;case"ZXZ":t.set(l*c,l*h,a*d,a*u);break;case"XZX":t.set(a*d,l*g,l*m,a*u);break;case"YXY":t.set(l*m,a*d,l*g,a*u);break;case"ZYZ":t.set(l*g,l*m,a*d,a*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ho(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function en(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var Sn=Object.freeze({__proto__:null,DEG2RAD:au,RAD2DEG:qf,ceilPowerOfTwo:ZD,clamp:Bn,damp:qU,degToRad:tF,denormalize:Ho,euclideanModulo:Ub,floorPowerOfTwo:tv,generateUUID:Sr,inverseLerp:$U,isPowerOfTwo:Uw,lerp:ff,mapLinear:jU,normalize:en,pingpong:XU,radToDeg:nF,randFloat:KU,randFloatSpread:QU,randInt:JU,seededRandom:eF,setQuaternionFromProperEuler:iF,smootherstep:ZU,smoothstep:YU});class te{constructor(e=0,n=0){te.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Jn{constructor(){Jn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,n,i,r,s,o,a,l,u){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=n,d[4]=s,d[5]=l,d[6]=i,d[7]=o,d[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],u=i[1],d=i[4],c=i[7],h=i[2],m=i[5],g=i[8],v=r[0],x=r[3],y=r[6],_=r[1],S=r[4],b=r[7],T=r[2],E=r[5],L=r[8];return s[0]=o*v+a*_+l*T,s[3]=o*x+a*S+l*E,s[6]=o*y+a*b+l*L,s[1]=u*v+d*_+c*T,s[4]=u*x+d*S+c*E,s[7]=u*y+d*b+c*L,s[2]=h*v+m*_+g*T,s[5]=h*x+m*S+g*E,s[8]=h*y+m*b+g*L,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8];return n*o*d-n*a*u-i*s*d+i*a*l+r*s*u-r*o*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],c=d*o-a*u,h=a*l-d*s,m=u*s-o*l,g=n*c+i*h+r*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/g;return e[0]=c*v,e[1]=(r*u-d*i)*v,e[2]=(a*i-r*o)*v,e[3]=h*v,e[4]=(d*n-r*l)*v,e[5]=(r*s-a*n)*v,e[6]=m*v,e[7]=(i*l-u*n)*v,e[8]=(o*n-i*s)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const l=Math.cos(s),u=Math.sin(s);return this.set(i*l,i*u,-i*(l*o+u*a)+o+e,-r*u,r*l,-r*(-u*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(J1.makeScale(e,n)),this}rotate(e){return this.premultiply(J1.makeRotation(-e)),this}translate(e,n){return this.premultiply(J1.makeTranslation(e,n)),this}makeTranslation(e,n){return this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const J1=new Jn;function JD(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const rF={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Uc(t,e){return new rF[t](e)}function Xf(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function lu(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function _0(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const K1={[Ms]:{[ph]:lu},[ph]:{[Ms]:_0}},Mi={legacyMode:!0,get workingColorSpace(){return ph},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(K1[e]&&K1[e][n]!==void 0){const i=K1[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},KD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},qn={r:0,g:0,b:0},vs={h:0,s:0,l:0},Ym={h:0,s:0,l:0};function Q1(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}function Zm(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}class Ge{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ms){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Mi.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Mi.workingColorSpace){return this.r=e,this.g=n,this.b=i,Mi.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Mi.workingColorSpace){if(e=Ub(e,1),n=Bn(n,0,1),i=Bn(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=Q1(o,s,e+1/3),this.g=Q1(o,s,e),this.b=Q1(o,s,e-1/3)}return Mi.toWorkingColorSpace(this,r),this}setStyle(e,n=Ms){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Mi.toWorkingColorSpace(this,n),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Mi.toWorkingColorSpace(this,n),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){const l=parseFloat(s[1])/360,u=parseFloat(s[2])/100,d=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,u,d,n)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Mi.toWorkingColorSpace(this,n),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Mi.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e,n=Ms){const i=KD[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=lu(e.r),this.g=lu(e.g),this.b=lu(e.b),this}copyLinearToSRGB(e){return this.r=_0(e.r),this.g=_0(e.g),this.b=_0(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ms){return Mi.fromWorkingColorSpace(Zm(this,qn),e),Bn(qn.r*255,0,255)<<16^Bn(qn.g*255,0,255)<<8^Bn(qn.b*255,0,255)<<0}getHexString(e=Ms){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Mi.workingColorSpace){Mi.fromWorkingColorSpace(Zm(this,qn),n);const i=qn.r,r=qn.g,s=qn.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,u;const d=(a+o)/2;if(a===o)l=0,u=0;else{const c=o-a;switch(u=d<=.5?c/(o+a):c/(2-o-a),o){case i:l=(r-s)/c+(r<s?6:0);break;case r:l=(s-i)/c+2;break;case s:l=(i-r)/c+4;break}l/=6}return e.h=l,e.s=u,e.l=d,e}getRGB(e,n=Mi.workingColorSpace){return Mi.fromWorkingColorSpace(Zm(this,qn),n),e.r=qn.r,e.g=qn.g,e.b=qn.b,e}getStyle(e=Ms){return Mi.fromWorkingColorSpace(Zm(this,qn),e),e!==Ms?`color(${e} ${qn.r} ${qn.g} ${qn.b})`:`rgb(${qn.r*255|0},${qn.g*255|0},${qn.b*255|0})`}offsetHSL(e,n,i){return this.getHSL(vs),vs.h+=e,vs.s+=n,vs.l+=i,this.setHSL(vs.h,vs.s,vs.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(vs),e.getHSL(Ym);const i=ff(vs.h,Ym.h,n),r=ff(vs.s,Ym.s,n),s=ff(vs.l,Ym.l,n);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Ge.NAMES=KD;let ec;class Fb{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{ec===void 0&&(ec=Xf("canvas")),ec.width=e.width,ec.height=e.height;const i=ec.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=ec}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=Xf("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=lu(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(lu(n[i]/255)*255):n[i]=lu(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Ql{constructor(e=null){this.isSource=!0,this.uuid=Sr(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(ex(r[o].image)):s.push(ex(r[o]))}else s=ex(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function ex(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?Fb.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let sF=0;class gn extends po{constructor(e=gn.DEFAULT_IMAGE,n=gn.DEFAULT_MAPPING,i=Ai,r=Ai,s=xn,o=nl,a=Ji,l=na,u=gn.DEFAULT_ANISOTROPY,d=ls){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:sF++}),this.uuid=Sr(),this.name="",this.source=new Ql(e),this.mipmaps=[],this.mapping=n,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new te(0,0),this.repeat=new te(1,1),this.center=new te(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Jn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==$v)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Vf:e.x=e.x-Math.floor(e.x);break;case Ai:e.x=e.x<0?0:1;break;case Gf:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Vf:e.y=e.y-Math.floor(e.y);break;case Ai:e.y=e.y<0?0:1;break;case Gf:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}gn.DEFAULT_IMAGE=null;gn.DEFAULT_MAPPING=$v;gn.DEFAULT_ANISOTROPY=1;class _t{constructor(e=0,n=0,i=0,r=1){_t.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,u=l[0],d=l[4],c=l[8],h=l[1],m=l[5],g=l[9],v=l[2],x=l[6],y=l[10];if(Math.abs(d-h)<.01&&Math.abs(c-v)<.01&&Math.abs(g-x)<.01){if(Math.abs(d+h)<.1&&Math.abs(c+v)<.1&&Math.abs(g+x)<.1&&Math.abs(u+m+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const S=(u+1)/2,b=(m+1)/2,T=(y+1)/2,E=(d+h)/4,L=(c+v)/4,A=(g+x)/4;return S>b&&S>T?S<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(S),r=E/i,s=L/i):b>T?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=E/r,s=A/r):T<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(T),i=L/s,r=A/s),this.set(i,r,s,n),this}let _=Math.sqrt((x-g)*(x-g)+(c-v)*(c-v)+(h-d)*(h-d));return Math.abs(_)<.001&&(_=1),this.x=(x-g)/_,this.y=(c-v)/_,this.z=(h-d)/_,this.w=Math.acos((u+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class us extends po{constructor(e=1,n=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new _t(0,0,e,n),this.scissorTest=!1,this.viewport=new _t(0,0,e,n);const r={width:e,height:n,depth:1};this.texture=new gn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:xn,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Ql(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Xv extends gn{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Nn,this.minFilter=Nn,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class oF extends us{constructor(e=1,n=1,i=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Xv(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Vb extends gn{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Nn,this.minFilter=Nn,this.wrapR=Ai,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class aF extends us{constructor(e=1,n=1,i=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new Vb(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class lF extends us{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=n,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,i=e.texture.length;n<i;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class Ti{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],u=i[r+1],d=i[r+2],c=i[r+3];const h=s[o+0],m=s[o+1],g=s[o+2],v=s[o+3];if(a===0){e[n+0]=l,e[n+1]=u,e[n+2]=d,e[n+3]=c;return}if(a===1){e[n+0]=h,e[n+1]=m,e[n+2]=g,e[n+3]=v;return}if(c!==v||l!==h||u!==m||d!==g){let x=1-a;const y=l*h+u*m+d*g+c*v,_=y>=0?1:-1,S=1-y*y;if(S>Number.EPSILON){const T=Math.sqrt(S),E=Math.atan2(T,y*_);x=Math.sin(x*E)/T,a=Math.sin(a*E)/T}const b=a*_;if(l=l*x+h*b,u=u*x+m*b,d=d*x+g*b,c=c*x+v*b,x===1-a){const T=1/Math.sqrt(l*l+u*u+d*d+c*c);l*=T,u*=T,d*=T,c*=T}}e[n]=l,e[n+1]=u,e[n+2]=d,e[n+3]=c}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],l=i[r+1],u=i[r+2],d=i[r+3],c=s[o],h=s[o+1],m=s[o+2],g=s[o+3];return e[n]=a*g+d*c+l*m-u*h,e[n+1]=l*g+d*h+u*c-a*m,e[n+2]=u*g+d*m+a*h-l*c,e[n+3]=d*g-a*c-l*h-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(i/2),d=a(r/2),c=a(s/2),h=l(i/2),m=l(r/2),g=l(s/2);switch(o){case"XYZ":this._x=h*d*c+u*m*g,this._y=u*m*c-h*d*g,this._z=u*d*g+h*m*c,this._w=u*d*c-h*m*g;break;case"YXZ":this._x=h*d*c+u*m*g,this._y=u*m*c-h*d*g,this._z=u*d*g-h*m*c,this._w=u*d*c+h*m*g;break;case"ZXY":this._x=h*d*c-u*m*g,this._y=u*m*c+h*d*g,this._z=u*d*g+h*m*c,this._w=u*d*c-h*m*g;break;case"ZYX":this._x=h*d*c-u*m*g,this._y=u*m*c+h*d*g,this._z=u*d*g-h*m*c,this._w=u*d*c+h*m*g;break;case"YZX":this._x=h*d*c+u*m*g,this._y=u*m*c+h*d*g,this._z=u*d*g-h*m*c,this._w=u*d*c-h*m*g;break;case"XZY":this._x=h*d*c-u*m*g,this._y=u*m*c-h*d*g,this._z=u*d*g+h*m*c,this._w=u*d*c+h*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],u=n[2],d=n[6],c=n[10],h=i+a+c;if(h>0){const m=.5/Math.sqrt(h+1);this._w=.25/m,this._x=(d-l)*m,this._y=(s-u)*m,this._z=(o-r)*m}else if(i>a&&i>c){const m=2*Math.sqrt(1+i-a-c);this._w=(d-l)/m,this._x=.25*m,this._y=(r+o)/m,this._z=(s+u)/m}else if(a>c){const m=2*Math.sqrt(1+a-i-c);this._w=(s-u)/m,this._x=(r+o)/m,this._y=.25*m,this._z=(l+d)/m}else{const m=2*Math.sqrt(1+c-i-a);this._w=(o-r)/m,this._x=(s+u)/m,this._y=(l+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bn(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,u=n._z,d=n._w;return this._x=i*d+o*a+r*u-s*l,this._y=r*d+o*l+s*a-i*u,this._z=s*d+o*u+i*l-r*a,this._w=o*d-i*a-r*l-s*u,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-n;return this._w=m*o+n*this._w,this._x=m*i+n*this._x,this._y=m*r+n*this._y,this._z=m*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const u=Math.sqrt(l),d=Math.atan2(u,a),c=Math.sin((1-n)*d)/u,h=Math.sin(n*d)/u;return this._w=o*c+this._w*h,this._x=i*c+this._x*h,this._y=r*c+this._y*h,this._z=s*c+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class R{constructor(e=0,n=0,i=0){R.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(rA.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(rA.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,u=l*n+o*r-a*i,d=l*i+a*n-s*r,c=l*r+s*i-o*n,h=-s*n-o*i-a*r;return this.x=u*l+h*-s+d*-a-c*-o,this.y=d*l+h*-o+c*-s-u*-a,this.z=c*l+h*-a+u*-o-d*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return tx.copy(this).projectOnVector(e),this.sub(tx)}reflect(e){return this.sub(tx.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Bn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const tx=new R,rA=new Ti;class ar{constructor(e=new R(1/0,1/0,1/0),n=new R(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){let n=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,u=e.length;l<u;l+=3){const d=e[l],c=e[l+1],h=e[l+2];d<n&&(n=d),c<i&&(i=c),h<r&&(r=h),d>s&&(s=d),c>o&&(o=c),h>a&&(a=h)}return this.min.set(n,i,r),this.max.set(s,o,a),this}setFromBufferAttribute(e){let n=1/0,i=1/0,r=1/0,s=-1/0,o=-1/0,a=-1/0;for(let l=0,u=e.count;l<u;l++){const d=e.getX(l),c=e.getY(l),h=e.getZ(l);d<n&&(n=d),c<i&&(i=c),h<r&&(r=h),d>s&&(s=d),c>o&&(o=c),h>a&&(a=h)}return this.min.set(n,i,r),this.max.set(s,o,a),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=El.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(n&&i.attributes!=null&&i.attributes.position!==void 0){const s=i.attributes.position;for(let o=0,a=s.count;o<a;o++)El.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(El)}else i.boundingBox===null&&i.computeBoundingBox(),nx.copy(i.boundingBox),nx.applyMatrix4(e.matrixWorld),this.union(nx);const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,El),El.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(xd),Jm.subVectors(this.max,xd),tc.subVectors(e.a,xd),nc.subVectors(e.b,xd),ic.subVectors(e.c,xd),ya.subVectors(nc,tc),xa.subVectors(ic,nc),Al.subVectors(tc,ic);let n=[0,-ya.z,ya.y,0,-xa.z,xa.y,0,-Al.z,Al.y,ya.z,0,-ya.x,xa.z,0,-xa.x,Al.z,0,-Al.x,-ya.y,ya.x,0,-xa.y,xa.x,0,-Al.y,Al.x,0];return!ix(n,tc,nc,ic,Jm)||(n=[1,0,0,0,1,0,0,0,1],!ix(n,tc,nc,ic,Jm))?!1:(Km.crossVectors(ya,xa),n=[Km.x,Km.y,Km.z],ix(n,tc,nc,ic,Jm))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return El.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(El).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Co[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Co[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Co[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Co[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Co[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Co[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Co[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Co[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Co),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Co=[new R,new R,new R,new R,new R,new R,new R,new R],El=new R,nx=new ar,tc=new R,nc=new R,ic=new R,ya=new R,xa=new R,Al=new R,xd=new R,Jm=new R,Km=new R,Tl=new R;function ix(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Tl.fromArray(t,s);const a=r.x*Math.abs(Tl.x)+r.y*Math.abs(Tl.y)+r.z*Math.abs(Tl.z),l=e.dot(Tl),u=n.dot(Tl),d=i.dot(Tl);if(Math.max(-Math.max(l,u,d),Math.min(l,u,d))>a)return!1}return!0}const uF=new ar,_d=new R,rx=new R;class Mr{constructor(e=new R,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):uF.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_d.subVectors(e,this.center);const n=_d.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(_d,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(rx.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_d.copy(e.center).add(rx)),this.expandByPoint(_d.copy(e.center).sub(rx))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Po=new R,sx=new R,Qm=new R,_a=new R,ox=new R,eg=new R,ax=new R;class hl{constructor(e=new R,n=new R(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Po)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=Po.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(Po.copy(this.direction).multiplyScalar(n).add(this.origin),Po.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){sx.copy(e).add(n).multiplyScalar(.5),Qm.copy(n).sub(e).normalize(),_a.copy(this.origin).sub(sx);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Qm),a=_a.dot(this.direction),l=-_a.dot(Qm),u=_a.lengthSq(),d=Math.abs(1-o*o);let c,h,m,g;if(d>0)if(c=o*l-a,h=o*a-l,g=s*d,c>=0)if(h>=-g)if(h<=g){const v=1/d;c*=v,h*=v,m=c*(c+o*h+2*a)+h*(o*c+h+2*l)+u}else h=s,c=Math.max(0,-(o*h+a)),m=-c*c+h*(h+2*l)+u;else h=-s,c=Math.max(0,-(o*h+a)),m=-c*c+h*(h+2*l)+u;else h<=-g?(c=Math.max(0,-(-o*s+a)),h=c>0?-s:Math.min(Math.max(-s,-l),s),m=-c*c+h*(h+2*l)+u):h<=g?(c=0,h=Math.min(Math.max(-s,-l),s),m=h*(h+2*l)+u):(c=Math.max(0,-(o*s+a)),h=c>0?s:Math.min(Math.max(-s,-l),s),m=-c*c+h*(h+2*l)+u);else h=o>0?-s:s,c=Math.max(0,-(o*h+a)),m=-c*c+h*(h+2*l)+u;return i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),r&&r.copy(Qm).multiplyScalar(h).add(sx),m}intersectSphere(e,n){Po.subVectors(e.center,this.origin);const i=Po.dot(this.direction),r=Po.dot(Po)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return a<0&&l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l;const u=1/this.direction.x,d=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(i=(e.min.x-h.x)*u,r=(e.max.x-h.x)*u):(i=(e.max.x-h.x)*u,r=(e.min.x-h.x)*u),d>=0?(s=(e.min.y-h.y)*d,o=(e.max.y-h.y)*d):(s=(e.max.y-h.y)*d,o=(e.min.y-h.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),c>=0?(a=(e.min.z-h.z)*c,l=(e.max.z-h.z)*c):(a=(e.max.z-h.z)*c,l=(e.min.z-h.z)*c),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,Po)!==null}intersectTriangle(e,n,i,r,s){ox.subVectors(n,e),eg.subVectors(i,e),ax.crossVectors(ox,eg);let o=this.direction.dot(ax),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;_a.subVectors(this.origin,e);const l=a*this.direction.dot(eg.crossVectors(_a,eg));if(l<0)return null;const u=a*this.direction.dot(ox.cross(_a));if(u<0||l+u>o)return null;const d=-a*_a.dot(ax);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Fe{constructor(){Fe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,i,r,s,o,a,l,u,d,c,h,m,g,v,x){const y=this.elements;return y[0]=e,y[4]=n,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=l,y[2]=u,y[6]=d,y[10]=c,y[14]=h,y[3]=m,y[7]=g,y[11]=v,y[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Fe().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/rc.setFromMatrixColumn(e,0).length(),s=1/rc.setFromMatrixColumn(e,1).length(),o=1/rc.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),u=Math.sin(r),d=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const h=o*d,m=o*c,g=a*d,v=a*c;n[0]=l*d,n[4]=-l*c,n[8]=u,n[1]=m+g*u,n[5]=h-v*u,n[9]=-a*l,n[2]=v-h*u,n[6]=g+m*u,n[10]=o*l}else if(e.order==="YXZ"){const h=l*d,m=l*c,g=u*d,v=u*c;n[0]=h+v*a,n[4]=g*a-m,n[8]=o*u,n[1]=o*c,n[5]=o*d,n[9]=-a,n[2]=m*a-g,n[6]=v+h*a,n[10]=o*l}else if(e.order==="ZXY"){const h=l*d,m=l*c,g=u*d,v=u*c;n[0]=h-v*a,n[4]=-o*c,n[8]=g+m*a,n[1]=m+g*a,n[5]=o*d,n[9]=v-h*a,n[2]=-o*u,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const h=o*d,m=o*c,g=a*d,v=a*c;n[0]=l*d,n[4]=g*u-m,n[8]=h*u+v,n[1]=l*c,n[5]=v*u+h,n[9]=m*u-g,n[2]=-u,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const h=o*l,m=o*u,g=a*l,v=a*u;n[0]=l*d,n[4]=v-h*c,n[8]=g*c+m,n[1]=c,n[5]=o*d,n[9]=-a*d,n[2]=-u*d,n[6]=m*c+g,n[10]=h-v*c}else if(e.order==="XZY"){const h=o*l,m=o*u,g=a*l,v=a*u;n[0]=l*d,n[4]=-c,n[8]=u*d,n[1]=h*c+v,n[5]=o*d,n[9]=m*c-g,n[2]=g*c-m,n[6]=a*d,n[10]=v*c+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cF,e,hF)}lookAt(e,n,i){const r=this.elements;return dr.subVectors(e,n),dr.lengthSq()===0&&(dr.z=1),dr.normalize(),wa.crossVectors(i,dr),wa.lengthSq()===0&&(Math.abs(i.z)===1?dr.x+=1e-4:dr.z+=1e-4,dr.normalize(),wa.crossVectors(i,dr)),wa.normalize(),tg.crossVectors(dr,wa),r[0]=wa.x,r[4]=tg.x,r[8]=dr.x,r[1]=wa.y,r[5]=tg.y,r[9]=dr.y,r[2]=wa.z,r[6]=tg.z,r[10]=dr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],u=i[12],d=i[1],c=i[5],h=i[9],m=i[13],g=i[2],v=i[6],x=i[10],y=i[14],_=i[3],S=i[7],b=i[11],T=i[15],E=r[0],L=r[4],A=r[8],I=r[12],P=r[1],O=r[5],k=r[9],F=r[13],G=r[2],Z=r[6],ne=r[10],J=r[14],z=r[3],V=r[7],U=r[11],X=r[15];return s[0]=o*E+a*P+l*G+u*z,s[4]=o*L+a*O+l*Z+u*V,s[8]=o*A+a*k+l*ne+u*U,s[12]=o*I+a*F+l*J+u*X,s[1]=d*E+c*P+h*G+m*z,s[5]=d*L+c*O+h*Z+m*V,s[9]=d*A+c*k+h*ne+m*U,s[13]=d*I+c*F+h*J+m*X,s[2]=g*E+v*P+x*G+y*z,s[6]=g*L+v*O+x*Z+y*V,s[10]=g*A+v*k+x*ne+y*U,s[14]=g*I+v*F+x*J+y*X,s[3]=_*E+S*P+b*G+T*z,s[7]=_*L+S*O+b*Z+T*V,s[11]=_*A+S*k+b*ne+T*U,s[15]=_*I+S*F+b*J+T*X,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],u=e[13],d=e[2],c=e[6],h=e[10],m=e[14],g=e[3],v=e[7],x=e[11],y=e[15];return g*(+s*l*c-r*u*c-s*a*h+i*u*h+r*a*m-i*l*m)+v*(+n*l*m-n*u*h+s*o*h-r*o*m+r*u*d-s*l*d)+x*(+n*u*c-n*a*m-s*o*c+i*o*m+s*a*d-i*u*d)+y*(-r*a*d-n*l*c+n*a*h+r*o*c-i*o*h+i*l*d)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],d=e[8],c=e[9],h=e[10],m=e[11],g=e[12],v=e[13],x=e[14],y=e[15],_=c*x*u-v*h*u+v*l*m-a*x*m-c*l*y+a*h*y,S=g*h*u-d*x*u-g*l*m+o*x*m+d*l*y-o*h*y,b=d*v*u-g*c*u+g*a*m-o*v*m-d*a*y+o*c*y,T=g*c*l-d*v*l-g*a*h+o*v*h+d*a*x-o*c*x,E=n*_+i*S+r*b+s*T;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const L=1/E;return e[0]=_*L,e[1]=(v*h*s-c*x*s-v*r*m+i*x*m+c*r*y-i*h*y)*L,e[2]=(a*x*s-v*l*s+v*r*u-i*x*u-a*r*y+i*l*y)*L,e[3]=(c*l*s-a*h*s-c*r*u+i*h*u+a*r*m-i*l*m)*L,e[4]=S*L,e[5]=(d*x*s-g*h*s+g*r*m-n*x*m-d*r*y+n*h*y)*L,e[6]=(g*l*s-o*x*s-g*r*u+n*x*u+o*r*y-n*l*y)*L,e[7]=(o*h*s-d*l*s+d*r*u-n*h*u-o*r*m+n*l*m)*L,e[8]=b*L,e[9]=(g*c*s-d*v*s-g*i*m+n*v*m+d*i*y-n*c*y)*L,e[10]=(o*v*s-g*a*s+g*i*u-n*v*u-o*i*y+n*a*y)*L,e[11]=(d*a*s-o*c*s-d*i*u+n*c*u+o*i*m-n*a*m)*L,e[12]=T*L,e[13]=(d*v*r-g*c*r+g*i*h-n*v*h-d*i*x+n*c*x)*L,e[14]=(g*a*r-o*v*r-g*i*l+n*v*l+o*i*x-n*a*x)*L,e[15]=(o*c*r-d*a*r+d*i*l-n*c*l-o*i*h+n*a*h)*L,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,u=s*o,d=s*a;return this.set(u*o+i,u*a-r*l,u*l+r*a,0,u*a+r*l,d*a+i,d*l-r*o,0,u*l-r*a,d*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,u=s+s,d=o+o,c=a+a,h=s*u,m=s*d,g=s*c,v=o*d,x=o*c,y=a*c,_=l*u,S=l*d,b=l*c,T=i.x,E=i.y,L=i.z;return r[0]=(1-(v+y))*T,r[1]=(m+b)*T,r[2]=(g-S)*T,r[3]=0,r[4]=(m-b)*E,r[5]=(1-(h+y))*E,r[6]=(x+_)*E,r[7]=0,r[8]=(g+S)*L,r[9]=(x-_)*L,r[10]=(1-(h+v))*L,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=rc.set(r[0],r[1],r[2]).length();const o=rc.set(r[4],r[5],r[6]).length(),a=rc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ys.copy(this);const u=1/s,d=1/o,c=1/a;return ys.elements[0]*=u,ys.elements[1]*=u,ys.elements[2]*=u,ys.elements[4]*=d,ys.elements[5]*=d,ys.elements[6]*=d,ys.elements[8]*=c,ys.elements[9]*=c,ys.elements[10]*=c,n.setFromRotationMatrix(ys),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){const a=this.elements,l=2*s/(n-e),u=2*s/(i-r),d=(n+e)/(n-e),c=(i+r)/(i-r),h=-(o+s)/(o-s),m=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=d,a[12]=0,a[1]=0,a[5]=u,a[9]=c,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){const a=this.elements,l=1/(n-e),u=1/(i-r),d=1/(o-s),c=(n+e)*l,h=(i+r)*u,m=(o+s)*d;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-c,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*d,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const rc=new R,ys=new Fe,cF=new R(0,0,0),hF=new R(1,1,1),wa=new R,tg=new R,dr=new R,sA=new Fe,oA=new Ti;class qo{constructor(e=0,n=0,i=0,r=qo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],u=r[5],d=r[9],c=r[2],h=r[6],m=r[10];switch(n){case"XYZ":this._y=Math.asin(Bn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Bn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(Bn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-c,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Bn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(h,m),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Bn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Bn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return sA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(sA,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return oA.setFromEuler(this),this.setFromQuaternion(oA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}qo.DEFAULT_ORDER="XYZ";class uu{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let dF=0;const aA=new R,sc=new Ti,Lo=new Fe,ng=new R,wd=new R,fF=new R,pF=new Ti,lA=new R(1,0,0),uA=new R(0,1,0),cA=new R(0,0,1),mF={type:"added"},hA={type:"removed"};class Pt extends po{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:dF++}),this.uuid=Sr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pt.DEFAULT_UP.clone();const e=new R,n=new qo,i=new Ti,r=new R(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Fe},normalMatrix:{value:new Jn}}),this.matrix=new Fe,this.matrixWorld=new Fe,this.matrixAutoUpdate=Pt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Pt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new uu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return sc.setFromAxisAngle(e,n),this.quaternion.multiply(sc),this}rotateOnWorldAxis(e,n){return sc.setFromAxisAngle(e,n),this.quaternion.premultiply(sc),this}rotateX(e){return this.rotateOnAxis(lA,e)}rotateY(e){return this.rotateOnAxis(uA,e)}rotateZ(e){return this.rotateOnAxis(cA,e)}translateOnAxis(e,n){return aA.copy(e).applyQuaternion(this.quaternion),this.position.add(aA.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(lA,e)}translateY(e){return this.translateOnAxis(uA,e)}translateZ(e){return this.translateOnAxis(cA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Lo.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?ng.copy(e):ng.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),wd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Lo.lookAt(wd,ng,this.up):Lo.lookAt(ng,wd,this.up),this.quaternion.setFromRotationMatrix(Lo),r&&(Lo.extractRotation(r.matrixWorld),sc.setFromRotationMatrix(Lo),this.quaternion.premultiply(sc.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(mF)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(hA)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(hA)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Lo.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Lo.multiply(e.parent.matrixWorld)),e.applyMatrix4(Lo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n){let i=[];this[e]===n&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,n);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wd,e,fF),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(wd,pF,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++){const s=n[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){const c=l[u];s(e.shapes,c)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),d=o(e.images),c=o(e.shapes),h=o(e.skeletons),m=o(e.animations),g=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),u.length>0&&(i.textures=u),d.length>0&&(i.images=d),c.length>0&&(i.shapes=c),h.length>0&&(i.skeletons=h),m.length>0&&(i.animations=m),g.length>0&&(i.nodes=g)}return i.object=r,i;function o(a){const l=[];for(const u in a){const d=a[u];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Pt.DEFAULT_UP=new R(0,1,0);Pt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Pt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const xs=new R,Io=new R,lx=new R,Do=new R,oc=new R,ac=new R,dA=new R,ux=new R,cx=new R,hx=new R;class Ui{constructor(e=new R,n=new R,i=new R){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),xs.subVectors(e,n),r.cross(xs);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){xs.subVectors(r,n),Io.subVectors(i,n),lx.subVectors(e,n);const o=xs.dot(xs),a=xs.dot(Io),l=xs.dot(lx),u=Io.dot(Io),d=Io.dot(lx),c=o*u-a*a;if(c===0)return s.set(-2,-1,-1);const h=1/c,m=(u*l-a*d)*h,g=(o*d-a*l)*h;return s.set(1-m-g,g,m)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,Do),Do.x>=0&&Do.y>=0&&Do.x+Do.y<=1}static getUV(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,Do),l.set(0,0),l.addScaledVector(s,Do.x),l.addScaledVector(o,Do.y),l.addScaledVector(a,Do.z),l}static isFrontFacing(e,n,i,r){return xs.subVectors(i,n),Io.subVectors(e,n),xs.cross(Io).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return xs.subVectors(this.c,this.b),Io.subVectors(this.a,this.b),xs.cross(Io).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ui.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Ui.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return Ui.getUV(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Ui.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ui.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let o,a;oc.subVectors(r,i),ac.subVectors(s,i),ux.subVectors(e,i);const l=oc.dot(ux),u=ac.dot(ux);if(l<=0&&u<=0)return n.copy(i);cx.subVectors(e,r);const d=oc.dot(cx),c=ac.dot(cx);if(d>=0&&c<=d)return n.copy(r);const h=l*c-d*u;if(h<=0&&l>=0&&d<=0)return o=l/(l-d),n.copy(i).addScaledVector(oc,o);hx.subVectors(e,s);const m=oc.dot(hx),g=ac.dot(hx);if(g>=0&&m<=g)return n.copy(s);const v=m*u-l*g;if(v<=0&&u>=0&&g<=0)return a=u/(u-g),n.copy(i).addScaledVector(ac,a);const x=d*g-m*c;if(x<=0&&c-d>=0&&m-g>=0)return dA.subVectors(s,r),a=(c-d)/(c-d+(m-g)),n.copy(r).addScaledVector(dA,a);const y=1/(x+v+h);return o=v*y,a=h*y,n.copy(i).addScaledVector(oc,o).addScaledVector(ac,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let gF=0;class gi extends po{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gF++}),this.uuid=Sr(),this.name="",this.type="Material",this.blending=su,this.side=Qo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Rb,this.blendDst=Ob,this.blendEquation=Vl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=K0,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=YD,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=x0,this.stencilZFail=x0,this.stencilZPass=x0,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}const r=this[n];if(r===void 0){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==su&&(i.blending=this.blending),this.side!==Qo&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class mo extends gi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Gn=new R,ig=new te;class pt{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=$f,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)ig.fromBufferAttribute(this,n),ig.applyMatrix3(e),this.setXY(n,ig.x,ig.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Gn.fromBufferAttribute(this,n),Gn.applyMatrix3(e),this.setXYZ(n,Gn.x,Gn.y,Gn.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Gn.fromBufferAttribute(this,n),Gn.applyMatrix4(e),this.setXYZ(n,Gn.x,Gn.y,Gn.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Gn.fromBufferAttribute(this,n),Gn.applyNormalMatrix(e),this.setXYZ(n,Gn.x,Gn.y,Gn.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Gn.fromBufferAttribute(this,n),Gn.transformDirection(e),this.setXYZ(n,Gn.x,Gn.y,Gn.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Ho(n,this.array)),n}setX(e,n){return this.normalized&&(n=en(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Ho(n,this.array)),n}setY(e,n){return this.normalized&&(n=en(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Ho(n,this.array)),n}setZ(e,n){return this.normalized&&(n=en(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Ho(n,this.array)),n}setW(e,n){return this.normalized&&(n=en(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=en(n,this.array),i=en(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=en(n,this.array),i=en(i,this.array),r=en(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=en(n,this.array),i=en(i,this.array),r=en(r,this.array),s=en(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==$f&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class vF extends pt{constructor(e,n,i){super(new Int8Array(e),n,i)}}class yF extends pt{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class xF extends pt{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class _F extends pt{constructor(e,n,i){super(new Int16Array(e),n,i)}}class Gb extends pt{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class wF extends pt{constructor(e,n,i){super(new Int32Array(e),n,i)}}class Zc extends pt{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class QD extends pt{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}}class De extends pt{constructor(e,n,i){super(new Float32Array(e),n,i)}}class SF extends pt{constructor(e,n,i){super(new Float64Array(e),n,i)}}let bF=0;const Vr=new Fe,dx=new Pt,lc=new R,fr=new ar,Sd=new ar,si=new R;class Ze extends po{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:bF++}),this.uuid=Sr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(JD(e)?Zc:Gb)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Jn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Vr.makeRotationFromQuaternion(e),this.applyMatrix4(Vr),this}rotateX(e){return Vr.makeRotationX(e),this.applyMatrix4(Vr),this}rotateY(e){return Vr.makeRotationY(e),this.applyMatrix4(Vr),this}rotateZ(e){return Vr.makeRotationZ(e),this.applyMatrix4(Vr),this}translate(e,n,i){return Vr.makeTranslation(e,n,i),this.applyMatrix4(Vr),this}scale(e,n,i){return Vr.makeScale(e,n,i),this.applyMatrix4(Vr),this}lookAt(e){return dx.lookAt(e),dx.updateMatrix(),this.applyMatrix4(dx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(lc).negate(),this.translate(lc.x,lc.y,lc.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new De(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ar);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new R(-1/0,-1/0,-1/0),new R(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];fr.setFromBufferAttribute(s),this.morphTargetsRelative?(si.addVectors(this.boundingBox.min,fr.min),this.boundingBox.expandByPoint(si),si.addVectors(this.boundingBox.max,fr.max),this.boundingBox.expandByPoint(si)):(this.boundingBox.expandByPoint(fr.min),this.boundingBox.expandByPoint(fr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mr);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new R,1/0);return}if(e){const i=this.boundingSphere.center;if(fr.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];Sd.setFromBufferAttribute(a),this.morphTargetsRelative?(si.addVectors(fr.min,Sd.min),fr.expandByPoint(si),si.addVectors(fr.max,Sd.max),fr.expandByPoint(si)):(fr.expandByPoint(Sd.min),fr.expandByPoint(Sd.max))}fr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)si.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(si));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let u=0,d=a.count;u<d;u++)si.fromBufferAttribute(a,u),l&&(lc.fromBufferAttribute(e,u),si.add(lc)),r=Math.max(r,i.distanceToSquared(si))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pt(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,u=[],d=[];for(let P=0;P<a;P++)u[P]=new R,d[P]=new R;const c=new R,h=new R,m=new R,g=new te,v=new te,x=new te,y=new R,_=new R;function S(P,O,k){c.fromArray(r,P*3),h.fromArray(r,O*3),m.fromArray(r,k*3),g.fromArray(o,P*2),v.fromArray(o,O*2),x.fromArray(o,k*2),h.sub(c),m.sub(c),v.sub(g),x.sub(g);const F=1/(v.x*x.y-x.x*v.y);isFinite(F)&&(y.copy(h).multiplyScalar(x.y).addScaledVector(m,-v.y).multiplyScalar(F),_.copy(m).multiplyScalar(v.x).addScaledVector(h,-x.x).multiplyScalar(F),u[P].add(y),u[O].add(y),u[k].add(y),d[P].add(_),d[O].add(_),d[k].add(_))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let P=0,O=b.length;P<O;++P){const k=b[P],F=k.start,G=k.count;for(let Z=F,ne=F+G;Z<ne;Z+=3)S(i[Z+0],i[Z+1],i[Z+2])}const T=new R,E=new R,L=new R,A=new R;function I(P){L.fromArray(s,P*3),A.copy(L);const O=u[P];T.copy(O),T.sub(L.multiplyScalar(L.dot(O))).normalize(),E.crossVectors(A,O);const F=E.dot(d[P])<0?-1:1;l[P*4]=T.x,l[P*4+1]=T.y,l[P*4+2]=T.z,l[P*4+3]=F}for(let P=0,O=b.length;P<O;++P){const k=b[P],F=k.start,G=k.count;for(let Z=F,ne=F+G;Z<ne;Z+=3)I(i[Z+0]),I(i[Z+1]),I(i[Z+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new pt(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let h=0,m=i.count;h<m;h++)i.setXYZ(h,0,0,0);const r=new R,s=new R,o=new R,a=new R,l=new R,u=new R,d=new R,c=new R;if(e)for(let h=0,m=e.count;h<m;h+=3){const g=e.getX(h+0),v=e.getX(h+1),x=e.getX(h+2);r.fromBufferAttribute(n,g),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,x),d.subVectors(o,s),c.subVectors(r,s),d.cross(c),a.fromBufferAttribute(i,g),l.fromBufferAttribute(i,v),u.fromBufferAttribute(i,x),a.add(d),l.add(d),u.add(d),i.setXYZ(g,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(x,u.x,u.y,u.z)}else for(let h=0,m=n.count;h<m;h+=3)r.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),o.fromBufferAttribute(n,h+2),d.subVectors(o,s),c.subVectors(r,s),d.cross(c),i.setXYZ(h+0,d.x,d.y,d.z),i.setXYZ(h+1,d.x,d.y,d.z),i.setXYZ(h+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)si.fromBufferAttribute(e,n),si.normalize(),e.setXYZ(n,si.x,si.y,si.z)}toNonIndexed(){function e(a,l){const u=a.array,d=a.itemSize,c=a.normalized,h=new u.constructor(l.length*d);let m=0,g=0;for(let v=0,x=l.length;v<x;v++){a.isInterleavedBufferAttribute?m=l[v]*a.data.stride+a.offset:m=l[v]*d;for(let y=0;y<d;y++)h[g++]=u[m++]}return new pt(h,d,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Ze,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],u=e(l,i);n.setAttribute(a,u)}const s=this.morphAttributes;for(const a in s){const l=[],u=s[a];for(let d=0,c=u.length;d<c;d++){const h=u[d],m=e(h,i);l.push(m)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];n.addGroup(u.start,u.count,u.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const u=i[l];e.data.attributes[l]=u.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],d=[];for(let c=0,h=u.length;c<h;c++){const m=u[c];d.push(m.toJSON(e.data))}d.length>0&&(r[l]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const u in r){const d=r[u];this.setAttribute(u,d.clone(n))}const s=e.morphAttributes;for(const u in s){const d=[],c=s[u];for(let h=0,m=c.length;h<m;h++)d.push(c[h].clone(n));this.morphAttributes[u]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,d=o.length;u<d;u++){const c=o[u];this.addGroup(c.start,c.count,c.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const fA=new Fe,uc=new hl,fx=new Mr,bd=new R,Md=new R,Ed=new R,px=new R,rg=new R,sg=new te,og=new te,ag=new te,mx=new R,lg=new R;class li extends Pt{constructor(e=new Ze,n=new mo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){rg.set(0,0,0);for(let l=0,u=s.length;l<u;l++){const d=a[l],c=s[l];d!==0&&(px.fromBufferAttribute(c,e),o?rg.addScaledVector(px,d):rg.addScaledVector(px.sub(n),d))}n.add(rg)}return this.isSkinnedMesh&&this.boneTransform(e,n),n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),fx.copy(i.boundingSphere),fx.applyMatrix4(s),e.ray.intersectsSphere(fx)===!1)||(fA.copy(s).invert(),uc.copy(e.ray).applyMatrix4(fA),i.boundingBox!==null&&uc.intersectsBox(i.boundingBox)===!1))return;let o;const a=i.index,l=i.attributes.position,u=i.attributes.uv,d=i.attributes.uv2,c=i.groups,h=i.drawRange;if(a!==null)if(Array.isArray(r))for(let m=0,g=c.length;m<g;m++){const v=c[m],x=r[v.materialIndex],y=Math.max(v.start,h.start),_=Math.min(a.count,Math.min(v.start+v.count,h.start+h.count));for(let S=y,b=_;S<b;S+=3){const T=a.getX(S),E=a.getX(S+1),L=a.getX(S+2);o=ug(this,x,e,uc,u,d,T,E,L),o&&(o.faceIndex=Math.floor(S/3),o.face.materialIndex=v.materialIndex,n.push(o))}}else{const m=Math.max(0,h.start),g=Math.min(a.count,h.start+h.count);for(let v=m,x=g;v<x;v+=3){const y=a.getX(v),_=a.getX(v+1),S=a.getX(v+2);o=ug(this,r,e,uc,u,d,y,_,S),o&&(o.faceIndex=Math.floor(v/3),n.push(o))}}else if(l!==void 0)if(Array.isArray(r))for(let m=0,g=c.length;m<g;m++){const v=c[m],x=r[v.materialIndex],y=Math.max(v.start,h.start),_=Math.min(l.count,Math.min(v.start+v.count,h.start+h.count));for(let S=y,b=_;S<b;S+=3){const T=S,E=S+1,L=S+2;o=ug(this,x,e,uc,u,d,T,E,L),o&&(o.faceIndex=Math.floor(S/3),o.face.materialIndex=v.materialIndex,n.push(o))}}else{const m=Math.max(0,h.start),g=Math.min(l.count,h.start+h.count);for(let v=m,x=g;v<x;v+=3){const y=v,_=v+1,S=v+2;o=ug(this,r,e,uc,u,d,y,_,S),o&&(o.faceIndex=Math.floor(v/3),n.push(o))}}}}function MF(t,e,n,i,r,s,o,a){let l;if(e.side===sr?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Qo,a),l===null)return null;lg.copy(a),lg.applyMatrix4(t.matrixWorld);const u=n.ray.origin.distanceTo(lg);return u<n.near||u>n.far?null:{distance:u,point:lg.clone(),object:t}}function ug(t,e,n,i,r,s,o,a,l){t.getVertexPosition(o,bd),t.getVertexPosition(a,Md),t.getVertexPosition(l,Ed);const u=MF(t,e,n,i,bd,Md,Ed,mx);if(u){r&&(sg.fromBufferAttribute(r,o),og.fromBufferAttribute(r,a),ag.fromBufferAttribute(r,l),u.uv=Ui.getUV(mx,bd,Md,Ed,sg,og,ag,new te)),s&&(sg.fromBufferAttribute(s,o),og.fromBufferAttribute(s,a),ag.fromBufferAttribute(s,l),u.uv2=Ui.getUV(mx,bd,Md,Ed,sg,og,ag,new te));const d={a:o,b:a,c:l,normal:new R,materialIndex:0};Ui.getNormal(bd,Md,Ed,d.normal),u.face=d}return u}class or extends Ze{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],u=[],d=[],c=[];let h=0,m=0;g("z","y","x",-1,-1,i,n,e,o,s,0),g("z","y","x",1,-1,i,n,-e,o,s,1),g("x","z","y",1,1,e,i,n,r,o,2),g("x","z","y",1,-1,e,i,-n,r,o,3),g("x","y","z",1,-1,e,n,i,r,s,4),g("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new De(u,3)),this.setAttribute("normal",new De(d,3)),this.setAttribute("uv",new De(c,2));function g(v,x,y,_,S,b,T,E,L,A,I){const P=b/L,O=T/A,k=b/2,F=T/2,G=E/2,Z=L+1,ne=A+1;let J=0,z=0;const V=new R;for(let U=0;U<ne;U++){const X=U*O-F;for(let N=0;N<Z;N++){const q=N*P-k;V[v]=q*_,V[x]=X*S,V[y]=G,u.push(V.x,V.y,V.z),V[v]=0,V[x]=0,V[y]=E>0?1:-1,d.push(V.x,V.y,V.z),c.push(N/L),c.push(1-U/A),J+=1}}for(let U=0;U<A;U++)for(let X=0;X<L;X++){const N=h+X+Z*U,q=h+X+Z*(U+1),Y=h+(X+1)+Z*(U+1),ee=h+(X+1)+Z*U;l.push(N,q,ee),l.push(q,Y,ee),z+=6}a.addGroup(m,z,I),m+=z,h+=J}}static fromJSON(e){return new or(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function mh(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function Ni(t){const e={};for(let n=0;n<t.length;n++){const i=mh(t[n]);for(const r in i)e[r]=i[r]}return e}function EF(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function eR(t){return t.getRenderTarget()===null&&t.outputEncoding===jt?Ms:ph}const Pu={clone:mh,merge:Ni};var AF=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,TF=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class zs extends gi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=AF,this.fragmentShader=TF,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=mh(e.uniforms),this.uniformsGroups=EF(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class Lu extends Pt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Fe,this.projectionMatrix=new Fe,this.projectionMatrixInverse=new Fe}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Un extends Lu{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=qf*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(au*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return qf*2*Math.atan(Math.tan(au*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(au*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/u,r*=o.width/l,i*=o.height/u}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const cc=-90,hc=1;class tR extends Pt{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new Un(cc,hc,e,n);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Un(cc,hc,e,n);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Un(cc,hc,e,n);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Un(cc,hc,e,n);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new Un(cc,hc,e,n);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const u=new Un(cc,hc,e,n);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,-1),this.add(u)}update(e,n){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,u]=this.children,d=e.getRenderTarget(),c=e.toneMapping,h=e.xr.enabled;e.toneMapping=Ps,e.xr.enabled=!1;const m=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(n,r),e.setRenderTarget(i,1),e.render(n,s),e.setRenderTarget(i,2),e.render(n,o),e.setRenderTarget(i,3),e.render(n,a),e.setRenderTarget(i,4),e.render(n,l),i.texture.generateMipmaps=m,e.setRenderTarget(i,5),e.render(n,u),e.setRenderTarget(d),e.toneMapping=c,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}}class Lh extends gn{constructor(e,n,i,r,s,o,a,l,u,d){e=e!==void 0?e:[],n=n!==void 0?n:ea,super(e,n,i,r,s,o,a,l,u,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class nR extends us{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new Lh(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:xn}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new or(5,5,5),s=new zs({name:"CubemapFromEquirect",uniforms:mh(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:sr,blending:$o});s.uniforms.tEquirect.value=n;const o=new li(r,s),a=n.minFilter;return n.minFilter===nl&&(n.minFilter=xn),new tR(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}}const gx=new R,CF=new R,PF=new Jn;class Bo{constructor(e=new R(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=gx.subVectors(i,n).cross(CF.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,n){const i=e.delta(gx),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||PF.getNormalMatrix(e),r=this.coplanarPoint(gx).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const dc=new Mr,cg=new R;class Yv{constructor(e=new Bo,n=new Bo,i=new Bo,r=new Bo,s=new Bo,o=new Bo){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],u=i[5],d=i[6],c=i[7],h=i[8],m=i[9],g=i[10],v=i[11],x=i[12],y=i[13],_=i[14],S=i[15];return n[0].setComponents(a-r,c-l,v-h,S-x).normalize(),n[1].setComponents(a+r,c+l,v+h,S+x).normalize(),n[2].setComponents(a+s,c+u,v+m,S+y).normalize(),n[3].setComponents(a-s,c-u,v-m,S-y).normalize(),n[4].setComponents(a-o,c-d,v-g,S-_).normalize(),n[5].setComponents(a+o,c+d,v+g,S+_).normalize(),this}intersectsObject(e){const n=e.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),dc.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(dc)}intersectsSprite(e){return dc.center.set(0,0,0),dc.radius=.7071067811865476,dc.applyMatrix4(e.matrixWorld),this.intersectsSphere(dc)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(cg.x=r.normal.x>0?e.max.x:e.min.x,cg.y=r.normal.y>0?e.max.y:e.min.y,cg.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(cg)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function iR(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function LF(t,e){const n=e.isWebGL2,i=new WeakMap;function r(u,d){const c=u.array,h=u.usage,m=t.createBuffer();t.bindBuffer(d,m),t.bufferData(d,c,h),u.onUploadCallback();let g;if(c instanceof Float32Array)g=5126;else if(c instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(n)g=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=5123;else if(c instanceof Int16Array)g=5122;else if(c instanceof Uint32Array)g=5125;else if(c instanceof Int32Array)g=5124;else if(c instanceof Int8Array)g=5120;else if(c instanceof Uint8Array)g=5121;else if(c instanceof Uint8ClampedArray)g=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:m,type:g,bytesPerElement:c.BYTES_PER_ELEMENT,version:u.version}}function s(u,d,c){const h=d.array,m=d.updateRange;t.bindBuffer(c,u),m.count===-1?t.bufferSubData(c,0,h):(n?t.bufferSubData(c,m.offset*h.BYTES_PER_ELEMENT,h,m.offset,m.count):t.bufferSubData(c,m.offset*h.BYTES_PER_ELEMENT,h.subarray(m.offset,m.offset+m.count)),m.count=-1),d.onUploadCallback()}function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),i.get(u)}function a(u){u.isInterleavedBufferAttribute&&(u=u.data);const d=i.get(u);d&&(t.deleteBuffer(d.buffer),i.delete(u))}function l(u,d){if(u.isGLBufferAttribute){const h=i.get(u);(!h||h.version<u.version)&&i.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);const c=i.get(u);c===void 0?i.set(u,r(u,d)):c.version<u.version&&(s(c.buffer,u,d),c.version=u.version)}return{get:o,remove:a,update:l}}class dl extends Ze{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),u=a+1,d=l+1,c=e/a,h=n/l,m=[],g=[],v=[],x=[];for(let y=0;y<d;y++){const _=y*h-o;for(let S=0;S<u;S++){const b=S*c-s;g.push(b,-_,0),v.push(0,0,1),x.push(S/a),x.push(1-y/l)}}for(let y=0;y<l;y++)for(let _=0;_<a;_++){const S=_+u*y,b=_+u*(y+1),T=_+1+u*(y+1),E=_+1+u*y;m.push(S,b,E),m.push(b,T,E)}this.setIndex(m),this.setAttribute("position",new De(g,3)),this.setAttribute("normal",new De(v,3)),this.setAttribute("uv",new De(x,2))}static fromJSON(e){return new dl(e.width,e.height,e.widthSegments,e.heightSegments)}}var IF=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,DF=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,RF=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,OF=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,zF=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,NF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,kF="vec3 transformed = vec3( position );",BF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,UF=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,FF=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,VF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,GF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,HF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,WF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,jF=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,$F=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,qF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,XF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,YF=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,ZF=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,JF=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,KF=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,QF=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,e5=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,t5=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,n5=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,i5="gl_FragColor = linearToOutputTexel( gl_FragColor );",r5=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,s5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,o5=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,a5=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,l5=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,u5=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,c5=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,h5=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,d5=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,f5=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,p5=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,m5=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,g5=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,v5=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,y5=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,x5=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,_5=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,w5=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,S5=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,b5=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,M5=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,E5=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,A5=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,T5=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,C5=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,P5=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,L5=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,I5=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,D5=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,R5=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,O5=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,z5=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,N5=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,k5=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,B5=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,U5=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,F5=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,V5=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,G5=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,H5=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,W5=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,j5=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,$5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,q5=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,X5=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Y5=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Z5=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,J5=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,K5=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Q5=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,e6=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,t6=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,n6=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,i6=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,r6=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,s6=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,o6=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,a6=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,l6=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,u6=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,c6=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,h6=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,d6=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,f6=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,p6=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,m6=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,g6=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,v6=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,y6=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,x6=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,_6=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,w6=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,S6=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,b6=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,M6=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,E6=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,A6=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,T6=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,C6=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const P6=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,L6=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,I6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,D6=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,R6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,O6=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,z6=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,N6=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,k6=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,B6=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,U6=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,F6=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,V6=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,G6=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,H6=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,W6=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,j6=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$6=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,q6=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,X6=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Y6=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Z6=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,J6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,K6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q6=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,eV=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,tV=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nV=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iV=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,rV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,sV=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oV=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,aV=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,lV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Et={alphamap_fragment:IF,alphamap_pars_fragment:DF,alphatest_fragment:RF,alphatest_pars_fragment:OF,aomap_fragment:zF,aomap_pars_fragment:NF,begin_vertex:kF,beginnormal_vertex:BF,bsdfs:UF,iridescence_fragment:FF,bumpmap_pars_fragment:VF,clipping_planes_fragment:GF,clipping_planes_pars_fragment:HF,clipping_planes_pars_vertex:WF,clipping_planes_vertex:jF,color_fragment:$F,color_pars_fragment:qF,color_pars_vertex:XF,color_vertex:YF,common:ZF,cube_uv_reflection_fragment:JF,defaultnormal_vertex:KF,displacementmap_pars_vertex:QF,displacementmap_vertex:e5,emissivemap_fragment:t5,emissivemap_pars_fragment:n5,encodings_fragment:i5,encodings_pars_fragment:r5,envmap_fragment:s5,envmap_common_pars_fragment:o5,envmap_pars_fragment:a5,envmap_pars_vertex:l5,envmap_physical_pars_fragment:_5,envmap_vertex:u5,fog_vertex:c5,fog_pars_vertex:h5,fog_fragment:d5,fog_pars_fragment:f5,gradientmap_pars_fragment:p5,lightmap_fragment:m5,lightmap_pars_fragment:g5,lights_lambert_fragment:v5,lights_lambert_pars_fragment:y5,lights_pars_begin:x5,lights_toon_fragment:w5,lights_toon_pars_fragment:S5,lights_phong_fragment:b5,lights_phong_pars_fragment:M5,lights_physical_fragment:E5,lights_physical_pars_fragment:A5,lights_fragment_begin:T5,lights_fragment_maps:C5,lights_fragment_end:P5,logdepthbuf_fragment:L5,logdepthbuf_pars_fragment:I5,logdepthbuf_pars_vertex:D5,logdepthbuf_vertex:R5,map_fragment:O5,map_pars_fragment:z5,map_particle_fragment:N5,map_particle_pars_fragment:k5,metalnessmap_fragment:B5,metalnessmap_pars_fragment:U5,morphcolor_vertex:F5,morphnormal_vertex:V5,morphtarget_pars_vertex:G5,morphtarget_vertex:H5,normal_fragment_begin:W5,normal_fragment_maps:j5,normal_pars_fragment:$5,normal_pars_vertex:q5,normal_vertex:X5,normalmap_pars_fragment:Y5,clearcoat_normal_fragment_begin:Z5,clearcoat_normal_fragment_maps:J5,clearcoat_pars_fragment:K5,iridescence_pars_fragment:Q5,output_fragment:e6,packing:t6,premultiplied_alpha_fragment:n6,project_vertex:i6,dithering_fragment:r6,dithering_pars_fragment:s6,roughnessmap_fragment:o6,roughnessmap_pars_fragment:a6,shadowmap_pars_fragment:l6,shadowmap_pars_vertex:u6,shadowmap_vertex:c6,shadowmask_pars_fragment:h6,skinbase_vertex:d6,skinning_pars_vertex:f6,skinning_vertex:p6,skinnormal_vertex:m6,specularmap_fragment:g6,specularmap_pars_fragment:v6,tonemapping_fragment:y6,tonemapping_pars_fragment:x6,transmission_fragment:_6,transmission_pars_fragment:w6,uv_pars_fragment:S6,uv_pars_vertex:b6,uv_vertex:M6,uv2_pars_fragment:E6,uv2_pars_vertex:A6,uv2_vertex:T6,worldpos_vertex:C6,background_vert:P6,background_frag:L6,backgroundCube_vert:I6,backgroundCube_frag:D6,cube_vert:R6,cube_frag:O6,depth_vert:z6,depth_frag:N6,distanceRGBA_vert:k6,distanceRGBA_frag:B6,equirect_vert:U6,equirect_frag:F6,linedashed_vert:V6,linedashed_frag:G6,meshbasic_vert:H6,meshbasic_frag:W6,meshlambert_vert:j6,meshlambert_frag:$6,meshmatcap_vert:q6,meshmatcap_frag:X6,meshnormal_vert:Y6,meshnormal_frag:Z6,meshphong_vert:J6,meshphong_frag:K6,meshphysical_vert:Q6,meshphysical_frag:eV,meshtoon_vert:tV,meshtoon_frag:nV,points_vert:iV,points_frag:rV,shadow_vert:sV,shadow_frag:oV,sprite_vert:aV,sprite_frag:lV},ke={common:{diffuse:{value:new Ge(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Jn},uv2Transform:{value:new Jn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new te(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ge(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ge(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jn}},sprite:{diffuse:{value:new Ge(16777215)},opacity:{value:1},center:{value:new te(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Jn}}},Zr={basic:{uniforms:Ni([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.fog]),vertexShader:Et.meshbasic_vert,fragmentShader:Et.meshbasic_frag},lambert:{uniforms:Ni([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,ke.lights,{emissive:{value:new Ge(0)}}]),vertexShader:Et.meshlambert_vert,fragmentShader:Et.meshlambert_frag},phong:{uniforms:Ni([ke.common,ke.specularmap,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,ke.lights,{emissive:{value:new Ge(0)},specular:{value:new Ge(1118481)},shininess:{value:30}}]),vertexShader:Et.meshphong_vert,fragmentShader:Et.meshphong_frag},standard:{uniforms:Ni([ke.common,ke.envmap,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.roughnessmap,ke.metalnessmap,ke.fog,ke.lights,{emissive:{value:new Ge(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag},toon:{uniforms:Ni([ke.common,ke.aomap,ke.lightmap,ke.emissivemap,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.gradientmap,ke.fog,ke.lights,{emissive:{value:new Ge(0)}}]),vertexShader:Et.meshtoon_vert,fragmentShader:Et.meshtoon_frag},matcap:{uniforms:Ni([ke.common,ke.bumpmap,ke.normalmap,ke.displacementmap,ke.fog,{matcap:{value:null}}]),vertexShader:Et.meshmatcap_vert,fragmentShader:Et.meshmatcap_frag},points:{uniforms:Ni([ke.points,ke.fog]),vertexShader:Et.points_vert,fragmentShader:Et.points_frag},dashed:{uniforms:Ni([ke.common,ke.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Et.linedashed_vert,fragmentShader:Et.linedashed_frag},depth:{uniforms:Ni([ke.common,ke.displacementmap]),vertexShader:Et.depth_vert,fragmentShader:Et.depth_frag},normal:{uniforms:Ni([ke.common,ke.bumpmap,ke.normalmap,ke.displacementmap,{opacity:{value:1}}]),vertexShader:Et.meshnormal_vert,fragmentShader:Et.meshnormal_frag},sprite:{uniforms:Ni([ke.sprite,ke.fog]),vertexShader:Et.sprite_vert,fragmentShader:Et.sprite_frag},background:{uniforms:{uvTransform:{value:new Jn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Et.background_vert,fragmentShader:Et.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Et.backgroundCube_vert,fragmentShader:Et.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Et.cube_vert,fragmentShader:Et.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Et.equirect_vert,fragmentShader:Et.equirect_frag},distanceRGBA:{uniforms:Ni([ke.common,ke.displacementmap,{referencePosition:{value:new R},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Et.distanceRGBA_vert,fragmentShader:Et.distanceRGBA_frag},shadow:{uniforms:Ni([ke.lights,ke.fog,{color:{value:new Ge(0)},opacity:{value:1}}]),vertexShader:Et.shadow_vert,fragmentShader:Et.shadow_frag}};Zr.physical={uniforms:Ni([Zr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new te(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ge(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ge(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ge(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag};const hg={r:0,b:0,g:0};function uV(t,e,n,i,r,s,o){const a=new Ge(0);let l=s===!0?0:1,u,d,c=null,h=0,m=null;function g(x,y){let _=!1,S=y.isScene===!0?y.background:null;S&&S.isTexture&&(S=(y.backgroundBlurriness>0?n:e).get(S));const b=t.xr,T=b.getSession&&b.getSession();T&&T.environmentBlendMode==="additive"&&(S=null),S===null?v(a,l):S&&S.isColor&&(v(S,1),_=!0),(t.autoClear||_)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),S&&(S.isCubeTexture||S.mapping===Cu)?(d===void 0&&(d=new li(new or(1,1,1),new zs({name:"BackgroundCubeMaterial",uniforms:mh(Zr.backgroundCube.uniforms),vertexShader:Zr.backgroundCube.vertexShader,fragmentShader:Zr.backgroundCube.fragmentShader,side:sr,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(E,L,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=S,d.material.uniforms.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,d.material.toneMapped=S.encoding!==jt,(c!==S||h!==S.version||m!==t.toneMapping)&&(d.material.needsUpdate=!0,c=S,h=S.version,m=t.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null)):S&&S.isTexture&&(u===void 0&&(u=new li(new dl(2,2),new zs({name:"BackgroundMaterial",uniforms:mh(Zr.background.uniforms),vertexShader:Zr.background.vertexShader,fragmentShader:Zr.background.fragmentShader,side:Qo,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(u)),u.material.uniforms.t2D.value=S,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=S.encoding!==jt,S.matrixAutoUpdate===!0&&S.updateMatrix(),u.material.uniforms.uvTransform.value.copy(S.matrix),(c!==S||h!==S.version||m!==t.toneMapping)&&(u.material.needsUpdate=!0,c=S,h=S.version,m=t.toneMapping),u.layers.enableAll(),x.unshift(u,u.geometry,u.material,0,0,null))}function v(x,y){x.getRGB(hg,eR(t)),i.buffers.color.setClear(hg.r,hg.g,hg.b,y,o)}return{getClearColor:function(){return a},setClearColor:function(x,y=1){a.set(x),l=y,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(x){l=x,v(a,l)},render:g}}function cV(t,e,n,i){const r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=x(null);let u=l,d=!1;function c(G,Z,ne,J,z){let V=!1;if(o){const U=v(J,ne,Z);u!==U&&(u=U,m(u.object)),V=y(G,J,ne,z),V&&_(G,J,ne,z)}else{const U=Z.wireframe===!0;(u.geometry!==J.id||u.program!==ne.id||u.wireframe!==U)&&(u.geometry=J.id,u.program=ne.id,u.wireframe=U,V=!0)}z!==null&&n.update(z,34963),(V||d)&&(d=!1,A(G,Z,ne,J),z!==null&&t.bindBuffer(34963,n.get(z).buffer))}function h(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function m(G){return i.isWebGL2?t.bindVertexArray(G):s.bindVertexArrayOES(G)}function g(G){return i.isWebGL2?t.deleteVertexArray(G):s.deleteVertexArrayOES(G)}function v(G,Z,ne){const J=ne.wireframe===!0;let z=a[G.id];z===void 0&&(z={},a[G.id]=z);let V=z[Z.id];V===void 0&&(V={},z[Z.id]=V);let U=V[J];return U===void 0&&(U=x(h()),V[J]=U),U}function x(G){const Z=[],ne=[],J=[];for(let z=0;z<r;z++)Z[z]=0,ne[z]=0,J[z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Z,enabledAttributes:ne,attributeDivisors:J,object:G,attributes:{},index:null}}function y(G,Z,ne,J){const z=u.attributes,V=Z.attributes;let U=0;const X=ne.getAttributes();for(const N in X)if(X[N].location>=0){const Y=z[N];let ee=V[N];if(ee===void 0&&(N==="instanceMatrix"&&G.instanceMatrix&&(ee=G.instanceMatrix),N==="instanceColor"&&G.instanceColor&&(ee=G.instanceColor)),Y===void 0||Y.attribute!==ee||ee&&Y.data!==ee.data)return!0;U++}return u.attributesNum!==U||u.index!==J}function _(G,Z,ne,J){const z={},V=Z.attributes;let U=0;const X=ne.getAttributes();for(const N in X)if(X[N].location>=0){let Y=V[N];Y===void 0&&(N==="instanceMatrix"&&G.instanceMatrix&&(Y=G.instanceMatrix),N==="instanceColor"&&G.instanceColor&&(Y=G.instanceColor));const ee={};ee.attribute=Y,Y&&Y.data&&(ee.data=Y.data),z[N]=ee,U++}u.attributes=z,u.attributesNum=U,u.index=J}function S(){const G=u.newAttributes;for(let Z=0,ne=G.length;Z<ne;Z++)G[Z]=0}function b(G){T(G,0)}function T(G,Z){const ne=u.newAttributes,J=u.enabledAttributes,z=u.attributeDivisors;ne[G]=1,J[G]===0&&(t.enableVertexAttribArray(G),J[G]=1),z[G]!==Z&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](G,Z),z[G]=Z)}function E(){const G=u.newAttributes,Z=u.enabledAttributes;for(let ne=0,J=Z.length;ne<J;ne++)Z[ne]!==G[ne]&&(t.disableVertexAttribArray(ne),Z[ne]=0)}function L(G,Z,ne,J,z,V){i.isWebGL2===!0&&(ne===5124||ne===5125)?t.vertexAttribIPointer(G,Z,ne,z,V):t.vertexAttribPointer(G,Z,ne,J,z,V)}function A(G,Z,ne,J){if(i.isWebGL2===!1&&(G.isInstancedMesh||J.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;S();const z=J.attributes,V=ne.getAttributes(),U=Z.defaultAttributeValues;for(const X in V){const N=V[X];if(N.location>=0){let q=z[X];if(q===void 0&&(X==="instanceMatrix"&&G.instanceMatrix&&(q=G.instanceMatrix),X==="instanceColor"&&G.instanceColor&&(q=G.instanceColor)),q!==void 0){const Y=q.normalized,ee=q.itemSize,W=n.get(q);if(W===void 0)continue;const se=W.buffer,le=W.type,ae=W.bytesPerElement;if(q.isInterleavedBufferAttribute){const ue=q.data,fe=ue.stride,K=q.offset;if(ue.isInstancedInterleavedBuffer){for(let Q=0;Q<N.locationSize;Q++)T(N.location+Q,ue.meshPerAttribute);G.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=ue.meshPerAttribute*ue.count)}else for(let Q=0;Q<N.locationSize;Q++)b(N.location+Q);t.bindBuffer(34962,se);for(let Q=0;Q<N.locationSize;Q++)L(N.location+Q,ee/N.locationSize,le,Y,fe*ae,(K+ee/N.locationSize*Q)*ae)}else{if(q.isInstancedBufferAttribute){for(let ue=0;ue<N.locationSize;ue++)T(N.location+ue,q.meshPerAttribute);G.isInstancedMesh!==!0&&J._maxInstanceCount===void 0&&(J._maxInstanceCount=q.meshPerAttribute*q.count)}else for(let ue=0;ue<N.locationSize;ue++)b(N.location+ue);t.bindBuffer(34962,se);for(let ue=0;ue<N.locationSize;ue++)L(N.location+ue,ee/N.locationSize,le,Y,ee*ae,ee/N.locationSize*ue*ae)}}else if(U!==void 0){const Y=U[X];if(Y!==void 0)switch(Y.length){case 2:t.vertexAttrib2fv(N.location,Y);break;case 3:t.vertexAttrib3fv(N.location,Y);break;case 4:t.vertexAttrib4fv(N.location,Y);break;default:t.vertexAttrib1fv(N.location,Y)}}}}E()}function I(){k();for(const G in a){const Z=a[G];for(const ne in Z){const J=Z[ne];for(const z in J)g(J[z].object),delete J[z];delete Z[ne]}delete a[G]}}function P(G){if(a[G.id]===void 0)return;const Z=a[G.id];for(const ne in Z){const J=Z[ne];for(const z in J)g(J[z].object),delete J[z];delete Z[ne]}delete a[G.id]}function O(G){for(const Z in a){const ne=a[Z];if(ne[G.id]===void 0)continue;const J=ne[G.id];for(const z in J)g(J[z].object),delete J[z];delete ne[G.id]}}function k(){F(),d=!0,u!==l&&(u=l,m(u.object))}function F(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:c,reset:k,resetDefaultState:F,dispose:I,releaseStatesOfGeometry:P,releaseStatesOfProgram:O,initAttributes:S,enableAttribute:b,disableUnusedAttributes:E}}function hV(t,e,n,i){const r=i.isWebGL2;let s;function o(u){s=u}function a(u,d){t.drawArrays(s,u,d),n.update(d,s,1)}function l(u,d,c){if(c===0)return;let h,m;if(r)h=t,m="drawArraysInstanced";else if(h=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",h===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}h[m](s,u,d,c),n.update(d,s,c)}this.setMode=o,this.render=a,this.renderInstances=l}function dV(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const L=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(L){if(L==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";L="mediump"}return L==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext;let a=n.precision!==void 0?n.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const u=o||e.has("WEBGL_draw_buffers"),d=n.logarithmicDepthBuffer===!0,c=t.getParameter(34930),h=t.getParameter(35660),m=t.getParameter(3379),g=t.getParameter(34076),v=t.getParameter(34921),x=t.getParameter(36347),y=t.getParameter(36348),_=t.getParameter(36349),S=h>0,b=o||e.has("OES_texture_float"),T=S&&b,E=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:c,maxVertexTextures:h,maxTextureSize:m,maxCubemapSize:g,maxAttributes:v,maxVertexUniforms:x,maxVaryings:y,maxFragmentUniforms:_,vertexTextures:S,floatFragmentTextures:b,floatVertexTextures:T,maxSamples:E}}function fV(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Bo,a=new Jn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(c,h){const m=c.length!==0||h||i!==0||r;return r=h,i=c.length,m},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(c,h){n=d(c,h,0)},this.setState=function(c,h,m){const g=c.clippingPlanes,v=c.clipIntersection,x=c.clipShadows,y=t.get(c);if(!r||g===null||g.length===0||s&&!x)s?d(null):u();else{const _=s?0:i,S=_*4;let b=y.clippingState||null;l.value=b,b=d(g,h,S,m);for(let T=0;T!==S;++T)b[T]=n[T];y.clippingState=b,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=_}};function u(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(c,h,m,g){const v=c!==null?c.length:0;let x=null;if(v!==0){if(x=l.value,g!==!0||x===null){const y=m+v*4,_=h.matrixWorldInverse;a.getNormalMatrix(_),(x===null||x.length<y)&&(x=new Float32Array(y));for(let S=0,b=m;S!==v;++S,b+=4)o.copy(c[S]).applyMatrix4(_,a),o.normal.toArray(x,b),x[b+3]=o.constant}l.value=x,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,x}}function pV(t){let e=new WeakMap;function n(o,a){return a===Uf?o.mapping=ea:a===Ff&&(o.mapping=ta),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===Uf||a===Ff)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new nR(l.height/2);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",r),n(u.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}let ia=class extends Lu{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=u*this.view.offsetX,o=s+u*this.view.width,a-=d*this.view.offsetY,l=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}};const Fc=4,pA=[.125,.215,.35,.446,.526,.582],Gl=20,vx=new ia,mA=new Ge;let yx=null;const kl=(1+Math.sqrt(5))/2,fc=1/kl,gA=[new R(1,1,1),new R(-1,1,1),new R(1,1,-1),new R(-1,1,-1),new R(0,kl,fc),new R(0,kl,-fc),new R(fc,0,kl),new R(-fc,0,kl),new R(kl,fc,0),new R(-kl,fc,0)];class Fw{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){yx=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=xA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=yA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(yx),e.scissorTest=!1,dg(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===ea||e.mapping===ta?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yx=this._renderer.getRenderTarget();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:xn,minFilter:xn,generateMipmaps:!1,type:yu,format:Ji,encoding:ls,depthBuffer:!1},r=vA(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=vA(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=mV(s)),this._blurMaterial=gV(s,e,n)}return r}_compileMaterial(e){const n=new li(this._lodPlanes[0],e);this._renderer.compile(n,vx)}_sceneToCubeUV(e,n,i,r){const a=new Un(90,1,n,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,c=d.autoClear,h=d.toneMapping;d.getClearColor(mA),d.toneMapping=Ps,d.autoClear=!1;const m=new mo({name:"PMREM.Background",side:sr,depthWrite:!1,depthTest:!1}),g=new li(new or,m);let v=!1;const x=e.background;x?x.isColor&&(m.color.copy(x),e.background=null,v=!0):(m.color.copy(mA),v=!0);for(let y=0;y<6;y++){const _=y%3;_===0?(a.up.set(0,l[y],0),a.lookAt(u[y],0,0)):_===1?(a.up.set(0,0,l[y]),a.lookAt(0,u[y],0)):(a.up.set(0,l[y],0),a.lookAt(0,0,u[y]));const S=this._cubeSize;dg(r,_*S,y>2?S:0,S,S),d.setRenderTarget(r),v&&d.render(g,a),d.render(e,a)}g.geometry.dispose(),g.material.dispose(),d.toneMapping=h,d.autoClear=c,e.background=x}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===ea||e.mapping===ta;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=xA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=yA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new li(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;dg(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,vx)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=gA[(r-1)%gA.length];this._blur(e,r-1,r,s,o)}n.autoClear=i}_blur(e,n,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,c=new li(this._lodPlanes[r],u),h=u.uniforms,m=this._sizeLods[i]-1,g=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Gl-1),v=s/g,x=isFinite(s)?1+Math.floor(d*v):Gl;x>Gl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${Gl}`);const y=[];let _=0;for(let L=0;L<Gl;++L){const A=L/v,I=Math.exp(-A*A/2);y.push(I),L===0?_+=I:L<x&&(_+=2*I)}for(let L=0;L<y.length;L++)y[L]=y[L]/_;h.envMap.value=e.texture,h.samples.value=x,h.weights.value=y,h.latitudinal.value=o==="latitudinal",a&&(h.poleAxis.value=a);const{_lodMax:S}=this;h.dTheta.value=g,h.mipInt.value=S-i;const b=this._sizeLods[r],T=3*b*(r>S-Fc?r-S+Fc:0),E=4*(this._cubeSize-b);dg(n,T,E,3*b,2*b),l.setRenderTarget(n),l.render(c,vx)}}function mV(t){const e=[],n=[],i=[];let r=t;const s=t-Fc+1+pA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);n.push(a);let l=1/a;o>t-Fc?l=pA[o-t+Fc-1]:o===0&&(l=0),i.push(l);const u=1/(a-2),d=-u,c=1+u,h=[d,d,c,d,c,c,d,d,c,c,d,c],m=6,g=6,v=3,x=2,y=1,_=new Float32Array(v*g*m),S=new Float32Array(x*g*m),b=new Float32Array(y*g*m);for(let E=0;E<m;E++){const L=E%3*2/3-1,A=E>2?0:-1,I=[L,A,0,L+2/3,A,0,L+2/3,A+1,0,L,A,0,L+2/3,A+1,0,L,A+1,0];_.set(I,v*g*E),S.set(h,x*g*E);const P=[E,E,E,E,E,E];b.set(P,y*g*E)}const T=new Ze;T.setAttribute("position",new pt(_,v)),T.setAttribute("uv",new pt(S,x)),T.setAttribute("faceIndex",new pt(b,y)),e.push(T),r>Fc&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function vA(t,e,n){const i=new us(t,e,n);return i.texture.mapping=Cu,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function dg(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function gV(t,e,n){const i=new Float32Array(Gl),r=new R(0,1,0);return new zs({name:"SphericalGaussianBlur",defines:{n:Gl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:Hb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:$o,depthTest:!1,depthWrite:!1})}function yA(){return new zs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Hb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:$o,depthTest:!1,depthWrite:!1})}function xA(){return new zs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Hb(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:$o,depthTest:!1,depthWrite:!1})}function Hb(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function vV(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){const l=a.mapping,u=l===Uf||l===Ff,d=l===ea||l===ta;if(u||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let c=e.get(a);return n===null&&(n=new Fw(t)),c=u?n.fromEquirectangular(a,c):n.fromCubemap(a,c),e.set(a,c),c.texture}else{if(e.has(a))return e.get(a).texture;{const c=a.image;if(u&&c&&c.height>0||d&&c&&r(c)){n===null&&(n=new Fw(t));const h=u?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,h),a.addEventListener("dispose",s),h.texture}else return null}}}return a}function r(a){let l=0;const u=6;for(let d=0;d<u;d++)a[d]!==void 0&&l++;return l===u}function s(a){const l=a.target;l.removeEventListener("dispose",s);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function yV(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function xV(t,e,n,i){const r={},s=new WeakMap;function o(c){const h=c.target;h.index!==null&&e.remove(h.index);for(const g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",o),delete r[h.id];const m=s.get(h);m&&(e.remove(m),s.delete(h)),i.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function a(c,h){return r[h.id]===!0||(h.addEventListener("dispose",o),r[h.id]=!0,n.memory.geometries++),h}function l(c){const h=c.attributes;for(const g in h)e.update(h[g],34962);const m=c.morphAttributes;for(const g in m){const v=m[g];for(let x=0,y=v.length;x<y;x++)e.update(v[x],34962)}}function u(c){const h=[],m=c.index,g=c.attributes.position;let v=0;if(m!==null){const _=m.array;v=m.version;for(let S=0,b=_.length;S<b;S+=3){const T=_[S+0],E=_[S+1],L=_[S+2];h.push(T,E,E,L,L,T)}}else{const _=g.array;v=g.version;for(let S=0,b=_.length/3-1;S<b;S+=3){const T=S+0,E=S+1,L=S+2;h.push(T,E,E,L,L,T)}}const x=new(JD(h)?Zc:Gb)(h,1);x.version=v;const y=s.get(c);y&&e.remove(y),s.set(c,x)}function d(c){const h=s.get(c);if(h){const m=c.index;m!==null&&h.version<m.version&&u(c)}else u(c);return s.get(c)}return{get:a,update:l,getWireframeAttribute:d}}function _V(t,e,n,i){const r=i.isWebGL2;let s;function o(h){s=h}let a,l;function u(h){a=h.type,l=h.bytesPerElement}function d(h,m){t.drawElements(s,m,a,h*l),n.update(m,s,1)}function c(h,m,g){if(g===0)return;let v,x;if(r)v=t,x="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[x](s,m,a,h*l,g),n.update(m,s,g)}this.setMode=o,this.setIndex=u,this.render=d,this.renderInstances=c}function wV(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case 4:n.triangles+=a*(s/3);break;case 1:n.lines+=a*(s/2);break;case 3:n.lines+=a*(s-1);break;case 2:n.lines+=a*s;break;case 0:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function SV(t,e){return t[0]-e[0]}function bV(t,e){return Math.abs(e[1])-Math.abs(t[1])}function MV(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new _t,a=[];for(let u=0;u<8;u++)a[u]=[u,0];function l(u,d,c,h){const m=u.morphTargetInfluences;if(e.isWebGL2===!0){const v=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,x=v!==void 0?v.length:0;let y=s.get(d);if(y===void 0||y.count!==x){let ne=function(){G.dispose(),s.delete(d),d.removeEventListener("dispose",ne)};var g=ne;y!==void 0&&y.texture.dispose();const b=d.morphAttributes.position!==void 0,T=d.morphAttributes.normal!==void 0,E=d.morphAttributes.color!==void 0,L=d.morphAttributes.position||[],A=d.morphAttributes.normal||[],I=d.morphAttributes.color||[];let P=0;b===!0&&(P=1),T===!0&&(P=2),E===!0&&(P=3);let O=d.attributes.position.count*P,k=1;O>e.maxTextureSize&&(k=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);const F=new Float32Array(O*k*4*x),G=new Xv(F,O,k,x);G.type=oo,G.needsUpdate=!0;const Z=P*4;for(let J=0;J<x;J++){const z=L[J],V=A[J],U=I[J],X=O*k*4*J;for(let N=0;N<z.count;N++){const q=N*Z;b===!0&&(o.fromBufferAttribute(z,N),F[X+q+0]=o.x,F[X+q+1]=o.y,F[X+q+2]=o.z,F[X+q+3]=0),T===!0&&(o.fromBufferAttribute(V,N),F[X+q+4]=o.x,F[X+q+5]=o.y,F[X+q+6]=o.z,F[X+q+7]=0),E===!0&&(o.fromBufferAttribute(U,N),F[X+q+8]=o.x,F[X+q+9]=o.y,F[X+q+10]=o.z,F[X+q+11]=U.itemSize===4?o.w:1)}}y={count:x,texture:G,size:new te(O,k)},s.set(d,y),d.addEventListener("dispose",ne)}let _=0;for(let b=0;b<m.length;b++)_+=m[b];const S=d.morphTargetsRelative?1:1-_;h.getUniforms().setValue(t,"morphTargetBaseInfluence",S),h.getUniforms().setValue(t,"morphTargetInfluences",m),h.getUniforms().setValue(t,"morphTargetsTexture",y.texture,n),h.getUniforms().setValue(t,"morphTargetsTextureSize",y.size)}else{const v=m===void 0?0:m.length;let x=i[d.id];if(x===void 0||x.length!==v){x=[];for(let T=0;T<v;T++)x[T]=[T,0];i[d.id]=x}for(let T=0;T<v;T++){const E=x[T];E[0]=T,E[1]=m[T]}x.sort(bV);for(let T=0;T<8;T++)T<v&&x[T][1]?(a[T][0]=x[T][0],a[T][1]=x[T][1]):(a[T][0]=Number.MAX_SAFE_INTEGER,a[T][1]=0);a.sort(SV);const y=d.morphAttributes.position,_=d.morphAttributes.normal;let S=0;for(let T=0;T<8;T++){const E=a[T],L=E[0],A=E[1];L!==Number.MAX_SAFE_INTEGER&&A?(y&&d.getAttribute("morphTarget"+T)!==y[L]&&d.setAttribute("morphTarget"+T,y[L]),_&&d.getAttribute("morphNormal"+T)!==_[L]&&d.setAttribute("morphNormal"+T,_[L]),r[T]=A,S+=A):(y&&d.hasAttribute("morphTarget"+T)===!0&&d.deleteAttribute("morphTarget"+T),_&&d.hasAttribute("morphNormal"+T)===!0&&d.deleteAttribute("morphNormal"+T),r[T]=0)}const b=d.morphTargetsRelative?1:1-S;h.getUniforms().setValue(t,"morphTargetBaseInfluence",b),h.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function EV(t,e,n,i){let r=new WeakMap;function s(l){const u=i.render.frame,d=l.geometry,c=e.get(l,d);return r.get(c)!==u&&(e.update(c),r.set(c,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.update(l.instanceMatrix,34962),l.instanceColor!==null&&n.update(l.instanceColor,34962)),c}function o(){r=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),n.remove(u.instanceMatrix),u.instanceColor!==null&&n.remove(u.instanceColor)}return{update:s,dispose:o}}const rR=new gn,sR=new Xv,oR=new Vb,aR=new Lh,_A=[],wA=[],SA=new Float32Array(16),bA=new Float32Array(9),MA=new Float32Array(4);function Ih(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=_A[r];if(s===void 0&&(s=new Float32Array(r),_A[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function Kn(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Qn(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Zv(t,e){let n=wA[e];n===void 0&&(n=new Int32Array(e),wA[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function AV(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function TV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Kn(n,e))return;t.uniform2fv(this.addr,e),Qn(n,e)}}function CV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Kn(n,e))return;t.uniform3fv(this.addr,e),Qn(n,e)}}function PV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Kn(n,e))return;t.uniform4fv(this.addr,e),Qn(n,e)}}function LV(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Kn(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Qn(n,e)}else{if(Kn(n,i))return;MA.set(i),t.uniformMatrix2fv(this.addr,!1,MA),Qn(n,i)}}function IV(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Kn(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Qn(n,e)}else{if(Kn(n,i))return;bA.set(i),t.uniformMatrix3fv(this.addr,!1,bA),Qn(n,i)}}function DV(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Kn(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Qn(n,e)}else{if(Kn(n,i))return;SA.set(i),t.uniformMatrix4fv(this.addr,!1,SA),Qn(n,i)}}function RV(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function OV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Kn(n,e))return;t.uniform2iv(this.addr,e),Qn(n,e)}}function zV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Kn(n,e))return;t.uniform3iv(this.addr,e),Qn(n,e)}}function NV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Kn(n,e))return;t.uniform4iv(this.addr,e),Qn(n,e)}}function kV(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function BV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Kn(n,e))return;t.uniform2uiv(this.addr,e),Qn(n,e)}}function UV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Kn(n,e))return;t.uniform3uiv(this.addr,e),Qn(n,e)}}function FV(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Kn(n,e))return;t.uniform4uiv(this.addr,e),Qn(n,e)}}function VV(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||rR,r)}function GV(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||oR,r)}function HV(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||aR,r)}function WV(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||sR,r)}function jV(t){switch(t){case 5126:return AV;case 35664:return TV;case 35665:return CV;case 35666:return PV;case 35674:return LV;case 35675:return IV;case 35676:return DV;case 5124:case 35670:return RV;case 35667:case 35671:return OV;case 35668:case 35672:return zV;case 35669:case 35673:return NV;case 5125:return kV;case 36294:return BV;case 36295:return UV;case 36296:return FV;case 35678:case 36198:case 36298:case 36306:case 35682:return VV;case 35679:case 36299:case 36307:return GV;case 35680:case 36300:case 36308:case 36293:return HV;case 36289:case 36303:case 36311:case 36292:return WV}}function $V(t,e){t.uniform1fv(this.addr,e)}function qV(t,e){const n=Ih(e,this.size,2);t.uniform2fv(this.addr,n)}function XV(t,e){const n=Ih(e,this.size,3);t.uniform3fv(this.addr,n)}function YV(t,e){const n=Ih(e,this.size,4);t.uniform4fv(this.addr,n)}function ZV(t,e){const n=Ih(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function JV(t,e){const n=Ih(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function KV(t,e){const n=Ih(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function QV(t,e){t.uniform1iv(this.addr,e)}function e8(t,e){t.uniform2iv(this.addr,e)}function t8(t,e){t.uniform3iv(this.addr,e)}function n8(t,e){t.uniform4iv(this.addr,e)}function i8(t,e){t.uniform1uiv(this.addr,e)}function r8(t,e){t.uniform2uiv(this.addr,e)}function s8(t,e){t.uniform3uiv(this.addr,e)}function o8(t,e){t.uniform4uiv(this.addr,e)}function a8(t,e,n){const i=this.cache,r=e.length,s=Zv(n,r);Kn(i,s)||(t.uniform1iv(this.addr,s),Qn(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||rR,s[o])}function l8(t,e,n){const i=this.cache,r=e.length,s=Zv(n,r);Kn(i,s)||(t.uniform1iv(this.addr,s),Qn(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||oR,s[o])}function u8(t,e,n){const i=this.cache,r=e.length,s=Zv(n,r);Kn(i,s)||(t.uniform1iv(this.addr,s),Qn(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||aR,s[o])}function c8(t,e,n){const i=this.cache,r=e.length,s=Zv(n,r);Kn(i,s)||(t.uniform1iv(this.addr,s),Qn(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||sR,s[o])}function h8(t){switch(t){case 5126:return $V;case 35664:return qV;case 35665:return XV;case 35666:return YV;case 35674:return ZV;case 35675:return JV;case 35676:return KV;case 5124:case 35670:return QV;case 35667:case 35671:return e8;case 35668:case 35672:return t8;case 35669:case 35673:return n8;case 5125:return i8;case 36294:return r8;case 36295:return s8;case 36296:return o8;case 35678:case 36198:case 36298:case 36306:case 35682:return a8;case 35679:case 36299:case 36307:return l8;case 35680:case 36300:case 36308:case 36293:return u8;case 36289:case 36303:case 36311:case 36292:return c8}}class d8{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.setValue=jV(n.type)}}class f8{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.size=n.size,this.setValue=h8(n.type)}}class p8{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,n[a.id],i)}}}const xx=/(\w+)(\])?(\[|\.)?/g;function EA(t,e){t.seq.push(e),t.map[e.id]=e}function m8(t,e,n){const i=t.name,r=i.length;for(xx.lastIndex=0;;){const s=xx.exec(i),o=xx.lastIndex;let a=s[1];const l=s[2]==="]",u=s[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===r){EA(n,u===void 0?new d8(a,t,e):new f8(a,t,e));break}else{let c=n.map[a];c===void 0&&(c=new p8(a),EA(n,c)),n=c}}}class w0{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,35718);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);m8(s,o,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in n&&i.push(o)}return i}}function AA(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let g8=0;function v8(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function y8(t){switch(t){case ls:return["Linear","( value )"];case jt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function TA(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+v8(t.getShaderSource(e),o)}else return r}function x8(t,e){const n=y8(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function _8(t,e){let n;switch(e){case MD:n="Linear";break;case ED:n="Reinhard";break;case AD:n="OptimizedCineon";break;case zb:n="ACESFilmic";break;case TD:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function w8(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zd).join(`
`)}function S8(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function b8(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Zd(t){return t!==""}function CA(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function PA(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const M8=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vw(t){return t.replace(M8,E8)}function E8(t,e){const n=Et[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return Vw(n)}const A8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LA(t){return t.replace(A8,T8)}function T8(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function IA(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function C8(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===jv?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===hf?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Zl&&(e="SHADOWMAP_TYPE_VSM"),e}function P8(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ea:case ta:e="ENVMAP_TYPE_CUBE";break;case Cu:e="ENVMAP_TYPE_CUBE_UV";break}return e}function L8(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ta:e="ENVMAP_MODE_REFRACTION";break}return e}function I8(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case vp:e="ENVMAP_BLENDING_MULTIPLY";break;case SD:e="ENVMAP_BLENDING_MIX";break;case bD:e="ENVMAP_BLENDING_ADD";break}return e}function D8(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function R8(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=C8(n),u=P8(n),d=L8(n),c=I8(n),h=D8(n),m=n.isWebGL2?"":w8(n),g=S8(s),v=r.createProgram();let x,y,_=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(x=[g].filter(Zd).join(`
`),x.length>0&&(x+=`
`),y=[m,g].filter(Zd).join(`
`),y.length>0&&(y+=`
`)):(x=[IA(n),"#define SHADER_NAME "+n.shaderName,g,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Zd).join(`
`),y=[m,IA(n),"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",n.envMap?"#define "+c:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ps?"#define TONE_MAPPING":"",n.toneMapping!==Ps?Et.tonemapping_pars_fragment:"",n.toneMapping!==Ps?_8("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Et.encodings_pars_fragment,x8("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Zd).join(`
`)),o=Vw(o),o=CA(o,n),o=PA(o,n),a=Vw(a),a=CA(a,n),a=PA(a,n),o=LA(o),a=LA(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,x=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,y=["#define varying in",n.glslVersion===Bw?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Bw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const S=_+x+o,b=_+y+a,T=AA(r,35633,S),E=AA(r,35632,b);if(r.attachShader(v,T),r.attachShader(v,E),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),t.debug.checkShaderErrors){const I=r.getProgramInfoLog(v).trim(),P=r.getShaderInfoLog(T).trim(),O=r.getShaderInfoLog(E).trim();let k=!0,F=!0;if(r.getProgramParameter(v,35714)===!1){k=!1;const G=TA(r,T,"vertex"),Z=TA(r,E,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,35715)+`

Program Info Log: `+I+`
`+G+`
`+Z)}else I!==""?console.warn("THREE.WebGLProgram: Program Info Log:",I):(P===""||O==="")&&(F=!1);F&&(this.diagnostics={runnable:k,programLog:I,vertexShader:{log:P,prefix:x},fragmentShader:{log:O,prefix:y}})}r.deleteShader(T),r.deleteShader(E);let L;this.getUniforms=function(){return L===void 0&&(L=new w0(r,v)),L};let A;return this.getAttributes=function(){return A===void 0&&(A=b8(r,v)),A},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=g8++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=T,this.fragmentShader=E,this}let O8=0;class z8{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new N8(e),n.set(e,i)),i}}class N8{constructor(e){this.id=O8++,this.code=e,this.usedTimes=0}}function k8(t,e,n,i,r,s,o){const a=new uu,l=new z8,u=[],d=r.isWebGL2,c=r.logarithmicDepthBuffer,h=r.vertexTextures;let m=r.precision;const g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(A,I,P,O,k){const F=O.fog,G=k.geometry,Z=A.isMeshStandardMaterial?O.environment:null,ne=(A.isMeshStandardMaterial?n:e).get(A.envMap||Z),J=ne&&ne.mapping===Cu?ne.image.height:null,z=g[A.type];A.precision!==null&&(m=r.getMaxPrecision(A.precision),m!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",m,"instead."));const V=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,U=V!==void 0?V.length:0;let X=0;G.morphAttributes.position!==void 0&&(X=1),G.morphAttributes.normal!==void 0&&(X=2),G.morphAttributes.color!==void 0&&(X=3);let N,q,Y,ee;if(z){const fe=Zr[z];N=fe.vertexShader,q=fe.fragmentShader}else N=A.vertexShader,q=A.fragmentShader,l.update(A),Y=l.getVertexShaderID(A),ee=l.getFragmentShaderID(A);const W=t.getRenderTarget(),se=A.alphaTest>0,le=A.clearcoat>0,ae=A.iridescence>0;return{isWebGL2:d,shaderID:z,shaderName:A.type,vertexShader:N,fragmentShader:q,defines:A.defines,customVertexShaderID:Y,customFragmentShaderID:ee,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:m,instancing:k.isInstancedMesh===!0,instancingColor:k.isInstancedMesh===!0&&k.instanceColor!==null,supportsVertexTextures:h,outputEncoding:W===null?t.outputEncoding:W.isXRRenderTarget===!0?W.texture.encoding:ls,map:!!A.map,matcap:!!A.matcap,envMap:!!ne,envMapMode:ne&&ne.mapping,envMapCubeUVHeight:J,lightMap:!!A.lightMap,aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===XD,tangentSpaceNormalMap:A.normalMapType===cl,decodeVideoTexture:!!A.map&&A.map.isVideoTexture===!0&&A.map.encoding===jt,clearcoat:le,clearcoatMap:le&&!!A.clearcoatMap,clearcoatRoughnessMap:le&&!!A.clearcoatRoughnessMap,clearcoatNormalMap:le&&!!A.clearcoatNormalMap,iridescence:ae,iridescenceMap:ae&&!!A.iridescenceMap,iridescenceThicknessMap:ae&&!!A.iridescenceThicknessMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,specularIntensityMap:!!A.specularIntensityMap,specularColorMap:!!A.specularColorMap,opaque:A.transparent===!1&&A.blending===su,alphaMap:!!A.alphaMap,alphaTest:se,gradientMap:!!A.gradientMap,sheen:A.sheen>0,sheenColorMap:!!A.sheenColorMap,sheenRoughnessMap:!!A.sheenRoughnessMap,transmission:A.transmission>0,transmissionMap:!!A.transmissionMap,thicknessMap:!!A.thicknessMap,combine:A.combine,vertexTangents:!!A.normalMap&&!!G.attributes.tangent,vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.iridescenceMap||!!A.iridescenceThicknessMap||!!A.displacementMap||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||!!A.sheenColorMap||!!A.sheenRoughnessMap,uvsVertexOnly:!(A.map||A.bumpMap||A.normalMap||A.specularMap||A.alphaMap||A.emissiveMap||A.roughnessMap||A.metalnessMap||A.clearcoatNormalMap||A.iridescenceMap||A.iridescenceThicknessMap||A.transmission>0||A.transmissionMap||A.thicknessMap||A.specularIntensityMap||A.specularColorMap||A.sheen>0||A.sheenColorMap||A.sheenRoughnessMap)&&!!A.displacementMap,fog:!!F,useFog:A.fog===!0,fogExp2:F&&F.isFogExp2,flatShading:!!A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:c,skinning:k.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:X,numDirLights:I.directional.length,numPointLights:I.point.length,numSpotLights:I.spot.length,numSpotLightMaps:I.spotLightMap.length,numRectAreaLights:I.rectArea.length,numHemiLights:I.hemi.length,numDirLightShadows:I.directionalShadowMap.length,numPointLightShadows:I.pointShadowMap.length,numSpotLightShadows:I.spotShadowMap.length,numSpotLightShadowsWithMaps:I.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:A.toneMapped?t.toneMapping:Ps,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===so,flipSided:A.side===sr,useDepthPacking:!!A.depthPacking,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function x(A){const I=[];if(A.shaderID?I.push(A.shaderID):(I.push(A.customVertexShaderID),I.push(A.customFragmentShaderID)),A.defines!==void 0)for(const P in A.defines)I.push(P),I.push(A.defines[P]);return A.isRawShaderMaterial===!1&&(y(I,A),_(I,A),I.push(t.outputEncoding)),I.push(A.customProgramCacheKey),I.join()}function y(A,I){A.push(I.precision),A.push(I.outputEncoding),A.push(I.envMapMode),A.push(I.envMapCubeUVHeight),A.push(I.combine),A.push(I.vertexUvs),A.push(I.fogExp2),A.push(I.sizeAttenuation),A.push(I.morphTargetsCount),A.push(I.morphAttributeCount),A.push(I.numDirLights),A.push(I.numPointLights),A.push(I.numSpotLights),A.push(I.numSpotLightMaps),A.push(I.numHemiLights),A.push(I.numRectAreaLights),A.push(I.numDirLightShadows),A.push(I.numPointLightShadows),A.push(I.numSpotLightShadows),A.push(I.numSpotLightShadowsWithMaps),A.push(I.shadowMapType),A.push(I.toneMapping),A.push(I.numClippingPlanes),A.push(I.numClipIntersection),A.push(I.depthPacking)}function _(A,I){a.disableAll(),I.isWebGL2&&a.enable(0),I.supportsVertexTextures&&a.enable(1),I.instancing&&a.enable(2),I.instancingColor&&a.enable(3),I.map&&a.enable(4),I.matcap&&a.enable(5),I.envMap&&a.enable(6),I.lightMap&&a.enable(7),I.aoMap&&a.enable(8),I.emissiveMap&&a.enable(9),I.bumpMap&&a.enable(10),I.normalMap&&a.enable(11),I.objectSpaceNormalMap&&a.enable(12),I.tangentSpaceNormalMap&&a.enable(13),I.clearcoat&&a.enable(14),I.clearcoatMap&&a.enable(15),I.clearcoatRoughnessMap&&a.enable(16),I.clearcoatNormalMap&&a.enable(17),I.iridescence&&a.enable(18),I.iridescenceMap&&a.enable(19),I.iridescenceThicknessMap&&a.enable(20),I.displacementMap&&a.enable(21),I.specularMap&&a.enable(22),I.roughnessMap&&a.enable(23),I.metalnessMap&&a.enable(24),I.gradientMap&&a.enable(25),I.alphaMap&&a.enable(26),I.alphaTest&&a.enable(27),I.vertexColors&&a.enable(28),I.vertexAlphas&&a.enable(29),I.vertexUvs&&a.enable(30),I.vertexTangents&&a.enable(31),I.uvsVertexOnly&&a.enable(32),A.push(a.mask),a.disableAll(),I.fog&&a.enable(0),I.useFog&&a.enable(1),I.flatShading&&a.enable(2),I.logarithmicDepthBuffer&&a.enable(3),I.skinning&&a.enable(4),I.morphTargets&&a.enable(5),I.morphNormals&&a.enable(6),I.morphColors&&a.enable(7),I.premultipliedAlpha&&a.enable(8),I.shadowMapEnabled&&a.enable(9),I.physicallyCorrectLights&&a.enable(10),I.doubleSided&&a.enable(11),I.flipSided&&a.enable(12),I.useDepthPacking&&a.enable(13),I.dithering&&a.enable(14),I.specularIntensityMap&&a.enable(15),I.specularColorMap&&a.enable(16),I.transmission&&a.enable(17),I.transmissionMap&&a.enable(18),I.thicknessMap&&a.enable(19),I.sheen&&a.enable(20),I.sheenColorMap&&a.enable(21),I.sheenRoughnessMap&&a.enable(22),I.decodeVideoTexture&&a.enable(23),I.opaque&&a.enable(24),A.push(a.mask)}function S(A){const I=g[A.type];let P;if(I){const O=Zr[I];P=Pu.clone(O.uniforms)}else P=A.uniforms;return P}function b(A,I){let P;for(let O=0,k=u.length;O<k;O++){const F=u[O];if(F.cacheKey===I){P=F,++P.usedTimes;break}}return P===void 0&&(P=new R8(t,I,A,s),u.push(P)),P}function T(A){if(--A.usedTimes===0){const I=u.indexOf(A);u[I]=u[u.length-1],u.pop(),A.destroy()}}function E(A){l.remove(A)}function L(){l.dispose()}return{getParameters:v,getProgramCacheKey:x,getUniforms:S,acquireProgram:b,releaseProgram:T,releaseShaderCache:E,programs:u,dispose:L}}function B8(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function U8(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function DA(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function RA(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(c,h,m,g,v,x){let y=t[e];return y===void 0?(y={id:c.id,object:c,geometry:h,material:m,groupOrder:g,renderOrder:c.renderOrder,z:v,group:x},t[e]=y):(y.id=c.id,y.object=c,y.geometry=h,y.material=m,y.groupOrder=g,y.renderOrder=c.renderOrder,y.z=v,y.group=x),e++,y}function a(c,h,m,g,v,x){const y=o(c,h,m,g,v,x);m.transmission>0?i.push(y):m.transparent===!0?r.push(y):n.push(y)}function l(c,h,m,g,v,x){const y=o(c,h,m,g,v,x);m.transmission>0?i.unshift(y):m.transparent===!0?r.unshift(y):n.unshift(y)}function u(c,h){n.length>1&&n.sort(c||U8),i.length>1&&i.sort(h||DA),r.length>1&&r.sort(h||DA)}function d(){for(let c=e,h=t.length;c<h;c++){const m=t[c];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:d,sort:u}}function F8(){let t=new WeakMap;function e(i,r){const s=t.get(i);let o;return s===void 0?(o=new RA,t.set(i,[o])):r>=s.length?(o=new RA,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function V8(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new R,color:new Ge};break;case"SpotLight":n={position:new R,direction:new R,color:new Ge,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new R,color:new Ge,distance:0,decay:0};break;case"HemisphereLight":n={direction:new R,skyColor:new Ge,groundColor:new Ge};break;case"RectAreaLight":n={color:new Ge,position:new R,halfWidth:new R,halfHeight:new R};break}return t[e.id]=n,n}}}function G8(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let H8=0;function W8(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function j8(t,e){const n=new V8,i=G8(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let d=0;d<9;d++)r.probe.push(new R);const s=new R,o=new Fe,a=new Fe;function l(d,c){let h=0,m=0,g=0;for(let O=0;O<9;O++)r.probe[O].set(0,0,0);let v=0,x=0,y=0,_=0,S=0,b=0,T=0,E=0,L=0,A=0;d.sort(W8);const I=c!==!0?Math.PI:1;for(let O=0,k=d.length;O<k;O++){const F=d[O],G=F.color,Z=F.intensity,ne=F.distance,J=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)h+=G.r*Z*I,m+=G.g*Z*I,g+=G.b*Z*I;else if(F.isLightProbe)for(let z=0;z<9;z++)r.probe[z].addScaledVector(F.sh.coefficients[z],Z);else if(F.isDirectionalLight){const z=n.get(F);if(z.color.copy(F.color).multiplyScalar(F.intensity*I),F.castShadow){const V=F.shadow,U=i.get(F);U.shadowBias=V.bias,U.shadowNormalBias=V.normalBias,U.shadowRadius=V.radius,U.shadowMapSize=V.mapSize,r.directionalShadow[v]=U,r.directionalShadowMap[v]=J,r.directionalShadowMatrix[v]=F.shadow.matrix,b++}r.directional[v]=z,v++}else if(F.isSpotLight){const z=n.get(F);z.position.setFromMatrixPosition(F.matrixWorld),z.color.copy(G).multiplyScalar(Z*I),z.distance=ne,z.coneCos=Math.cos(F.angle),z.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),z.decay=F.decay,r.spot[y]=z;const V=F.shadow;if(F.map&&(r.spotLightMap[L]=F.map,L++,V.updateMatrices(F),F.castShadow&&A++),r.spotLightMatrix[y]=V.matrix,F.castShadow){const U=i.get(F);U.shadowBias=V.bias,U.shadowNormalBias=V.normalBias,U.shadowRadius=V.radius,U.shadowMapSize=V.mapSize,r.spotShadow[y]=U,r.spotShadowMap[y]=J,E++}y++}else if(F.isRectAreaLight){const z=n.get(F);z.color.copy(G).multiplyScalar(Z),z.halfWidth.set(F.width*.5,0,0),z.halfHeight.set(0,F.height*.5,0),r.rectArea[_]=z,_++}else if(F.isPointLight){const z=n.get(F);if(z.color.copy(F.color).multiplyScalar(F.intensity*I),z.distance=F.distance,z.decay=F.decay,F.castShadow){const V=F.shadow,U=i.get(F);U.shadowBias=V.bias,U.shadowNormalBias=V.normalBias,U.shadowRadius=V.radius,U.shadowMapSize=V.mapSize,U.shadowCameraNear=V.camera.near,U.shadowCameraFar=V.camera.far,r.pointShadow[x]=U,r.pointShadowMap[x]=J,r.pointShadowMatrix[x]=F.shadow.matrix,T++}r.point[x]=z,x++}else if(F.isHemisphereLight){const z=n.get(F);z.skyColor.copy(F.color).multiplyScalar(Z*I),z.groundColor.copy(F.groundColor).multiplyScalar(Z*I),r.hemi[S]=z,S++}}_>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=ke.LTC_FLOAT_1,r.rectAreaLTC2=ke.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=ke.LTC_HALF_1,r.rectAreaLTC2=ke.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=h,r.ambient[1]=m,r.ambient[2]=g;const P=r.hash;(P.directionalLength!==v||P.pointLength!==x||P.spotLength!==y||P.rectAreaLength!==_||P.hemiLength!==S||P.numDirectionalShadows!==b||P.numPointShadows!==T||P.numSpotShadows!==E||P.numSpotMaps!==L)&&(r.directional.length=v,r.spot.length=y,r.rectArea.length=_,r.point.length=x,r.hemi.length=S,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=T,r.pointShadowMap.length=T,r.spotShadow.length=E,r.spotShadowMap.length=E,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=T,r.spotLightMatrix.length=E+L-A,r.spotLightMap.length=L,r.numSpotLightShadowsWithMaps=A,P.directionalLength=v,P.pointLength=x,P.spotLength=y,P.rectAreaLength=_,P.hemiLength=S,P.numDirectionalShadows=b,P.numPointShadows=T,P.numSpotShadows=E,P.numSpotMaps=L,r.version=H8++)}function u(d,c){let h=0,m=0,g=0,v=0,x=0;const y=c.matrixWorldInverse;for(let _=0,S=d.length;_<S;_++){const b=d[_];if(b.isDirectionalLight){const T=r.directional[h];T.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),h++}else if(b.isSpotLight){const T=r.spot[g];T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),g++}else if(b.isRectAreaLight){const T=r.rectArea[v];T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(y),a.identity(),o.copy(b.matrixWorld),o.premultiply(y),a.extractRotation(o),T.halfWidth.set(b.width*.5,0,0),T.halfHeight.set(0,b.height*.5,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),v++}else if(b.isPointLight){const T=r.point[m];T.position.setFromMatrixPosition(b.matrixWorld),T.position.applyMatrix4(y),m++}else if(b.isHemisphereLight){const T=r.hemi[x];T.direction.setFromMatrixPosition(b.matrixWorld),T.direction.transformDirection(y),x++}}}return{setup:l,setupView:u,state:r}}function OA(t,e){const n=new j8(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(c){i.push(c)}function a(c){r.push(c)}function l(c){n.setup(i,c)}function u(c){n.setupView(i,c)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:a}}function $8(t,e){let n=new WeakMap;function i(s,o=0){const a=n.get(s);let l;return a===void 0?(l=new OA(t,e),n.set(s,[l])):o>=a.length?(l=new OA(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}class Wb extends gi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=$D,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class jb extends gi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new R,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const q8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,X8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Y8(t,e,n){let i=new Yv;const r=new te,s=new te,o=new _t,a=new Wb({depthPacking:qD}),l=new jb,u={},d=n.maxTextureSize,c={[Qo]:sr,[sr]:Qo,[so]:so},h=new zs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new te},radius:{value:4}},vertexShader:q8,fragmentShader:X8}),m=h.clone();m.defines.HORIZONTAL_PASS=1;const g=new Ze;g.setAttribute("position",new pt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new li(g,h),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=jv,this.render=function(b,T,E){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||b.length===0)return;const L=t.getRenderTarget(),A=t.getActiveCubeFace(),I=t.getActiveMipmapLevel(),P=t.state;P.setBlending($o),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let O=0,k=b.length;O<k;O++){const F=b[O],G=F.shadow;if(G===void 0){console.warn("THREE.WebGLShadowMap:",F,"has no shadow.");continue}if(G.autoUpdate===!1&&G.needsUpdate===!1)continue;r.copy(G.mapSize);const Z=G.getFrameExtents();if(r.multiply(Z),s.copy(G.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/Z.x),r.x=s.x*Z.x,G.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/Z.y),r.y=s.y*Z.y,G.mapSize.y=s.y)),G.map===null){const J=this.type!==Zl?{minFilter:Nn,magFilter:Nn}:{};G.map=new us(r.x,r.y,J),G.map.texture.name=F.name+".shadowMap",G.camera.updateProjectionMatrix()}t.setRenderTarget(G.map),t.clear();const ne=G.getViewportCount();for(let J=0;J<ne;J++){const z=G.getViewport(J);o.set(s.x*z.x,s.y*z.y,s.x*z.z,s.y*z.w),P.viewport(o),G.updateMatrices(F,J),i=G.getFrustum(),S(T,E,G.camera,F,this.type)}G.isPointLightShadow!==!0&&this.type===Zl&&y(G,E),G.needsUpdate=!1}x.needsUpdate=!1,t.setRenderTarget(L,A,I)};function y(b,T){const E=e.update(v);h.defines.VSM_SAMPLES!==b.blurSamples&&(h.defines.VSM_SAMPLES=b.blurSamples,m.defines.VSM_SAMPLES=b.blurSamples,h.needsUpdate=!0,m.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new us(r.x,r.y)),h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(T,null,E,h,v,null),m.uniforms.shadow_pass.value=b.mapPass.texture,m.uniforms.resolution.value=b.mapSize,m.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(T,null,E,m,v,null)}function _(b,T,E,L,A,I){let P=null;const O=E.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(O!==void 0)P=O;else if(P=E.isPointLight===!0?l:a,t.localClippingEnabled&&T.clipShadows===!0&&Array.isArray(T.clippingPlanes)&&T.clippingPlanes.length!==0||T.displacementMap&&T.displacementScale!==0||T.alphaMap&&T.alphaTest>0||T.map&&T.alphaTest>0){const k=P.uuid,F=T.uuid;let G=u[k];G===void 0&&(G={},u[k]=G);let Z=G[F];Z===void 0&&(Z=P.clone(),G[F]=Z),P=Z}return P.visible=T.visible,P.wireframe=T.wireframe,I===Zl?P.side=T.shadowSide!==null?T.shadowSide:T.side:P.side=T.shadowSide!==null?T.shadowSide:c[T.side],P.alphaMap=T.alphaMap,P.alphaTest=T.alphaTest,P.map=T.map,P.clipShadows=T.clipShadows,P.clippingPlanes=T.clippingPlanes,P.clipIntersection=T.clipIntersection,P.displacementMap=T.displacementMap,P.displacementScale=T.displacementScale,P.displacementBias=T.displacementBias,P.wireframeLinewidth=T.wireframeLinewidth,P.linewidth=T.linewidth,E.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(E.matrixWorld),P.nearDistance=L,P.farDistance=A),P}function S(b,T,E,L,A){if(b.visible===!1)return;if(b.layers.test(T.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&A===Zl)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(E.matrixWorldInverse,b.matrixWorld);const O=e.update(b),k=b.material;if(Array.isArray(k)){const F=O.groups;for(let G=0,Z=F.length;G<Z;G++){const ne=F[G],J=k[ne.materialIndex];if(J&&J.visible){const z=_(b,J,L,E.near,E.far,A);t.renderBufferDirect(E,null,O,z,b,ne)}}}else if(k.visible){const F=_(b,k,L,E.near,E.far,A);t.renderBufferDirect(E,null,O,F,b,null)}}const P=b.children;for(let O=0,k=P.length;O<k;O++)S(P[O],T,E,L,A)}}function Z8(t,e,n){const i=n.isWebGL2;function r(){let re=!1;const _e=new _t;let Ie=null;const Ue=new _t(0,0,0,0);return{setMask:function(tt){Ie!==tt&&!re&&(t.colorMask(tt,tt,tt,tt),Ie=tt)},setLocked:function(tt){re=tt},setClear:function(tt,Ot,rn,ei,Fs){Fs===!0&&(tt*=ei,Ot*=ei,rn*=ei),_e.set(tt,Ot,rn,ei),Ue.equals(_e)===!1&&(t.clearColor(tt,Ot,rn,ei),Ue.copy(_e))},reset:function(){re=!1,Ie=null,Ue.set(-1,0,0,0)}}}function s(){let re=!1,_e=null,Ie=null,Ue=null;return{setTest:function(tt){tt?se(2929):le(2929)},setMask:function(tt){_e!==tt&&!re&&(t.depthMask(tt),_e=tt)},setFunc:function(tt){if(Ie!==tt){switch(tt){case mD:t.depthFunc(512);break;case gD:t.depthFunc(519);break;case vD:t.depthFunc(513);break;case K0:t.depthFunc(515);break;case yD:t.depthFunc(514);break;case xD:t.depthFunc(518);break;case _D:t.depthFunc(516);break;case wD:t.depthFunc(517);break;default:t.depthFunc(515)}Ie=tt}},setLocked:function(tt){re=tt},setClear:function(tt){Ue!==tt&&(t.clearDepth(tt),Ue=tt)},reset:function(){re=!1,_e=null,Ie=null,Ue=null}}}function o(){let re=!1,_e=null,Ie=null,Ue=null,tt=null,Ot=null,rn=null,ei=null,Fs=null;return{setTest:function(Kt){re||(Kt?se(2960):le(2960))},setMask:function(Kt){_e!==Kt&&!re&&(t.stencilMask(Kt),_e=Kt)},setFunc:function(Kt,Cr,ji){(Ie!==Kt||Ue!==Cr||tt!==ji)&&(t.stencilFunc(Kt,Cr,ji),Ie=Kt,Ue=Cr,tt=ji)},setOp:function(Kt,Cr,ji){(Ot!==Kt||rn!==Cr||ei!==ji)&&(t.stencilOp(Kt,Cr,ji),Ot=Kt,rn=Cr,ei=ji)},setLocked:function(Kt){re=Kt},setClear:function(Kt){Fs!==Kt&&(t.clearStencil(Kt),Fs=Kt)},reset:function(){re=!1,_e=null,Ie=null,Ue=null,tt=null,Ot=null,rn=null,ei=null,Fs=null}}}const a=new r,l=new s,u=new o,d=new WeakMap,c=new WeakMap;let h={},m={},g=new WeakMap,v=[],x=null,y=!1,_=null,S=null,b=null,T=null,E=null,L=null,A=null,I=!1,P=null,O=null,k=null,F=null,G=null;const Z=t.getParameter(35661);let ne=!1,J=0;const z=t.getParameter(7938);z.indexOf("WebGL")!==-1?(J=parseFloat(/^WebGL (\d)/.exec(z)[1]),ne=J>=1):z.indexOf("OpenGL ES")!==-1&&(J=parseFloat(/^OpenGL ES (\d)/.exec(z)[1]),ne=J>=2);let V=null,U={};const X=t.getParameter(3088),N=t.getParameter(2978),q=new _t().fromArray(X),Y=new _t().fromArray(N);function ee(re,_e,Ie){const Ue=new Uint8Array(4),tt=t.createTexture();t.bindTexture(re,tt),t.texParameteri(re,10241,9728),t.texParameteri(re,10240,9728);for(let Ot=0;Ot<Ie;Ot++)t.texImage2D(_e+Ot,0,6408,1,1,0,6408,5121,Ue);return tt}const W={};W[3553]=ee(3553,3553,1),W[34067]=ee(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),u.setClear(0),se(2929),l.setFunc(K0),be(!1),Te(uw),se(2884),he($o);function se(re){h[re]!==!0&&(t.enable(re),h[re]=!0)}function le(re){h[re]!==!1&&(t.disable(re),h[re]=!1)}function ae(re,_e){return m[re]!==_e?(t.bindFramebuffer(re,_e),m[re]=_e,i&&(re===36009&&(m[36160]=_e),re===36160&&(m[36009]=_e)),!0):!1}function ue(re,_e){let Ie=v,Ue=!1;if(re)if(Ie=g.get(_e),Ie===void 0&&(Ie=[],g.set(_e,Ie)),re.isWebGLMultipleRenderTargets){const tt=re.texture;if(Ie.length!==tt.length||Ie[0]!==36064){for(let Ot=0,rn=tt.length;Ot<rn;Ot++)Ie[Ot]=36064+Ot;Ie.length=tt.length,Ue=!0}}else Ie[0]!==36064&&(Ie[0]=36064,Ue=!0);else Ie[0]!==1029&&(Ie[0]=1029,Ue=!0);Ue&&(n.isWebGL2?t.drawBuffers(Ie):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Ie))}function fe(re){return x!==re?(t.useProgram(re),x=re,!0):!1}const K={[Vl]:32774,[rD]:32778,[sD]:32779};if(i)K[fw]=32775,K[pw]=32776;else{const re=e.get("EXT_blend_minmax");re!==null&&(K[fw]=re.MIN_EXT,K[pw]=re.MAX_EXT)}const Q={[oD]:0,[aD]:1,[lD]:768,[Rb]:770,[pD]:776,[dD]:774,[cD]:772,[uD]:769,[Ob]:771,[fD]:775,[hD]:773};function he(re,_e,Ie,Ue,tt,Ot,rn,ei){if(re===$o){y===!0&&(le(3042),y=!1);return}if(y===!1&&(se(3042),y=!0),re!==iD){if(re!==_||ei!==I){if((S!==Vl||E!==Vl)&&(t.blendEquation(32774),S=Vl,E=Vl),ei)switch(re){case su:t.blendFuncSeparate(1,771,1,771);break;case cw:t.blendFunc(1,1);break;case hw:t.blendFuncSeparate(0,769,0,1);break;case dw:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}else switch(re){case su:t.blendFuncSeparate(770,771,1,771);break;case cw:t.blendFunc(770,1);break;case hw:t.blendFuncSeparate(0,769,0,1);break;case dw:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",re);break}b=null,T=null,L=null,A=null,_=re,I=ei}return}tt=tt||_e,Ot=Ot||Ie,rn=rn||Ue,(_e!==S||tt!==E)&&(t.blendEquationSeparate(K[_e],K[tt]),S=_e,E=tt),(Ie!==b||Ue!==T||Ot!==L||rn!==A)&&(t.blendFuncSeparate(Q[Ie],Q[Ue],Q[Ot],Q[rn]),b=Ie,T=Ue,L=Ot,A=rn),_=re,I=!1}function ye(re,_e){re.side===so?le(2884):se(2884);let Ie=re.side===sr;_e&&(Ie=!Ie),be(Ie),re.blending===su&&re.transparent===!1?he($o):he(re.blending,re.blendEquation,re.blendSrc,re.blendDst,re.blendEquationAlpha,re.blendSrcAlpha,re.blendDstAlpha,re.premultipliedAlpha),l.setFunc(re.depthFunc),l.setTest(re.depthTest),l.setMask(re.depthWrite),a.setMask(re.colorWrite);const Ue=re.stencilWrite;u.setTest(Ue),Ue&&(u.setMask(re.stencilWriteMask),u.setFunc(re.stencilFunc,re.stencilRef,re.stencilFuncMask),u.setOp(re.stencilFail,re.stencilZFail,re.stencilZPass)),ze(re.polygonOffset,re.polygonOffsetFactor,re.polygonOffsetUnits),re.alphaToCoverage===!0?se(32926):le(32926)}function be(re){P!==re&&(re?t.frontFace(2304):t.frontFace(2305),P=re)}function Te(re){re!==eD?(se(2884),re!==O&&(re===uw?t.cullFace(1029):re===tD?t.cullFace(1028):t.cullFace(1032))):le(2884),O=re}function Le(re){re!==k&&(ne&&t.lineWidth(re),k=re)}function ze(re,_e,Ie){re?(se(32823),(F!==_e||G!==Ie)&&(t.polygonOffset(_e,Ie),F=_e,G=Ie)):le(32823)}function Ye(re){re?se(3089):le(3089)}function nt(re){re===void 0&&(re=33984+Z-1),V!==re&&(t.activeTexture(re),V=re)}function H(re,_e,Ie){Ie===void 0&&(V===null?Ie=33984+Z-1:Ie=V);let Ue=U[Ie];Ue===void 0&&(Ue={type:void 0,texture:void 0},U[Ie]=Ue),(Ue.type!==re||Ue.texture!==_e)&&(V!==Ie&&(t.activeTexture(Ie),V=Ie),t.bindTexture(re,_e||W[re]),Ue.type=re,Ue.texture=_e)}function B(){const re=U[V];re!==void 0&&re.type!==void 0&&(t.bindTexture(re.type,null),re.type=void 0,re.texture=void 0)}function ge(){try{t.compressedTexImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Pe(){try{t.compressedTexImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Oe(){try{t.texSubImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Be(){try{t.texSubImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ht(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function He(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Me(){try{t.texStorage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function We(){try{t.texStorage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function et(){try{t.texImage2D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function Xe(){try{t.texImage3D.apply(t,arguments)}catch(re){console.error("THREE.WebGLState:",re)}}function ut(re){q.equals(re)===!1&&(t.scissor(re.x,re.y,re.z,re.w),q.copy(re))}function ot(re){Y.equals(re)===!1&&(t.viewport(re.x,re.y,re.z,re.w),Y.copy(re))}function Lt(re,_e){let Ie=c.get(_e);Ie===void 0&&(Ie=new WeakMap,c.set(_e,Ie));let Ue=Ie.get(re);Ue===void 0&&(Ue=t.getUniformBlockIndex(_e,re.name),Ie.set(re,Ue))}function $t(re,_e){const Ue=c.get(_e).get(re);d.get(_e)!==Ue&&(t.uniformBlockBinding(_e,Ue,re.__bindingPointIndex),d.set(_e,Ue))}function Mn(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),i===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},V=null,U={},m={},g=new WeakMap,v=[],x=null,y=!1,_=null,S=null,b=null,T=null,E=null,L=null,A=null,I=!1,P=null,O=null,k=null,F=null,G=null,q.set(0,0,t.canvas.width,t.canvas.height),Y.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),u.reset()}return{buffers:{color:a,depth:l,stencil:u},enable:se,disable:le,bindFramebuffer:ae,drawBuffers:ue,useProgram:fe,setBlending:he,setMaterial:ye,setFlipSided:be,setCullFace:Te,setLineWidth:Le,setPolygonOffset:ze,setScissorTest:Ye,activeTexture:nt,bindTexture:H,unbindTexture:B,compressedTexImage2D:ge,compressedTexImage3D:Pe,texImage2D:et,texImage3D:Xe,updateUBOMapping:Lt,uniformBlockBinding:$t,texStorage2D:Me,texStorage3D:We,texSubImage2D:Oe,texSubImage3D:Be,compressedTexSubImage2D:ht,compressedTexSubImage3D:He,scissor:ut,viewport:ot,reset:Mn}}function J8(t,e,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,u=r.maxCubemapSize,d=r.maxTextureSize,c=r.maxSamples,h=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap;let v;const x=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(H,B){return y?new OffscreenCanvas(H,B):Xf("canvas")}function S(H,B,ge,Pe){let Oe=1;if((H.width>Pe||H.height>Pe)&&(Oe=Pe/Math.max(H.width,H.height)),Oe<1||B===!0)if(typeof HTMLImageElement<"u"&&H instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&H instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&H instanceof ImageBitmap){const Be=B?tv:Math.floor,ht=Be(Oe*H.width),He=Be(Oe*H.height);v===void 0&&(v=_(ht,He));const Me=ge?_(ht,He):v;return Me.width=ht,Me.height=He,Me.getContext("2d").drawImage(H,0,0,ht,He),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+H.width+"x"+H.height+") to ("+ht+"x"+He+")."),Me}else return"data"in H&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+H.width+"x"+H.height+")."),H;return H}function b(H){return Uw(H.width)&&Uw(H.height)}function T(H){return a?!1:H.wrapS!==Ai||H.wrapT!==Ai||H.minFilter!==Nn&&H.minFilter!==xn}function E(H,B){return H.generateMipmaps&&B&&H.minFilter!==Nn&&H.minFilter!==xn}function L(H){t.generateMipmap(H)}function A(H,B,ge,Pe,Oe=!1){if(a===!1)return B;if(H!==null){if(t[H]!==void 0)return t[H];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+H+"'")}let Be=B;return B===6403&&(ge===5126&&(Be=33326),ge===5131&&(Be=33325),ge===5121&&(Be=33321)),B===33319&&(ge===5126&&(Be=33328),ge===5131&&(Be=33327),ge===5121&&(Be=33323)),B===6408&&(ge===5126&&(Be=34836),ge===5131&&(Be=34842),ge===5121&&(Be=Pe===jt&&Oe===!1?35907:32856),ge===32819&&(Be=32854),ge===32820&&(Be=32855)),(Be===33325||Be===33326||Be===33327||Be===33328||Be===34842||Be===34836)&&e.get("EXT_color_buffer_float"),Be}function I(H,B,ge){return E(H,ge)===!0||H.isFramebufferTexture&&H.minFilter!==Nn&&H.minFilter!==xn?Math.log2(Math.max(B.width,B.height))+1:H.mipmaps!==void 0&&H.mipmaps.length>0?H.mipmaps.length:H.isCompressedTexture&&Array.isArray(H.image)?B.mipmaps.length:1}function P(H){return H===Nn||H===Q0||H===df?9728:9729}function O(H){const B=H.target;B.removeEventListener("dispose",O),F(B),B.isVideoTexture&&g.delete(B)}function k(H){const B=H.target;B.removeEventListener("dispose",k),Z(B)}function F(H){const B=i.get(H);if(B.__webglInit===void 0)return;const ge=H.source,Pe=x.get(ge);if(Pe){const Oe=Pe[B.__cacheKey];Oe.usedTimes--,Oe.usedTimes===0&&G(H),Object.keys(Pe).length===0&&x.delete(ge)}i.remove(H)}function G(H){const B=i.get(H);t.deleteTexture(B.__webglTexture);const ge=H.source,Pe=x.get(ge);delete Pe[B.__cacheKey],o.memory.textures--}function Z(H){const B=H.texture,ge=i.get(H),Pe=i.get(B);if(Pe.__webglTexture!==void 0&&(t.deleteTexture(Pe.__webglTexture),o.memory.textures--),H.depthTexture&&H.depthTexture.dispose(),H.isWebGLCubeRenderTarget)for(let Oe=0;Oe<6;Oe++)t.deleteFramebuffer(ge.__webglFramebuffer[Oe]),ge.__webglDepthbuffer&&t.deleteRenderbuffer(ge.__webglDepthbuffer[Oe]);else{if(t.deleteFramebuffer(ge.__webglFramebuffer),ge.__webglDepthbuffer&&t.deleteRenderbuffer(ge.__webglDepthbuffer),ge.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ge.__webglMultisampledFramebuffer),ge.__webglColorRenderbuffer)for(let Oe=0;Oe<ge.__webglColorRenderbuffer.length;Oe++)ge.__webglColorRenderbuffer[Oe]&&t.deleteRenderbuffer(ge.__webglColorRenderbuffer[Oe]);ge.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ge.__webglDepthRenderbuffer)}if(H.isWebGLMultipleRenderTargets)for(let Oe=0,Be=B.length;Oe<Be;Oe++){const ht=i.get(B[Oe]);ht.__webglTexture&&(t.deleteTexture(ht.__webglTexture),o.memory.textures--),i.remove(B[Oe])}i.remove(B),i.remove(H)}let ne=0;function J(){ne=0}function z(){const H=ne;return H>=l&&console.warn("THREE.WebGLTextures: Trying to use "+H+" texture units while this GPU supports only "+l),ne+=1,H}function V(H){const B=[];return B.push(H.wrapS),B.push(H.wrapT),B.push(H.wrapR||0),B.push(H.magFilter),B.push(H.minFilter),B.push(H.anisotropy),B.push(H.internalFormat),B.push(H.format),B.push(H.type),B.push(H.generateMipmaps),B.push(H.premultiplyAlpha),B.push(H.flipY),B.push(H.unpackAlignment),B.push(H.encoding),B.join()}function U(H,B){const ge=i.get(H);if(H.isVideoTexture&&Ye(H),H.isRenderTargetTexture===!1&&H.version>0&&ge.__version!==H.version){const Pe=H.image;if(Pe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Pe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{le(ge,H,B);return}}n.bindTexture(3553,ge.__webglTexture,33984+B)}function X(H,B){const ge=i.get(H);if(H.version>0&&ge.__version!==H.version){le(ge,H,B);return}n.bindTexture(35866,ge.__webglTexture,33984+B)}function N(H,B){const ge=i.get(H);if(H.version>0&&ge.__version!==H.version){le(ge,H,B);return}n.bindTexture(32879,ge.__webglTexture,33984+B)}function q(H,B){const ge=i.get(H);if(H.version>0&&ge.__version!==H.version){ae(ge,H,B);return}n.bindTexture(34067,ge.__webglTexture,33984+B)}const Y={[Vf]:10497,[Ai]:33071,[Gf]:33648},ee={[Nn]:9728,[Q0]:9984,[df]:9986,[xn]:9729,[Nb]:9985,[nl]:9987};function W(H,B,ge){if(ge?(t.texParameteri(H,10242,Y[B.wrapS]),t.texParameteri(H,10243,Y[B.wrapT]),(H===32879||H===35866)&&t.texParameteri(H,32882,Y[B.wrapR]),t.texParameteri(H,10240,ee[B.magFilter]),t.texParameteri(H,10241,ee[B.minFilter])):(t.texParameteri(H,10242,33071),t.texParameteri(H,10243,33071),(H===32879||H===35866)&&t.texParameteri(H,32882,33071),(B.wrapS!==Ai||B.wrapT!==Ai)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(H,10240,P(B.magFilter)),t.texParameteri(H,10241,P(B.minFilter)),B.minFilter!==Nn&&B.minFilter!==xn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Pe=e.get("EXT_texture_filter_anisotropic");if(B.magFilter===Nn||B.minFilter!==df&&B.minFilter!==nl||B.type===oo&&e.has("OES_texture_float_linear")===!1||a===!1&&B.type===yu&&e.has("OES_texture_half_float_linear")===!1)return;(B.anisotropy>1||i.get(B).__currentAnisotropy)&&(t.texParameterf(H,Pe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,r.getMaxAnisotropy())),i.get(B).__currentAnisotropy=B.anisotropy)}}function se(H,B){let ge=!1;H.__webglInit===void 0&&(H.__webglInit=!0,B.addEventListener("dispose",O));const Pe=B.source;let Oe=x.get(Pe);Oe===void 0&&(Oe={},x.set(Pe,Oe));const Be=V(B);if(Be!==H.__cacheKey){Oe[Be]===void 0&&(Oe[Be]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,ge=!0),Oe[Be].usedTimes++;const ht=Oe[H.__cacheKey];ht!==void 0&&(Oe[H.__cacheKey].usedTimes--,ht.usedTimes===0&&G(B)),H.__cacheKey=Be,H.__webglTexture=Oe[Be].texture}return ge}function le(H,B,ge){let Pe=3553;(B.isDataArrayTexture||B.isCompressedArrayTexture)&&(Pe=35866),B.isData3DTexture&&(Pe=32879);const Oe=se(H,B),Be=B.source;n.bindTexture(Pe,H.__webglTexture,33984+ge);const ht=i.get(Be);if(Be.version!==ht.__version||Oe===!0){n.activeTexture(33984+ge),t.pixelStorei(37440,B.flipY),t.pixelStorei(37441,B.premultiplyAlpha),t.pixelStorei(3317,B.unpackAlignment),t.pixelStorei(37443,0);const He=T(B)&&b(B.image)===!1;let Me=S(B.image,He,!1,d);Me=nt(B,Me);const We=b(Me)||a,et=s.convert(B.format,B.encoding);let Xe=s.convert(B.type),ut=A(B.internalFormat,et,Xe,B.encoding,B.isVideoTexture);W(Pe,B,We);let ot;const Lt=B.mipmaps,$t=a&&B.isVideoTexture!==!0,Mn=ht.__version===void 0||Oe===!0,re=I(B,Me,We);if(B.isDepthTexture)ut=6402,a?B.type===oo?ut=36012:B.type===Ra?ut=33190:B.type===ou?ut=35056:ut=33189:B.type===oo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),B.format===Ja&&ut===6402&&B.type!==kb&&B.type!==Ra&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),B.type=Ra,Xe=s.convert(B.type)),B.format===xu&&ut===6402&&(ut=34041,B.type!==ou&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),B.type=ou,Xe=s.convert(B.type))),Mn&&($t?n.texStorage2D(3553,1,ut,Me.width,Me.height):n.texImage2D(3553,0,ut,Me.width,Me.height,0,et,Xe,null));else if(B.isDataTexture)if(Lt.length>0&&We){$t&&Mn&&n.texStorage2D(3553,re,ut,Lt[0].width,Lt[0].height);for(let _e=0,Ie=Lt.length;_e<Ie;_e++)ot=Lt[_e],$t?n.texSubImage2D(3553,_e,0,0,ot.width,ot.height,et,Xe,ot.data):n.texImage2D(3553,_e,ut,ot.width,ot.height,0,et,Xe,ot.data);B.generateMipmaps=!1}else $t?(Mn&&n.texStorage2D(3553,re,ut,Me.width,Me.height),n.texSubImage2D(3553,0,0,0,Me.width,Me.height,et,Xe,Me.data)):n.texImage2D(3553,0,ut,Me.width,Me.height,0,et,Xe,Me.data);else if(B.isCompressedTexture)if(B.isCompressedArrayTexture){$t&&Mn&&n.texStorage3D(35866,re,ut,Lt[0].width,Lt[0].height,Me.depth);for(let _e=0,Ie=Lt.length;_e<Ie;_e++)ot=Lt[_e],B.format!==Ji?et!==null?$t?n.compressedTexSubImage3D(35866,_e,0,0,0,ot.width,ot.height,Me.depth,et,ot.data,0,0):n.compressedTexImage3D(35866,_e,ut,ot.width,ot.height,Me.depth,0,ot.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t?n.texSubImage3D(35866,_e,0,0,0,ot.width,ot.height,Me.depth,et,Xe,ot.data):n.texImage3D(35866,_e,ut,ot.width,ot.height,Me.depth,0,et,Xe,ot.data)}else{$t&&Mn&&n.texStorage2D(3553,re,ut,Lt[0].width,Lt[0].height);for(let _e=0,Ie=Lt.length;_e<Ie;_e++)ot=Lt[_e],B.format!==Ji?et!==null?$t?n.compressedTexSubImage2D(3553,_e,0,0,ot.width,ot.height,et,ot.data):n.compressedTexImage2D(3553,_e,ut,ot.width,ot.height,0,ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$t?n.texSubImage2D(3553,_e,0,0,ot.width,ot.height,et,Xe,ot.data):n.texImage2D(3553,_e,ut,ot.width,ot.height,0,et,Xe,ot.data)}else if(B.isDataArrayTexture)$t?(Mn&&n.texStorage3D(35866,re,ut,Me.width,Me.height,Me.depth),n.texSubImage3D(35866,0,0,0,0,Me.width,Me.height,Me.depth,et,Xe,Me.data)):n.texImage3D(35866,0,ut,Me.width,Me.height,Me.depth,0,et,Xe,Me.data);else if(B.isData3DTexture)$t?(Mn&&n.texStorage3D(32879,re,ut,Me.width,Me.height,Me.depth),n.texSubImage3D(32879,0,0,0,0,Me.width,Me.height,Me.depth,et,Xe,Me.data)):n.texImage3D(32879,0,ut,Me.width,Me.height,Me.depth,0,et,Xe,Me.data);else if(B.isFramebufferTexture){if(Mn)if($t)n.texStorage2D(3553,re,ut,Me.width,Me.height);else{let _e=Me.width,Ie=Me.height;for(let Ue=0;Ue<re;Ue++)n.texImage2D(3553,Ue,ut,_e,Ie,0,et,Xe,null),_e>>=1,Ie>>=1}}else if(Lt.length>0&&We){$t&&Mn&&n.texStorage2D(3553,re,ut,Lt[0].width,Lt[0].height);for(let _e=0,Ie=Lt.length;_e<Ie;_e++)ot=Lt[_e],$t?n.texSubImage2D(3553,_e,0,0,et,Xe,ot):n.texImage2D(3553,_e,ut,et,Xe,ot);B.generateMipmaps=!1}else $t?(Mn&&n.texStorage2D(3553,re,ut,Me.width,Me.height),n.texSubImage2D(3553,0,0,0,et,Xe,Me)):n.texImage2D(3553,0,ut,et,Xe,Me);E(B,We)&&L(Pe),ht.__version=Be.version,B.onUpdate&&B.onUpdate(B)}H.__version=B.version}function ae(H,B,ge){if(B.image.length!==6)return;const Pe=se(H,B),Oe=B.source;n.bindTexture(34067,H.__webglTexture,33984+ge);const Be=i.get(Oe);if(Oe.version!==Be.__version||Pe===!0){n.activeTexture(33984+ge),t.pixelStorei(37440,B.flipY),t.pixelStorei(37441,B.premultiplyAlpha),t.pixelStorei(3317,B.unpackAlignment),t.pixelStorei(37443,0);const ht=B.isCompressedTexture||B.image[0].isCompressedTexture,He=B.image[0]&&B.image[0].isDataTexture,Me=[];for(let _e=0;_e<6;_e++)!ht&&!He?Me[_e]=S(B.image[_e],!1,!0,u):Me[_e]=He?B.image[_e].image:B.image[_e],Me[_e]=nt(B,Me[_e]);const We=Me[0],et=b(We)||a,Xe=s.convert(B.format,B.encoding),ut=s.convert(B.type),ot=A(B.internalFormat,Xe,ut,B.encoding),Lt=a&&B.isVideoTexture!==!0,$t=Be.__version===void 0||Pe===!0;let Mn=I(B,We,et);W(34067,B,et);let re;if(ht){Lt&&$t&&n.texStorage2D(34067,Mn,ot,We.width,We.height);for(let _e=0;_e<6;_e++){re=Me[_e].mipmaps;for(let Ie=0;Ie<re.length;Ie++){const Ue=re[Ie];B.format!==Ji?Xe!==null?Lt?n.compressedTexSubImage2D(34069+_e,Ie,0,0,Ue.width,Ue.height,Xe,Ue.data):n.compressedTexImage2D(34069+_e,Ie,ot,Ue.width,Ue.height,0,Ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Lt?n.texSubImage2D(34069+_e,Ie,0,0,Ue.width,Ue.height,Xe,ut,Ue.data):n.texImage2D(34069+_e,Ie,ot,Ue.width,Ue.height,0,Xe,ut,Ue.data)}}}else{re=B.mipmaps,Lt&&$t&&(re.length>0&&Mn++,n.texStorage2D(34067,Mn,ot,Me[0].width,Me[0].height));for(let _e=0;_e<6;_e++)if(He){Lt?n.texSubImage2D(34069+_e,0,0,0,Me[_e].width,Me[_e].height,Xe,ut,Me[_e].data):n.texImage2D(34069+_e,0,ot,Me[_e].width,Me[_e].height,0,Xe,ut,Me[_e].data);for(let Ie=0;Ie<re.length;Ie++){const tt=re[Ie].image[_e].image;Lt?n.texSubImage2D(34069+_e,Ie+1,0,0,tt.width,tt.height,Xe,ut,tt.data):n.texImage2D(34069+_e,Ie+1,ot,tt.width,tt.height,0,Xe,ut,tt.data)}}else{Lt?n.texSubImage2D(34069+_e,0,0,0,Xe,ut,Me[_e]):n.texImage2D(34069+_e,0,ot,Xe,ut,Me[_e]);for(let Ie=0;Ie<re.length;Ie++){const Ue=re[Ie];Lt?n.texSubImage2D(34069+_e,Ie+1,0,0,Xe,ut,Ue.image[_e]):n.texImage2D(34069+_e,Ie+1,ot,Xe,ut,Ue.image[_e])}}}E(B,et)&&L(34067),Be.__version=Oe.version,B.onUpdate&&B.onUpdate(B)}H.__version=B.version}function ue(H,B,ge,Pe,Oe){const Be=s.convert(ge.format,ge.encoding),ht=s.convert(ge.type),He=A(ge.internalFormat,Be,ht,ge.encoding);i.get(B).__hasExternalTextures||(Oe===32879||Oe===35866?n.texImage3D(Oe,0,He,B.width,B.height,B.depth,0,Be,ht,null):n.texImage2D(Oe,0,He,B.width,B.height,0,Be,ht,null)),n.bindFramebuffer(36160,H),ze(B)?h.framebufferTexture2DMultisampleEXT(36160,Pe,Oe,i.get(ge).__webglTexture,0,Le(B)):(Oe===3553||Oe>=34069&&Oe<=34074)&&t.framebufferTexture2D(36160,Pe,Oe,i.get(ge).__webglTexture,0),n.bindFramebuffer(36160,null)}function fe(H,B,ge){if(t.bindRenderbuffer(36161,H),B.depthBuffer&&!B.stencilBuffer){let Pe=33189;if(ge||ze(B)){const Oe=B.depthTexture;Oe&&Oe.isDepthTexture&&(Oe.type===oo?Pe=36012:Oe.type===Ra&&(Pe=33190));const Be=Le(B);ze(B)?h.renderbufferStorageMultisampleEXT(36161,Be,Pe,B.width,B.height):t.renderbufferStorageMultisample(36161,Be,Pe,B.width,B.height)}else t.renderbufferStorage(36161,Pe,B.width,B.height);t.framebufferRenderbuffer(36160,36096,36161,H)}else if(B.depthBuffer&&B.stencilBuffer){const Pe=Le(B);ge&&ze(B)===!1?t.renderbufferStorageMultisample(36161,Pe,35056,B.width,B.height):ze(B)?h.renderbufferStorageMultisampleEXT(36161,Pe,35056,B.width,B.height):t.renderbufferStorage(36161,34041,B.width,B.height),t.framebufferRenderbuffer(36160,33306,36161,H)}else{const Pe=B.isWebGLMultipleRenderTargets===!0?B.texture:[B.texture];for(let Oe=0;Oe<Pe.length;Oe++){const Be=Pe[Oe],ht=s.convert(Be.format,Be.encoding),He=s.convert(Be.type),Me=A(Be.internalFormat,ht,He,Be.encoding),We=Le(B);ge&&ze(B)===!1?t.renderbufferStorageMultisample(36161,We,Me,B.width,B.height):ze(B)?h.renderbufferStorageMultisampleEXT(36161,We,Me,B.width,B.height):t.renderbufferStorage(36161,Me,B.width,B.height)}}t.bindRenderbuffer(36161,null)}function K(H,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,H),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),U(B.depthTexture,0);const Pe=i.get(B.depthTexture).__webglTexture,Oe=Le(B);if(B.depthTexture.format===Ja)ze(B)?h.framebufferTexture2DMultisampleEXT(36160,36096,3553,Pe,0,Oe):t.framebufferTexture2D(36160,36096,3553,Pe,0);else if(B.depthTexture.format===xu)ze(B)?h.framebufferTexture2DMultisampleEXT(36160,33306,3553,Pe,0,Oe):t.framebufferTexture2D(36160,33306,3553,Pe,0);else throw new Error("Unknown depthTexture format")}function Q(H){const B=i.get(H),ge=H.isWebGLCubeRenderTarget===!0;if(H.depthTexture&&!B.__autoAllocateDepthBuffer){if(ge)throw new Error("target.depthTexture not supported in Cube render targets");K(B.__webglFramebuffer,H)}else if(ge){B.__webglDepthbuffer=[];for(let Pe=0;Pe<6;Pe++)n.bindFramebuffer(36160,B.__webglFramebuffer[Pe]),B.__webglDepthbuffer[Pe]=t.createRenderbuffer(),fe(B.__webglDepthbuffer[Pe],H,!1)}else n.bindFramebuffer(36160,B.__webglFramebuffer),B.__webglDepthbuffer=t.createRenderbuffer(),fe(B.__webglDepthbuffer,H,!1);n.bindFramebuffer(36160,null)}function he(H,B,ge){const Pe=i.get(H);B!==void 0&&ue(Pe.__webglFramebuffer,H,H.texture,36064,3553),ge!==void 0&&Q(H)}function ye(H){const B=H.texture,ge=i.get(H),Pe=i.get(B);H.addEventListener("dispose",k),H.isWebGLMultipleRenderTargets!==!0&&(Pe.__webglTexture===void 0&&(Pe.__webglTexture=t.createTexture()),Pe.__version=B.version,o.memory.textures++);const Oe=H.isWebGLCubeRenderTarget===!0,Be=H.isWebGLMultipleRenderTargets===!0,ht=b(H)||a;if(Oe){ge.__webglFramebuffer=[];for(let He=0;He<6;He++)ge.__webglFramebuffer[He]=t.createFramebuffer()}else{if(ge.__webglFramebuffer=t.createFramebuffer(),Be)if(r.drawBuffers){const He=H.texture;for(let Me=0,We=He.length;Me<We;Me++){const et=i.get(He[Me]);et.__webglTexture===void 0&&(et.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&H.samples>0&&ze(H)===!1){const He=Be?B:[B];ge.__webglMultisampledFramebuffer=t.createFramebuffer(),ge.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,ge.__webglMultisampledFramebuffer);for(let Me=0;Me<He.length;Me++){const We=He[Me];ge.__webglColorRenderbuffer[Me]=t.createRenderbuffer(),t.bindRenderbuffer(36161,ge.__webglColorRenderbuffer[Me]);const et=s.convert(We.format,We.encoding),Xe=s.convert(We.type),ut=A(We.internalFormat,et,Xe,We.encoding,H.isXRRenderTarget===!0),ot=Le(H);t.renderbufferStorageMultisample(36161,ot,ut,H.width,H.height),t.framebufferRenderbuffer(36160,36064+Me,36161,ge.__webglColorRenderbuffer[Me])}t.bindRenderbuffer(36161,null),H.depthBuffer&&(ge.__webglDepthRenderbuffer=t.createRenderbuffer(),fe(ge.__webglDepthRenderbuffer,H,!0)),n.bindFramebuffer(36160,null)}}if(Oe){n.bindTexture(34067,Pe.__webglTexture),W(34067,B,ht);for(let He=0;He<6;He++)ue(ge.__webglFramebuffer[He],H,B,36064,34069+He);E(B,ht)&&L(34067),n.unbindTexture()}else if(Be){const He=H.texture;for(let Me=0,We=He.length;Me<We;Me++){const et=He[Me],Xe=i.get(et);n.bindTexture(3553,Xe.__webglTexture),W(3553,et,ht),ue(ge.__webglFramebuffer,H,et,36064+Me,3553),E(et,ht)&&L(3553)}n.unbindTexture()}else{let He=3553;(H.isWebGL3DRenderTarget||H.isWebGLArrayRenderTarget)&&(a?He=H.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(He,Pe.__webglTexture),W(He,B,ht),ue(ge.__webglFramebuffer,H,B,36064,He),E(B,ht)&&L(He),n.unbindTexture()}H.depthBuffer&&Q(H)}function be(H){const B=b(H)||a,ge=H.isWebGLMultipleRenderTargets===!0?H.texture:[H.texture];for(let Pe=0,Oe=ge.length;Pe<Oe;Pe++){const Be=ge[Pe];if(E(Be,B)){const ht=H.isWebGLCubeRenderTarget?34067:3553,He=i.get(Be).__webglTexture;n.bindTexture(ht,He),L(ht),n.unbindTexture()}}}function Te(H){if(a&&H.samples>0&&ze(H)===!1){const B=H.isWebGLMultipleRenderTargets?H.texture:[H.texture],ge=H.width,Pe=H.height;let Oe=16384;const Be=[],ht=H.stencilBuffer?33306:36096,He=i.get(H),Me=H.isWebGLMultipleRenderTargets===!0;if(Me)for(let We=0;We<B.length;We++)n.bindFramebuffer(36160,He.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+We,36161,null),n.bindFramebuffer(36160,He.__webglFramebuffer),t.framebufferTexture2D(36009,36064+We,3553,null,0);n.bindFramebuffer(36008,He.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,He.__webglFramebuffer);for(let We=0;We<B.length;We++){Be.push(36064+We),H.depthBuffer&&Be.push(ht);const et=He.__ignoreDepthValues!==void 0?He.__ignoreDepthValues:!1;if(et===!1&&(H.depthBuffer&&(Oe|=256),H.stencilBuffer&&(Oe|=1024)),Me&&t.framebufferRenderbuffer(36008,36064,36161,He.__webglColorRenderbuffer[We]),et===!0&&(t.invalidateFramebuffer(36008,[ht]),t.invalidateFramebuffer(36009,[ht])),Me){const Xe=i.get(B[We]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,Xe,0)}t.blitFramebuffer(0,0,ge,Pe,0,0,ge,Pe,Oe,9728),m&&t.invalidateFramebuffer(36008,Be)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),Me)for(let We=0;We<B.length;We++){n.bindFramebuffer(36160,He.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+We,36161,He.__webglColorRenderbuffer[We]);const et=i.get(B[We]).__webglTexture;n.bindFramebuffer(36160,He.__webglFramebuffer),t.framebufferTexture2D(36009,36064+We,3553,et,0)}n.bindFramebuffer(36009,He.__webglMultisampledFramebuffer)}}function Le(H){return Math.min(c,H.samples)}function ze(H){const B=i.get(H);return a&&H.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&B.__useRenderToTexture!==!1}function Ye(H){const B=o.render.frame;g.get(H)!==B&&(g.set(H,B),H.update())}function nt(H,B){const ge=H.encoding,Pe=H.format,Oe=H.type;return H.isCompressedTexture===!0||H.isVideoTexture===!0||H.format===ev||ge!==ls&&(ge===jt?a===!1?e.has("EXT_sRGB")===!0&&Pe===Ji?(H.format=ev,H.minFilter=xn,H.generateMipmaps=!1):B=Fb.sRGBToLinear(B):(Pe!==Ji||Oe!==na)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ge)),B}this.allocateTextureUnit=z,this.resetTextureUnits=J,this.setTexture2D=U,this.setTexture2DArray=X,this.setTexture3D=N,this.setTextureCube=q,this.rebindTextures=he,this.setupRenderTarget=ye,this.updateRenderTargetMipmap=be,this.updateMultisampleRenderTarget=Te,this.setupDepthRenderbuffer=Q,this.setupFrameBufferTexture=ue,this.useMultisampledRTT=ze}function lR(t,e,n){const i=n.isWebGL2;function r(s,o=null){let a;if(s===na)return 5121;if(s===ID)return 32819;if(s===DD)return 32820;if(s===CD)return 5120;if(s===PD)return 5122;if(s===kb)return 5123;if(s===LD)return 5124;if(s===Ra)return 5125;if(s===oo)return 5126;if(s===yu)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===RD)return 6406;if(s===Ji)return 6408;if(s===OD)return 6409;if(s===zD)return 6410;if(s===Ja)return 6402;if(s===xu)return 34041;if(s===ev)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===ND)return 6403;if(s===kD)return 36244;if(s===BD)return 33319;if(s===UD)return 33320;if(s===FD)return 36249;if(s===f0||s===p0||s===m0||s===g0)if(o===jt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===f0)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===p0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===m0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===g0)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===f0)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===p0)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===m0)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===g0)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===mw||s===gw||s===vw||s===yw)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===mw)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===gw)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===vw)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===yw)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===VD)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===xw||s===_w)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===xw)return o===jt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===_w)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===ww||s===Sw||s===bw||s===Mw||s===Ew||s===Aw||s===Tw||s===Cw||s===Pw||s===Lw||s===Iw||s===Dw||s===Rw||s===Ow)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===ww)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===Sw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===bw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Mw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Ew)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===Aw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===Tw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===Cw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Pw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Lw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Iw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Dw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Rw)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Ow)return o===jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===v0)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===v0)return o===jt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===GD||s===zw||s===Nw||s===kw)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===v0)return a.COMPRESSED_RED_RGTC1_EXT;if(s===zw)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===Nw)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===kw)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ou?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class uR extends Un{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Oa extends Pt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const K8={type:"move"};class _x{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Oa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Oa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new R,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new R),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Oa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new R,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new R),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const v of e.hand.values()){const x=n.getJointPose(v,i),y=this._getHandJoint(u,v);x!==null&&(y.matrix.fromArray(x.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=x.radius),y.visible=x!==null}const d=u.joints["index-finger-tip"],c=u.joints["thumb-tip"],h=d.position.distanceTo(c.position),m=.02,g=.005;u.inputState.pinching&&h>m+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&h<=m-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(K8)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new Oa;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class $b extends gn{constructor(e,n,i,r,s,o,a,l,u,d){if(d=d!==void 0?d:Ja,d!==Ja&&d!==xu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===Ja&&(i=Ra),i===void 0&&d===xu&&(i=ou),super(null,r,s,o,a,l,d,i,u),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:Nn,this.minFilter=l!==void 0?l:Nn,this.flipY=!1,this.generateMipmaps=!1}}class Q8 extends po{constructor(e,n){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,u=null,d=null,c=null,h=null,m=null,g=null;const v=n.getContextAttributes();let x=null,y=null;const _=[],S=[],b=new Set,T=new Map,E=new Un;E.layers.enable(1),E.viewport=new _t;const L=new Un;L.layers.enable(2),L.viewport=new _t;const A=[E,L],I=new uR;I.layers.enable(1),I.layers.enable(2);let P=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let q=_[N];return q===void 0&&(q=new _x,_[N]=q),q.getTargetRaySpace()},this.getControllerGrip=function(N){let q=_[N];return q===void 0&&(q=new _x,_[N]=q),q.getGripSpace()},this.getHand=function(N){let q=_[N];return q===void 0&&(q=new _x,_[N]=q),q.getHandSpace()};function k(N){const q=S.indexOf(N.inputSource);if(q===-1)return;const Y=_[q];Y!==void 0&&Y.dispatchEvent({type:N.type,data:N.inputSource})}function F(){r.removeEventListener("select",k),r.removeEventListener("selectstart",k),r.removeEventListener("selectend",k),r.removeEventListener("squeeze",k),r.removeEventListener("squeezestart",k),r.removeEventListener("squeezeend",k),r.removeEventListener("end",F),r.removeEventListener("inputsourceschange",G);for(let N=0;N<_.length;N++){const q=S[N];q!==null&&(S[N]=null,_[N].disconnect(q))}P=null,O=null,e.setRenderTarget(x),m=null,h=null,c=null,r=null,y=null,X.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(N){s=N,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){a=N,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(N){u=N},this.getBaseLayer=function(){return h!==null?h:m},this.getBinding=function(){return c},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=async function(N){if(r=N,r!==null){if(x=e.getRenderTarget(),r.addEventListener("select",k),r.addEventListener("selectstart",k),r.addEventListener("selectend",k),r.addEventListener("squeeze",k),r.addEventListener("squeezestart",k),r.addEventListener("squeezeend",k),r.addEventListener("end",F),r.addEventListener("inputsourceschange",G),v.xrCompatible!==!0&&await n.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const q={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:v.alpha,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};m=new XRWebGLLayer(r,n,q),r.updateRenderState({baseLayer:m}),y=new us(m.framebufferWidth,m.framebufferHeight,{format:Ji,type:na,encoding:e.outputEncoding,stencilBuffer:v.stencil})}else{let q=null,Y=null,ee=null;v.depth&&(ee=v.stencil?35056:33190,q=v.stencil?xu:Ja,Y=v.stencil?ou:Ra);const W={colorFormat:32856,depthFormat:ee,scaleFactor:s};c=new XRWebGLBinding(r,n),h=c.createProjectionLayer(W),r.updateRenderState({layers:[h]}),y=new us(h.textureWidth,h.textureHeight,{format:Ji,type:na,depthTexture:new $b(h.textureWidth,h.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,q),stencilBuffer:v.stencil,encoding:e.outputEncoding,samples:v.antialias?4:0});const se=e.properties.get(y);se.__ignoreDepthValues=h.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await r.requestReferenceSpace(a),X.setContext(r),X.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function G(N){for(let q=0;q<N.removed.length;q++){const Y=N.removed[q],ee=S.indexOf(Y);ee>=0&&(S[ee]=null,_[ee].disconnect(Y))}for(let q=0;q<N.added.length;q++){const Y=N.added[q];let ee=S.indexOf(Y);if(ee===-1){for(let se=0;se<_.length;se++)if(se>=S.length){S.push(Y),ee=se;break}else if(S[se]===null){S[se]=Y,ee=se;break}if(ee===-1)break}const W=_[ee];W&&W.connect(Y)}}const Z=new R,ne=new R;function J(N,q,Y){Z.setFromMatrixPosition(q.matrixWorld),ne.setFromMatrixPosition(Y.matrixWorld);const ee=Z.distanceTo(ne),W=q.projectionMatrix.elements,se=Y.projectionMatrix.elements,le=W[14]/(W[10]-1),ae=W[14]/(W[10]+1),ue=(W[9]+1)/W[5],fe=(W[9]-1)/W[5],K=(W[8]-1)/W[0],Q=(se[8]+1)/se[0],he=le*K,ye=le*Q,be=ee/(-K+Q),Te=be*-K;q.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(Te),N.translateZ(be),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();const Le=le+be,ze=ae+be,Ye=he-Te,nt=ye+(ee-Te),H=ue*ae/ze*Le,B=fe*ae/ze*Le;N.projectionMatrix.makePerspective(Ye,nt,H,B,Le,ze)}function z(N,q){q===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(q.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}this.updateCamera=function(N){if(r===null)return;I.near=L.near=E.near=N.near,I.far=L.far=E.far=N.far,(P!==I.near||O!==I.far)&&(r.updateRenderState({depthNear:I.near,depthFar:I.far}),P=I.near,O=I.far);const q=N.parent,Y=I.cameras;z(I,q);for(let W=0;W<Y.length;W++)z(Y[W],q);I.matrixWorld.decompose(I.position,I.quaternion,I.scale),N.matrix.copy(I.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale);const ee=N.children;for(let W=0,se=ee.length;W<se;W++)ee[W].updateMatrixWorld(!0);Y.length===2?J(I,E,L):I.projectionMatrix.copy(E.projectionMatrix)},this.getCamera=function(){return I},this.getFoveation=function(){if(!(h===null&&m===null))return l},this.setFoveation=function(N){l=N,h!==null&&(h.fixedFoveation=N),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=N)},this.getPlanes=function(){return b};let V=null;function U(N,q){if(d=q.getViewerPose(u||o),g=q,d!==null){const Y=d.views;m!==null&&(e.setRenderTargetFramebuffer(y,m.framebuffer),e.setRenderTarget(y));let ee=!1;Y.length!==I.cameras.length&&(I.cameras.length=0,ee=!0);for(let W=0;W<Y.length;W++){const se=Y[W];let le=null;if(m!==null)le=m.getViewport(se);else{const ue=c.getViewSubImage(h,se);le=ue.viewport,W===0&&(e.setRenderTargetTextures(y,ue.colorTexture,h.ignoreDepthValues?void 0:ue.depthStencilTexture),e.setRenderTarget(y))}let ae=A[W];ae===void 0&&(ae=new Un,ae.layers.enable(W),ae.viewport=new _t,A[W]=ae),ae.matrix.fromArray(se.transform.matrix),ae.projectionMatrix.fromArray(se.projectionMatrix),ae.viewport.set(le.x,le.y,le.width,le.height),W===0&&I.matrix.copy(ae.matrix),ee===!0&&I.cameras.push(ae)}}for(let Y=0;Y<_.length;Y++){const ee=S[Y],W=_[Y];ee!==null&&W!==void 0&&W.update(ee,q,u||o)}if(V&&V(N,q),q.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:q.detectedPlanes});let Y=null;for(const ee of b)q.detectedPlanes.has(ee)||(Y===null&&(Y=[]),Y.push(ee));if(Y!==null)for(const ee of Y)b.delete(ee),T.delete(ee),i.dispatchEvent({type:"planeremoved",data:ee});for(const ee of q.detectedPlanes)if(!b.has(ee))b.add(ee),T.set(ee,q.lastChangedTime),i.dispatchEvent({type:"planeadded",data:ee});else{const W=T.get(ee);ee.lastChangedTime>W&&(T.set(ee,ee.lastChangedTime),i.dispatchEvent({type:"planechanged",data:ee}))}}g=null}const X=new iR;X.setAnimationLoop(U),this.setAnimationLoop=function(N){V=N},this.dispose=function(){}}}function eG(t,e){function n(v,x){x.color.getRGB(v.fogColor.value,eR(t)),x.isFog?(v.fogNear.value=x.near,v.fogFar.value=x.far):x.isFogExp2&&(v.fogDensity.value=x.density)}function i(v,x,y,_,S){x.isMeshBasicMaterial||x.isMeshLambertMaterial?r(v,x):x.isMeshToonMaterial?(r(v,x),d(v,x)):x.isMeshPhongMaterial?(r(v,x),u(v,x)):x.isMeshStandardMaterial?(r(v,x),c(v,x),x.isMeshPhysicalMaterial&&h(v,x,S)):x.isMeshMatcapMaterial?(r(v,x),m(v,x)):x.isMeshDepthMaterial?r(v,x):x.isMeshDistanceMaterial?(r(v,x),g(v,x)):x.isMeshNormalMaterial?r(v,x):x.isLineBasicMaterial?(s(v,x),x.isLineDashedMaterial&&o(v,x)):x.isPointsMaterial?a(v,x,y,_):x.isSpriteMaterial?l(v,x):x.isShadowMaterial?(v.color.value.copy(x.color),v.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function r(v,x){v.opacity.value=x.opacity,x.color&&v.diffuse.value.copy(x.color),x.emissive&&v.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(v.map.value=x.map),x.alphaMap&&(v.alphaMap.value=x.alphaMap),x.bumpMap&&(v.bumpMap.value=x.bumpMap,v.bumpScale.value=x.bumpScale,x.side===sr&&(v.bumpScale.value*=-1)),x.displacementMap&&(v.displacementMap.value=x.displacementMap,v.displacementScale.value=x.displacementScale,v.displacementBias.value=x.displacementBias),x.emissiveMap&&(v.emissiveMap.value=x.emissiveMap),x.normalMap&&(v.normalMap.value=x.normalMap,v.normalScale.value.copy(x.normalScale),x.side===sr&&v.normalScale.value.negate()),x.specularMap&&(v.specularMap.value=x.specularMap),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest);const y=e.get(x).envMap;if(y&&(v.envMap.value=y,v.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=x.reflectivity,v.ior.value=x.ior,v.refractionRatio.value=x.refractionRatio),x.lightMap){v.lightMap.value=x.lightMap;const b=t.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=x.lightMapIntensity*b}x.aoMap&&(v.aoMap.value=x.aoMap,v.aoMapIntensity.value=x.aoMapIntensity);let _;x.map?_=x.map:x.specularMap?_=x.specularMap:x.displacementMap?_=x.displacementMap:x.normalMap?_=x.normalMap:x.bumpMap?_=x.bumpMap:x.roughnessMap?_=x.roughnessMap:x.metalnessMap?_=x.metalnessMap:x.alphaMap?_=x.alphaMap:x.emissiveMap?_=x.emissiveMap:x.clearcoatMap?_=x.clearcoatMap:x.clearcoatNormalMap?_=x.clearcoatNormalMap:x.clearcoatRoughnessMap?_=x.clearcoatRoughnessMap:x.iridescenceMap?_=x.iridescenceMap:x.iridescenceThicknessMap?_=x.iridescenceThicknessMap:x.specularIntensityMap?_=x.specularIntensityMap:x.specularColorMap?_=x.specularColorMap:x.transmissionMap?_=x.transmissionMap:x.thicknessMap?_=x.thicknessMap:x.sheenColorMap?_=x.sheenColorMap:x.sheenRoughnessMap&&(_=x.sheenRoughnessMap),_!==void 0&&(_.isWebGLRenderTarget&&(_=_.texture),_.matrixAutoUpdate===!0&&_.updateMatrix(),v.uvTransform.value.copy(_.matrix));let S;x.aoMap?S=x.aoMap:x.lightMap&&(S=x.lightMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),v.uv2Transform.value.copy(S.matrix))}function s(v,x){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity}function o(v,x){v.dashSize.value=x.dashSize,v.totalSize.value=x.dashSize+x.gapSize,v.scale.value=x.scale}function a(v,x,y,_){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,v.size.value=x.size*y,v.scale.value=_*.5,x.map&&(v.map.value=x.map),x.alphaMap&&(v.alphaMap.value=x.alphaMap),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest);let S;x.map?S=x.map:x.alphaMap&&(S=x.alphaMap),S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),v.uvTransform.value.copy(S.matrix))}function l(v,x){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,v.rotation.value=x.rotation,x.map&&(v.map.value=x.map),x.alphaMap&&(v.alphaMap.value=x.alphaMap),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest);let y;x.map?y=x.map:x.alphaMap&&(y=x.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix))}function u(v,x){v.specular.value.copy(x.specular),v.shininess.value=Math.max(x.shininess,1e-4)}function d(v,x){x.gradientMap&&(v.gradientMap.value=x.gradientMap)}function c(v,x){v.roughness.value=x.roughness,v.metalness.value=x.metalness,x.roughnessMap&&(v.roughnessMap.value=x.roughnessMap),x.metalnessMap&&(v.metalnessMap.value=x.metalnessMap),e.get(x).envMap&&(v.envMapIntensity.value=x.envMapIntensity)}function h(v,x,y){v.ior.value=x.ior,x.sheen>0&&(v.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),v.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(v.sheenColorMap.value=x.sheenColorMap),x.sheenRoughnessMap&&(v.sheenRoughnessMap.value=x.sheenRoughnessMap)),x.clearcoat>0&&(v.clearcoat.value=x.clearcoat,v.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(v.clearcoatMap.value=x.clearcoatMap),x.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap),x.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),v.clearcoatNormalMap.value=x.clearcoatNormalMap,x.side===sr&&v.clearcoatNormalScale.value.negate())),x.iridescence>0&&(v.iridescence.value=x.iridescence,v.iridescenceIOR.value=x.iridescenceIOR,v.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(v.iridescenceMap.value=x.iridescenceMap),x.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=x.iridescenceThicknessMap)),x.transmission>0&&(v.transmission.value=x.transmission,v.transmissionSamplerMap.value=y.texture,v.transmissionSamplerSize.value.set(y.width,y.height),x.transmissionMap&&(v.transmissionMap.value=x.transmissionMap),v.thickness.value=x.thickness,x.thicknessMap&&(v.thicknessMap.value=x.thicknessMap),v.attenuationDistance.value=x.attenuationDistance,v.attenuationColor.value.copy(x.attenuationColor)),v.specularIntensity.value=x.specularIntensity,v.specularColor.value.copy(x.specularColor),x.specularIntensityMap&&(v.specularIntensityMap.value=x.specularIntensityMap),x.specularColorMap&&(v.specularColorMap.value=x.specularColorMap)}function m(v,x){x.matcap&&(v.matcap.value=x.matcap)}function g(v,x){v.referencePosition.value.copy(x.referencePosition),v.nearDistance.value=x.nearDistance,v.farDistance.value=x.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function tG(t,e,n,i){let r={},s={},o=[];const a=n.isWebGL2?t.getParameter(35375):0;function l(_,S){const b=S.program;i.uniformBlockBinding(_,b)}function u(_,S){let b=r[_.id];b===void 0&&(g(_),b=d(_),r[_.id]=b,_.addEventListener("dispose",x));const T=S.program;i.updateUBOMapping(_,T);const E=e.render.frame;s[_.id]!==E&&(h(_),s[_.id]=E)}function d(_){const S=c();_.__bindingPointIndex=S;const b=t.createBuffer(),T=_.__size,E=_.usage;return t.bindBuffer(35345,b),t.bufferData(35345,T,E),t.bindBuffer(35345,null),t.bindBufferBase(35345,S,b),b}function c(){for(let _=0;_<a;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(_){const S=r[_.id],b=_.uniforms,T=_.__cache;t.bindBuffer(35345,S);for(let E=0,L=b.length;E<L;E++){const A=b[E];if(m(A,E,T)===!0){const I=A.__offset,P=Array.isArray(A.value)?A.value:[A.value];let O=0;for(let k=0;k<P.length;k++){const F=P[k],G=v(F);typeof F=="number"?(A.__data[0]=F,t.bufferSubData(35345,I+O,A.__data)):F.isMatrix3?(A.__data[0]=F.elements[0],A.__data[1]=F.elements[1],A.__data[2]=F.elements[2],A.__data[3]=F.elements[0],A.__data[4]=F.elements[3],A.__data[5]=F.elements[4],A.__data[6]=F.elements[5],A.__data[7]=F.elements[0],A.__data[8]=F.elements[6],A.__data[9]=F.elements[7],A.__data[10]=F.elements[8],A.__data[11]=F.elements[0]):(F.toArray(A.__data,O),O+=G.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,I,A.__data)}}t.bindBuffer(35345,null)}function m(_,S,b){const T=_.value;if(b[S]===void 0){if(typeof T=="number")b[S]=T;else{const E=Array.isArray(T)?T:[T],L=[];for(let A=0;A<E.length;A++)L.push(E[A].clone());b[S]=L}return!0}else if(typeof T=="number"){if(b[S]!==T)return b[S]=T,!0}else{const E=Array.isArray(b[S])?b[S]:[b[S]],L=Array.isArray(T)?T:[T];for(let A=0;A<E.length;A++){const I=E[A];if(I.equals(L[A])===!1)return I.copy(L[A]),!0}}return!1}function g(_){const S=_.uniforms;let b=0;const T=16;let E=0;for(let L=0,A=S.length;L<A;L++){const I=S[L],P={boundary:0,storage:0},O=Array.isArray(I.value)?I.value:[I.value];for(let k=0,F=O.length;k<F;k++){const G=O[k],Z=v(G);P.boundary+=Z.boundary,P.storage+=Z.storage}if(I.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),I.__offset=b,L>0){E=b%T;const k=T-E;E!==0&&k-P.boundary<0&&(b+=T-E,I.__offset=b)}b+=P.storage}return E=b%T,E>0&&(b+=T-E),_.__size=b,_.__cache={},this}function v(_){const S={boundary:0,storage:0};return typeof _=="number"?(S.boundary=4,S.storage=4):_.isVector2?(S.boundary=8,S.storage=8):_.isVector3||_.isColor?(S.boundary=16,S.storage=12):_.isVector4?(S.boundary=16,S.storage=16):_.isMatrix3?(S.boundary=48,S.storage=48):_.isMatrix4?(S.boundary=64,S.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),S}function x(_){const S=_.target;S.removeEventListener("dispose",x);const b=o.indexOf(S.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[S.id]),delete r[S.id],delete s[S.id]}function y(){for(const _ in r)t.deleteBuffer(r[_]);o=[],r={},s={}}return{bind:l,update:u,dispose:y}}function nG(){const t=Xf("canvas");return t.style.display="block",t}function qb(t={}){this.isWebGLRenderer=!0;const e=t.canvas!==void 0?t.canvas:nG(),n=t.context!==void 0?t.context:null,i=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",u=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1;let d;n!==null?d=n.getContextAttributes().alpha:d=t.alpha!==void 0?t.alpha:!1;let c=null,h=null;const m=[],g=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=ls,this.physicallyCorrectLights=!1,this.toneMapping=Ps,this.toneMappingExposure=1;const v=this;let x=!1,y=0,_=0,S=null,b=-1,T=null;const E=new _t,L=new _t;let A=null,I=e.width,P=e.height,O=1,k=null,F=null;const G=new _t(0,0,I,P),Z=new _t(0,0,I,P);let ne=!1;const J=new Yv;let z=!1,V=!1,U=null;const X=new Fe,N=new te,q=new R,Y={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ee(){return S===null?O:1}let W=n;function se(j,pe){for(let Se=0;Se<j.length;Se++){const de=j[Se],Ae=e.getContext(de,pe);if(Ae!==null)return Ae}return null}try{const j={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:u};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Wv}`),e.addEventListener("webglcontextlost",ut,!1),e.addEventListener("webglcontextrestored",ot,!1),e.addEventListener("webglcontextcreationerror",Lt,!1),W===null){const pe=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&pe.shift(),W=se(pe,j),W===null)throw se(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}W.getShaderPrecisionFormat===void 0&&(W.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(j){throw console.error("THREE.WebGLRenderer: "+j.message),j}let le,ae,ue,fe,K,Q,he,ye,be,Te,Le,ze,Ye,nt,H,B,ge,Pe,Oe,Be,ht,He,Me,We;function et(){le=new yV(W),ae=new dV(W,le,t),le.init(ae),He=new lR(W,le,ae),ue=new Z8(W,le,ae),fe=new wV,K=new B8,Q=new J8(W,le,ue,K,ae,He,fe),he=new pV(v),ye=new vV(v),be=new LF(W,ae),Me=new cV(W,le,be,ae),Te=new xV(W,be,fe,Me),Le=new EV(W,Te,be,fe),Oe=new MV(W,ae,Q),B=new fV(K),ze=new k8(v,he,ye,le,ae,Me,B),Ye=new eG(v,K),nt=new F8,H=new $8(le,ae),Pe=new uV(v,he,ye,ue,Le,d,o),ge=new Y8(v,Le,ae),We=new tG(W,fe,ae,ue),Be=new hV(W,le,fe,ae),ht=new _V(W,le,fe,ae),fe.programs=ze.programs,v.capabilities=ae,v.extensions=le,v.properties=K,v.renderLists=nt,v.shadowMap=ge,v.state=ue,v.info=fe}et();const Xe=new Q8(v,W);this.xr=Xe,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){const j=le.get("WEBGL_lose_context");j&&j.loseContext()},this.forceContextRestore=function(){const j=le.get("WEBGL_lose_context");j&&j.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(j){j!==void 0&&(O=j,this.setSize(I,P,!1))},this.getSize=function(j){return j.set(I,P)},this.setSize=function(j,pe,Se){if(Xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}I=j,P=pe,e.width=Math.floor(j*O),e.height=Math.floor(pe*O),Se!==!1&&(e.style.width=j+"px",e.style.height=pe+"px"),this.setViewport(0,0,j,pe)},this.getDrawingBufferSize=function(j){return j.set(I*O,P*O).floor()},this.setDrawingBufferSize=function(j,pe,Se){I=j,P=pe,O=Se,e.width=Math.floor(j*Se),e.height=Math.floor(pe*Se),this.setViewport(0,0,j,pe)},this.getCurrentViewport=function(j){return j.copy(E)},this.getViewport=function(j){return j.copy(G)},this.setViewport=function(j,pe,Se,de){j.isVector4?G.set(j.x,j.y,j.z,j.w):G.set(j,pe,Se,de),ue.viewport(E.copy(G).multiplyScalar(O).floor())},this.getScissor=function(j){return j.copy(Z)},this.setScissor=function(j,pe,Se,de){j.isVector4?Z.set(j.x,j.y,j.z,j.w):Z.set(j,pe,Se,de),ue.scissor(L.copy(Z).multiplyScalar(O).floor())},this.getScissorTest=function(){return ne},this.setScissorTest=function(j){ue.setScissorTest(ne=j)},this.setOpaqueSort=function(j){k=j},this.setTransparentSort=function(j){F=j},this.getClearColor=function(j){return j.copy(Pe.getClearColor())},this.setClearColor=function(){Pe.setClearColor.apply(Pe,arguments)},this.getClearAlpha=function(){return Pe.getClearAlpha()},this.setClearAlpha=function(){Pe.setClearAlpha.apply(Pe,arguments)},this.clear=function(j=!0,pe=!0,Se=!0){let de=0;j&&(de|=16384),pe&&(de|=256),Se&&(de|=1024),W.clear(de)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ut,!1),e.removeEventListener("webglcontextrestored",ot,!1),e.removeEventListener("webglcontextcreationerror",Lt,!1),nt.dispose(),H.dispose(),K.dispose(),he.dispose(),ye.dispose(),Le.dispose(),Me.dispose(),We.dispose(),ze.dispose(),Xe.dispose(),Xe.removeEventListener("sessionstart",Ue),Xe.removeEventListener("sessionend",tt),U&&(U.dispose(),U=null),Ot.stop()};function ut(j){j.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),x=!0}function ot(){console.log("THREE.WebGLRenderer: Context Restored."),x=!1;const j=fe.autoReset,pe=ge.enabled,Se=ge.autoUpdate,de=ge.needsUpdate,Ae=ge.type;et(),fe.autoReset=j,ge.enabled=pe,ge.autoUpdate=Se,ge.needsUpdate=de,ge.type=Ae}function Lt(j){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",j.statusMessage)}function $t(j){const pe=j.target;pe.removeEventListener("dispose",$t),Mn(pe)}function Mn(j){re(j),K.remove(j)}function re(j){const pe=K.get(j).programs;pe!==void 0&&(pe.forEach(function(Se){ze.releaseProgram(Se)}),j.isShaderMaterial&&ze.releaseShaderCache(j))}this.renderBufferDirect=function(j,pe,Se,de,Ae,ct){pe===null&&(pe=Y);const gt=Ae.isMesh&&Ae.matrixWorld.determinant()<0,St=_y(j,pe,Se,de,Ae);ue.setMaterial(de,gt);let At=Se.index,zt=1;de.wireframe===!0&&(At=Te.getWireframeAttribute(Se),zt=2);const It=Se.drawRange,Dt=Se.attributes.position;let En=It.start*zt,Ii=(It.start+It.count)*zt;ct!==null&&(En=Math.max(En,ct.start*zt),Ii=Math.min(Ii,(ct.start+ct.count)*zt)),At!==null?(En=Math.max(En,0),Ii=Math.min(Ii,At.count)):Dt!=null&&(En=Math.max(En,0),Ii=Math.min(Ii,Dt.count));const ds=Ii-En;if(ds<0||ds===1/0)return;Me.setup(Ae,de,St,Se,At);let yo,fn=Be;if(At!==null&&(yo=be.get(At),fn=ht,fn.setIndex(yo)),Ae.isMesh)de.wireframe===!0?(ue.setLineWidth(de.wireframeLinewidth*ee()),fn.setMode(1)):fn.setMode(4);else if(Ae.isLine){let bt=de.linewidth;bt===void 0&&(bt=1),ue.setLineWidth(bt*ee()),Ae.isLineSegments?fn.setMode(1):Ae.isLineLoop?fn.setMode(2):fn.setMode(3)}else Ae.isPoints?fn.setMode(0):Ae.isSprite&&fn.setMode(4);if(Ae.isInstancedMesh)fn.renderInstances(En,ds,Ae.count);else if(Se.isInstancedBufferGeometry){const bt=Se._maxInstanceCount!==void 0?Se._maxInstanceCount:1/0,ml=Math.min(Se.instanceCount,bt);fn.renderInstances(En,ds,ml)}else fn.render(En,ds)},this.compile=function(j,pe){function Se(de,Ae,ct){de.transparent===!0&&de.side===so&&de.forceSinglePass===!1?(de.side=sr,de.needsUpdate=!0,ji(de,Ae,ct),de.side=Qo,de.needsUpdate=!0,ji(de,Ae,ct),de.side=so):ji(de,Ae,ct)}h=H.get(j),h.init(),g.push(h),j.traverseVisible(function(de){de.isLight&&de.layers.test(pe.layers)&&(h.pushLight(de),de.castShadow&&h.pushShadow(de))}),h.setupLights(v.physicallyCorrectLights),j.traverse(function(de){const Ae=de.material;if(Ae)if(Array.isArray(Ae))for(let ct=0;ct<Ae.length;ct++){const gt=Ae[ct];Se(gt,j,de)}else Se(Ae,j,de)}),g.pop(),h=null};let _e=null;function Ie(j){_e&&_e(j)}function Ue(){Ot.stop()}function tt(){Ot.start()}const Ot=new iR;Ot.setAnimationLoop(Ie),typeof self<"u"&&Ot.setContext(self),this.setAnimationLoop=function(j){_e=j,Xe.setAnimationLoop(j),j===null?Ot.stop():Ot.start()},Xe.addEventListener("sessionstart",Ue),Xe.addEventListener("sessionend",tt),this.render=function(j,pe){if(pe!==void 0&&pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(x===!0)return;j.matrixWorldAutoUpdate===!0&&j.updateMatrixWorld(),pe.parent===null&&pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),Xe.enabled===!0&&Xe.isPresenting===!0&&(Xe.cameraAutoUpdate===!0&&Xe.updateCamera(pe),pe=Xe.getCamera()),j.isScene===!0&&j.onBeforeRender(v,j,pe,S),h=H.get(j,g.length),h.init(),g.push(h),X.multiplyMatrices(pe.projectionMatrix,pe.matrixWorldInverse),J.setFromProjectionMatrix(X),V=this.localClippingEnabled,z=B.init(this.clippingPlanes,V),c=nt.get(j,m.length),c.init(),m.push(c),rn(j,pe,0,v.sortObjects),c.finish(),v.sortObjects===!0&&c.sort(k,F),z===!0&&B.beginShadows();const Se=h.state.shadowsArray;if(ge.render(Se,j,pe),z===!0&&B.endShadows(),this.info.autoReset===!0&&this.info.reset(),Pe.render(c,j),h.setupLights(v.physicallyCorrectLights),pe.isArrayCamera){const de=pe.cameras;for(let Ae=0,ct=de.length;Ae<ct;Ae++){const gt=de[Ae];ei(c,j,gt,gt.viewport)}}else ei(c,j,pe);S!==null&&(Q.updateMultisampleRenderTarget(S),Q.updateRenderTargetMipmap(S)),j.isScene===!0&&j.onAfterRender(v,j,pe),Me.resetDefaultState(),b=-1,T=null,g.pop(),g.length>0?h=g[g.length-1]:h=null,m.pop(),m.length>0?c=m[m.length-1]:c=null};function rn(j,pe,Se,de){if(j.visible===!1)return;if(j.layers.test(pe.layers)){if(j.isGroup)Se=j.renderOrder;else if(j.isLOD)j.autoUpdate===!0&&j.update(pe);else if(j.isLight)h.pushLight(j),j.castShadow&&h.pushShadow(j);else if(j.isSprite){if(!j.frustumCulled||J.intersectsSprite(j)){de&&q.setFromMatrixPosition(j.matrixWorld).applyMatrix4(X);const gt=Le.update(j),St=j.material;St.visible&&c.push(j,gt,St,Se,q.z,null)}}else if((j.isMesh||j.isLine||j.isPoints)&&(j.isSkinnedMesh&&j.skeleton.frame!==fe.render.frame&&(j.skeleton.update(),j.skeleton.frame=fe.render.frame),!j.frustumCulled||J.intersectsObject(j))){de&&q.setFromMatrixPosition(j.matrixWorld).applyMatrix4(X);const gt=Le.update(j),St=j.material;if(Array.isArray(St)){const At=gt.groups;for(let zt=0,It=At.length;zt<It;zt++){const Dt=At[zt],En=St[Dt.materialIndex];En&&En.visible&&c.push(j,gt,En,Se,q.z,Dt)}}else St.visible&&c.push(j,gt,St,Se,q.z,null)}}const ct=j.children;for(let gt=0,St=ct.length;gt<St;gt++)rn(ct[gt],pe,Se,de)}function ei(j,pe,Se,de){const Ae=j.opaque,ct=j.transmissive,gt=j.transparent;h.setupLightsView(Se),z===!0&&B.setGlobalState(v.clippingPlanes,Se),ct.length>0&&Fs(Ae,pe,Se),de&&ue.viewport(E.copy(de)),Ae.length>0&&Kt(Ae,pe,Se),ct.length>0&&Kt(ct,pe,Se),gt.length>0&&Kt(gt,pe,Se),ue.buffers.depth.setTest(!0),ue.buffers.depth.setMask(!0),ue.buffers.color.setMask(!0),ue.setPolygonOffset(!1)}function Fs(j,pe,Se){const de=ae.isWebGL2;U===null&&(U=new us(1,1,{generateMipmaps:!0,type:le.has("EXT_color_buffer_half_float")?yu:na,minFilter:nl,samples:de&&s===!0?4:0})),v.getDrawingBufferSize(N),de?U.setSize(N.x,N.y):U.setSize(tv(N.x),tv(N.y));const Ae=v.getRenderTarget();v.setRenderTarget(U),v.clear();const ct=v.toneMapping;v.toneMapping=Ps,Kt(j,pe,Se),v.toneMapping=ct,Q.updateMultisampleRenderTarget(U),Q.updateRenderTargetMipmap(U),v.setRenderTarget(Ae)}function Kt(j,pe,Se){const de=pe.isScene===!0?pe.overrideMaterial:null;for(let Ae=0,ct=j.length;Ae<ct;Ae++){const gt=j[Ae],St=gt.object,At=gt.geometry,zt=de===null?gt.material:de,It=gt.group;St.layers.test(Se.layers)&&Cr(St,pe,Se,At,zt,It)}}function Cr(j,pe,Se,de,Ae,ct){j.onBeforeRender(v,pe,Se,de,Ae,ct),j.modelViewMatrix.multiplyMatrices(Se.matrixWorldInverse,j.matrixWorld),j.normalMatrix.getNormalMatrix(j.modelViewMatrix),Ae.onBeforeRender(v,pe,Se,de,j,ct),Ae.transparent===!0&&Ae.side===so&&Ae.forceSinglePass===!1?(Ae.side=sr,Ae.needsUpdate=!0,v.renderBufferDirect(Se,pe,de,Ae,j,ct),Ae.side=Qo,Ae.needsUpdate=!0,v.renderBufferDirect(Se,pe,de,Ae,j,ct),Ae.side=so):v.renderBufferDirect(Se,pe,de,Ae,j,ct),j.onAfterRender(v,pe,Se,de,Ae,ct)}function ji(j,pe,Se){pe.isScene!==!0&&(pe=Y);const de=K.get(j),Ae=h.state.lights,ct=h.state.shadowsArray,gt=Ae.state.version,St=ze.getParameters(j,Ae.state,ct,pe,Se),At=ze.getProgramCacheKey(St);let zt=de.programs;de.environment=j.isMeshStandardMaterial?pe.environment:null,de.fog=pe.fog,de.envMap=(j.isMeshStandardMaterial?ye:he).get(j.envMap||de.environment),zt===void 0&&(j.addEventListener("dispose",$t),zt=new Map,de.programs=zt);let It=zt.get(At);if(It!==void 0){if(de.currentProgram===It&&de.lightsStateVersion===gt)return Np(j,St),It}else St.uniforms=ze.getUniforms(j),j.onBuild(Se,St,v),j.onBeforeCompile(St,v),It=ze.acquireProgram(St,At),zt.set(At,It),de.uniforms=St.uniforms;const Dt=de.uniforms;(!j.isShaderMaterial&&!j.isRawShaderMaterial||j.clipping===!0)&&(Dt.clippingPlanes=B.uniform),Np(j,St),de.needsLights=jh(j),de.lightsStateVersion=gt,de.needsLights&&(Dt.ambientLightColor.value=Ae.state.ambient,Dt.lightProbe.value=Ae.state.probe,Dt.directionalLights.value=Ae.state.directional,Dt.directionalLightShadows.value=Ae.state.directionalShadow,Dt.spotLights.value=Ae.state.spot,Dt.spotLightShadows.value=Ae.state.spotShadow,Dt.rectAreaLights.value=Ae.state.rectArea,Dt.ltc_1.value=Ae.state.rectAreaLTC1,Dt.ltc_2.value=Ae.state.rectAreaLTC2,Dt.pointLights.value=Ae.state.point,Dt.pointLightShadows.value=Ae.state.pointShadow,Dt.hemisphereLights.value=Ae.state.hemi,Dt.directionalShadowMap.value=Ae.state.directionalShadowMap,Dt.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,Dt.spotShadowMap.value=Ae.state.spotShadowMap,Dt.spotLightMatrix.value=Ae.state.spotLightMatrix,Dt.spotLightMap.value=Ae.state.spotLightMap,Dt.pointShadowMap.value=Ae.state.pointShadowMap,Dt.pointShadowMatrix.value=Ae.state.pointShadowMatrix);const En=It.getUniforms(),Ii=w0.seqWithValue(En.seq,Dt);return de.currentProgram=It,de.uniformsList=Ii,It}function Np(j,pe){const Se=K.get(j);Se.outputEncoding=pe.outputEncoding,Se.instancing=pe.instancing,Se.skinning=pe.skinning,Se.morphTargets=pe.morphTargets,Se.morphNormals=pe.morphNormals,Se.morphColors=pe.morphColors,Se.morphTargetsCount=pe.morphTargetsCount,Se.numClippingPlanes=pe.numClippingPlanes,Se.numIntersection=pe.numClipIntersection,Se.vertexAlphas=pe.vertexAlphas,Se.vertexTangents=pe.vertexTangents,Se.toneMapping=pe.toneMapping}function _y(j,pe,Se,de,Ae){pe.isScene!==!0&&(pe=Y),Q.resetTextureUnits();const ct=pe.fog,gt=de.isMeshStandardMaterial?pe.environment:null,St=S===null?v.outputEncoding:S.isXRRenderTarget===!0?S.texture.encoding:ls,At=(de.isMeshStandardMaterial?ye:he).get(de.envMap||gt),zt=de.vertexColors===!0&&!!Se.attributes.color&&Se.attributes.color.itemSize===4,It=!!de.normalMap&&!!Se.attributes.tangent,Dt=!!Se.morphAttributes.position,En=!!Se.morphAttributes.normal,Ii=!!Se.morphAttributes.color,ds=de.toneMapped?v.toneMapping:Ps,yo=Se.morphAttributes.position||Se.morphAttributes.normal||Se.morphAttributes.color,fn=yo!==void 0?yo.length:0,bt=K.get(de),ml=h.state.lights;if(z===!0&&(V===!0||j!==T)){const Ht=j===T&&de.id===b;B.setState(de,j,Ht)}let An=!1;de.version===bt.__version?(bt.needsLights&&bt.lightsStateVersion!==ml.state.version||bt.outputEncoding!==St||Ae.isInstancedMesh&&bt.instancing===!1||!Ae.isInstancedMesh&&bt.instancing===!0||Ae.isSkinnedMesh&&bt.skinning===!1||!Ae.isSkinnedMesh&&bt.skinning===!0||bt.envMap!==At||de.fog===!0&&bt.fog!==ct||bt.numClippingPlanes!==void 0&&(bt.numClippingPlanes!==B.numPlanes||bt.numIntersection!==B.numIntersection)||bt.vertexAlphas!==zt||bt.vertexTangents!==It||bt.morphTargets!==Dt||bt.morphNormals!==En||bt.morphColors!==Ii||bt.toneMapping!==ds||ae.isWebGL2===!0&&bt.morphTargetsCount!==fn)&&(An=!0):(An=!0,bt.__version=de.version);let xo=bt.currentProgram;An===!0&&(xo=ji(de,pe,Ae));let Fu=!1,Pr=!1,Lr=!1;const wt=xo.getUniforms(),Nt=bt.uniforms;if(ue.useProgram(xo.program)&&(Fu=!0,Pr=!0,Lr=!0),de.id!==b&&(b=de.id,Pr=!0),Fu||T!==j){if(wt.setValue(W,"projectionMatrix",j.projectionMatrix),ae.logarithmicDepthBuffer&&wt.setValue(W,"logDepthBufFC",2/(Math.log(j.far+1)/Math.LN2)),T!==j&&(T=j,Pr=!0,Lr=!0),de.isShaderMaterial||de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshStandardMaterial||de.envMap){const Ht=wt.map.cameraPosition;Ht!==void 0&&Ht.setValue(W,q.setFromMatrixPosition(j.matrixWorld))}(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial)&&wt.setValue(W,"isOrthographic",j.isOrthographicCamera===!0),(de.isMeshPhongMaterial||de.isMeshToonMaterial||de.isMeshLambertMaterial||de.isMeshBasicMaterial||de.isMeshStandardMaterial||de.isShaderMaterial||de.isShadowMaterial||Ae.isSkinnedMesh)&&wt.setValue(W,"viewMatrix",j.matrixWorldInverse)}if(Ae.isSkinnedMesh){wt.setOptional(W,Ae,"bindMatrix"),wt.setOptional(W,Ae,"bindMatrixInverse");const Ht=Ae.skeleton;Ht&&(ae.floatVertexTextures?(Ht.boneTexture===null&&Ht.computeBoneTexture(),wt.setValue(W,"boneTexture",Ht.boneTexture,Q),wt.setValue(W,"boneTextureSize",Ht.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Ir=Se.morphAttributes;if((Ir.position!==void 0||Ir.normal!==void 0||Ir.color!==void 0&&ae.isWebGL2===!0)&&Oe.update(Ae,Se,de,xo),(Pr||bt.receiveShadow!==Ae.receiveShadow)&&(bt.receiveShadow=Ae.receiveShadow,wt.setValue(W,"receiveShadow",Ae.receiveShadow)),de.isMeshGouraudMaterial&&de.envMap!==null&&(Nt.envMap.value=At,Nt.flipEnvMap.value=At.isCubeTexture&&At.isRenderTargetTexture===!1?-1:1),Pr&&(wt.setValue(W,"toneMappingExposure",v.toneMappingExposure),bt.needsLights&&kp(Nt,Lr),ct&&de.fog===!0&&Ye.refreshFogUniforms(Nt,ct),Ye.refreshMaterialUniforms(Nt,de,O,P,U),w0.upload(W,bt.uniformsList,Nt,Q)),de.isShaderMaterial&&de.uniformsNeedUpdate===!0&&(w0.upload(W,bt.uniformsList,Nt,Q),de.uniformsNeedUpdate=!1),de.isSpriteMaterial&&wt.setValue(W,"center",Ae.center),wt.setValue(W,"modelViewMatrix",Ae.modelViewMatrix),wt.setValue(W,"normalMatrix",Ae.normalMatrix),wt.setValue(W,"modelMatrix",Ae.matrixWorld),de.isShaderMaterial||de.isRawShaderMaterial){const Ht=de.uniformsGroups;for(let ti=0,_o=Ht.length;ti<_o;ti++)if(ae.isWebGL2){const wo=Ht[ti];We.update(wo,xo),We.bind(wo,xo)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xo}function kp(j,pe){j.ambientLightColor.needsUpdate=pe,j.lightProbe.needsUpdate=pe,j.directionalLights.needsUpdate=pe,j.directionalLightShadows.needsUpdate=pe,j.pointLights.needsUpdate=pe,j.pointLightShadows.needsUpdate=pe,j.spotLights.needsUpdate=pe,j.spotLightShadows.needsUpdate=pe,j.rectAreaLights.needsUpdate=pe,j.hemisphereLights.needsUpdate=pe}function jh(j){return j.isMeshLambertMaterial||j.isMeshToonMaterial||j.isMeshPhongMaterial||j.isMeshStandardMaterial||j.isShadowMaterial||j.isShaderMaterial&&j.lights===!0}this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return S},this.setRenderTargetTextures=function(j,pe,Se){K.get(j.texture).__webglTexture=pe,K.get(j.depthTexture).__webglTexture=Se;const de=K.get(j);de.__hasExternalTextures=!0,de.__hasExternalTextures&&(de.__autoAllocateDepthBuffer=Se===void 0,de.__autoAllocateDepthBuffer||le.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),de.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(j,pe){const Se=K.get(j);Se.__webglFramebuffer=pe,Se.__useDefaultFramebuffer=pe===void 0},this.setRenderTarget=function(j,pe=0,Se=0){S=j,y=pe,_=Se;let de=!0,Ae=null,ct=!1,gt=!1;if(j){const At=K.get(j);At.__useDefaultFramebuffer!==void 0?(ue.bindFramebuffer(36160,null),de=!1):At.__webglFramebuffer===void 0?Q.setupRenderTarget(j):At.__hasExternalTextures&&Q.rebindTextures(j,K.get(j.texture).__webglTexture,K.get(j.depthTexture).__webglTexture);const zt=j.texture;(zt.isData3DTexture||zt.isDataArrayTexture||zt.isCompressedArrayTexture)&&(gt=!0);const It=K.get(j).__webglFramebuffer;j.isWebGLCubeRenderTarget?(Ae=It[pe],ct=!0):ae.isWebGL2&&j.samples>0&&Q.useMultisampledRTT(j)===!1?Ae=K.get(j).__webglMultisampledFramebuffer:Ae=It,E.copy(j.viewport),L.copy(j.scissor),A=j.scissorTest}else E.copy(G).multiplyScalar(O).floor(),L.copy(Z).multiplyScalar(O).floor(),A=ne;if(ue.bindFramebuffer(36160,Ae)&&ae.drawBuffers&&de&&ue.drawBuffers(j,Ae),ue.viewport(E),ue.scissor(L),ue.setScissorTest(A),ct){const At=K.get(j.texture);W.framebufferTexture2D(36160,36064,34069+pe,At.__webglTexture,Se)}else if(gt){const At=K.get(j.texture),zt=pe||0;W.framebufferTextureLayer(36160,36064,At.__webglTexture,Se||0,zt)}b=-1},this.readRenderTargetPixels=function(j,pe,Se,de,Ae,ct,gt){if(!(j&&j.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let St=K.get(j).__webglFramebuffer;if(j.isWebGLCubeRenderTarget&&gt!==void 0&&(St=St[gt]),St){ue.bindFramebuffer(36160,St);try{const At=j.texture,zt=At.format,It=At.type;if(zt!==Ji&&He.convert(zt)!==W.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Dt=It===yu&&(le.has("EXT_color_buffer_half_float")||ae.isWebGL2&&le.has("EXT_color_buffer_float"));if(It!==na&&He.convert(It)!==W.getParameter(35738)&&!(It===oo&&(ae.isWebGL2||le.has("OES_texture_float")||le.has("WEBGL_color_buffer_float")))&&!Dt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pe>=0&&pe<=j.width-de&&Se>=0&&Se<=j.height-Ae&&W.readPixels(pe,Se,de,Ae,He.convert(zt),He.convert(It),ct)}finally{const At=S!==null?K.get(S).__webglFramebuffer:null;ue.bindFramebuffer(36160,At)}}},this.copyFramebufferToTexture=function(j,pe,Se=0){const de=Math.pow(2,-Se),Ae=Math.floor(pe.image.width*de),ct=Math.floor(pe.image.height*de);Q.setTexture2D(pe,0),W.copyTexSubImage2D(3553,Se,0,0,j.x,j.y,Ae,ct),ue.unbindTexture()},this.copyTextureToTexture=function(j,pe,Se,de=0){const Ae=pe.image.width,ct=pe.image.height,gt=He.convert(Se.format),St=He.convert(Se.type);Q.setTexture2D(Se,0),W.pixelStorei(37440,Se.flipY),W.pixelStorei(37441,Se.premultiplyAlpha),W.pixelStorei(3317,Se.unpackAlignment),pe.isDataTexture?W.texSubImage2D(3553,de,j.x,j.y,Ae,ct,gt,St,pe.image.data):pe.isCompressedTexture?W.compressedTexSubImage2D(3553,de,j.x,j.y,pe.mipmaps[0].width,pe.mipmaps[0].height,gt,pe.mipmaps[0].data):W.texSubImage2D(3553,de,j.x,j.y,gt,St,pe.image),de===0&&Se.generateMipmaps&&W.generateMipmap(3553),ue.unbindTexture()},this.copyTextureToTexture3D=function(j,pe,Se,de,Ae=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ct=j.max.x-j.min.x+1,gt=j.max.y-j.min.y+1,St=j.max.z-j.min.z+1,At=He.convert(de.format),zt=He.convert(de.type);let It;if(de.isData3DTexture)Q.setTexture3D(de,0),It=32879;else if(de.isDataArrayTexture)Q.setTexture2DArray(de,0),It=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(37440,de.flipY),W.pixelStorei(37441,de.premultiplyAlpha),W.pixelStorei(3317,de.unpackAlignment);const Dt=W.getParameter(3314),En=W.getParameter(32878),Ii=W.getParameter(3316),ds=W.getParameter(3315),yo=W.getParameter(32877),fn=Se.isCompressedTexture?Se.mipmaps[0]:Se.image;W.pixelStorei(3314,fn.width),W.pixelStorei(32878,fn.height),W.pixelStorei(3316,j.min.x),W.pixelStorei(3315,j.min.y),W.pixelStorei(32877,j.min.z),Se.isDataTexture||Se.isData3DTexture?W.texSubImage3D(It,Ae,pe.x,pe.y,pe.z,ct,gt,St,At,zt,fn.data):Se.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),W.compressedTexSubImage3D(It,Ae,pe.x,pe.y,pe.z,ct,gt,St,At,fn.data)):W.texSubImage3D(It,Ae,pe.x,pe.y,pe.z,ct,gt,St,At,zt,fn),W.pixelStorei(3314,Dt),W.pixelStorei(32878,En),W.pixelStorei(3316,Ii),W.pixelStorei(3315,ds),W.pixelStorei(32877,yo),Ae===0&&de.generateMipmaps&&W.generateMipmap(It),ue.unbindTexture()},this.initTexture=function(j){j.isCubeTexture?Q.setTextureCube(j,0):j.isData3DTexture?Q.setTexture3D(j,0):j.isDataArrayTexture||j.isCompressedArrayTexture?Q.setTexture2DArray(j,0):Q.setTexture2D(j,0),ue.unbindTexture()},this.resetState=function(){y=0,_=0,S=null,ue.reset(),Me.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class cR extends qb{}cR.prototype.isWebGL1Renderer=!0;class Jv{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new Ge(e),this.density=n}clone(){return new Jv(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class yp{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new Ge(e),this.near=n,this.far=i}clone(){return new yp(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}let Yf=class extends Pt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}};class Kv{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=$f,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Sr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Sr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Oi=new R;class _u{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyMatrix4(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyNormalMatrix(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.transformDirection(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}setX(e,n){return this.normalized&&(n=en(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=en(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=en(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=en(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Ho(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Ho(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Ho(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Ho(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=en(n,this.array),i=en(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=en(n,this.array),i=en(i,this.array),r=en(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=en(n,this.array),i=en(i,this.array),r=en(r,this.array),s=en(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new pt(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _u(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Xb extends gi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let pc;const Ad=new R,mc=new R,gc=new R,vc=new te,Td=new te,hR=new Fe,fg=new R,Cd=new R,pg=new R,zA=new te,wx=new te,NA=new te;class dR extends Pt{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",pc===void 0){pc=new Ze;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Kv(n,5);pc.setIndex([0,1,2,0,2,3]),pc.setAttribute("position",new _u(i,3,0,!1)),pc.setAttribute("uv",new _u(i,2,3,!1))}this.geometry=pc,this.material=e!==void 0?e:new Xb,this.center=new te(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),mc.setFromMatrixScale(this.matrixWorld),hR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),gc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&mc.multiplyScalar(-gc.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;mg(fg.set(-.5,-.5,0),gc,o,mc,r,s),mg(Cd.set(.5,-.5,0),gc,o,mc,r,s),mg(pg.set(.5,.5,0),gc,o,mc,r,s),zA.set(0,0),wx.set(1,0),NA.set(1,1);let a=e.ray.intersectTriangle(fg,Cd,pg,!1,Ad);if(a===null&&(mg(Cd.set(-.5,.5,0),gc,o,mc,r,s),wx.set(0,1),a=e.ray.intersectTriangle(fg,pg,Cd,!1,Ad),a===null))return;const l=e.ray.origin.distanceTo(Ad);l<e.near||l>e.far||n.push({distance:l,point:Ad.clone(),uv:Ui.getUV(Ad,fg,Cd,pg,zA,wx,NA,new te),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function mg(t,e,n,i,r,s){vc.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(Td.x=s*vc.x-r*vc.y,Td.y=r*vc.x+s*vc.y):Td.copy(vc),t.copy(e),t.x+=Td.x,t.y+=Td.y,t.applyMatrix4(hR)}const gg=new R,kA=new R;class fR extends Pt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){gg.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(gg);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){gg.setFromMatrixPosition(e.matrixWorld),kA.setFromMatrixPosition(this.matrixWorld);const i=gg.distanceTo(kA)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const BA=new R,UA=new _t,FA=new _t,iG=new R,VA=new Fe;class pR extends li{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Fe,this.bindMatrixInverse=new Fe}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new _t,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,n){const i=this.skeleton,r=this.geometry;UA.fromBufferAttribute(r.attributes.skinIndex,e),FA.fromBufferAttribute(r.attributes.skinWeight,e),BA.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=FA.getComponent(s);if(o!==0){const a=UA.getComponent(s);VA.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(iG.copy(BA).applyMatrix4(VA),o)}}return n.applyMatrix4(this.bindMatrixInverse)}}class Yb extends Pt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Jc extends gn{constructor(e=null,n=1,i=1,r,s,o,a,l,u=Nn,d=Nn,c,h){super(null,o,a,l,u,d,r,s,c,h),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const GA=new Fe,rG=new Fe;class Qv{constructor(e=[],n=[]){this.uuid=Sr(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Fe)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Fe;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:rG;GA.multiplyMatrices(a,n[s]),GA.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new Qv(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=ZD(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new Jc(n,e,e,Ji,oo);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=n[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Yb),this.bones.push(o),this.boneInverses.push(new Fe().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class gh extends pt{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const HA=new Fe,WA=new Fe,vg=[],sG=new Fe,Pd=new li;class mR extends li{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new gh(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,sG)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const i=this.matrixWorld,r=this.count;if(Pd.geometry=this.geometry,Pd.material=this.material,Pd.material!==void 0)for(let s=0;s<r;s++){this.getMatrixAt(s,HA),WA.multiplyMatrices(i,HA),Pd.matrixWorld=WA,Pd.raycast(e,vg);for(let o=0,a=vg.length;o<a;o++){const l=vg[o];l.instanceId=s,l.object=this,n.push(l)}vg.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new gh(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Li extends gi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ge(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const jA=new R,$A=new R,qA=new Fe,Sx=new hl,yg=new Mr;class il extends Pt{constructor(e=new Ze,n=new Li){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)jA.fromBufferAttribute(n,r-1),$A.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=jA.distanceTo($A);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),yg.copy(i.boundingSphere),yg.applyMatrix4(r),yg.radius+=s,e.ray.intersectsSphere(yg)===!1)return;qA.copy(r).invert(),Sx.copy(e.ray).applyMatrix4(qA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=new R,d=new R,c=new R,h=new R,m=this.isLineSegments?2:1,g=i.index,x=i.attributes.position;if(g!==null){const y=Math.max(0,o.start),_=Math.min(g.count,o.start+o.count);for(let S=y,b=_-1;S<b;S+=m){const T=g.getX(S),E=g.getX(S+1);if(u.fromBufferAttribute(x,T),d.fromBufferAttribute(x,E),Sx.distanceSqToSegment(u,d,h,c)>l)continue;h.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(h);A<e.near||A>e.far||n.push({distance:A,point:c.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,o.start),_=Math.min(x.count,o.start+o.count);for(let S=y,b=_-1;S<b;S+=m){if(u.fromBufferAttribute(x,S),d.fromBufferAttribute(x,S+1),Sx.distanceSqToSegment(u,d,h,c)>l)continue;h.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(h);E<e.near||E>e.far||n.push({distance:E,point:c.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const XA=new R,YA=new R;class ks extends il{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)XA.fromBufferAttribute(n,r),YA.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+XA.distanceTo(YA);e.setAttribute("lineDistance",new De(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gR extends il{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class Zb extends gi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const ZA=new Fe,Gw=new hl,xg=new Mr,_g=new R;class vR extends Pt{constructor(e=new Ze,n=new Zb){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),xg.copy(i.boundingSphere),xg.applyMatrix4(r),xg.radius+=s,e.ray.intersectsSphere(xg)===!1)return;ZA.copy(r).invert(),Gw.copy(e.ray).applyMatrix4(ZA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,u=i.index,c=i.attributes.position;if(u!==null){const h=Math.max(0,o.start),m=Math.min(u.count,o.start+o.count);for(let g=h,v=m;g<v;g++){const x=u.getX(g);_g.fromBufferAttribute(c,x),JA(_g,x,l,r,e,n,this)}}else{const h=Math.max(0,o.start),m=Math.min(c.count,o.start+o.count);for(let g=h,v=m;g<v;g++)_g.fromBufferAttribute(c,g),JA(_g,g,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function JA(t,e,n,i,r,s,o){const a=Gw.distanceSqToPoint(t);if(a<n){const l=new R;Gw.closestPointToPoint(t,l),l.applyMatrix4(i);const u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;s.push({distance:u,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class yR extends gn{constructor(e,n,i,r,s,o,a,l,u){super(e,n,i,r,s,o,a,l,u),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:xn,this.magFilter=s!==void 0?s:xn,this.generateMipmaps=!1;const d=this;function c(){d.needsUpdate=!0,e.requestVideoFrameCallback(c)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(c)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class oG extends gn{constructor(e,n,i){super({width:e,height:n}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=Nn,this.minFilter=Nn,this.generateMipmaps=!1,this.needsUpdate=!0}}class Jb extends gn{constructor(e,n,i,r,s,o,a,l,u,d,c,h){super(null,o,a,l,u,d,r,s,c,h),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class aG extends Jb{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Ai}}class lG extends gn{constructor(e,n,i,r,s,o,a,l,u){super(e,n,i,r,s,o,a,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Bs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const s=i.length;let o;n?o=n:o=e*i[s-1];let a=0,l=s-1,u;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),u=i[r]-o,u<0)a=r+1;else if(u>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const d=i[r],h=i[r+1]-d,m=(o-d)/h;return(r+m)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new te:new R);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new R,r=[],s=[],o=[],a=new R,l=new Fe;for(let m=0;m<=e;m++){const g=m/e;r[m]=this.getTangentAt(g,new R)}s[0]=new R,o[0]=new R;let u=Number.MAX_VALUE;const d=Math.abs(r[0].x),c=Math.abs(r[0].y),h=Math.abs(r[0].z);d<=u&&(u=d,i.set(1,0,0)),c<=u&&(u=c,i.set(0,1,0)),h<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),a.crossVectors(r[m-1],r[m]),a.length()>Number.EPSILON){a.normalize();const g=Math.acos(Bn(r[m-1].dot(r[m]),-1,1));s[m].applyMatrix4(l.makeRotationAxis(a,g))}o[m].crossVectors(r[m],s[m])}if(n===!0){let m=Math.acos(Bn(s[0].dot(s[e]),-1,1));m/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(m=-m);for(let g=1;g<=e;g++)s[g].applyMatrix4(l.makeRotationAxis(r[g],m*g)),o[g].crossVectors(r[g],s[g])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class xp extends Bs{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n){const i=n||new te,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),u=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=l-this.aX,m=u-this.aY;l=h*d-m*c+this.aX,u=h*c+m*d+this.aY}return i.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class xR extends xp{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Kb(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,u){r(o,a,u*(a-s),u*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,u,d,c){let h=(o-s)/u-(a-s)/(u+d)+(a-o)/d,m=(a-o)/d-(l-o)/(d+c)+(l-a)/c;h*=d,m*=d,r(o,a,h,m)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const wg=new R,bx=new Kb,Mx=new Kb,Ex=new Kb;class _R extends Bs{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new R){const i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let u,d;this.closed||a>0?u=r[(a-1)%s]:(wg.subVectors(r[0],r[1]).add(r[0]),u=wg);const c=r[a%s],h=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(wg.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=wg),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let g=Math.pow(u.distanceToSquared(c),m),v=Math.pow(c.distanceToSquared(h),m),x=Math.pow(h.distanceToSquared(d),m);v<1e-4&&(v=1),g<1e-4&&(g=v),x<1e-4&&(x=v),bx.initNonuniformCatmullRom(u.x,c.x,h.x,d.x,g,v,x),Mx.initNonuniformCatmullRom(u.y,c.y,h.y,d.y,g,v,x),Ex.initNonuniformCatmullRom(u.z,c.z,h.z,d.z,g,v,x)}else this.curveType==="catmullrom"&&(bx.initCatmullRom(u.x,c.x,h.x,d.x,this.tension),Mx.initCatmullRom(u.y,c.y,h.y,d.y,this.tension),Ex.initCatmullRom(u.z,c.z,h.z,d.z,this.tension));return i.set(bx.calc(l),Mx.calc(l),Ex.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new R().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function KA(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function uG(t,e){const n=1-t;return n*n*e}function cG(t,e){return 2*(1-t)*t*e}function hG(t,e){return t*t*e}function pf(t,e,n,i){return uG(t,e)+cG(t,n)+hG(t,i)}function dG(t,e){const n=1-t;return n*n*n*e}function fG(t,e){const n=1-t;return 3*n*n*t*e}function pG(t,e){return 3*(1-t)*t*t*e}function mG(t,e){return t*t*t*e}function mf(t,e,n,i,r){return dG(t,e)+fG(t,n)+pG(t,i)+mG(t,r)}class ns extends Bs{constructor(e=new te,n=new te,i=new te,r=new te){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new te){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(mf(e,r.x,s.x,o.x,a.x),mf(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class gf extends Bs{constructor(e=new R,n=new R,i=new R,r=new R){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new R){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(mf(e,r.x,s.x,o.x,a.x),mf(e,r.y,s.y,o.y,a.y),mf(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rs extends Bs{constructor(e=new te,n=new te){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new te){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n){const i=n||new te;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Qb extends Bs{constructor(e=new R,n=new R){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new R){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ra extends Bs{constructor(e=new te,n=new te,i=new te){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new te){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(pf(e,r.x,s.x,o.x),pf(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class eM extends Bs{constructor(e=new R,n=new R,i=new R){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new R){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(pf(e,r.x,s.x,o.x),pf(e,r.y,s.y,o.y),pf(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ey extends Bs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new te){const i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],u=r[o],d=r[o>r.length-2?r.length-1:o+1],c=r[o>r.length-3?r.length-1:o+2];return i.set(KA(a,l.x,u.x,d.x,c.x),KA(a,l.y,u.y,d.y,c.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new te().fromArray(r))}return this}}var tM=Object.freeze({__proto__:null,ArcCurve:xR,CatmullRomCurve3:_R,CubicBezierCurve:ns,CubicBezierCurve3:gf,EllipseCurve:xp,LineCurve:rs,LineCurve3:Qb,QuadraticBezierCurve:ra,QuadraticBezierCurve3:eM,SplineCurve:ey});class nM extends Bs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new rs(n,e))}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),u=l===0?0:1-o/l;return a.getPointAt(u,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let u=0;u<l.length;u++){const d=l[u];i&&i.equals(d)||(n.push(d),i=d)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new tM[r.type]().fromJSON(r))}return this}}class wu extends nM{constructor(e){super(),this.type="Path",this.currentPoint=new te,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new rs(this.currentPoint.clone(),new te(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new ra(this.currentPoint.clone(),new te(e,n),new te(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){const a=new ns(this.currentPoint.clone(),new te(e,n),new te(i,r),new te(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new ey(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){const u=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+u,n+d,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){const u=new xp(e,n,i,r,s,o,a,l);if(this.curves.length>0){const c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);const d=u.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Iu extends Ze{constructor(e=[new te(0,-.5),new te(.5,0),new te(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Bn(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],u=[],d=1/n,c=new R,h=new te,m=new R,g=new R,v=new R;let x=0,y=0;for(let _=0;_<=e.length-1;_++)switch(_){case 0:x=e[_+1].x-e[_].x,y=e[_+1].y-e[_].y,m.x=y*1,m.y=-x,m.z=y*0,v.copy(m),m.normalize(),l.push(m.x,m.y,m.z);break;case e.length-1:l.push(v.x,v.y,v.z);break;default:x=e[_+1].x-e[_].x,y=e[_+1].y-e[_].y,m.x=y*1,m.y=-x,m.z=y*0,g.copy(m),m.x+=v.x,m.y+=v.y,m.z+=v.z,m.normalize(),l.push(m.x,m.y,m.z),v.copy(g)}for(let _=0;_<=n;_++){const S=i+_*d*r,b=Math.sin(S),T=Math.cos(S);for(let E=0;E<=e.length-1;E++){c.x=e[E].x*b,c.y=e[E].y,c.z=e[E].x*T,o.push(c.x,c.y,c.z),h.x=_/n,h.y=E/(e.length-1),a.push(h.x,h.y);const L=l[3*E+0]*b,A=l[3*E+1],I=l[3*E+0]*T;u.push(L,A,I)}}for(let _=0;_<n;_++)for(let S=0;S<e.length-1;S++){const b=S+_*e.length,T=b,E=b+e.length,L=b+e.length+1,A=b+1;s.push(T,E,A),s.push(L,A,E)}this.setIndex(s),this.setAttribute("position",new De(o,3)),this.setAttribute("uv",new De(a,2)),this.setAttribute("normal",new De(u,3))}static fromJSON(e){return new Iu(e.points,e.segments,e.phiStart,e.phiLength)}}class _p extends Iu{constructor(e=1,n=1,i=4,r=8){const s=new wu;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r}}static fromJSON(e){return new _p(e.radius,e.length,e.capSegments,e.radialSegments)}}class wp extends Ze{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],o=[],a=[],l=[],u=new R,d=new te;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let c=0,h=3;c<=n;c++,h+=3){const m=i+c/n*r;u.x=e*Math.cos(m),u.y=e*Math.sin(m),o.push(u.x,u.y,u.z),a.push(0,0,1),d.x=(o[h]/e+1)/2,d.y=(o[h+1]/e+1)/2,l.push(d.x,d.y)}for(let c=1;c<=n;c++)s.push(c,c+1,0);this.setIndex(s),this.setAttribute("position",new De(o,3)),this.setAttribute("normal",new De(a,3)),this.setAttribute("uv",new De(l,2))}static fromJSON(e){return new wp(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class fl extends Ze{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const u=this;r=Math.floor(r),s=Math.floor(s);const d=[],c=[],h=[],m=[];let g=0;const v=[],x=i/2;let y=0;_(),o===!1&&(e>0&&S(!0),n>0&&S(!1)),this.setIndex(d),this.setAttribute("position",new De(c,3)),this.setAttribute("normal",new De(h,3)),this.setAttribute("uv",new De(m,2));function _(){const b=new R,T=new R;let E=0;const L=(n-e)/i;for(let A=0;A<=s;A++){const I=[],P=A/s,O=P*(n-e)+e;for(let k=0;k<=r;k++){const F=k/r,G=F*l+a,Z=Math.sin(G),ne=Math.cos(G);T.x=O*Z,T.y=-P*i+x,T.z=O*ne,c.push(T.x,T.y,T.z),b.set(Z,L,ne).normalize(),h.push(b.x,b.y,b.z),m.push(F,1-P),I.push(g++)}v.push(I)}for(let A=0;A<r;A++)for(let I=0;I<s;I++){const P=v[I][A],O=v[I+1][A],k=v[I+1][A+1],F=v[I][A+1];d.push(P,O,F),d.push(O,k,F),E+=6}u.addGroup(y,E,0),y+=E}function S(b){const T=g,E=new te,L=new R;let A=0;const I=b===!0?e:n,P=b===!0?1:-1;for(let k=1;k<=r;k++)c.push(0,x*P,0),h.push(0,P,0),m.push(.5,.5),g++;const O=g;for(let k=0;k<=r;k++){const G=k/r*l+a,Z=Math.cos(G),ne=Math.sin(G);L.x=I*ne,L.y=x*P,L.z=I*Z,c.push(L.x,L.y,L.z),h.push(0,P,0),E.x=Z*.5+.5,E.y=ne*.5*P+.5,m.push(E.x,E.y),g++}for(let k=0;k<r;k++){const F=T+k,G=O+k;b===!0?d.push(G,G+1,F):d.push(G+1,G,F),A+=3}u.addGroup(y,A,b===!0?1:2),y+=A}}static fromJSON(e){return new fl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Dh extends fl{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new Dh(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class aa extends Ze{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],o=[];a(r),u(i),d(),this.setAttribute("position",new De(s,3)),this.setAttribute("normal",new De(s.slice(),3)),this.setAttribute("uv",new De(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(_){const S=new R,b=new R,T=new R;for(let E=0;E<n.length;E+=3)m(n[E+0],S),m(n[E+1],b),m(n[E+2],T),l(S,b,T,_)}function l(_,S,b,T){const E=T+1,L=[];for(let A=0;A<=E;A++){L[A]=[];const I=_.clone().lerp(b,A/E),P=S.clone().lerp(b,A/E),O=E-A;for(let k=0;k<=O;k++)k===0&&A===E?L[A][k]=I:L[A][k]=I.clone().lerp(P,k/O)}for(let A=0;A<E;A++)for(let I=0;I<2*(E-A)-1;I++){const P=Math.floor(I/2);I%2===0?(h(L[A][P+1]),h(L[A+1][P]),h(L[A][P])):(h(L[A][P+1]),h(L[A+1][P+1]),h(L[A+1][P]))}}function u(_){const S=new R;for(let b=0;b<s.length;b+=3)S.x=s[b+0],S.y=s[b+1],S.z=s[b+2],S.normalize().multiplyScalar(_),s[b+0]=S.x,s[b+1]=S.y,s[b+2]=S.z}function d(){const _=new R;for(let S=0;S<s.length;S+=3){_.x=s[S+0],_.y=s[S+1],_.z=s[S+2];const b=x(_)/2/Math.PI+.5,T=y(_)/Math.PI+.5;o.push(b,1-T)}g(),c()}function c(){for(let _=0;_<o.length;_+=6){const S=o[_+0],b=o[_+2],T=o[_+4],E=Math.max(S,b,T),L=Math.min(S,b,T);E>.9&&L<.1&&(S<.2&&(o[_+0]+=1),b<.2&&(o[_+2]+=1),T<.2&&(o[_+4]+=1))}}function h(_){s.push(_.x,_.y,_.z)}function m(_,S){const b=_*3;S.x=e[b+0],S.y=e[b+1],S.z=e[b+2]}function g(){const _=new R,S=new R,b=new R,T=new R,E=new te,L=new te,A=new te;for(let I=0,P=0;I<s.length;I+=9,P+=6){_.set(s[I+0],s[I+1],s[I+2]),S.set(s[I+3],s[I+4],s[I+5]),b.set(s[I+6],s[I+7],s[I+8]),E.set(o[P+0],o[P+1]),L.set(o[P+2],o[P+3]),A.set(o[P+4],o[P+5]),T.copy(_).add(S).add(b).divideScalar(3);const O=x(T);v(E,P+0,_,O),v(L,P+2,S,O),v(A,P+4,b,O)}}function v(_,S,b,T){T<0&&_.x===1&&(o[S]=_.x-1),b.x===0&&b.z===0&&(o[S]=T/2/Math.PI+.5)}function x(_){return Math.atan2(_.z,-_.x)}function y(_){return Math.atan2(-_.y,Math.sqrt(_.x*_.x+_.z*_.z))}}static fromJSON(e){return new aa(e.vertices,e.indices,e.radius,e.details)}}class Rh extends aa{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Rh(e.radius,e.detail)}}const Sg=new R,bg=new R,Ax=new R,Mg=new Ui;class wR extends Ze{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(au*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,u=[0,0,0],d=["a","b","c"],c=new Array(3),h={},m=[];for(let g=0;g<l;g+=3){o?(u[0]=o.getX(g),u[1]=o.getX(g+1),u[2]=o.getX(g+2)):(u[0]=g,u[1]=g+1,u[2]=g+2);const{a:v,b:x,c:y}=Mg;if(v.fromBufferAttribute(a,u[0]),x.fromBufferAttribute(a,u[1]),y.fromBufferAttribute(a,u[2]),Mg.getNormal(Ax),c[0]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,c[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,c[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let _=0;_<3;_++){const S=(_+1)%3,b=c[_],T=c[S],E=Mg[d[_]],L=Mg[d[S]],A=`${b}_${T}`,I=`${T}_${b}`;I in h&&h[I]?(Ax.dot(h[I].normal)<=s&&(m.push(E.x,E.y,E.z),m.push(L.x,L.y,L.z)),h[I]=null):A in h||(h[A]={index0:u[_],index1:u[S],normal:Ax.clone()})}}for(const g in h)if(h[g]){const{index0:v,index1:x}=h[g];Sg.fromBufferAttribute(a,v),bg.fromBufferAttribute(a,x),m.push(Sg.x,Sg.y,Sg.z),m.push(bg.x,bg.y,bg.z)}this.setAttribute("position",new De(m,3))}}}class Ls extends wu{constructor(e){super(e),this.uuid=Sr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new wu().fromJSON(r))}return this}}const gG={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=SR(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,u,d,c,h,m;if(i&&(s=wG(t,e,s,n)),t.length>80*n){a=u=t[0],l=d=t[1];for(let g=n;g<r;g+=n)c=t[g],h=t[g+1],c<a&&(a=c),h<l&&(l=h),c>u&&(u=c),h>d&&(d=h);m=Math.max(u-a,d-l),m=m!==0?32767/m:0}return Zf(s,o,n,a,l,m,0),o}};function SR(t,e,n,i,r){let s,o;if(r===DG(t,e,n,i)>0)for(s=e;s<n;s+=i)o=QA(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=QA(s,t[s],t[s+1],o);return o&&ty(o,o.next)&&(Kf(o),o=o.next),o}function Su(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(ty(n,n.next)||_n(n.prev,n,n.next)===0)){if(Kf(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Zf(t,e,n,i,r,s,o){if(!t)return;!o&&s&&AG(t,i,r,s);let a=t,l,u;for(;t.prev!==t.next;){if(l=t.prev,u=t.next,s?yG(t,i,r,s):vG(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),Kf(t),t=u.next,a=u.next;continue}if(t=u,t===a){o?o===1?(t=xG(Su(t),e,n),Zf(t,e,n,i,r,s,2)):o===2&&_G(t,e,n,i,r,s):Zf(Su(t),e,n,i,r,s,1);break}}}function vG(t){const e=t.prev,n=t,i=t.next;if(_n(e,n,i)>=0)return!1;const r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,u=i.y,d=r<s?r<o?r:o:s<o?s:o,c=a<l?a<u?a:u:l<u?l:u,h=r>s?r>o?r:o:s>o?s:o,m=a>l?a>u?a:u:l>u?l:u;let g=i.next;for(;g!==e;){if(g.x>=d&&g.x<=h&&g.y>=c&&g.y<=m&&Vc(r,a,s,l,o,u,g.x,g.y)&&_n(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function yG(t,e,n,i){const r=t.prev,s=t,o=t.next;if(_n(r,s,o)>=0)return!1;const a=r.x,l=s.x,u=o.x,d=r.y,c=s.y,h=o.y,m=a<l?a<u?a:u:l<u?l:u,g=d<c?d<h?d:h:c<h?c:h,v=a>l?a>u?a:u:l>u?l:u,x=d>c?d>h?d:h:c>h?c:h,y=Hw(m,g,e,n,i),_=Hw(v,x,e,n,i);let S=t.prevZ,b=t.nextZ;for(;S&&S.z>=y&&b&&b.z<=_;){if(S.x>=m&&S.x<=v&&S.y>=g&&S.y<=x&&S!==r&&S!==o&&Vc(a,d,l,c,u,h,S.x,S.y)&&_n(S.prev,S,S.next)>=0||(S=S.prevZ,b.x>=m&&b.x<=v&&b.y>=g&&b.y<=x&&b!==r&&b!==o&&Vc(a,d,l,c,u,h,b.x,b.y)&&_n(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;S&&S.z>=y;){if(S.x>=m&&S.x<=v&&S.y>=g&&S.y<=x&&S!==r&&S!==o&&Vc(a,d,l,c,u,h,S.x,S.y)&&_n(S.prev,S,S.next)>=0)return!1;S=S.prevZ}for(;b&&b.z<=_;){if(b.x>=m&&b.x<=v&&b.y>=g&&b.y<=x&&b!==r&&b!==o&&Vc(a,d,l,c,u,h,b.x,b.y)&&_n(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function xG(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!ty(r,s)&&bR(r,i,i.next,s)&&Jf(r,s)&&Jf(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),Kf(i),Kf(i.next),i=t=s),i=i.next}while(i!==t);return Su(i)}function _G(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&PG(o,a)){let l=MR(o,a);o=Su(o,o.next),l=Su(l,l.next),Zf(o,e,n,i,r,s,0),Zf(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function wG(t,e,n,i){const r=[];let s,o,a,l,u;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,u=SR(t,a,l,i,!1),u===u.next&&(u.steiner=!0),r.push(CG(u));for(r.sort(SG),s=0;s<r.length;s++)n=bG(r[s],n);return n}function SG(t,e){return t.x-e.x}function bG(t,e){const n=MG(t,e);if(!n)return e;const i=MR(n,t);return Su(i,i.next),Su(n,n.next)}function MG(t,e){let n=e,i=-1/0,r;const s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const h=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=s&&h>i&&(i=h,r=n.x<n.next.x?n:n.next,h===s))return r}n=n.next}while(n!==e);if(!r)return null;const a=r,l=r.x,u=r.y;let d=1/0,c;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&Vc(o<u?s:i,o,l,u,o<u?i:s,o,n.x,n.y)&&(c=Math.abs(o-n.y)/(s-n.x),Jf(n,t)&&(c<d||c===d&&(n.x>r.x||n.x===r.x&&EG(r,n)))&&(r=n,d=c)),n=n.next;while(n!==a);return r}function EG(t,e){return _n(t.prev,t,e.prev)<0&&_n(e.next,t,t.next)<0}function AG(t,e,n,i){let r=t;do r.z===0&&(r.z=Hw(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,TG(r)}function TG(t){let e,n,i,r,s,o,a,l,u=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ,!!i);e++);for(l=u;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1);return t}function Hw(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function CG(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Vc(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function PG(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!LG(t,e)&&(Jf(t,e)&&Jf(e,t)&&IG(t,e)&&(_n(t.prev,t,e.prev)||_n(t,e.prev,e))||ty(t,e)&&_n(t.prev,t,t.next)>0&&_n(e.prev,e,e.next)>0)}function _n(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ty(t,e){return t.x===e.x&&t.y===e.y}function bR(t,e,n,i){const r=Ag(_n(t,e,n)),s=Ag(_n(t,e,i)),o=Ag(_n(n,i,t)),a=Ag(_n(n,i,e));return!!(r!==s&&o!==a||r===0&&Eg(t,n,e)||s===0&&Eg(t,i,e)||o===0&&Eg(n,t,i)||a===0&&Eg(n,e,i))}function Eg(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ag(t){return t>0?1:t<0?-1:0}function LG(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&bR(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Jf(t,e){return _n(t.prev,t,t.next)<0?_n(t,e,t.next)>=0&&_n(t,t.prev,e)>=0:_n(t,e,t.prev)<0||_n(t,t.next,e)<0}function IG(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function MR(t,e){const n=new Ww(t.i,t.x,t.y),i=new Ww(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function QA(t,e,n,i){const r=new Ww(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Kf(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ww(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function DG(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class Is{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Is.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];eT(e),tT(i,e);let o=e.length;n.forEach(eT);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,tT(i,n[l]);const a=gG.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function eT(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function tT(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Sp extends Ze{constructor(e=new Ls([new te(.5,.5),new te(-.5,.5),new te(-.5,-.5),new te(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const u=e[a];o(u)}this.setAttribute("position",new De(r,3)),this.setAttribute("uv",new De(s,2)),this.computeVertexNormals();function o(a){const l=[],u=n.curveSegments!==void 0?n.curveSegments:12,d=n.steps!==void 0?n.steps:1,c=n.depth!==void 0?n.depth:1;let h=n.bevelEnabled!==void 0?n.bevelEnabled:!0,m=n.bevelThickness!==void 0?n.bevelThickness:.2,g=n.bevelSize!==void 0?n.bevelSize:m-.1,v=n.bevelOffset!==void 0?n.bevelOffset:0,x=n.bevelSegments!==void 0?n.bevelSegments:3;const y=n.extrudePath,_=n.UVGenerator!==void 0?n.UVGenerator:RG;let S,b=!1,T,E,L,A;y&&(S=y.getSpacedPoints(d),b=!0,h=!1,T=y.computeFrenetFrames(d,!1),E=new R,L=new R,A=new R),h||(x=0,m=0,g=0,v=0);const I=a.extractPoints(u);let P=I.shape;const O=I.holes;if(!Is.isClockWise(P)){P=P.reverse();for(let K=0,Q=O.length;K<Q;K++){const he=O[K];Is.isClockWise(he)&&(O[K]=he.reverse())}}const F=Is.triangulateShape(P,O),G=P;for(let K=0,Q=O.length;K<Q;K++){const he=O[K];P=P.concat(he)}function Z(K,Q,he){return Q||console.error("THREE.ExtrudeGeometry: vec does not exist"),Q.clone().multiplyScalar(he).add(K)}const ne=P.length,J=F.length;function z(K,Q,he){let ye,be,Te;const Le=K.x-Q.x,ze=K.y-Q.y,Ye=he.x-K.x,nt=he.y-K.y,H=Le*Le+ze*ze,B=Le*nt-ze*Ye;if(Math.abs(B)>Number.EPSILON){const ge=Math.sqrt(H),Pe=Math.sqrt(Ye*Ye+nt*nt),Oe=Q.x-ze/ge,Be=Q.y+Le/ge,ht=he.x-nt/Pe,He=he.y+Ye/Pe,Me=((ht-Oe)*nt-(He-Be)*Ye)/(Le*nt-ze*Ye);ye=Oe+Le*Me-K.x,be=Be+ze*Me-K.y;const We=ye*ye+be*be;if(We<=2)return new te(ye,be);Te=Math.sqrt(We/2)}else{let ge=!1;Le>Number.EPSILON?Ye>Number.EPSILON&&(ge=!0):Le<-Number.EPSILON?Ye<-Number.EPSILON&&(ge=!0):Math.sign(ze)===Math.sign(nt)&&(ge=!0),ge?(ye=-ze,be=Le,Te=Math.sqrt(H)):(ye=Le,be=ze,Te=Math.sqrt(H/2))}return new te(ye/Te,be/Te)}const V=[];for(let K=0,Q=G.length,he=Q-1,ye=K+1;K<Q;K++,he++,ye++)he===Q&&(he=0),ye===Q&&(ye=0),V[K]=z(G[K],G[he],G[ye]);const U=[];let X,N=V.concat();for(let K=0,Q=O.length;K<Q;K++){const he=O[K];X=[];for(let ye=0,be=he.length,Te=be-1,Le=ye+1;ye<be;ye++,Te++,Le++)Te===be&&(Te=0),Le===be&&(Le=0),X[ye]=z(he[ye],he[Te],he[Le]);U.push(X),N=N.concat(X)}for(let K=0;K<x;K++){const Q=K/x,he=m*Math.cos(Q*Math.PI/2),ye=g*Math.sin(Q*Math.PI/2)+v;for(let be=0,Te=G.length;be<Te;be++){const Le=Z(G[be],V[be],ye);se(Le.x,Le.y,-he)}for(let be=0,Te=O.length;be<Te;be++){const Le=O[be];X=U[be];for(let ze=0,Ye=Le.length;ze<Ye;ze++){const nt=Z(Le[ze],X[ze],ye);se(nt.x,nt.y,-he)}}}const q=g+v;for(let K=0;K<ne;K++){const Q=h?Z(P[K],N[K],q):P[K];b?(L.copy(T.normals[0]).multiplyScalar(Q.x),E.copy(T.binormals[0]).multiplyScalar(Q.y),A.copy(S[0]).add(L).add(E),se(A.x,A.y,A.z)):se(Q.x,Q.y,0)}for(let K=1;K<=d;K++)for(let Q=0;Q<ne;Q++){const he=h?Z(P[Q],N[Q],q):P[Q];b?(L.copy(T.normals[K]).multiplyScalar(he.x),E.copy(T.binormals[K]).multiplyScalar(he.y),A.copy(S[K]).add(L).add(E),se(A.x,A.y,A.z)):se(he.x,he.y,c/d*K)}for(let K=x-1;K>=0;K--){const Q=K/x,he=m*Math.cos(Q*Math.PI/2),ye=g*Math.sin(Q*Math.PI/2)+v;for(let be=0,Te=G.length;be<Te;be++){const Le=Z(G[be],V[be],ye);se(Le.x,Le.y,c+he)}for(let be=0,Te=O.length;be<Te;be++){const Le=O[be];X=U[be];for(let ze=0,Ye=Le.length;ze<Ye;ze++){const nt=Z(Le[ze],X[ze],ye);b?se(nt.x,nt.y+S[d-1].y,S[d-1].x+he):se(nt.x,nt.y,c+he)}}}Y(),ee();function Y(){const K=r.length/3;if(h){let Q=0,he=ne*Q;for(let ye=0;ye<J;ye++){const be=F[ye];le(be[2]+he,be[1]+he,be[0]+he)}Q=d+x*2,he=ne*Q;for(let ye=0;ye<J;ye++){const be=F[ye];le(be[0]+he,be[1]+he,be[2]+he)}}else{for(let Q=0;Q<J;Q++){const he=F[Q];le(he[2],he[1],he[0])}for(let Q=0;Q<J;Q++){const he=F[Q];le(he[0]+ne*d,he[1]+ne*d,he[2]+ne*d)}}i.addGroup(K,r.length/3-K,0)}function ee(){const K=r.length/3;let Q=0;W(G,Q),Q+=G.length;for(let he=0,ye=O.length;he<ye;he++){const be=O[he];W(be,Q),Q+=be.length}i.addGroup(K,r.length/3-K,1)}function W(K,Q){let he=K.length;for(;--he>=0;){const ye=he;let be=he-1;be<0&&(be=K.length-1);for(let Te=0,Le=d+x*2;Te<Le;Te++){const ze=ne*Te,Ye=ne*(Te+1),nt=Q+ye+ze,H=Q+be+ze,B=Q+be+Ye,ge=Q+ye+Ye;ae(nt,H,B,ge)}}}function se(K,Q,he){l.push(K),l.push(Q),l.push(he)}function le(K,Q,he){ue(K),ue(Q),ue(he);const ye=r.length/3,be=_.generateTopUV(i,r,ye-3,ye-2,ye-1);fe(be[0]),fe(be[1]),fe(be[2])}function ae(K,Q,he,ye){ue(K),ue(Q),ue(ye),ue(Q),ue(he),ue(ye);const be=r.length/3,Te=_.generateSideWallUV(i,r,be-6,be-3,be-2,be-1);fe(Te[0]),fe(Te[1]),fe(Te[3]),fe(Te[1]),fe(Te[2]),fe(Te[3])}function ue(K){r.push(l[K*3+0]),r.push(l[K*3+1]),r.push(l[K*3+2])}function fe(K){s.push(K.x),s.push(K.y)}}}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return OG(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new tM[r.type]().fromJSON(r)),new Sp(i,e.options)}}const RG={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],u=e[r*3],d=e[r*3+1];return[new te(s,o),new te(a,l),new te(u,d)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],u=e[i*3],d=e[i*3+1],c=e[i*3+2],h=e[r*3],m=e[r*3+1],g=e[r*3+2],v=e[s*3],x=e[s*3+1],y=e[s*3+2];return Math.abs(a-d)<Math.abs(o-u)?[new te(o,1-l),new te(u,1-c),new te(h,1-g),new te(v,1-y)]:[new te(a,1-l),new te(d,1-c),new te(m,1-g),new te(x,1-y)]}};function OG(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class Oh extends aa{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Oh(e.radius,e.detail)}}class zh extends aa{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new zh(e.radius,e.detail)}}class bp extends Ze{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],u=[],d=[];let c=e;const h=(n-e)/r,m=new R,g=new te;for(let v=0;v<=r;v++){for(let x=0;x<=i;x++){const y=s+x/i*o;m.x=c*Math.cos(y),m.y=c*Math.sin(y),l.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/n+1)/2,g.y=(m.y/n+1)/2,d.push(g.x,g.y)}c+=h}for(let v=0;v<r;v++){const x=v*(i+1);for(let y=0;y<i;y++){const _=y+x,S=_,b=_+i+1,T=_+i+2,E=_+1;a.push(S,b,E),a.push(b,T,E)}}this.setIndex(a),this.setAttribute("position",new De(l,3)),this.setAttribute("normal",new De(u,3)),this.setAttribute("uv",new De(d,2))}static fromJSON(e){return new bp(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Mp extends Ze{constructor(e=new Ls([new te(0,.5),new te(-.5,-.5),new te(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)u(e);else for(let d=0;d<e.length;d++)u(e[d]),this.addGroup(a,l,d),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new De(r,3)),this.setAttribute("normal",new De(s,3)),this.setAttribute("uv",new De(o,2));function u(d){const c=r.length/3,h=d.extractPoints(n);let m=h.shape;const g=h.holes;Is.isClockWise(m)===!1&&(m=m.reverse());for(let x=0,y=g.length;x<y;x++){const _=g[x];Is.isClockWise(_)===!0&&(g[x]=_.reverse())}const v=Is.triangulateShape(m,g);for(let x=0,y=g.length;x<y;x++){const _=g[x];m=m.concat(_)}for(let x=0,y=m.length;x<y;x++){const _=m[x];r.push(_.x,_.y,0),s.push(0,0,1),o.push(_.x,_.y)}for(let x=0,y=v.length;x<y;x++){const _=v[x],S=_[0]+c,b=_[1]+c,T=_[2]+c;i.push(S,b,T),l+=3}}}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return zG(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=n[e.shapes[r]];i.push(o)}return new Mp(i,e.curveSegments)}}function zG(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class Du extends Ze{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let u=0;const d=[],c=new R,h=new R,m=[],g=[],v=[],x=[];for(let y=0;y<=i;y++){const _=[],S=y/i;let b=0;y==0&&o==0?b=.5/n:y==i&&l==Math.PI&&(b=-.5/n);for(let T=0;T<=n;T++){const E=T/n;c.x=-e*Math.cos(r+E*s)*Math.sin(o+S*a),c.y=e*Math.cos(o+S*a),c.z=e*Math.sin(r+E*s)*Math.sin(o+S*a),g.push(c.x,c.y,c.z),h.copy(c).normalize(),v.push(h.x,h.y,h.z),x.push(E+b,1-S),_.push(u++)}d.push(_)}for(let y=0;y<i;y++)for(let _=0;_<n;_++){const S=d[y][_+1],b=d[y][_],T=d[y+1][_],E=d[y+1][_+1];(y!==0||o>0)&&m.push(S,b,E),(y!==i-1||l<Math.PI)&&m.push(b,T,E)}this.setIndex(m),this.setAttribute("position",new De(g,3)),this.setAttribute("normal",new De(v,3)),this.setAttribute("uv",new De(x,2))}static fromJSON(e){return new Du(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ep extends aa{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new Ep(e.radius,e.detail)}}class Ap extends Ze{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],u=[],d=new R,c=new R,h=new R;for(let m=0;m<=i;m++)for(let g=0;g<=r;g++){const v=g/r*s,x=m/i*Math.PI*2;c.x=(e+n*Math.cos(x))*Math.cos(v),c.y=(e+n*Math.cos(x))*Math.sin(v),c.z=n*Math.sin(x),a.push(c.x,c.y,c.z),d.x=e*Math.cos(v),d.y=e*Math.sin(v),h.subVectors(c,d).normalize(),l.push(h.x,h.y,h.z),u.push(g/r),u.push(m/i)}for(let m=1;m<=i;m++)for(let g=1;g<=r;g++){const v=(r+1)*m+g-1,x=(r+1)*(m-1)+g-1,y=(r+1)*(m-1)+g,_=(r+1)*m+g;o.push(v,x,_),o.push(x,y,_)}this.setIndex(o),this.setAttribute("position",new De(a,3)),this.setAttribute("normal",new De(l,3)),this.setAttribute("uv",new De(u,2))}static fromJSON(e){return new Ap(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Nh extends Ze{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],u=[],d=[],c=new R,h=new R,m=new R,g=new R,v=new R,x=new R,y=new R;for(let S=0;S<=i;++S){const b=S/i*s*Math.PI*2;_(b,s,o,e,m),_(b+.01,s,o,e,g),x.subVectors(g,m),y.addVectors(g,m),v.crossVectors(x,y),y.crossVectors(v,x),v.normalize(),y.normalize();for(let T=0;T<=r;++T){const E=T/r*Math.PI*2,L=-n*Math.cos(E),A=n*Math.sin(E);c.x=m.x+(L*y.x+A*v.x),c.y=m.y+(L*y.y+A*v.y),c.z=m.z+(L*y.z+A*v.z),l.push(c.x,c.y,c.z),h.subVectors(c,m).normalize(),u.push(h.x,h.y,h.z),d.push(S/i),d.push(T/r)}}for(let S=1;S<=i;S++)for(let b=1;b<=r;b++){const T=(r+1)*(S-1)+(b-1),E=(r+1)*S+(b-1),L=(r+1)*S+b,A=(r+1)*(S-1)+b;a.push(T,E,A),a.push(E,L,A)}this.setIndex(a),this.setAttribute("position",new De(l,3)),this.setAttribute("normal",new De(u,3)),this.setAttribute("uv",new De(d,2));function _(S,b,T,E,L){const A=Math.cos(S),I=Math.sin(S),P=T/b*S,O=Math.cos(P);L.x=E*(2+O)*.5*A,L.y=E*(2+O)*I*.5,L.z=E*Math.sin(P)*.5}}static fromJSON(e){return new Nh(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Tp extends Ze{constructor(e=new eM(new R(-1,-1,0),new R(-1,1,0),new R(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new R,l=new R,u=new te;let d=new R;const c=[],h=[],m=[],g=[];v(),this.setIndex(g),this.setAttribute("position",new De(c,3)),this.setAttribute("normal",new De(h,3)),this.setAttribute("uv",new De(m,2));function v(){for(let S=0;S<n;S++)x(S);x(s===!1?n:0),_(),y()}function x(S){d=e.getPointAt(S/n,d);const b=o.normals[S],T=o.binormals[S];for(let E=0;E<=r;E++){const L=E/r*Math.PI*2,A=Math.sin(L),I=-Math.cos(L);l.x=I*b.x+A*T.x,l.y=I*b.y+A*T.y,l.z=I*b.z+A*T.z,l.normalize(),h.push(l.x,l.y,l.z),a.x=d.x+i*l.x,a.y=d.y+i*l.y,a.z=d.z+i*l.z,c.push(a.x,a.y,a.z)}}function y(){for(let S=1;S<=n;S++)for(let b=1;b<=r;b++){const T=(r+1)*(S-1)+(b-1),E=(r+1)*S+(b-1),L=(r+1)*S+b,A=(r+1)*(S-1)+b;g.push(T,E,A),g.push(E,L,A)}}function _(){for(let S=0;S<=n;S++)for(let b=0;b<=r;b++)u.x=S/n,u.y=b/r,m.push(u.x,u.y)}}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Tp(new tM[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class ER extends Ze{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new R,s=new R;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let u=0,d=l.length;u<d;++u){const c=l[u],h=c.start,m=c.count;for(let g=h,v=h+m;g<v;g+=3)for(let x=0;x<3;x++){const y=a.getX(g+x),_=a.getX(g+(x+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,_),nT(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let u=0;u<3;u++){const d=3*a+u,c=3*a+(u+1)%3;r.fromBufferAttribute(o,d),s.fromBufferAttribute(o,c),nT(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new De(n,3))}}}function nT(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var iT=Object.freeze({__proto__:null,BoxGeometry:or,CapsuleGeometry:_p,CircleGeometry:wp,ConeGeometry:Dh,CylinderGeometry:fl,DodecahedronGeometry:Rh,EdgesGeometry:wR,ExtrudeGeometry:Sp,IcosahedronGeometry:Oh,LatheGeometry:Iu,OctahedronGeometry:zh,PlaneGeometry:dl,PolyhedronGeometry:aa,RingGeometry:bp,ShapeGeometry:Mp,SphereGeometry:Du,TetrahedronGeometry:Ep,TorusGeometry:Ap,TorusKnotGeometry:Nh,TubeGeometry:Tp,WireframeGeometry:ER});class AR extends gi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ge(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class TR extends zs{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class iM extends gi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ge(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CR extends iM{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new te(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Bn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ge(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Ge(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ge(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class PR extends gi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ge(16777215),this.specular=new Ge(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LR extends gi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ge(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class IR extends gi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class DR extends gi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class RR extends gi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ge(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=cl,this.normalScale=new te(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OR extends Li{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Wr(t,e,n){return rM(t)?new t.constructor(t.subarray(e,n!==void 0?n:t.length)):t.slice(e,n)}function eu(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function rM(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function zR(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function jw(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function sM(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function NG(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const u=s.tracks[l],d=u.getValueSize(),c=[],h=[];for(let m=0;m<u.times.length;++m){const g=u.times[m]*r;if(!(g<n||g>=i)){c.push(u.times[m]);for(let v=0;v<d;++v)h.push(u.values[m*d+v])}}c.length!==0&&(u.times=eu(c,u.times.constructor),u.values=eu(h,u.values.constructor),o.push(u))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function kG(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const u=t.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===l});if(u===void 0)continue;let d=0;const c=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=c/3);let h=0;const m=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=m/3);const g=a.times.length-1;let v;if(s<=a.times[0]){const y=d,_=c-d;v=Wr(a.values,y,_)}else if(s>=a.times[g]){const y=g*c+d,_=y+c-d;v=Wr(a.values,y,_)}else{const y=a.createInterpolant(),_=d,S=c-d;y.evaluate(s),v=Wr(y.resultBuffer,_,S)}l==="quaternion"&&new Ti().fromArray(v).normalize().conjugate().toArray(v);const x=u.times.length;for(let y=0;y<x;++y){const _=y*m+h;if(l==="quaternion")Ti.multiplyQuaternionsFlat(u.values,_,v,0,u.values,_);else{const S=m-h*2;for(let b=0;b<S;++b)u.values[_+b]-=v[b]}}}return t.blendMode=Bb,t}var BG=Object.freeze({__proto__:null,arraySlice:Wr,convertArray:eu,flattenJSON:sM,getKeyframeOrder:zR,isTypedArray:rM,makeClipAdditive:kG,sortedArray:jw,subclip:NG});class Cp{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NR extends Cp{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Jl,endingEnd:Jl}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case Kl:s=e,a=2*n-i;break;case jf:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case Kl:o=e,l=2*i-n;break;case jf:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}const u=(i-n)*.5,d=this.valueSize;this._weightPrev=u/(n-a),this._weightNext=u/(l-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,m=this._weightNext,g=(i-n)/(r-n),v=g*g,x=v*g,y=-h*x+2*h*v-h*g,_=(1+h)*x+(-1.5-2*h)*v+(-.5+h)*g+1,S=(-1-m)*x+(1.5+m)*v+.5*g,b=m*x-m*v;for(let T=0;T!==a;++T)s[T]=y*o[d+T]+_*o[u+T]+S*o[l+T]+b*o[c+T];return s}}class oM extends Cp{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,u=l-a,d=(i-n)/(r-n),c=1-d;for(let h=0;h!==a;++h)s[h]=o[u+h]*c+o[l+h]*d;return s}}class kR extends Cp{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Us{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=eu(n,this.TimeBufferType),this.values=eu(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:eu(e.times,Array),values:eu(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new kR(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new oM(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new NR(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Hf:n=this.InterpolantFactoryMethodDiscrete;break;case Wf:n=this.InterpolantFactoryMethodLinear;break;case y0:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Hf;case this.InterpolantFactoryMethodLinear:return Wf;case this.InterpolantFactoryMethodSmooth:return y0}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Wr(i,s,o),this.values=Wr(this.values,s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&rM(r))for(let a=0,l=r.length;a!==l;++a){const u=r[a];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,u),e=!1;break}}return e}optimize(){const e=Wr(this.times),n=Wr(this.values),i=this.getValueSize(),r=this.getInterpolation()===y0,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const u=e[a],d=e[a+1];if(u!==d&&(a!==1||u!==e[0]))if(r)l=!0;else{const c=a*i,h=c-i,m=c+i;for(let g=0;g!==i;++g){const v=n[c+g];if(v!==n[h+g]||v!==n[m+g]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const c=a*i,h=o*i;for(let m=0;m!==i;++m)n[h+m]=n[c+m]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,u=0;u!==i;++u)n[l+u]=n[a+u];++o}return o!==e.length?(this.times=Wr(e,0,o),this.values=Wr(n,0,o*i)):(this.times=e,this.values=n),this}clone(){const e=Wr(this.times,0),n=Wr(this.values,0),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}Us.prototype.TimeBufferType=Float32Array;Us.prototype.ValueBufferType=Float32Array;Us.prototype.DefaultInterpolation=Wf;class Ru extends Us{}Ru.prototype.ValueTypeName="bool";Ru.prototype.ValueBufferType=Array;Ru.prototype.DefaultInterpolation=Hf;Ru.prototype.InterpolantFactoryMethodLinear=void 0;Ru.prototype.InterpolantFactoryMethodSmooth=void 0;class aM extends Us{}aM.prototype.ValueTypeName="color";class Qf extends Us{}Qf.prototype.ValueTypeName="number";class BR extends Cp{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n);let u=e*a;for(let d=u+a;u!==d;u+=4)Ti.slerpFlat(s,0,o,u-a,o,u,l);return s}}class kh extends Us{InterpolantFactoryMethodLinear(e){return new BR(this.times,this.values,this.getValueSize(),e)}}kh.prototype.ValueTypeName="quaternion";kh.prototype.DefaultInterpolation=Wf;kh.prototype.InterpolantFactoryMethodSmooth=void 0;class Ou extends Us{}Ou.prototype.ValueTypeName="string";Ou.prototype.ValueBufferType=Array;Ou.prototype.DefaultInterpolation=Hf;Ou.prototype.InterpolantFactoryMethodLinear=void 0;Ou.prototype.InterpolantFactoryMethodSmooth=void 0;class ep extends Us{}ep.prototype.ValueTypeName="vector";class tp{constructor(e,n=-1,i,r=qv){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=Sr(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(FG(i[o]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)n.push(Us.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],u=[];l.push((a+s-1)%s,a,(a+1)%s),u.push(0,1,0);const d=zR(l);l=jw(l,1,d),u=jw(u,1,d),!r&&l[0]===0&&(l.push(s),u.push(u[0])),o.push(new Qf(".morphTargetInfluences["+n[a].name+"]",l,u).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const u=e[a],d=u.name.match(s);if(d&&d.length>1){const c=d[1];let h=r[c];h||(r[c]=h=[]),h.push(u)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(c,h,m,g,v){if(m.length!==0){const x=[],y=[];sM(m,x,y,g),x.length!==0&&v.push(new c(h,x,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const u=e.hierarchy||[];for(let c=0;c<u.length;c++){const h=u[c].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const m={};let g;for(g=0;g<h.length;g++)if(h[g].morphTargets)for(let v=0;v<h[g].morphTargets.length;v++)m[h[g].morphTargets[v]]=-1;for(const v in m){const x=[],y=[];for(let _=0;_!==h[g].morphTargets.length;++_){const S=h[g];x.push(S.time),y.push(S.morphTarget===v?1:0)}r.push(new Qf(".morphTargetInfluence["+v+"]",x,y))}l=m.length*o}else{const m=".bones["+n[c].name+"]";i(ep,m+".position",h,"pos",r),i(kh,m+".quaternion",h,"rot",r),i(ep,m+".scale",h,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function UG(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Qf;case"vector":case"vector2":case"vector3":case"vector4":return ep;case"color":return aM;case"quaternion":return kh;case"bool":case"boolean":return Ru;case"string":return Ou}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function FG(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=UG(t.type);if(t.times===void 0){const n=[],i=[];sM(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const bu={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class lM{constructor(e,n,i){const r=this;let s=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,c){return u.push(d,c),this},this.removeHandler=function(d){const c=u.indexOf(d);return c!==-1&&u.splice(c,2),this},this.getHandler=function(d){for(let c=0,h=u.length;c<h;c+=2){const m=u[c],g=u[c+1];if(m.global&&(m.lastIndex=0),m.test(d))return g}return null}}}const UR=new lM;class Wi{constructor(e){this.manager=e!==void 0?e:UR,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Ro={};class VG extends Error{constructor(e,n){super(e),this.response=n}}class cs extends Wi{constructor(e){super(e)}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=bu.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(Ro[e]!==void 0){Ro[e].push({onLoad:n,onProgress:i,onError:r});return}Ro[e]=[],Ro[e].push({onLoad:n,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;const d=Ro[e],c=u.body.getReader(),h=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),m=h?parseInt(h):0,g=m!==0;let v=0;const x=new ReadableStream({start(y){_();function _(){c.read().then(({done:S,value:b})=>{if(S)y.close();else{v+=b.byteLength;const T=new ProgressEvent("progress",{lengthComputable:g,loaded:v,total:m});for(let E=0,L=d.length;E<L;E++){const A=d[E];A.onProgress&&A.onProgress(T)}y.enqueue(b),_()}})}}});return new Response(x)}else throw new VG(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return u.json();default:if(a===void 0)return u.text();{const c=/charset="?([^;"\s]*)"?/i.exec(a),h=c&&c[1]?c[1].toLowerCase():void 0,m=new TextDecoder(h);return u.arrayBuffer().then(g=>m.decode(g))}}}).then(u=>{bu.add(e,u);const d=Ro[e];delete Ro[e];for(let c=0,h=d.length;c<h;c++){const m=d[c];m.onLoad&&m.onLoad(u)}}).catch(u=>{const d=Ro[e];if(d===void 0)throw this.manager.itemError(e),u;delete Ro[e];for(let c=0,h=d.length;c<h;c++){const m=d[c];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class GG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new cs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=tp.parse(e[i]);n.push(r)}return n}}class HG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=[],a=new Jb,l=new cs(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let u=0;function d(c){l.load(e[c],function(h){const m=s.parse(h,!0);o[c]={width:m.width,height:m.height,format:m.format,mipmaps:m.mipmaps},u+=1,u===6&&(m.mipmapCount===1&&(a.minFilter=xn),a.image=o,a.format=m.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let c=0,h=e.length;c<h;++c)d(c);else l.load(e,function(c){const h=s.parse(c,!0);if(h.isCubemap){const m=h.mipmaps.length/h.mipmapCount;for(let g=0;g<m;g++){o[g]={mipmaps:[]};for(let v=0;v<h.mipmapCount;v++)o[g].mipmaps.push(h.mipmaps[g*h.mipmapCount+v]),o[g].format=h.format,o[g].width=h.width,o[g].height=h.height}a.image=o}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=xn),a.format=h.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}}class np extends Wi{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=bu.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a=Xf("img");function l(){d(),bu.add(e,this),n&&n(this),s.manager.itemEnd(e)}function u(c){d(),r&&r(c),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class WG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=new Lh,o=new np(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(u){o.load(e[u],function(d){s.images[u]=d,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let u=0;u<e.length;++u)l(u);return s}}class jG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new Jc,a=new cs(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const u=s.parse(l);u&&(u.image!==void 0?o.image=u.image:u.data!==void 0&&(o.image.width=u.width,o.image.height=u.height,o.image.data=u.data),o.wrapS=u.wrapS!==void 0?u.wrapS:Ai,o.wrapT=u.wrapT!==void 0?u.wrapT:Ai,o.magFilter=u.magFilter!==void 0?u.magFilter:xn,o.minFilter=u.minFilter!==void 0?u.minFilter:xn,o.anisotropy=u.anisotropy!==void 0?u.anisotropy:1,u.encoding!==void 0&&(o.encoding=u.encoding),u.flipY!==void 0&&(o.flipY=u.flipY),u.format!==void 0&&(o.format=u.format),u.type!==void 0&&(o.type=u.type),u.mipmaps!==void 0&&(o.mipmaps=u.mipmaps,o.minFilter=nl),u.mipmapCount===1&&(o.minFilter=xn),u.generateMipmaps!==void 0&&(o.generateMipmaps=u.generateMipmaps),o.needsUpdate=!0,n&&n(o,u))},i,r),o}}class $G extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=new gn,o=new np(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class la extends Pt{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new Ge(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class uM extends la{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Pt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Ge(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const Tx=new Fe,rT=new R,sT=new R;class cM{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new te(512,512),this.map=null,this.mapPass=null,this.matrix=new Fe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Yv,this._frameExtents=new te(1,1),this._viewportCount=1,this._viewports=[new _t(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;rT.setFromMatrixPosition(e.matrixWorld),n.position.copy(rT),sT.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(sT),n.updateMatrixWorld(),Tx.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Tx),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Tx)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class qG extends cM{constructor(){super(new Un(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=qf*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class hM extends la{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Pt.DEFAULT_UP),this.updateMatrix(),this.target=new Pt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new qG}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const oT=new Fe,Ld=new R,Cx=new R;class XG extends cM{constructor(){super(new Un(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new te(4,2),this._viewportCount=6,this._viewports=[new _t(2,1,1,1),new _t(0,1,1,1),new _t(3,1,1,1),new _t(1,1,1,1),new _t(3,0,1,1),new _t(1,0,1,1)],this._cubeDirections=[new R(1,0,0),new R(-1,0,0),new R(0,0,1),new R(0,0,-1),new R(0,1,0),new R(0,-1,0)],this._cubeUps=[new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,1,0),new R(0,0,1),new R(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Ld.setFromMatrixPosition(e.matrixWorld),i.position.copy(Ld),Cx.copy(i.position),Cx.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(Cx),i.updateMatrixWorld(),r.makeTranslation(-Ld.x,-Ld.y,-Ld.z),oT.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oT)}}class dM extends la{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new XG}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class YG extends cM{constructor(){super(new ia(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fM extends la{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Pt.DEFAULT_UP),this.updateMatrix(),this.target=new Pt,this.shadow=new YG}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class FR extends la{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class VR extends la{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class GR{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new R)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class ny extends la{constructor(e=new GR,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class iy extends Wi{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,o=new cs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=iy.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Ge().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new Ge().setHex(o.value);break;case"v2":r.uniforms[s].value=new te().fromArray(o.value);break;case"v3":r.uniforms[s].value=new R().fromArray(o.value);break;case"v4":r.uniforms[s].value=new _t().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Jn().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Fe().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new te().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new te().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:AR,SpriteMaterial:Xb,RawShaderMaterial:TR,ShaderMaterial:zs,PointsMaterial:Zb,MeshPhysicalMaterial:CR,MeshStandardMaterial:iM,MeshPhongMaterial:PR,MeshToonMaterial:LR,MeshNormalMaterial:IR,MeshLambertMaterial:DR,MeshDepthMaterial:Wb,MeshDistanceMaterial:jb,MeshBasicMaterial:mo,MeshMatcapMaterial:RR,LineDashedMaterial:OR,LineBasicMaterial:Li,Material:gi};return new n[e]}}class $w{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class HR extends Ze{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class ry extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new cs(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(m,g){if(n[g]!==void 0)return n[g];const x=m.interleavedBuffers[g],y=s(m,x.buffer),_=Uc(x.type,y),S=new Kv(_,x.stride);return S.uuid=x.uuid,n[g]=S,S}function s(m,g){if(i[g]!==void 0)return i[g];const x=m.arrayBuffers[g],y=new Uint32Array(x).buffer;return i[g]=y,y}const o=e.isInstancedBufferGeometry?new HR:new Ze,a=e.data.index;if(a!==void 0){const m=Uc(a.type,a.array);o.setIndex(new pt(m,1))}const l=e.data.attributes;for(const m in l){const g=l[m];let v;if(g.isInterleavedBufferAttribute){const x=r(e.data,g.data);v=new _u(x,g.itemSize,g.offset,g.normalized)}else{const x=Uc(g.type,g.array),y=g.isInstancedBufferAttribute?gh:pt;v=new y(x,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),g.usage!==void 0&&v.setUsage(g.usage),g.updateRange!==void 0&&(v.updateRange.offset=g.updateRange.offset,v.updateRange.count=g.updateRange.count),o.setAttribute(m,v)}const u=e.data.morphAttributes;if(u)for(const m in u){const g=u[m],v=[];for(let x=0,y=g.length;x<y;x++){const _=g[x];let S;if(_.isInterleavedBufferAttribute){const b=r(e.data,_.data);S=new _u(b,_.itemSize,_.offset,_.normalized)}else{const b=Uc(_.type,_.array);S=new pt(b,_.itemSize,_.normalized)}_.name!==void 0&&(S.name=_.name),v.push(S)}o.morphAttributes[m]=v}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let m=0,g=c.length;m!==g;++m){const v=c[m];o.addGroup(v.start,v.count,v.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const m=new R;h.center!==void 0&&m.fromArray(h.center),o.boundingSphere=new Mr(m,h.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class ZG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?$w.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new cs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let u=null;try{u=JSON.parse(l)}catch(c){r!==void 0&&r(c),console.error("THREE:ObjectLoader: Can't parse "+e+".",c.message);return}const d=u.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(u,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?$w.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new cs(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(u)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),u=this.parseObject(e.object,s,l,a,i),d=this.parseSkeletons(e.skeletons,u);if(this.bindSkeletons(u,d),n!==void 0){let c=!1;for(const h in o)if(o[h].data instanceof HTMLImageElement){c=!0;break}c===!1&&n(u)}return u}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),u=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,u),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new Ls().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new Qv().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new ry;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in iT?a=iT[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),a.isBufferGeometry===!0&&l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new iy;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=tp.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const u=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:i.resourcePath+u;return o(d)}else return l.data?{data:Uc(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new lM(n);s=new np(l),s.setCrossOrigin(this.crossOrigin);for(let u=0,d=e.length;u<d;u++){const c=e[u],h=c.url;if(Array.isArray(h)){const m=[];for(let g=0,v=h.length;g<v;g++){const x=h[g],y=a(x);y!==null&&(y instanceof HTMLImageElement?m.push(y):m.push(new Jc(y.data,y.width,y.height)))}r[c.uuid]=new Ql(m)}else{const m=a(c.url);r[c.uuid]=new Ql(m)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Uc(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new np(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],u=l.url;if(Array.isArray(u)){const d=[];for(let c=0,h=u.length;c<h;c++){const m=u[c],g=await s(m);g!==null&&(g instanceof HTMLImageElement?d.push(g):d.push(new Jc(g.data,g.width,g.height)))}i[l.uuid]=new Ql(d)}else{const d=await s(l.url);i[l.uuid]=new Ql(d)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=n[a.image],u=l.data;let d;Array.isArray(u)?(d=new Lh,u.length===6&&(d.needsUpdate=!0)):(u&&u.data?d=new Jc:d=new gn,u&&(d.needsUpdate=!0)),d.source=l,d.uuid=a.uuid,a.name!==void 0&&(d.name=a.name),a.mapping!==void 0&&(d.mapping=i(a.mapping,JG)),a.offset!==void 0&&d.offset.fromArray(a.offset),a.repeat!==void 0&&d.repeat.fromArray(a.repeat),a.center!==void 0&&d.center.fromArray(a.center),a.rotation!==void 0&&(d.rotation=a.rotation),a.wrap!==void 0&&(d.wrapS=i(a.wrap[0],aT),d.wrapT=i(a.wrap[1],aT)),a.format!==void 0&&(d.format=a.format),a.type!==void 0&&(d.type=a.type),a.encoding!==void 0&&(d.encoding=a.encoding),a.minFilter!==void 0&&(d.minFilter=i(a.minFilter,lT)),a.magFilter!==void 0&&(d.magFilter=i(a.magFilter,lT)),a.anisotropy!==void 0&&(d.anisotropy=a.anisotropy),a.flipY!==void 0&&(d.flipY=a.flipY),a.generateMipmaps!==void 0&&(d.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(d.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,n,i,r,s){let o;function a(h){return n[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),n[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const m=[];for(let g=0,v=h.length;g<v;g++){const x=h[g];i[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),m.push(i[x])}return m}return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),i[h]}}function u(h){return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),r[h]}let d,c;switch(e.type){case"Scene":o=new Yf,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Ge(e.background):o.background=u(e.background)),e.environment!==void 0&&(o.environment=u(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new yp(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new Jv(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Un(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ia(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new FR(e.color,e.intensity);break;case"DirectionalLight":o=new fM(e.color,e.intensity);break;case"PointLight":o=new dM(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new VR(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new hM(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new uM(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new ny().fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),c=l(e.material),o=new pR(d,c),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),c=l(e.material),o=new li(d,c);break;case"InstancedMesh":d=a(e.geometry),c=l(e.material);const h=e.count,m=e.instanceMatrix,g=e.instanceColor;o=new mR(d,c,h),o.instanceMatrix=new gh(new Float32Array(m.array),16),g!==void 0&&(o.instanceColor=new gh(new Float32Array(g.array),g.itemSize));break;case"LOD":o=new fR;break;case"Line":o=new il(a(e.geometry),l(e.material));break;case"LineLoop":o=new gR(a(e.geometry),l(e.material));break;case"LineSegments":o=new ks(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new vR(a(e.geometry),l(e.material));break;case"Sprite":o=new dR(l(e.material));break;case"Group":o=new Oa;break;case"Bone":o=new Yb;break;default:o=new Pt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let m=0;m<h.length;m++)o.add(this.parseObject(h[m],n,i,r,s))}if(e.animations!==void 0){const h=e.animations;for(let m=0;m<h.length;m++){const g=h[m];o.animations.push(s[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const h=e.levels;for(let m=0;m<h.length;m++){const g=h[m],v=o.getObjectByProperty("uuid",g.object);v!==void 0&&o.addLevel(v,g.distance,g.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const JG={UVMapping:$v,CubeReflectionMapping:ea,CubeRefractionMapping:ta,EquirectangularReflectionMapping:Uf,EquirectangularRefractionMapping:Ff,CubeUVReflectionMapping:Cu},aT={RepeatWrapping:Vf,ClampToEdgeWrapping:Ai,MirroredRepeatWrapping:Gf},lT={NearestFilter:Nn,NearestMipmapNearestFilter:Q0,NearestMipmapLinearFilter:df,LinearFilter:xn,LinearMipmapNearestFilter:Nb,LinearMipmapLinearFilter:nl};class KG extends Wi{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=bu.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){bu.add(e,l),n&&n(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Tg,pM=class{static getContext(){return Tg===void 0&&(Tg=new(window.AudioContext||window.webkitAudioContext)),Tg}static setContext(e){Tg=e}};class QG extends Wi{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new cs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const l=a.slice(0);pM.getContext().decodeAudioData(l,function(d){n(d)})}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}}class eH extends ny{constructor(e,n,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=new Ge().set(e),s=new Ge().set(n),o=new R(r.r,r.g,r.b),a=new R(s.r,s.g,s.b),l=Math.sqrt(Math.PI),u=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(u)}}class tH extends ny{constructor(e,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const i=new Ge().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const uT=new Fe,cT=new Fe,Cl=new Fe;class nH{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Un,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Un,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Cl.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(au*n.fov*.5)/n.zoom;let a,l;cT.elements[12]=-r,uT.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,Cl.elements[0]=2*n.near/(l-a),Cl.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(Cl),a=-o*n.aspect-s,l=o*n.aspect-s,Cl.elements[0]=2*n.near/(l-a),Cl.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(Cl)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cT),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(uT)}}class mM{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=hT(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=hT();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function hT(){return(typeof performance>"u"?Date:performance).now()}const Pl=new R,dT=new Ti,iH=new R,Ll=new R;class rH extends Pt{constructor(){super(),this.type="AudioListener",this.context=pM.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new mM}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Pl,dT,iH),Ll.set(0,0,-1).applyQuaternion(dT),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Pl.x,r),n.positionY.linearRampToValueAtTime(Pl.y,r),n.positionZ.linearRampToValueAtTime(Pl.z,r),n.forwardX.linearRampToValueAtTime(Ll.x,r),n.forwardY.linearRampToValueAtTime(Ll.y,r),n.forwardZ.linearRampToValueAtTime(Ll.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(Pl.x,Pl.y,Pl.z),n.setOrientation(Ll.x,Ll.y,Ll.z,i.x,i.y,i.z)}}let WR=class extends Pt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Il=new R,fT=new Ti,sH=new R,Dl=new R;class oH extends WR{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Il,fT,sH),Dl.set(0,0,1).applyQuaternion(fT);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Il.x,i),n.positionY.linearRampToValueAtTime(Il.y,i),n.positionZ.linearRampToValueAtTime(Il.z,i),n.orientationX.linearRampToValueAtTime(Dl.x,i),n.orientationY.linearRampToValueAtTime(Dl.y,i),n.orientationZ.linearRampToValueAtTime(Dl.z,i)}else n.setPosition(Il.x,Il.y,Il.z),n.setOrientation(Dl.x,Dl.y,Dl.z)}}class aH{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class jR{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,u=n+n;l!==u;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){Ti.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const o=this._workIndex*s;Ti.multiplyQuaternionsFlat(e,o,e,n,e,i),Ti.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[i+o]*r}}}const gM="\\[\\]\\.:\\/",lH=new RegExp("["+gM+"]","g"),vM="[^"+gM+"]",uH="[^"+gM.replace("\\.","")+"]",cH=/((?:WC+[\/:])*)/.source.replace("WC",vM),hH=/(WCOD+)?/.source.replace("WCOD",uH),dH=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vM),fH=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vM),pH=new RegExp("^"+cH+hH+dH+fH+"$"),mH=["material","materials","bones","map"];class gH{constructor(e,n,i){const r=i||kt.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class kt{constructor(e,n,i){this.path=n,this.parsedPath=i||kt.parseTrackName(n),this.node=kt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new kt.Composite(e,n,i):new kt(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(lH,"")}static parseTrackName(e){const n=pH.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);mH.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=kt.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let u=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===u){u=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}const o=e[r];if(o===void 0){const u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}kt.Composite=gH;kt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};kt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};kt.prototype.GetterByBindingType=[kt.prototype._getValue_direct,kt.prototype._getValue_array,kt.prototype._getValue_arrayElement,kt.prototype._getValue_toArray];kt.prototype.SetterByBindingTypeAndVersioning=[[kt.prototype._setValue_direct,kt.prototype._setValue_direct_setNeedsUpdate,kt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_array,kt.prototype._setValue_array_setNeedsUpdate,kt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_arrayElement,kt.prototype._setValue_arrayElement_setNeedsUpdate,kt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[kt.prototype._setValue_fromArray,kt.prototype._setValue_fromArray_setNeedsUpdate,kt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class vH{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Sr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,u=this.nCachedObjects_;for(let d=0,c=arguments.length;d!==c;++d){const h=arguments[d],m=h.uuid;let g=n[m];if(g===void 0){g=l++,n[m]=g,e.push(h);for(let v=0,x=o;v!==x;++v)s[v].push(new kt(h,i[v],r[v]))}else if(g<u){a=e[g];const v=--u,x=e[v];n[x.uuid]=g,e[g]=x,n[m]=v,e[v]=h;for(let y=0,_=o;y!==_;++y){const S=s[y],b=S[v];let T=S[g];S[g]=b,T===void 0&&(T=new kt(h,i[y],r[y])),S[v]=T}}else e[g]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=u}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],u=l.uuid,d=n[u];if(d!==void 0&&d>=s){const c=s++,h=e[c];n[h.uuid]=d,e[d]=h,n[u]=c,e[c]=l;for(let m=0,g=r;m!==g;++m){const v=i[m],x=v[c],y=v[d];v[d]=x,v[c]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const u=arguments[a],d=u.uuid,c=n[d];if(c!==void 0)if(delete n[d],c<s){const h=--s,m=e[h],g=--o,v=e[g];n[m.uuid]=c,e[c]=m,n[v.uuid]=h,e[h]=v,e.pop();for(let x=0,y=r;x!==y;++x){const _=i[x],S=_[h],b=_[g];_[c]=S,_[h]=b,_.pop()}}else{const h=--o,m=e[h];h>0&&(n[m.uuid]=c),e[c]=m,e.pop();for(let g=0,v=r;g!==v;++g){const x=i[g];x[c]=x[h],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,u=l.length,d=this.nCachedObjects_,c=new Array(u);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(c);for(let h=d,m=l.length;h!==m;++h){const g=l[h];c[h]=new kt(g,e,n)}return c}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],u=e[a];n[u]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class yH{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:Jl,endingEnd:Jl};for(let u=0;u!==o;++u){const d=s[u].createInterpolant(null);a[u]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=WD,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,u=a.sampleValues;return l[0]=s,l[1]=s+i,u[0]=e/o,u[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case Bb:for(let d=0,c=l.length;d!==c;++d)l[d].evaluate(o),u[d].accumulateAdditive(a);break;case qv:default:for(let d=0,c=l.length;d!==c;++d)l[d].evaluate(o),u[d].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===jD;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===HD){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const u=e<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=Kl,r.endingEnd=Kl):(e?r.endingStart=this.zeroSlopeAtStart?Kl:Jl:r.endingStart=jf,n?r.endingEnd=this.zeroSlopeAtEnd?Kl:Jl:r.endingEnd=jf)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}}const xH=new Float32Array(1);class _H extends po{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,u=this._bindingsByRootAndName;let d=u[l];d===void 0&&(d={},u[l]=d);for(let c=0;c!==s;++c){const h=r[c],m=h.name;let g=d[m];if(g!==void 0)++g.referenceCount,o[c]=g;else{if(g=o[c],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,l,m));continue}const v=n&&n._propertyBindings[c].binding.parsedPath;g=new jR(kt.create(i,m,v),h.ValueTypeName,h.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,l,m),o[c]=g}a[c].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,u=l[l.length-1],d=e._byClipCacheIndex;u._byClipCacheIndex=d,l[d]=u,l.pop(),e._byClipCacheIndex=null;const c=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete c[h],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],u=e._cacheIndex;l._cacheIndex=u,n[u]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new oM(new Float32Array(2),new Float32Array(2),1,xH),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let o=typeof e=="string"?tp.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let u=null;if(i===void 0&&(o!==null?i=o.blendMode:i=qv),l!==void 0){const c=l.actionByRoot[s];if(c!==void 0&&c.blendMode===i)return c;u=l.knownActions[0],o===null&&(o=u._clip)}if(o===null)return null;const d=new yH(this,o,n,i);return this._bindAction(d,u),this._addInactiveAction(d,a,s),d}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?tp.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let u=0;u!==i;++u)n[u]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let u=0;u!==l;++u)a[u].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const u=o[a];this._deactivateAction(u);const d=u._cacheIndex,c=n[n.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=d,n[d]=c,n.pop(),this._removeInactiveBindingsForAction(u)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class yM{constructor(e){this.value=e}clone(){return new yM(this.value.clone===void 0?this.value:this.value.clone())}}let wH=0;class SH extends po{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:wH++}),this.name="",this.usage=$f,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++)this.uniforms.push(n[i].clone());return this}clone(){return new this.constructor().copy(this)}}class bH extends Kv{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class MH{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class xM{constructor(e,n,i=0,r=1/0){this.ray=new hl(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new uu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,i=[]){return qw(e,this,i,n),i.sort(pT),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)qw(e[r],this,i,n);return i.sort(pT),i}}function pT(t,e){return t.distance-e.distance}function qw(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)qw(r[s],e,n,!0)}}class EH{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Bn(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class AH{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const mT=new te;class $R{constructor(e=new te(1/0,1/0),n=new te(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=mT.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return mT.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gT=new R,Cg=new R;class qR{constructor(e=new R,n=new R){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){gT.subVectors(e,this.start),Cg.subVectors(this.end,this.start);const i=Cg.dot(Cg);let s=Cg.dot(gT)/i;return n&&(s=Bn(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const vT=new R;class XR extends Pt{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Ze,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const u=o/l*Math.PI*2,d=a/l*Math.PI*2;r.push(Math.cos(u),Math.sin(u),1,Math.cos(d),Math.sin(d),1)}i.setAttribute("position",new De(r,3));const s=new Li({fog:!1,toneMapped:!1});this.cone=new ks(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),vT.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(vT),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Sa=new R,Pg=new Fe,Px=new Fe;class TH extends ks{constructor(e){const n=YR(e),i=new Ze,r=[],s=[],o=new Ge(0,0,1),a=new Ge(0,1,0);for(let u=0;u<n.length;u++){const d=n[u];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new De(r,3)),i.setAttribute("color",new De(s,3));const l=new Li({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");Px.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(Pg.multiplyMatrices(Px,a.matrixWorld),Sa.setFromMatrixPosition(Pg),r.setXYZ(o,Sa.x,Sa.y,Sa.z),Pg.multiplyMatrices(Px,a.parent.matrixWorld),Sa.setFromMatrixPosition(Pg),r.setXYZ(o+1,Sa.x,Sa.y,Sa.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function YR(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,YR(t.children[n]));return e}class ZR extends li{constructor(e,n,i){const r=new Du(n,4,2),s=new mo({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const CH=new R,yT=new Ge,xT=new Ge;class PH extends Pt{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new zh(n);r.rotateY(Math.PI*.5),this.material=new mo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new pt(o,3)),this.add(new li(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");yT.copy(this.light.color),xT.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?yT:xT;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(CH.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LH extends ks{constructor(e=10,n=10,i=4473924,r=8947848){i=new Ge(i),r=new Ge(r);const s=n/2,o=e/n,a=e/2,l=[],u=[];for(let h=0,m=0,g=-a;h<=n;h++,g+=o){l.push(-a,0,g,a,0,g),l.push(g,0,-a,g,0,a);const v=h===s?i:r;v.toArray(u,m),m+=3,v.toArray(u,m),m+=3,v.toArray(u,m),m+=3,v.toArray(u,m),m+=3}const d=new Ze;d.setAttribute("position",new De(l,3)),d.setAttribute("color",new De(u,3));const c=new Li({vertexColors:!0,toneMapped:!1});super(d,c),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class IH extends ks{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new Ge(s),o=new Ge(o);const a=[],l=[];if(n>1)for(let c=0;c<n;c++){const h=c/n*(Math.PI*2),m=Math.sin(h)*e,g=Math.cos(h)*e;a.push(0,0,0),a.push(m,0,g);const v=c&1?s:o;l.push(v.r,v.g,v.b),l.push(v.r,v.g,v.b)}for(let c=0;c<i;c++){const h=c&1?s:o,m=e-e/i*c;for(let g=0;g<r;g++){let v=g/r*(Math.PI*2),x=Math.sin(v)*m,y=Math.cos(v)*m;a.push(x,0,y),l.push(h.r,h.g,h.b),v=(g+1)/r*(Math.PI*2),x=Math.sin(v)*m,y=Math.cos(v)*m,a.push(x,0,y),l.push(h.r,h.g,h.b)}}const u=new Ze;u.setAttribute("position",new De(a,3)),u.setAttribute("color",new De(l,3));const d=new Li({vertexColors:!0,toneMapped:!1});super(u,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _T=new R,Lg=new R,wT=new R;class JR extends Pt{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Ze;r.setAttribute("position",new De([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new Li({fog:!1,toneMapped:!1});this.lightPlane=new il(r,s),this.add(this.lightPlane),r=new Ze,r.setAttribute("position",new De([0,0,0,0,0,1],3)),this.targetLine=new il(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_T.setFromMatrixPosition(this.light.matrixWorld),Lg.setFromMatrixPosition(this.light.target.matrixWorld),wT.subVectors(Lg,_T),this.lightPlane.lookAt(Lg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Lg),this.targetLine.scale.z=wT.length()}}const Ig=new R,Cn=new Lu;class ip extends ks{constructor(e){const n=new Ze,i=new Li({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(g,v){l(g),l(v)}function l(g){r.push(0,0,0),s.push(0,0,0),o[g]===void 0&&(o[g]=[]),o[g].push(r.length/3-1)}n.setAttribute("position",new De(r,3)),n.setAttribute("color",new De(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const u=new Ge(16755200),d=new Ge(16711680),c=new Ge(43775),h=new Ge(16777215),m=new Ge(3355443);this.setColors(u,d,c,h,m)}setColors(e,n,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;Cn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),On("c",n,e,Cn,0,0,-1),On("t",n,e,Cn,0,0,1),On("n1",n,e,Cn,-i,-r,-1),On("n2",n,e,Cn,i,-r,-1),On("n3",n,e,Cn,-i,r,-1),On("n4",n,e,Cn,i,r,-1),On("f1",n,e,Cn,-i,-r,1),On("f2",n,e,Cn,i,-r,1),On("f3",n,e,Cn,-i,r,1),On("f4",n,e,Cn,i,r,1),On("u1",n,e,Cn,i*.7,r*1.1,-1),On("u2",n,e,Cn,-i*.7,r*1.1,-1),On("u3",n,e,Cn,0,r*2,-1),On("cf1",n,e,Cn,-i,0,1),On("cf2",n,e,Cn,i,0,1),On("cf3",n,e,Cn,0,-r,1),On("cf4",n,e,Cn,0,r,1),On("cn1",n,e,Cn,-i,0,-1),On("cn2",n,e,Cn,i,0,-1),On("cn3",n,e,Cn,0,-r,-1),On("cn4",n,e,Cn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function On(t,e,n,i,r,s,o){Ig.set(r,s,o).unproject(i);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let u=0,d=a.length;u<d;u++)l.setXYZ(a[u],Ig.x,Ig.y,Ig.z)}}const Dg=new ar;class DH extends ks{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Ze;s.setIndex(new pt(i,1)),s.setAttribute("position",new pt(r,3)),super(s,new Li({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Dg.setFromObject(this.object),Dg.isEmpty())return;const n=Dg.min,i=Dg.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=n.x,s[4]=i.y,s[5]=i.z,s[6]=n.x,s[7]=n.y,s[8]=i.z,s[9]=i.x,s[10]=n.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=n.z,s[15]=n.x,s[16]=i.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=i.x,s[22]=n.y,s[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class rp extends ks{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ze;s.setIndex(new pt(i,1)),s.setAttribute("position",new De(r,3)),super(s,new Li({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class RH extends il{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Ze;o.setAttribute("position",new De(s,3)),o.computeBoundingSphere(),super(o,new Li({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Ze;l.setAttribute("position",new De(a,3)),l.computeBoundingSphere(),this.add(new li(l,new mo({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const ST=new R;let Rg,Lx;class OH extends Pt{constructor(e=new R(0,0,1),n=new R(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Rg===void 0&&(Rg=new Ze,Rg.setAttribute("position",new De([0,0,0,0,1,0],3)),Lx=new fl(0,.5,1,5,1),Lx.translate(0,-.5,0)),this.position.copy(n),this.line=new il(Rg,new Li({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new li(Lx,new mo({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{ST.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(ST,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class KR extends ks{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ze;r.setAttribute("position",new De(n,3)),r.setAttribute("color",new De(i,3));const s=new Li({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new Ge,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class zH{constructor(){this.type="ShapePath",this.color=new Ge,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new wu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(y){const _=[];for(let S=0,b=y.length;S<b;S++){const T=y[S],E=new Ls;E.curves=T.curves,_.push(E)}return _}function i(y,_){const S=_.length;let b=!1;for(let T=S-1,E=0;E<S;T=E++){let L=_[T],A=_[E],I=A.x-L.x,P=A.y-L.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(L=_[E],I=-I,A=_[T],P=-P),y.y<L.y||y.y>A.y)continue;if(y.y===L.y){if(y.x===L.x)return!0}else{const O=P*(y.x-L.x)-I*(y.y-L.y);if(O===0)return!0;if(O<0)continue;b=!b}}else{if(y.y!==L.y)continue;if(A.x<=y.x&&y.x<=L.x||L.x<=y.x&&y.x<=A.x)return!0}}return b}const r=Is.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const u=[];if(s.length===1)return a=s[0],l=new Ls,l.curves=a.curves,u.push(l),u;let d=!r(s[0].getPoints());d=e?!d:d;const c=[],h=[];let m=[],g=0,v;h[g]=void 0,m[g]=[];for(let y=0,_=s.length;y<_;y++)a=s[y],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!d&&h[g]&&g++,h[g]={s:new Ls,p:v},h[g].s.curves=a.curves,d&&g++,m[g]=[]):m[g].push({h:a,p:v[0]});if(!h[0])return n(s);if(h.length>1){let y=!1,_=0;for(let S=0,b=h.length;S<b;S++)c[S]=[];for(let S=0,b=h.length;S<b;S++){const T=m[S];for(let E=0;E<T.length;E++){const L=T[E];let A=!0;for(let I=0;I<h.length;I++)i(L.p,h[I].p)&&(S!==I&&_++,A?(A=!1,c[I].push(L)):y=!0);A&&c[S].push(L)}}_>0&&y===!1&&(m=c)}let x;for(let y=0,_=h.length;y<_;y++){l=h[y].s,u.push(l),x=m[y];for(let S=0,b=x.length;S<b;S++)l.holes.push(x[S].h)}return u}}const Uo=NH();function NH(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const u=l-127;u<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):u<-14?(i[l]=1024>>-u-14,i[l|256]=1024>>-u-14|32768,r[l]=-u-1,r[l|256]=-u-1):u<=15?(i[l]=u+15<<10,i[l|256]=u+15<<10|32768,r[l]=13,r[l|256]=13):u<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let u=l<<13,d=0;for(;!(u&8388608);)u<<=1,d-=8388608;u&=-8388609,d+=947912704,s[l]=u|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function kH(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Bn(t,-65504,65504),Uo.floatView[0]=t;const e=Uo.uint32View[0],n=e>>23&511;return Uo.baseTable[n]+((e&8388607)>>Uo.shiftTable[n])}function BH(t){const e=t>>10;return Uo.uint32View[0]=Uo.mantissaTable[Uo.offsetTable[e]+(t&1023)]+Uo.exponentTable[e],Uo.floatView[0]}var UH=Object.freeze({__proto__:null,fromHalfFloat:BH,toHalfFloat:kH});class FH extends or{constructor(e,n,i,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,n,i,r,s,o)}}class VH extends _p{constructor(e,n,i,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,n,i,r)}}class GH extends wp{constructor(e,n,i,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,n,i,r)}}class HH extends Dh{constructor(e,n,i,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,n,i,r,s,o,a)}}class WH extends fl{constructor(e,n,i,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,n,i,r,s,o,a,l)}}class jH extends Rh{constructor(e,n){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,n)}}class $H extends Sp{constructor(e,n){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,n)}}class qH extends Oh{constructor(e,n){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,n)}}class XH extends Iu{constructor(e,n,i,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,n,i,r)}}class YH extends zh{constructor(e,n){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,n)}}class ZH extends dl{constructor(e,n,i,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,n,i,r)}}class JH extends aa{constructor(e,n,i,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,n,i,r)}}class KH extends bp{constructor(e,n,i,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,n,i,r,s,o)}}class QH extends Mp{constructor(e,n){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,n)}}class eW extends Du{constructor(e,n,i,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,n,i,r,s,o,a)}}class tW extends Ep{constructor(e,n){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,n)}}class nW extends Ap{constructor(e,n,i,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,n,i,r,s)}}class iW extends Nh{constructor(e,n,i,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,n,i,r,s,o)}}class rW extends Tp{constructor(e,n,i,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,n,i,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Wv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Wv);const sW=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:zb,AddEquation:Vl,AddOperation:bD,AdditiveAnimationBlendMode:Bb,AdditiveBlending:cw,AlphaFormat:RD,AlwaysDepth:gD,AlwaysStencilFunc:YD,AmbientLight:FR,AmbientLightProbe:tH,AnimationClip:tp,AnimationLoader:GG,AnimationMixer:_H,AnimationObjectGroup:vH,AnimationUtils:BG,ArcCurve:xR,ArrayCamera:uR,ArrowHelper:OH,Audio:WR,AudioAnalyser:aH,AudioContext:pM,AudioListener:rH,AudioLoader:QG,AxesHelper:KR,BackSide:sr,BasicDepthPacking:$D,BasicShadowMap:nD,Bone:Yb,BooleanKeyframeTrack:Ru,Box2:$R,Box3:ar,Box3Helper:rp,BoxBufferGeometry:FH,BoxGeometry:or,BoxHelper:DH,BufferAttribute:pt,BufferGeometry:Ze,BufferGeometryLoader:ry,ByteType:CD,Cache:bu,Camera:Lu,CameraHelper:ip,CanvasTexture:lG,CapsuleBufferGeometry:VH,CapsuleGeometry:_p,CatmullRomCurve3:_R,CineonToneMapping:AD,CircleBufferGeometry:GH,CircleGeometry:wp,ClampToEdgeWrapping:Ai,Clock:mM,Color:Ge,ColorKeyframeTrack:aM,ColorManagement:Mi,CompressedArrayTexture:aG,CompressedTexture:Jb,CompressedTextureLoader:HG,ConeBufferGeometry:HH,ConeGeometry:Dh,CubeCamera:tR,CubeReflectionMapping:ea,CubeRefractionMapping:ta,CubeTexture:Lh,CubeTextureLoader:WG,CubeUVReflectionMapping:Cu,CubicBezierCurve:ns,CubicBezierCurve3:gf,CubicInterpolant:NR,CullFaceBack:uw,CullFaceFront:tD,CullFaceFrontBack:dU,CullFaceNone:eD,Curve:Bs,CurvePath:nM,CustomBlending:iD,CustomToneMapping:TD,CylinderBufferGeometry:WH,CylinderGeometry:fl,Cylindrical:AH,Data3DTexture:Vb,DataArrayTexture:Xv,DataTexture:Jc,DataTextureLoader:jG,DataUtils:UH,DecrementStencilOp:EU,DecrementWrapStencilOp:TU,DefaultLoadingManager:UR,DepthFormat:Ja,DepthStencilFormat:xu,DepthTexture:$b,DirectionalLight:fM,DirectionalLightHelper:JR,DiscreteInterpolant:kR,DodecahedronBufferGeometry:jH,DodecahedronGeometry:Rh,DoubleSide:so,DstAlphaFactor:cD,DstColorFactor:dD,DynamicCopyUsage:GU,DynamicDrawUsage:NU,DynamicReadUsage:UU,EdgesGeometry:wR,EllipseCurve:xp,EqualDepth:yD,EqualStencilFunc:IU,EquirectangularReflectionMapping:Uf,EquirectangularRefractionMapping:Ff,Euler:qo,EventDispatcher:po,ExtrudeBufferGeometry:$H,ExtrudeGeometry:Sp,FileLoader:cs,Float16BufferAttribute:QD,Float32BufferAttribute:De,Float64BufferAttribute:SF,FloatType:oo,Fog:yp,FogExp2:Jv,FramebufferTexture:oG,FrontSide:Qo,Frustum:Yv,GLBufferAttribute:MH,GLSL1:WU,GLSL3:Bw,GreaterDepth:_D,GreaterEqualDepth:xD,GreaterEqualStencilFunc:zU,GreaterStencilFunc:RU,GridHelper:LH,Group:Oa,HalfFloatType:yu,HemisphereLight:uM,HemisphereLightHelper:PH,HemisphereLightProbe:eH,IcosahedronBufferGeometry:qH,IcosahedronGeometry:Oh,ImageBitmapLoader:KG,ImageLoader:np,ImageUtils:Fb,IncrementStencilOp:MU,IncrementWrapStencilOp:AU,InstancedBufferAttribute:gh,InstancedBufferGeometry:HR,InstancedInterleavedBuffer:bH,InstancedMesh:mR,Int16BufferAttribute:_F,Int32BufferAttribute:wF,Int8BufferAttribute:vF,IntType:LD,InterleavedBuffer:Kv,InterleavedBufferAttribute:_u,Interpolant:Cp,InterpolateDiscrete:Hf,InterpolateLinear:Wf,InterpolateSmooth:y0,InvertStencilOp:CU,KeepStencilOp:x0,KeyframeTrack:Us,LOD:fR,LatheBufferGeometry:XH,LatheGeometry:Iu,Layers:uu,LessDepth:vD,LessEqualDepth:K0,LessEqualStencilFunc:DU,LessStencilFunc:LU,Light:la,LightProbe:ny,Line:il,Line3:qR,LineBasicMaterial:Li,LineCurve:rs,LineCurve3:Qb,LineDashedMaterial:OR,LineLoop:gR,LineSegments:ks,LinearEncoding:ls,LinearFilter:xn,LinearInterpolant:oM,LinearMipMapLinearFilter:vU,LinearMipMapNearestFilter:gU,LinearMipmapLinearFilter:nl,LinearMipmapNearestFilter:Nb,LinearSRGBColorSpace:ph,LinearToneMapping:MD,Loader:Wi,LoaderUtils:$w,LoadingManager:lM,LoopOnce:HD,LoopPingPong:jD,LoopRepeat:WD,LuminanceAlphaFormat:zD,LuminanceFormat:OD,MOUSE:cU,Material:gi,MaterialLoader:iy,MathUtils:Sn,Matrix3:Jn,Matrix4:Fe,MaxEquation:pw,Mesh:li,MeshBasicMaterial:mo,MeshDepthMaterial:Wb,MeshDistanceMaterial:jb,MeshLambertMaterial:DR,MeshMatcapMaterial:RR,MeshNormalMaterial:IR,MeshPhongMaterial:PR,MeshPhysicalMaterial:CR,MeshStandardMaterial:iM,MeshToonMaterial:LR,MinEquation:fw,MirroredRepeatWrapping:Gf,MixOperation:SD,MultiplyBlending:dw,MultiplyOperation:vp,NearestFilter:Nn,NearestMipMapLinearFilter:mU,NearestMipMapNearestFilter:pU,NearestMipmapLinearFilter:df,NearestMipmapNearestFilter:Q0,NeverDepth:mD,NeverStencilFunc:PU,NoBlending:$o,NoColorSpace:wU,NoToneMapping:Ps,NormalAnimationBlendMode:qv,NormalBlending:su,NotEqualDepth:wD,NotEqualStencilFunc:OU,NumberKeyframeTrack:Qf,Object3D:Pt,ObjectLoader:ZG,ObjectSpaceNormalMap:XD,OctahedronBufferGeometry:YH,OctahedronGeometry:zh,OneFactor:aD,OneMinusDstAlphaFactor:hD,OneMinusDstColorFactor:fD,OneMinusSrcAlphaFactor:Ob,OneMinusSrcColorFactor:uD,OrthographicCamera:ia,PCFShadowMap:jv,PCFSoftShadowMap:hf,PMREMGenerator:Fw,Path:wu,PerspectiveCamera:Un,Plane:Bo,PlaneBufferGeometry:ZH,PlaneGeometry:dl,PlaneHelper:RH,PointLight:dM,PointLightHelper:ZR,Points:vR,PointsMaterial:Zb,PolarGridHelper:IH,PolyhedronBufferGeometry:JH,PolyhedronGeometry:aa,PositionalAudio:oH,PropertyBinding:kt,PropertyMixer:jR,QuadraticBezierCurve:ra,QuadraticBezierCurve3:eM,Quaternion:Ti,QuaternionKeyframeTrack:kh,QuaternionLinearInterpolant:BR,RED_GREEN_RGTC2_Format:Nw,RED_RGTC1_Format:GD,REVISION:Wv,RGBADepthPacking:qD,RGBAFormat:Ji,RGBAIntegerFormat:FD,RGBA_ASTC_10x10_Format:Dw,RGBA_ASTC_10x5_Format:Pw,RGBA_ASTC_10x6_Format:Lw,RGBA_ASTC_10x8_Format:Iw,RGBA_ASTC_12x10_Format:Rw,RGBA_ASTC_12x12_Format:Ow,RGBA_ASTC_4x4_Format:ww,RGBA_ASTC_5x4_Format:Sw,RGBA_ASTC_5x5_Format:bw,RGBA_ASTC_6x5_Format:Mw,RGBA_ASTC_6x6_Format:Ew,RGBA_ASTC_8x5_Format:Aw,RGBA_ASTC_8x6_Format:Tw,RGBA_ASTC_8x8_Format:Cw,RGBA_BPTC_Format:v0,RGBA_ETC2_EAC_Format:_w,RGBA_PVRTC_2BPPV1_Format:yw,RGBA_PVRTC_4BPPV1_Format:vw,RGBA_S3TC_DXT1_Format:p0,RGBA_S3TC_DXT3_Format:m0,RGBA_S3TC_DXT5_Format:g0,RGB_ETC1_Format:VD,RGB_ETC2_Format:xw,RGB_PVRTC_2BPPV1_Format:gw,RGB_PVRTC_4BPPV1_Format:mw,RGB_S3TC_DXT1_Format:f0,RGFormat:BD,RGIntegerFormat:UD,RawShaderMaterial:TR,Ray:hl,Raycaster:xM,RectAreaLight:VR,RedFormat:ND,RedIntegerFormat:kD,ReinhardToneMapping:ED,RepeatWrapping:Vf,ReplaceStencilOp:bU,ReverseSubtractEquation:sD,RingBufferGeometry:KH,RingGeometry:bp,SIGNED_RED_GREEN_RGTC2_Format:kw,SIGNED_RED_RGTC1_Format:zw,SRGBColorSpace:Ms,Scene:Yf,ShaderChunk:Et,ShaderLib:Zr,ShaderMaterial:zs,ShadowMaterial:AR,Shape:Ls,ShapeBufferGeometry:QH,ShapeGeometry:Mp,ShapePath:zH,ShapeUtils:Is,ShortType:PD,Skeleton:Qv,SkeletonHelper:TH,SkinnedMesh:pR,Source:Ql,Sphere:Mr,SphereBufferGeometry:eW,SphereGeometry:Du,Spherical:EH,SphericalHarmonics3:GR,SplineCurve:ey,SpotLight:hM,SpotLightHelper:XR,Sprite:dR,SpriteMaterial:Xb,SrcAlphaFactor:Rb,SrcAlphaSaturateFactor:pD,SrcColorFactor:lD,StaticCopyUsage:VU,StaticDrawUsage:$f,StaticReadUsage:BU,StereoCamera:nH,StreamCopyUsage:HU,StreamDrawUsage:kU,StreamReadUsage:FU,StringKeyframeTrack:Ou,SubtractEquation:rD,SubtractiveBlending:hw,TOUCH:hU,TangentSpaceNormalMap:cl,TetrahedronBufferGeometry:tW,TetrahedronGeometry:Ep,Texture:gn,TextureLoader:$G,TorusBufferGeometry:nW,TorusGeometry:Ap,TorusKnotBufferGeometry:iW,TorusKnotGeometry:Nh,Triangle:Ui,TriangleFanDrawMode:_U,TriangleStripDrawMode:xU,TrianglesDrawMode:yU,TubeBufferGeometry:rW,TubeGeometry:Tp,TwoPassDoubleSide:fU,UVMapping:$v,Uint16BufferAttribute:Gb,Uint32BufferAttribute:Zc,Uint8BufferAttribute:yF,Uint8ClampedBufferAttribute:xF,Uniform:yM,UniformsGroup:SH,UniformsLib:ke,UniformsUtils:Pu,UnsignedByteType:na,UnsignedInt248Type:ou,UnsignedIntType:Ra,UnsignedShort4444Type:ID,UnsignedShort5551Type:DD,UnsignedShortType:kb,VSMShadowMap:Zl,Vector2:te,Vector3:R,Vector4:_t,VectorKeyframeTrack:ep,VideoTexture:yR,WebGL1Renderer:cR,WebGL3DRenderTarget:aF,WebGLArrayRenderTarget:oF,WebGLCubeRenderTarget:nR,WebGLMultipleRenderTargets:lF,WebGLRenderTarget:us,WebGLRenderer:qb,WebGLUtils:lR,WireframeGeometry:ER,WrapAroundEnding:jf,ZeroCurvatureEnding:Jl,ZeroFactor:oD,ZeroSlopeEnding:Kl,ZeroStencilOp:SU,_SRGBAFormat:ev,sRGBEncoding:jt},Symbol.toStringTag,{value:"Module"}));var za={},oW={get exports(){return za},set exports(t){za=t}},zu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */zu.ConcurrentRoot=1;zu.ContinuousEventPriority=4;zu.DefaultEventPriority=16;zu.DiscreteEventPriority=1;zu.IdleEventPriority=536870912;zu.LegacyRoot=0;(function(t){t.exports=zu})(oW);function aW(t){let e;const n=new Set,i=(u,d)=>{const c=typeof u=="function"?u(e):u;if(c!==e){const h=e;e=d?c:Object.assign({},e,c),n.forEach(m=>m(e,h))}},r=()=>e,s=(u,d=r,c=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=d(e);function m(){const g=d(e);if(!c(h,g)){const v=h;u(h=g,v)}}return n.add(m),()=>n.delete(m)},l={setState:i,getState:r,subscribe:(u,d,c)=>d||c?s(u,d,c):(n.add(u),()=>n.delete(u)),destroy:()=>n.clear()};return e=t(i,r,l),l}const lW=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),bT=lW?Ce.useEffect:Ce.useLayoutEffect;function uW(t){const e=typeof t=="function"?aW(t):t,n=(i=e.getState,r=Object.is)=>{const[,s]=Ce.useReducer(x=>x+1,0),o=e.getState(),a=Ce.useRef(o),l=Ce.useRef(i),u=Ce.useRef(r),d=Ce.useRef(!1),c=Ce.useRef();c.current===void 0&&(c.current=i(o));let h,m=!1;(a.current!==o||l.current!==i||u.current!==r||d.current)&&(h=i(o),m=!r(c.current,h)),bT(()=>{m&&(c.current=h),a.current=o,l.current=i,u.current=r,d.current=!1});const g=Ce.useRef(o);bT(()=>{const x=()=>{try{const _=e.getState(),S=l.current(_);u.current(c.current,S)||(a.current=_,c.current=S,s())}catch{d.current=!0,s()}},y=e.subscribe(x);return e.getState()!==g.current&&x(),y},[]);const v=m?h:c.current;return Ce.useDebugValue(v),v};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}var Xw={},cW={get exports(){return Xw},set exports(t){Xw=t}},sp={},hW={get exports(){return sp},set exports(t){sp=t}},QR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,V){var U=z.length;z.push(V);e:for(;0<U;){var X=U-1>>>1,N=z[X];if(0<r(N,V))z[X]=V,z[U]=N,U=X;else break e}}function n(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var V=z[0],U=z.pop();if(U!==V){z[0]=U;e:for(var X=0,N=z.length,q=N>>>1;X<q;){var Y=2*(X+1)-1,ee=z[Y],W=Y+1,se=z[W];if(0>r(ee,U))W<N&&0>r(se,ee)?(z[X]=se,z[W]=U,X=W):(z[X]=ee,z[Y]=U,X=Y);else if(W<N&&0>r(se,U))z[X]=se,z[W]=U,X=W;else break e}}return V}function r(z,V){var U=z.sortIndex-V.sortIndex;return U!==0?U:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,c=null,h=3,m=!1,g=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(z){for(var V=n(u);V!==null;){if(V.callback===null)i(u);else if(V.startTime<=z)i(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(z){if(v=!1,S(z),!g)if(n(l)!==null)g=!0,ne(T);else{var V=n(u);V!==null&&J(b,V.startTime-z)}}function T(z,V){g=!1,v&&(v=!1,y(A),A=-1),m=!0;var U=h;try{for(S(V),c=n(l);c!==null&&(!(c.expirationTime>V)||z&&!O());){var X=c.callback;if(typeof X=="function"){c.callback=null,h=c.priorityLevel;var N=X(c.expirationTime<=V);V=t.unstable_now(),typeof N=="function"?c.callback=N:c===n(l)&&i(l),S(V)}else i(l);c=n(l)}if(c!==null)var q=!0;else{var Y=n(u);Y!==null&&J(b,Y.startTime-V),q=!1}return q}finally{c=null,h=U,m=!1}}var E=!1,L=null,A=-1,I=5,P=-1;function O(){return!(t.unstable_now()-P<I)}function k(){if(L!==null){var z=t.unstable_now();P=z;var V=!0;try{V=L(!0,z)}finally{V?F():(E=!1,L=null)}}else E=!1}var F;if(typeof _=="function")F=function(){_(k)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=k,F=function(){Z.postMessage(null)}}else F=function(){x(k,0)};function ne(z){L=z,E||(E=!0,F())}function J(z,V){A=x(function(){z(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,ne(T))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(z){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var U=h;h=V;try{return z()}finally{h=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var U=h;h=z;try{return V()}finally{h=U}},t.unstable_scheduleCallback=function(z,V,U){var X=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?X+U:X):U=X,z){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=U+N,z={id:d++,callback:V,priorityLevel:z,startTime:U,expirationTime:N,sortIndex:-1},U>X?(z.sortIndex=U,e(u,z),n(l)===null&&z===n(u)&&(v?(y(A),A=-1):v=!0,J(b,U-X))):(z.sortIndex=N,e(l,z),g||m||(g=!0,ne(T))),z},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(z){var V=h;return function(){var U=h;h=V;try{return z.apply(this,arguments)}finally{h=U}}}})(QR);(function(t){t.exports=QR})(hW);/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dW=function(e){var n={},i=Ce,r=sp,s=Object.assign;function o(f){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+f,w=1;w<arguments.length;w++)p+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),g=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),S=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),T=Symbol.iterator;function E(f){return f===null||typeof f!="object"?null:(f=T&&f[T]||f["@@iterator"],typeof f=="function"?f:null)}function L(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case d:return"Fragment";case u:return"Portal";case h:return"Profiler";case c:return"StrictMode";case x:return"Suspense";case y:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case g:return(f.displayName||"Context")+".Consumer";case m:return(f._context.displayName||"Context")+".Provider";case v:var p=f.render;return f=f.displayName,f||(f=p.displayName||p.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case _:return p=f.displayName||null,p!==null?p:L(f.type)||"Memo";case S:p=f._payload,f=f._init;try{return L(f(p))}catch{}}return null}function A(f){var p=f.type;switch(f.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=p.render,f=f.displayName||f.name||"",p.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L(p);case 8:return p===c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function I(f){var p=f,w=f;if(f.alternate)for(;p.return;)p=p.return;else{f=p;do p=f,p.flags&4098&&(w=p.return),f=p.return;while(f)}return p.tag===3?w:null}function P(f){if(I(f)!==f)throw Error(o(188))}function O(f){var p=f.alternate;if(!p){if(p=I(f),p===null)throw Error(o(188));return p!==f?null:f}for(var w=f,M=p;;){var C=w.return;if(C===null)break;var D=C.alternate;if(D===null){if(M=C.return,M!==null){w=M;continue}break}if(C.child===D.child){for(D=C.child;D;){if(D===w)return P(C),f;if(D===M)return P(C),p;D=D.sibling}throw Error(o(188))}if(w.return!==M.return)w=C,M=D;else{for(var $=!1,ie=C.child;ie;){if(ie===w){$=!0,w=C,M=D;break}if(ie===M){$=!0,M=C,w=D;break}ie=ie.sibling}if(!$){for(ie=D.child;ie;){if(ie===w){$=!0,w=D,M=C;break}if(ie===M){$=!0,M=D,w=C;break}ie=ie.sibling}if(!$)throw Error(o(189))}}if(w.alternate!==M)throw Error(o(190))}if(w.tag!==3)throw Error(o(188));return w.stateNode.current===w?f:p}function k(f){return f=O(f),f!==null?F(f):null}function F(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var p=F(f);if(p!==null)return p;f=f.sibling}return null}function G(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var p=G(f);if(p!==null)return p}f=f.sibling}return null}var Z=Array.isArray,ne=e.getPublicInstance,J=e.getRootHostContext,z=e.getChildHostContext,V=e.prepareForCommit,U=e.resetAfterCommit,X=e.createInstance,N=e.appendInitialChild,q=e.finalizeInitialChildren,Y=e.prepareUpdate,ee=e.shouldSetTextContent,W=e.createTextInstance,se=e.scheduleTimeout,le=e.cancelTimeout,ae=e.noTimeout,ue=e.isPrimaryRenderer,fe=e.supportsMutation,K=e.supportsPersistence,Q=e.supportsHydration,he=e.getInstanceFromNode,ye=e.preparePortalMount,be=e.getCurrentEventPriority,Te=e.detachDeletedInstance,Le=e.supportsMicrotasks,ze=e.scheduleMicrotask,Ye=e.supportsTestSelectors,nt=e.findFiberRoot,H=e.getBoundingRect,B=e.getTextContent,ge=e.isHiddenSubtree,Pe=e.matchAccessibilityRole,Oe=e.setFocusIfFocusable,Be=e.setupIntersectionObserver,ht=e.appendChild,He=e.appendChildToContainer,Me=e.commitTextUpdate,We=e.commitMount,et=e.commitUpdate,Xe=e.insertBefore,ut=e.insertInContainerBefore,ot=e.removeChild,Lt=e.removeChildFromContainer,$t=e.resetTextContent,Mn=e.hideInstance,re=e.hideTextInstance,_e=e.unhideInstance,Ie=e.unhideTextInstance,Ue=e.clearContainer,tt=e.cloneInstance,Ot=e.createContainerChildSet,rn=e.appendChildToContainerChildSet,ei=e.finalizeContainerChildren,Fs=e.replaceContainerChildren,Kt=e.cloneHiddenInstance,Cr=e.cloneHiddenTextInstance,ji=e.canHydrateInstance,Np=e.canHydrateTextInstance,_y=e.canHydrateSuspenseInstance,kp=e.isSuspenseInstancePending,jh=e.isSuspenseInstanceFallback,j=e.registerSuspenseInstanceRetry,pe=e.getNextHydratableSibling,Se=e.getFirstHydratableChild,de=e.getFirstHydratableChildWithinContainer,Ae=e.getFirstHydratableChildWithinSuspenseInstance,ct=e.hydrateInstance,gt=e.hydrateTextInstance,St=e.hydrateSuspenseInstance,At=e.getNextHydratableInstanceAfterSuspenseInstance,zt=e.commitHydratedContainer,It=e.commitHydratedSuspenseInstance,Dt=e.clearSuspenseBoundary,En=e.clearSuspenseBoundaryFromContainer,Ii=e.shouldDeleteUnhydratedTailInstances,ds=e.didNotMatchHydratedContainerTextInstance,yo=e.didNotMatchHydratedTextInstance,fn;function bt(f){if(fn===void 0)try{throw Error()}catch(w){var p=w.stack.trim().match(/\n( *(at )?)/);fn=p&&p[1]||""}return`
`+fn+f}var ml=!1;function An(f,p){if(!f||ml)return"";ml=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Ne){var M=Ne}Reflect.construct(f,[],p)}else{try{p.call()}catch(Ne){M=Ne}f.call(p.prototype)}else{try{throw Error()}catch(Ne){M=Ne}f()}}catch(Ne){if(Ne&&M&&typeof Ne.stack=="string"){for(var C=Ne.stack.split(`
`),D=M.stack.split(`
`),$=C.length-1,ie=D.length-1;1<=$&&0<=ie&&C[$]!==D[ie];)ie--;for(;1<=$&&0<=ie;$--,ie--)if(C[$]!==D[ie]){if($!==1||ie!==1)do if($--,ie--,0>ie||C[$]!==D[ie]){var we=`
`+C[$].replace(" at new "," at ");return f.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",f.displayName)),we}while(1<=$&&0<=ie);break}}}finally{ml=!1,Error.prepareStackTrace=w}return(f=f?f.displayName||f.name:"")?bt(f):""}var xo=Object.prototype.hasOwnProperty,Fu=[],Pr=-1;function Lr(f){return{current:f}}function wt(f){0>Pr||(f.current=Fu[Pr],Fu[Pr]=null,Pr--)}function Nt(f,p){Pr++,Fu[Pr]=f.current,f.current=p}var Ir={},Ht=Lr(Ir),ti=Lr(!1),_o=Ir;function wo(f,p){var w=f.type.contextTypes;if(!w)return Ir;var M=f.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===p)return M.__reactInternalMemoizedMaskedChildContext;var C={},D;for(D in w)C[D]=p[D];return M&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=p,f.__reactInternalMemoizedMaskedChildContext=C),C}function $i(f){return f=f.childContextTypes,f!=null}function Bp(){wt(ti),wt(Ht)}function p2(f,p,w){if(Ht.current!==Ir)throw Error(o(168));Nt(Ht,p),Nt(ti,w)}function m2(f,p,w){var M=f.stateNode;if(p=p.childContextTypes,typeof M.getChildContext!="function")return w;M=M.getChildContext();for(var C in M)if(!(C in p))throw Error(o(108,A(f)||"Unknown",C));return s({},w,M)}function Up(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||Ir,_o=Ht.current,Nt(Ht,f),Nt(ti,ti.current),!0}function g2(f,p,w){var M=f.stateNode;if(!M)throw Error(o(169));w?(f=m2(f,p,_o),M.__reactInternalMemoizedMergedChildContext=f,wt(ti),wt(Ht),Nt(Ht,f)):wt(ti),Nt(ti,w)}var fs=Math.clz32?Math.clz32:$N,WN=Math.log,jN=Math.LN2;function $N(f){return f>>>=0,f===0?32:31-(WN(f)/jN|0)|0}var Fp=64,Vp=4194304;function $h(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function Gp(f,p){var w=f.pendingLanes;if(w===0)return 0;var M=0,C=f.suspendedLanes,D=f.pingedLanes,$=w&268435455;if($!==0){var ie=$&~C;ie!==0?M=$h(ie):(D&=$,D!==0&&(M=$h(D)))}else $=w&~C,$!==0?M=$h($):D!==0&&(M=$h(D));if(M===0)return 0;if(p!==0&&p!==M&&!(p&C)&&(C=M&-M,D=p&-p,C>=D||C===16&&(D&4194240)!==0))return p;if(M&4&&(M|=w&16),p=f.entangledLanes,p!==0)for(f=f.entanglements,p&=M;0<p;)w=31-fs(p),C=1<<w,M|=f[w],p&=~C;return M}function qN(f,p){switch(f){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XN(f,p){for(var w=f.suspendedLanes,M=f.pingedLanes,C=f.expirationTimes,D=f.pendingLanes;0<D;){var $=31-fs(D),ie=1<<$,we=C[$];we===-1?(!(ie&w)||ie&M)&&(C[$]=qN(ie,p)):we<=p&&(f.expiredLanes|=ie),D&=~ie}}function wy(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function Sy(f){for(var p=[],w=0;31>w;w++)p.push(f);return p}function qh(f,p,w){f.pendingLanes|=p,p!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,p=31-fs(p),f[p]=w}function YN(f,p){var w=f.pendingLanes&~p;f.pendingLanes=p,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=p,f.mutableReadLanes&=p,f.entangledLanes&=p,p=f.entanglements;var M=f.eventTimes;for(f=f.expirationTimes;0<w;){var C=31-fs(w),D=1<<C;p[C]=0,M[C]=-1,f[C]=-1,w&=~D}}function by(f,p){var w=f.entangledLanes|=p;for(f=f.entanglements;w;){var M=31-fs(w),C=1<<M;C&p|f[M]&p&&(f[M]|=p),w&=~C}}var Ut=0;function v2(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var My=r.unstable_scheduleCallback,y2=r.unstable_cancelCallback,ZN=r.unstable_shouldYield,JN=r.unstable_requestPaint,ni=r.unstable_now,Ey=r.unstable_ImmediatePriority,KN=r.unstable_UserBlockingPriority,Ay=r.unstable_NormalPriority,QN=r.unstable_IdlePriority,Hp=null,Vs=null;function e4(f){if(Vs&&typeof Vs.onCommitFiberRoot=="function")try{Vs.onCommitFiberRoot(Hp,f,void 0,(f.current.flags&128)===128)}catch{}}function t4(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var Gs=typeof Object.is=="function"?Object.is:t4,So=null,Wp=!1,Ty=!1;function x2(f){So===null?So=[f]:So.push(f)}function n4(f){Wp=!0,x2(f)}function Hs(){if(!Ty&&So!==null){Ty=!0;var f=0,p=Ut;try{var w=So;for(Ut=1;f<w.length;f++){var M=w[f];do M=M(!0);while(M!==null)}So=null,Wp=!1}catch(C){throw So!==null&&(So=So.slice(f+1)),My(Ey,Hs),C}finally{Ut=p,Ty=!1}}return null}var i4=a.ReactCurrentBatchConfig;function jp(f,p){if(Gs(f,p))return!0;if(typeof f!="object"||f===null||typeof p!="object"||p===null)return!1;var w=Object.keys(f),M=Object.keys(p);if(w.length!==M.length)return!1;for(M=0;M<w.length;M++){var C=w[M];if(!xo.call(p,C)||!Gs(f[C],p[C]))return!1}return!0}function r4(f){switch(f.tag){case 5:return bt(f.type);case 16:return bt("Lazy");case 13:return bt("Suspense");case 19:return bt("SuspenseList");case 0:case 2:case 15:return f=An(f.type,!1),f;case 11:return f=An(f.type.render,!1),f;case 1:return f=An(f.type,!0),f;default:return""}}function ps(f,p){if(f&&f.defaultProps){p=s({},p),f=f.defaultProps;for(var w in f)p[w]===void 0&&(p[w]=f[w]);return p}return p}var $p=Lr(null),qp=null,Vu=null,Cy=null;function Py(){Cy=Vu=qp=null}function _2(f,p,w){ue?(Nt($p,p._currentValue),p._currentValue=w):(Nt($p,p._currentValue2),p._currentValue2=w)}function Ly(f){var p=$p.current;wt($p),ue?f._currentValue=p:f._currentValue2=p}function Iy(f,p,w){for(;f!==null;){var M=f.alternate;if((f.childLanes&p)!==p?(f.childLanes|=p,M!==null&&(M.childLanes|=p)):M!==null&&(M.childLanes&p)!==p&&(M.childLanes|=p),f===w)break;f=f.return}}function Gu(f,p){qp=f,Cy=Vu=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&p&&(cr=!0),f.firstContext=null)}function Dr(f){var p=ue?f._currentValue:f._currentValue2;if(Cy!==f)if(f={context:f,memoizedValue:p,next:null},Vu===null){if(qp===null)throw Error(o(308));Vu=f,qp.dependencies={lanes:0,firstContext:f}}else Vu=Vu.next=f;return p}var Ws=null,ua=!1;function Dy(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w2(f,p){f=f.updateQueue,p.updateQueue===f&&(p.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function bo(f,p){return{eventTime:f,lane:p,tag:0,payload:null,callback:null,next:null}}function ca(f,p){var w=f.updateQueue;w!==null&&(w=w.shared,Fn!==null&&f.mode&1&&!(Tt&2)?(f=w.interleaved,f===null?(p.next=p,Ws===null?Ws=[w]:Ws.push(w)):(p.next=f.next,f.next=p),w.interleaved=p):(f=w.pending,f===null?p.next=p:(p.next=f.next,f.next=p),w.pending=p))}function Xp(f,p,w){if(p=p.updateQueue,p!==null&&(p=p.shared,(w&4194240)!==0)){var M=p.lanes;M&=f.pendingLanes,w|=M,p.lanes=w,by(f,w)}}function S2(f,p){var w=f.updateQueue,M=f.alternate;if(M!==null&&(M=M.updateQueue,w===M)){var C=null,D=null;if(w=w.firstBaseUpdate,w!==null){do{var $={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};D===null?C=D=$:D=D.next=$,w=w.next}while(w!==null);D===null?C=D=p:D=D.next=p}else C=D=p;w={baseState:M.baseState,firstBaseUpdate:C,lastBaseUpdate:D,shared:M.shared,effects:M.effects},f.updateQueue=w;return}f=w.lastBaseUpdate,f===null?w.firstBaseUpdate=p:f.next=p,w.lastBaseUpdate=p}function Yp(f,p,w,M){var C=f.updateQueue;ua=!1;var D=C.firstBaseUpdate,$=C.lastBaseUpdate,ie=C.shared.pending;if(ie!==null){C.shared.pending=null;var we=ie,Ne=we.next;we.next=null,$===null?D=Ne:$.next=Ne,$=we;var Ke=f.alternate;Ke!==null&&(Ke=Ke.updateQueue,ie=Ke.lastBaseUpdate,ie!==$&&(ie===null?Ke.firstBaseUpdate=Ne:ie.next=Ne,Ke.lastBaseUpdate=we))}if(D!==null){var yt=C.baseState;$=0,Ke=Ne=we=null,ie=D;do{var dt=ie.lane,Qt=ie.eventTime;if((M&dt)===dt){Ke!==null&&(Ke=Ke.next={eventTime:Qt,lane:0,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null});e:{var st=f,_i=ie;switch(dt=p,Qt=w,_i.tag){case 1:if(st=_i.payload,typeof st=="function"){yt=st.call(Qt,yt,dt);break e}yt=st;break e;case 3:st.flags=st.flags&-65537|128;case 0:if(st=_i.payload,dt=typeof st=="function"?st.call(Qt,yt,dt):st,dt==null)break e;yt=s({},yt,dt);break e;case 2:ua=!0}}ie.callback!==null&&ie.lane!==0&&(f.flags|=64,dt=C.effects,dt===null?C.effects=[ie]:dt.push(ie))}else Qt={eventTime:Qt,lane:dt,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},Ke===null?(Ne=Ke=Qt,we=yt):Ke=Ke.next=Qt,$|=dt;if(ie=ie.next,ie===null){if(ie=C.shared.pending,ie===null)break;dt=ie,ie=dt.next,dt.next=null,C.lastBaseUpdate=dt,C.shared.pending=null}}while(1);if(Ke===null&&(we=yt),C.baseState=we,C.firstBaseUpdate=Ne,C.lastBaseUpdate=Ke,p=C.shared.interleaved,p!==null){C=p;do $|=C.lane,C=C.next;while(C!==p)}else D===null&&(C.shared.lanes=0);Ju|=$,f.lanes=$,f.memoizedState=yt}}function b2(f,p,w){if(f=p.effects,p.effects=null,f!==null)for(p=0;p<f.length;p++){var M=f[p],C=M.callback;if(C!==null){if(M.callback=null,M=w,typeof C!="function")throw Error(o(191,C));C.call(M)}}}var M2=new i.Component().refs;function Ry(f,p,w,M){p=f.memoizedState,w=w(M,p),w=w==null?p:s({},p,w),f.memoizedState=w,f.lanes===0&&(f.updateQueue.baseState=w)}var Zp={isMounted:function(f){return(f=f._reactInternals)?I(f)===f:!1},enqueueSetState:function(f,p,w){f=f._reactInternals;var M=Ri(),C=fa(f),D=bo(M,C);D.payload=p,w!=null&&(D.callback=w),ca(f,D),p=kr(f,C,M),p!==null&&Xp(p,f,C)},enqueueReplaceState:function(f,p,w){f=f._reactInternals;var M=Ri(),C=fa(f),D=bo(M,C);D.tag=1,D.payload=p,w!=null&&(D.callback=w),ca(f,D),p=kr(f,C,M),p!==null&&Xp(p,f,C)},enqueueForceUpdate:function(f,p){f=f._reactInternals;var w=Ri(),M=fa(f),C=bo(w,M);C.tag=2,p!=null&&(C.callback=p),ca(f,C),p=kr(f,M,w),p!==null&&Xp(p,f,M)}};function E2(f,p,w,M,C,D,$){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(M,D,$):p.prototype&&p.prototype.isPureReactComponent?!jp(w,M)||!jp(C,D):!0}function A2(f,p,w){var M=!1,C=Ir,D=p.contextType;return typeof D=="object"&&D!==null?D=Dr(D):(C=$i(p)?_o:Ht.current,M=p.contextTypes,D=(M=M!=null)?wo(f,C):Ir),p=new p(w,D),f.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Zp,f.stateNode=p,p._reactInternals=f,M&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=C,f.__reactInternalMemoizedMaskedChildContext=D),p}function T2(f,p,w,M){f=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(w,M),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(w,M),p.state!==f&&Zp.enqueueReplaceState(p,p.state,null)}function Oy(f,p,w,M){var C=f.stateNode;C.props=w,C.state=f.memoizedState,C.refs=M2,Dy(f);var D=p.contextType;typeof D=="object"&&D!==null?C.context=Dr(D):(D=$i(p)?_o:Ht.current,C.context=wo(f,D)),C.state=f.memoizedState,D=p.getDerivedStateFromProps,typeof D=="function"&&(Ry(f,p,D,w),C.state=f.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(p=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),p!==C.state&&Zp.enqueueReplaceState(C,C.state,null),Yp(f,w,C,M),C.state=f.memoizedState),typeof C.componentDidMount=="function"&&(f.flags|=4194308)}var Hu=[],Wu=0,Jp=null,Kp=0,Rr=[],Or=0,gl=null,Mo=1,Eo="";function vl(f,p){Hu[Wu++]=Kp,Hu[Wu++]=Jp,Jp=f,Kp=p}function C2(f,p,w){Rr[Or++]=Mo,Rr[Or++]=Eo,Rr[Or++]=gl,gl=f;var M=Mo;f=Eo;var C=32-fs(M)-1;M&=~(1<<C),w+=1;var D=32-fs(p)+C;if(30<D){var $=C-C%5;D=(M&(1<<$)-1).toString(32),M>>=$,C-=$,Mo=1<<32-fs(p)+C|w<<C|M,Eo=D+f}else Mo=1<<D|w<<C|M,Eo=f}function zy(f){f.return!==null&&(vl(f,1),C2(f,1,0))}function Ny(f){for(;f===Jp;)Jp=Hu[--Wu],Hu[Wu]=null,Kp=Hu[--Wu],Hu[Wu]=null;for(;f===gl;)gl=Rr[--Or],Rr[Or]=null,Eo=Rr[--Or],Rr[Or]=null,Mo=Rr[--Or],Rr[Or]=null}var lr=null,ur=null,pn=!1,Xh=!1,ms=null;function P2(f,p){var w=Br(5,null,null,0);w.elementType="DELETED",w.stateNode=p,w.return=f,p=f.deletions,p===null?(f.deletions=[w],f.flags|=16):p.push(w)}function L2(f,p){switch(f.tag){case 5:return p=ji(p,f.type,f.pendingProps),p!==null?(f.stateNode=p,lr=f,ur=Se(p),!0):!1;case 6:return p=Np(p,f.pendingProps),p!==null?(f.stateNode=p,lr=f,ur=null,!0):!1;case 13:if(p=_y(p),p!==null){var w=gl!==null?{id:Mo,overflow:Eo}:null;return f.memoizedState={dehydrated:p,treeContext:w,retryLane:1073741824},w=Br(18,null,null,0),w.stateNode=p,w.return=f,f.child=w,lr=f,ur=null,!0}return!1;default:return!1}}function ky(f){return(f.mode&1)!==0&&(f.flags&128)===0}function By(f){if(pn){var p=ur;if(p){var w=p;if(!L2(f,p)){if(ky(f))throw Error(o(418));p=pe(w);var M=lr;p&&L2(f,p)?P2(M,w):(f.flags=f.flags&-4097|2,pn=!1,lr=f)}}else{if(ky(f))throw Error(o(418));f.flags=f.flags&-4097|2,pn=!1,lr=f}}}function I2(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;lr=f}function Yh(f){if(!Q||f!==lr)return!1;if(!pn)return I2(f),pn=!0,!1;if(f.tag!==3&&(f.tag!==5||Ii(f.type)&&!ee(f.type,f.memoizedProps))){var p=ur;if(p){if(ky(f)){for(f=ur;f;)f=pe(f);throw Error(o(418))}for(;p;)P2(f,p),p=pe(p)}}if(I2(f),f.tag===13){if(!Q)throw Error(o(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));ur=At(f)}else ur=lr?pe(f.stateNode):null;return!0}function ju(){Q&&(ur=lr=null,Xh=pn=!1)}function Uy(f){ms===null?ms=[f]:ms.push(f)}function Zh(f,p,w){if(f=w.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(o(309));var M=w.stateNode}if(!M)throw Error(o(147,f));var C=M,D=""+f;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===D?p.ref:(p=function($){var ie=C.refs;ie===M2&&(ie=C.refs={}),$===null?delete ie[D]:ie[D]=$},p._stringRef=D,p)}if(typeof f!="string")throw Error(o(284));if(!w._owner)throw Error(o(290,f))}return f}function Qp(f,p){throw f=Object.prototype.toString.call(p),Error(o(31,f==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":f))}function D2(f){var p=f._init;return p(f._payload)}function R2(f){function p(me,oe){if(f){var xe=me.deletions;xe===null?(me.deletions=[oe],me.flags|=16):xe.push(oe)}}function w(me,oe){if(!f)return null;for(;oe!==null;)p(me,oe),oe=oe.sibling;return null}function M(me,oe){for(me=new Map;oe!==null;)oe.key!==null?me.set(oe.key,oe):me.set(oe.index,oe),oe=oe.sibling;return me}function C(me,oe){return me=ma(me,oe),me.index=0,me.sibling=null,me}function D(me,oe,xe){return me.index=xe,f?(xe=me.alternate,xe!==null?(xe=xe.index,xe<oe?(me.flags|=2,oe):xe):(me.flags|=2,oe)):(me.flags|=1048576,oe)}function $(me){return f&&me.alternate===null&&(me.flags|=2),me}function ie(me,oe,xe,$e){return oe===null||oe.tag!==6?(oe=S1(xe,me.mode,$e),oe.return=me,oe):(oe=C(oe,xe),oe.return=me,oe)}function we(me,oe,xe,$e){var rt=xe.type;return rt===d?Ke(me,oe,xe.props.children,$e,xe.key):oe!==null&&(oe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===S&&D2(rt)===oe.type)?($e=C(oe,xe.props),$e.ref=Zh(me,oe,xe),$e.return=me,$e):($e=Lm(xe.type,xe.key,xe.props,null,me.mode,$e),$e.ref=Zh(me,oe,xe),$e.return=me,$e)}function Ne(me,oe,xe,$e){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==xe.containerInfo||oe.stateNode.implementation!==xe.implementation?(oe=b1(xe,me.mode,$e),oe.return=me,oe):(oe=C(oe,xe.children||[]),oe.return=me,oe)}function Ke(me,oe,xe,$e,rt){return oe===null||oe.tag!==7?(oe=Ml(xe,me.mode,$e,rt),oe.return=me,oe):(oe=C(oe,xe),oe.return=me,oe)}function yt(me,oe,xe){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=S1(""+oe,me.mode,xe),oe.return=me,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case l:return xe=Lm(oe.type,oe.key,oe.props,null,me.mode,xe),xe.ref=Zh(me,null,oe),xe.return=me,xe;case u:return oe=b1(oe,me.mode,xe),oe.return=me,oe;case S:var $e=oe._init;return yt(me,$e(oe._payload),xe)}if(Z(oe)||E(oe))return oe=Ml(oe,me.mode,xe,null),oe.return=me,oe;Qp(me,oe)}return null}function dt(me,oe,xe,$e){var rt=oe!==null?oe.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number")return rt!==null?null:ie(me,oe,""+xe,$e);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case l:return xe.key===rt?we(me,oe,xe,$e):null;case u:return xe.key===rt?Ne(me,oe,xe,$e):null;case S:return rt=xe._init,dt(me,oe,rt(xe._payload),$e)}if(Z(xe)||E(xe))return rt!==null?null:Ke(me,oe,xe,$e,null);Qp(me,xe)}return null}function Qt(me,oe,xe,$e,rt){if(typeof $e=="string"&&$e!==""||typeof $e=="number")return me=me.get(xe)||null,ie(oe,me,""+$e,rt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case l:return me=me.get($e.key===null?xe:$e.key)||null,we(oe,me,$e,rt);case u:return me=me.get($e.key===null?xe:$e.key)||null,Ne(oe,me,$e,rt);case S:var Mt=$e._init;return Qt(me,oe,xe,Mt($e._payload),rt)}if(Z($e)||E($e))return me=me.get(xe)||null,Ke(oe,me,$e,rt,null);Qp(oe,$e)}return null}function st(me,oe,xe,$e){for(var rt=null,Mt=null,xt=oe,Ft=oe=0,ri=null;xt!==null&&Ft<xe.length;Ft++){xt.index>Ft?(ri=xt,xt=null):ri=xt.sibling;var Vt=dt(me,xt,xe[Ft],$e);if(Vt===null){xt===null&&(xt=ri);break}f&&xt&&Vt.alternate===null&&p(me,xt),oe=D(Vt,oe,Ft),Mt===null?rt=Vt:Mt.sibling=Vt,Mt=Vt,xt=ri}if(Ft===xe.length)return w(me,xt),pn&&vl(me,Ft),rt;if(xt===null){for(;Ft<xe.length;Ft++)xt=yt(me,xe[Ft],$e),xt!==null&&(oe=D(xt,oe,Ft),Mt===null?rt=xt:Mt.sibling=xt,Mt=xt);return pn&&vl(me,Ft),rt}for(xt=M(me,xt);Ft<xe.length;Ft++)ri=Qt(xt,me,Ft,xe[Ft],$e),ri!==null&&(f&&ri.alternate!==null&&xt.delete(ri.key===null?Ft:ri.key),oe=D(ri,oe,Ft),Mt===null?rt=ri:Mt.sibling=ri,Mt=ri);return f&&xt.forEach(function(ga){return p(me,ga)}),pn&&vl(me,Ft),rt}function _i(me,oe,xe,$e){var rt=E(xe);if(typeof rt!="function")throw Error(o(150));if(xe=rt.call(xe),xe==null)throw Error(o(151));for(var Mt=rt=null,xt=oe,Ft=oe=0,ri=null,Vt=xe.next();xt!==null&&!Vt.done;Ft++,Vt=xe.next()){xt.index>Ft?(ri=xt,xt=null):ri=xt.sibling;var ga=dt(me,xt,Vt.value,$e);if(ga===null){xt===null&&(xt=ri);break}f&&xt&&ga.alternate===null&&p(me,xt),oe=D(ga,oe,Ft),Mt===null?rt=ga:Mt.sibling=ga,Mt=ga,xt=ri}if(Vt.done)return w(me,xt),pn&&vl(me,Ft),rt;if(xt===null){for(;!Vt.done;Ft++,Vt=xe.next())Vt=yt(me,Vt.value,$e),Vt!==null&&(oe=D(Vt,oe,Ft),Mt===null?rt=Vt:Mt.sibling=Vt,Mt=Vt);return pn&&vl(me,Ft),rt}for(xt=M(me,xt);!Vt.done;Ft++,Vt=xe.next())Vt=Qt(xt,me,Ft,Vt.value,$e),Vt!==null&&(f&&Vt.alternate!==null&&xt.delete(Vt.key===null?Ft:Vt.key),oe=D(Vt,oe,Ft),Mt===null?rt=Vt:Mt.sibling=Vt,Mt=Vt);return f&&xt.forEach(function(O4){return p(me,O4)}),pn&&vl(me,Ft),rt}function Ur(me,oe,xe,$e){if(typeof xe=="object"&&xe!==null&&xe.type===d&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case l:e:{for(var rt=xe.key,Mt=oe;Mt!==null;){if(Mt.key===rt){if(rt=xe.type,rt===d){if(Mt.tag===7){w(me,Mt.sibling),oe=C(Mt,xe.props.children),oe.return=me,me=oe;break e}}else if(Mt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===S&&D2(rt)===Mt.type){w(me,Mt.sibling),oe=C(Mt,xe.props),oe.ref=Zh(me,Mt,xe),oe.return=me,me=oe;break e}w(me,Mt);break}else p(me,Mt);Mt=Mt.sibling}xe.type===d?(oe=Ml(xe.props.children,me.mode,$e,xe.key),oe.return=me,me=oe):($e=Lm(xe.type,xe.key,xe.props,null,me.mode,$e),$e.ref=Zh(me,oe,xe),$e.return=me,me=$e)}return $(me);case u:e:{for(Mt=xe.key;oe!==null;){if(oe.key===Mt)if(oe.tag===4&&oe.stateNode.containerInfo===xe.containerInfo&&oe.stateNode.implementation===xe.implementation){w(me,oe.sibling),oe=C(oe,xe.children||[]),oe.return=me,me=oe;break e}else{w(me,oe);break}else p(me,oe);oe=oe.sibling}oe=b1(xe,me.mode,$e),oe.return=me,me=oe}return $(me);case S:return Mt=xe._init,Ur(me,oe,Mt(xe._payload),$e)}if(Z(xe))return st(me,oe,xe,$e);if(E(xe))return _i(me,oe,xe,$e);Qp(me,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"?(xe=""+xe,oe!==null&&oe.tag===6?(w(me,oe.sibling),oe=C(oe,xe),oe.return=me,me=oe):(w(me,oe),oe=S1(xe,me.mode,$e),oe.return=me,me=oe),$(me)):w(me,oe)}return Ur}var $u=R2(!0),O2=R2(!1),Jh={},zr=Lr(Jh),Kh=Lr(Jh),qu=Lr(Jh);function js(f){if(f===Jh)throw Error(o(174));return f}function Fy(f,p){Nt(qu,p),Nt(Kh,f),Nt(zr,Jh),f=J(p),wt(zr),Nt(zr,f)}function Xu(){wt(zr),wt(Kh),wt(qu)}function z2(f){var p=js(qu.current),w=js(zr.current);p=z(w,f.type,p),w!==p&&(Nt(Kh,f),Nt(zr,p))}function Vy(f){Kh.current===f&&(wt(zr),wt(Kh))}var vn=Lr(0);function em(f){for(var p=f;p!==null;){if(p.tag===13){var w=p.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||kp(w)||jh(w)))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if(p.flags&128)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Gy=[];function Hy(){for(var f=0;f<Gy.length;f++){var p=Gy[f];ue?p._workInProgressVersionPrimary=null:p._workInProgressVersionSecondary=null}Gy.length=0}var tm=a.ReactCurrentDispatcher,Nr=a.ReactCurrentBatchConfig,Yu=0,Tn=null,vi=null,ii=null,nm=!1,Qh=!1,ed=0,s4=0;function yi(){throw Error(o(321))}function Wy(f,p){if(p===null)return!1;for(var w=0;w<p.length&&w<f.length;w++)if(!Gs(f[w],p[w]))return!1;return!0}function jy(f,p,w,M,C,D){if(Yu=D,Tn=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,tm.current=f===null||f.memoizedState===null?u4:c4,f=w(M,C),Qh){D=0;do{if(Qh=!1,ed=0,25<=D)throw Error(o(301));D+=1,ii=vi=null,p.updateQueue=null,tm.current=h4,f=w(M,C)}while(Qh)}if(tm.current=am,p=vi!==null&&vi.next!==null,Yu=0,ii=vi=Tn=null,nm=!1,p)throw Error(o(300));return f}function $y(){var f=ed!==0;return ed=0,f}function Ao(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ii===null?Tn.memoizedState=ii=f:ii=ii.next=f,ii}function $s(){if(vi===null){var f=Tn.alternate;f=f!==null?f.memoizedState:null}else f=vi.next;var p=ii===null?Tn.memoizedState:ii.next;if(p!==null)ii=p,vi=f;else{if(f===null)throw Error(o(310));vi=f,f={memoizedState:vi.memoizedState,baseState:vi.baseState,baseQueue:vi.baseQueue,queue:vi.queue,next:null},ii===null?Tn.memoizedState=ii=f:ii=ii.next=f}return ii}function yl(f,p){return typeof p=="function"?p(f):p}function im(f){var p=$s(),w=p.queue;if(w===null)throw Error(o(311));w.lastRenderedReducer=f;var M=vi,C=M.baseQueue,D=w.pending;if(D!==null){if(C!==null){var $=C.next;C.next=D.next,D.next=$}M.baseQueue=C=D,w.pending=null}if(C!==null){D=C.next,M=M.baseState;var ie=$=null,we=null,Ne=D;do{var Ke=Ne.lane;if((Yu&Ke)===Ke)we!==null&&(we=we.next={lane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),M=Ne.hasEagerState?Ne.eagerState:f(M,Ne.action);else{var yt={lane:Ke,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null};we===null?(ie=we=yt,$=M):we=we.next=yt,Tn.lanes|=Ke,Ju|=Ke}Ne=Ne.next}while(Ne!==null&&Ne!==D);we===null?$=M:we.next=ie,Gs(M,p.memoizedState)||(cr=!0),p.memoizedState=M,p.baseState=$,p.baseQueue=we,w.lastRenderedState=M}if(f=w.interleaved,f!==null){C=f;do D=C.lane,Tn.lanes|=D,Ju|=D,C=C.next;while(C!==f)}else C===null&&(w.lanes=0);return[p.memoizedState,w.dispatch]}function rm(f){var p=$s(),w=p.queue;if(w===null)throw Error(o(311));w.lastRenderedReducer=f;var M=w.dispatch,C=w.pending,D=p.memoizedState;if(C!==null){w.pending=null;var $=C=C.next;do D=f(D,$.action),$=$.next;while($!==C);Gs(D,p.memoizedState)||(cr=!0),p.memoizedState=D,p.baseQueue===null&&(p.baseState=D),w.lastRenderedState=D}return[D,M]}function N2(){}function k2(f,p){var w=Tn,M=$s(),C=p(),D=!Gs(M.memoizedState,C);if(D&&(M.memoizedState=C,cr=!0),M=M.queue,nd(F2.bind(null,w,M,f),[f]),M.getSnapshot!==p||D||ii!==null&&ii.memoizedState.tag&1){if(w.flags|=2048,td(9,U2.bind(null,w,M,C,p),void 0,null),Fn===null)throw Error(o(349));Yu&30||B2(w,p,C)}return C}function B2(f,p,w){f.flags|=16384,f={getSnapshot:p,value:w},p=Tn.updateQueue,p===null?(p={lastEffect:null,stores:null},Tn.updateQueue=p,p.stores=[f]):(w=p.stores,w===null?p.stores=[f]:w.push(f))}function U2(f,p,w,M){p.value=w,p.getSnapshot=M,V2(p)&&kr(f,1,-1)}function F2(f,p,w){return w(function(){V2(p)&&kr(f,1,-1)})}function V2(f){var p=f.getSnapshot;f=f.value;try{var w=p();return!Gs(f,w)}catch{return!0}}function qy(f){var p=Ao();return typeof f=="function"&&(f=f()),p.memoizedState=p.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:f},p.queue=f,f=f.dispatch=l4.bind(null,Tn,f),[p.memoizedState,f]}function td(f,p,w,M){return f={tag:f,create:p,destroy:w,deps:M,next:null},p=Tn.updateQueue,p===null?(p={lastEffect:null,stores:null},Tn.updateQueue=p,p.lastEffect=f.next=f):(w=p.lastEffect,w===null?p.lastEffect=f.next=f:(M=w.next,w.next=f,f.next=M,p.lastEffect=f)),f}function G2(){return $s().memoizedState}function sm(f,p,w,M){var C=Ao();Tn.flags|=f,C.memoizedState=td(1|p,w,void 0,M===void 0?null:M)}function om(f,p,w,M){var C=$s();M=M===void 0?null:M;var D=void 0;if(vi!==null){var $=vi.memoizedState;if(D=$.destroy,M!==null&&Wy(M,$.deps)){C.memoizedState=td(p,w,D,M);return}}Tn.flags|=f,C.memoizedState=td(1|p,w,D,M)}function Xy(f,p){return sm(8390656,8,f,p)}function nd(f,p){return om(2048,8,f,p)}function H2(f,p){return om(4,2,f,p)}function W2(f,p){return om(4,4,f,p)}function j2(f,p){if(typeof p=="function")return f=f(),p(f),function(){p(null)};if(p!=null)return f=f(),p.current=f,function(){p.current=null}}function $2(f,p,w){return w=w!=null?w.concat([f]):null,om(4,4,j2.bind(null,p,f),w)}function Yy(){}function q2(f,p){var w=$s();p=p===void 0?null:p;var M=w.memoizedState;return M!==null&&p!==null&&Wy(p,M[1])?M[0]:(w.memoizedState=[f,p],f)}function X2(f,p){var w=$s();p=p===void 0?null:p;var M=w.memoizedState;return M!==null&&p!==null&&Wy(p,M[1])?M[0]:(f=f(),w.memoizedState=[f,p],f)}function o4(f,p){var w=Ut;Ut=w!==0&&4>w?w:4,f(!0);var M=Nr.transition;Nr.transition={};try{f(!1),p()}finally{Ut=w,Nr.transition=M}}function Y2(){return $s().memoizedState}function a4(f,p,w){var M=fa(f);w={lane:M,action:w,hasEagerState:!1,eagerState:null,next:null},Z2(f)?J2(p,w):(K2(f,p,w),w=Ri(),f=kr(f,M,w),f!==null&&Q2(f,p,M))}function l4(f,p,w){var M=fa(f),C={lane:M,action:w,hasEagerState:!1,eagerState:null,next:null};if(Z2(f))J2(p,C);else{K2(f,p,C);var D=f.alternate;if(f.lanes===0&&(D===null||D.lanes===0)&&(D=p.lastRenderedReducer,D!==null))try{var $=p.lastRenderedState,ie=D($,w);if(C.hasEagerState=!0,C.eagerState=ie,Gs(ie,$))return}catch{}finally{}w=Ri(),f=kr(f,M,w),f!==null&&Q2(f,p,M)}}function Z2(f){var p=f.alternate;return f===Tn||p!==null&&p===Tn}function J2(f,p){Qh=nm=!0;var w=f.pending;w===null?p.next=p:(p.next=w.next,w.next=p),f.pending=p}function K2(f,p,w){Fn!==null&&f.mode&1&&!(Tt&2)?(f=p.interleaved,f===null?(w.next=w,Ws===null?Ws=[p]:Ws.push(p)):(w.next=f.next,f.next=w),p.interleaved=w):(f=p.pending,f===null?w.next=w:(w.next=f.next,f.next=w),p.pending=w)}function Q2(f,p,w){if(w&4194240){var M=p.lanes;M&=f.pendingLanes,w|=M,p.lanes=w,by(f,w)}}var am={readContext:Dr,useCallback:yi,useContext:yi,useEffect:yi,useImperativeHandle:yi,useInsertionEffect:yi,useLayoutEffect:yi,useMemo:yi,useReducer:yi,useRef:yi,useState:yi,useDebugValue:yi,useDeferredValue:yi,useTransition:yi,useMutableSource:yi,useSyncExternalStore:yi,useId:yi,unstable_isNewReconciler:!1},u4={readContext:Dr,useCallback:function(f,p){return Ao().memoizedState=[f,p===void 0?null:p],f},useContext:Dr,useEffect:Xy,useImperativeHandle:function(f,p,w){return w=w!=null?w.concat([f]):null,sm(4194308,4,j2.bind(null,p,f),w)},useLayoutEffect:function(f,p){return sm(4194308,4,f,p)},useInsertionEffect:function(f,p){return sm(4,2,f,p)},useMemo:function(f,p){var w=Ao();return p=p===void 0?null:p,f=f(),w.memoizedState=[f,p],f},useReducer:function(f,p,w){var M=Ao();return p=w!==void 0?w(p):p,M.memoizedState=M.baseState=p,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:p},M.queue=f,f=f.dispatch=a4.bind(null,Tn,f),[M.memoizedState,f]},useRef:function(f){var p=Ao();return f={current:f},p.memoizedState=f},useState:qy,useDebugValue:Yy,useDeferredValue:function(f){var p=qy(f),w=p[0],M=p[1];return Xy(function(){var C=Nr.transition;Nr.transition={};try{M(f)}finally{Nr.transition=C}},[f]),w},useTransition:function(){var f=qy(!1),p=f[0];return f=o4.bind(null,f[1]),Ao().memoizedState=f,[p,f]},useMutableSource:function(){},useSyncExternalStore:function(f,p,w){var M=Tn,C=Ao();if(pn){if(w===void 0)throw Error(o(407));w=w()}else{if(w=p(),Fn===null)throw Error(o(349));Yu&30||B2(M,p,w)}C.memoizedState=w;var D={value:w,getSnapshot:p};return C.queue=D,Xy(F2.bind(null,M,D,f),[f]),M.flags|=2048,td(9,U2.bind(null,M,D,w,p),void 0,null),w},useId:function(){var f=Ao(),p=Fn.identifierPrefix;if(pn){var w=Eo,M=Mo;w=(M&~(1<<32-fs(M)-1)).toString(32)+w,p=":"+p+"R"+w,w=ed++,0<w&&(p+="H"+w.toString(32)),p+=":"}else w=s4++,p=":"+p+"r"+w.toString(32)+":";return f.memoizedState=p},unstable_isNewReconciler:!1},c4={readContext:Dr,useCallback:q2,useContext:Dr,useEffect:nd,useImperativeHandle:$2,useInsertionEffect:H2,useLayoutEffect:W2,useMemo:X2,useReducer:im,useRef:G2,useState:function(){return im(yl)},useDebugValue:Yy,useDeferredValue:function(f){var p=im(yl),w=p[0],M=p[1];return nd(function(){var C=Nr.transition;Nr.transition={};try{M(f)}finally{Nr.transition=C}},[f]),w},useTransition:function(){var f=im(yl)[0],p=$s().memoizedState;return[f,p]},useMutableSource:N2,useSyncExternalStore:k2,useId:Y2,unstable_isNewReconciler:!1},h4={readContext:Dr,useCallback:q2,useContext:Dr,useEffect:nd,useImperativeHandle:$2,useInsertionEffect:H2,useLayoutEffect:W2,useMemo:X2,useReducer:rm,useRef:G2,useState:function(){return rm(yl)},useDebugValue:Yy,useDeferredValue:function(f){var p=rm(yl),w=p[0],M=p[1];return nd(function(){var C=Nr.transition;Nr.transition={};try{M(f)}finally{Nr.transition=C}},[f]),w},useTransition:function(){var f=rm(yl)[0],p=$s().memoizedState;return[f,p]},useMutableSource:N2,useSyncExternalStore:k2,useId:Y2,unstable_isNewReconciler:!1};function Zy(f,p){try{var w="",M=p;do w+=r4(M),M=M.return;while(M);var C=w}catch(D){C=`
Error generating stack: `+D.message+`
`+D.stack}return{value:f,source:p,stack:C}}function Jy(f,p){try{console.error(p.value)}catch(w){setTimeout(function(){throw w})}}var d4=typeof WeakMap=="function"?WeakMap:Map;function e3(f,p,w){w=bo(-1,w),w.tag=3,w.payload={element:null};var M=p.value;return w.callback=function(){bm||(bm=!0,m1=M),Jy(f,p)},w}function t3(f,p,w){w=bo(-1,w),w.tag=3;var M=f.type.getDerivedStateFromError;if(typeof M=="function"){var C=p.value;w.payload=function(){return M(C)},w.callback=function(){Jy(f,p)}}var D=f.stateNode;return D!==null&&typeof D.componentDidCatch=="function"&&(w.callback=function(){Jy(f,p),typeof M!="function"&&(ha===null?ha=new Set([this]):ha.add(this));var $=p.stack;this.componentDidCatch(p.value,{componentStack:$!==null?$:""})}),w}function n3(f,p,w){var M=f.pingCache;if(M===null){M=f.pingCache=new d4;var C=new Set;M.set(p,C)}else C=M.get(p),C===void 0&&(C=new Set,M.set(p,C));C.has(w)||(C.add(w),f=A4.bind(null,f,p,w),p.then(f,f))}function i3(f){do{var p;if((p=f.tag===13)&&(p=f.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return f;f=f.return}while(f!==null);return null}function r3(f,p,w,M,C){return f.mode&1?(f.flags|=65536,f.lanes=C,f):(f===p?f.flags|=65536:(f.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(p=bo(-1,1),p.tag=2,ca(w,p))),w.lanes|=1),f)}function qs(f){f.flags|=4}function s3(f,p){if(f!==null&&f.child===p.child)return!0;if(p.flags&16)return!1;for(f=p.child;f!==null;){if(f.flags&12854||f.subtreeFlags&12854)return!1;f=f.sibling}return!0}var id,rd,lm,um;if(fe)id=function(f,p){for(var w=p.child;w!==null;){if(w.tag===5||w.tag===6)N(f,w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===p)break;for(;w.sibling===null;){if(w.return===null||w.return===p)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},rd=function(){},lm=function(f,p,w,M,C){if(f=f.memoizedProps,f!==M){var D=p.stateNode,$=js(zr.current);w=Y(D,w,f,M,C,$),(p.updateQueue=w)&&qs(p)}},um=function(f,p,w,M){w!==M&&qs(p)};else if(K){id=function(f,p,w,M){for(var C=p.child;C!==null;){if(C.tag===5){var D=C.stateNode;w&&M&&(D=Kt(D,C.type,C.memoizedProps,C)),N(f,D)}else if(C.tag===6)D=C.stateNode,w&&M&&(D=Cr(D,C.memoizedProps,C)),N(f,D);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)D=C.child,D!==null&&(D.return=C),id(f,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===p)break;for(;C.sibling===null;){if(C.return===null||C.return===p)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};var o3=function(f,p,w,M){for(var C=p.child;C!==null;){if(C.tag===5){var D=C.stateNode;w&&M&&(D=Kt(D,C.type,C.memoizedProps,C)),rn(f,D)}else if(C.tag===6)D=C.stateNode,w&&M&&(D=Cr(D,C.memoizedProps,C)),rn(f,D);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)D=C.child,D!==null&&(D.return=C),o3(f,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===p)break;for(;C.sibling===null;){if(C.return===null||C.return===p)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};rd=function(f,p){var w=p.stateNode;if(!s3(f,p)){f=w.containerInfo;var M=Ot(f);o3(M,p,!1,!1),w.pendingChildren=M,qs(p),ei(f,M)}},lm=function(f,p,w,M,C){var D=f.stateNode,$=f.memoizedProps;if((f=s3(f,p))&&$===M)p.stateNode=D;else{var ie=p.stateNode,we=js(zr.current),Ne=null;$!==M&&(Ne=Y(ie,w,$,M,C,we)),f&&Ne===null?p.stateNode=D:(D=tt(D,Ne,w,$,M,p,f,ie),q(D,w,M,C,we)&&qs(p),p.stateNode=D,f?qs(p):id(D,p,!1,!1))}},um=function(f,p,w,M){w!==M?(f=js(qu.current),w=js(zr.current),p.stateNode=W(M,f,w,p),qs(p)):p.stateNode=f.stateNode}}else rd=function(){},lm=function(){},um=function(){};function sd(f,p){if(!pn)switch(f.tailMode){case"hidden":p=f.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?f.tail=null:w.sibling=null;break;case"collapsed":w=f.tail;for(var M=null;w!==null;)w.alternate!==null&&(M=w),w=w.sibling;M===null?p||f.tail===null?f.tail=null:f.tail.sibling=null:M.sibling=null}}function xi(f){var p=f.alternate!==null&&f.alternate.child===f.child,w=0,M=0;if(p)for(var C=f.child;C!==null;)w|=C.lanes|C.childLanes,M|=C.subtreeFlags&14680064,M|=C.flags&14680064,C.return=f,C=C.sibling;else for(C=f.child;C!==null;)w|=C.lanes|C.childLanes,M|=C.subtreeFlags,M|=C.flags,C.return=f,C=C.sibling;return f.subtreeFlags|=M,f.childLanes=w,p}function f4(f,p,w){var M=p.pendingProps;switch(Ny(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xi(p),null;case 1:return $i(p.type)&&Bp(),xi(p),null;case 3:return M=p.stateNode,Xu(),wt(ti),wt(Ht),Hy(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(f===null||f.child===null)&&(Yh(p)?qs(p):f===null||f.memoizedState.isDehydrated&&!(p.flags&256)||(p.flags|=1024,ms!==null&&(y1(ms),ms=null))),rd(f,p),xi(p),null;case 5:Vy(p),w=js(qu.current);var C=p.type;if(f!==null&&p.stateNode!=null)lm(f,p,C,M,w),f.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!M){if(p.stateNode===null)throw Error(o(166));return xi(p),null}if(f=js(zr.current),Yh(p)){if(!Q)throw Error(o(175));f=ct(p.stateNode,p.type,p.memoizedProps,w,f,p,!Xh),p.updateQueue=f,f!==null&&qs(p)}else{var D=X(C,M,w,f,p);id(D,p,!1,!1),p.stateNode=D,q(D,C,M,w,f)&&qs(p)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return xi(p),null;case 6:if(f&&p.stateNode!=null)um(f,p,f.memoizedProps,M);else{if(typeof M!="string"&&p.stateNode===null)throw Error(o(166));if(f=js(qu.current),w=js(zr.current),Yh(p)){if(!Q)throw Error(o(176));if(f=p.stateNode,M=p.memoizedProps,(w=gt(f,M,p,!Xh))&&(C=lr,C!==null))switch(D=(C.mode&1)!==0,C.tag){case 3:ds(C.stateNode.containerInfo,f,M,D);break;case 5:yo(C.type,C.memoizedProps,C.stateNode,f,M,D)}w&&qs(p)}else p.stateNode=W(M,f,w,p)}return xi(p),null;case 13:if(wt(vn),M=p.memoizedState,pn&&ur!==null&&p.mode&1&&!(p.flags&128)){for(f=ur;f;)f=pe(f);return ju(),p.flags|=98560,p}if(M!==null&&M.dehydrated!==null){if(M=Yh(p),f===null){if(!M)throw Error(o(318));if(!Q)throw Error(o(344));if(f=p.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(o(317));St(f,p)}else ju(),!(p.flags&128)&&(p.memoizedState=null),p.flags|=4;return xi(p),null}return ms!==null&&(y1(ms),ms=null),p.flags&128?(p.lanes=w,p):(M=M!==null,w=!1,f===null?Yh(p):w=f.memoizedState!==null,M&&!w&&(p.child.flags|=8192,p.mode&1&&(f===null||vn.current&1?$n===0&&($n=3):_1())),p.updateQueue!==null&&(p.flags|=4),xi(p),null);case 4:return Xu(),rd(f,p),f===null&&ye(p.stateNode.containerInfo),xi(p),null;case 10:return Ly(p.type._context),xi(p),null;case 17:return $i(p.type)&&Bp(),xi(p),null;case 19:if(wt(vn),C=p.memoizedState,C===null)return xi(p),null;if(M=(p.flags&128)!==0,D=C.rendering,D===null)if(M)sd(C,!1);else{if($n!==0||f!==null&&f.flags&128)for(f=p.child;f!==null;){if(D=em(f),D!==null){for(p.flags|=128,sd(C,!1),f=D.updateQueue,f!==null&&(p.updateQueue=f,p.flags|=4),p.subtreeFlags=0,f=w,M=p.child;M!==null;)w=M,C=f,w.flags&=14680066,D=w.alternate,D===null?(w.childLanes=0,w.lanes=C,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=D.childLanes,w.lanes=D.lanes,w.child=D.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=D.memoizedProps,w.memoizedState=D.memoizedState,w.updateQueue=D.updateQueue,w.type=D.type,C=D.dependencies,w.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),M=M.sibling;return Nt(vn,vn.current&1|2),p.child}f=f.sibling}C.tail!==null&&ni()>p1&&(p.flags|=128,M=!0,sd(C,!1),p.lanes=4194304)}else{if(!M)if(f=em(D),f!==null){if(p.flags|=128,M=!0,f=f.updateQueue,f!==null&&(p.updateQueue=f,p.flags|=4),sd(C,!0),C.tail===null&&C.tailMode==="hidden"&&!D.alternate&&!pn)return xi(p),null}else 2*ni()-C.renderingStartTime>p1&&w!==1073741824&&(p.flags|=128,M=!0,sd(C,!1),p.lanes=4194304);C.isBackwards?(D.sibling=p.child,p.child=D):(f=C.last,f!==null?f.sibling=D:p.child=D,C.last=D)}return C.tail!==null?(p=C.tail,C.rendering=p,C.tail=p.sibling,C.renderingStartTime=ni(),p.sibling=null,f=vn.current,Nt(vn,M?f&1|2:f&1),p):(xi(p),null);case 22:case 23:return x1(),M=p.memoizedState!==null,f!==null&&f.memoizedState!==null!==M&&(p.flags|=8192),M&&p.mode&1?hr&1073741824&&(xi(p),fe&&p.subtreeFlags&6&&(p.flags|=8192)):xi(p),null;case 24:return null;case 25:return null}throw Error(o(156,p.tag))}var p4=a.ReactCurrentOwner,cr=!1;function Di(f,p,w,M){p.child=f===null?O2(p,null,w,M):$u(p,f.child,w,M)}function a3(f,p,w,M,C){w=w.render;var D=p.ref;return Gu(p,C),M=jy(f,p,w,M,D,C),w=$y(),f!==null&&!cr?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~C,To(f,p,C)):(pn&&w&&zy(p),p.flags|=1,Di(f,p,M,C),p.child)}function l3(f,p,w,M,C){if(f===null){var D=w.type;return typeof D=="function"&&!w1(D)&&D.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(p.tag=15,p.type=D,u3(f,p,D,M,C)):(f=Lm(w.type,null,M,p,p.mode,C),f.ref=p.ref,f.return=p,p.child=f)}if(D=f.child,!(f.lanes&C)){var $=D.memoizedProps;if(w=w.compare,w=w!==null?w:jp,w($,M)&&f.ref===p.ref)return To(f,p,C)}return p.flags|=1,f=ma(D,M),f.ref=p.ref,f.return=p,p.child=f}function u3(f,p,w,M,C){if(f!==null&&jp(f.memoizedProps,M)&&f.ref===p.ref)if(cr=!1,(f.lanes&C)!==0)f.flags&131072&&(cr=!0);else return p.lanes=f.lanes,To(f,p,C);return Ky(f,p,w,M,C)}function c3(f,p,w){var M=p.pendingProps,C=M.children,D=f!==null?f.memoizedState:null;if(M.mode==="hidden")if(!(p.mode&1))p.memoizedState={baseLanes:0,cachePool:null},Nt(Zu,hr),hr|=w;else if(w&1073741824)p.memoizedState={baseLanes:0,cachePool:null},M=D!==null?D.baseLanes:w,Nt(Zu,hr),hr|=M;else return f=D!==null?D.baseLanes|w:w,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:f,cachePool:null},p.updateQueue=null,Nt(Zu,hr),hr|=f,null;else D!==null?(M=D.baseLanes|w,p.memoizedState=null):M=w,Nt(Zu,hr),hr|=M;return Di(f,p,C,w),p.child}function h3(f,p){var w=p.ref;(f===null&&w!==null||f!==null&&f.ref!==w)&&(p.flags|=512,p.flags|=2097152)}function Ky(f,p,w,M,C){var D=$i(w)?_o:Ht.current;return D=wo(p,D),Gu(p,C),w=jy(f,p,w,M,D,C),M=$y(),f!==null&&!cr?(p.updateQueue=f.updateQueue,p.flags&=-2053,f.lanes&=~C,To(f,p,C)):(pn&&M&&zy(p),p.flags|=1,Di(f,p,w,C),p.child)}function d3(f,p,w,M,C){if($i(w)){var D=!0;Up(p)}else D=!1;if(Gu(p,C),p.stateNode===null)f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2),A2(p,w,M),Oy(p,w,M,C),M=!0;else if(f===null){var $=p.stateNode,ie=p.memoizedProps;$.props=ie;var we=$.context,Ne=w.contextType;typeof Ne=="object"&&Ne!==null?Ne=Dr(Ne):(Ne=$i(w)?_o:Ht.current,Ne=wo(p,Ne));var Ke=w.getDerivedStateFromProps,yt=typeof Ke=="function"||typeof $.getSnapshotBeforeUpdate=="function";yt||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ie!==M||we!==Ne)&&T2(p,$,M,Ne),ua=!1;var dt=p.memoizedState;$.state=dt,Yp(p,M,$,C),we=p.memoizedState,ie!==M||dt!==we||ti.current||ua?(typeof Ke=="function"&&(Ry(p,w,Ke,M),we=p.memoizedState),(ie=ua||E2(p,w,ie,M,dt,we,Ne))?(yt||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(p.flags|=4194308)):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=M,p.memoizedState=we),$.props=M,$.state=we,$.context=Ne,M=ie):(typeof $.componentDidMount=="function"&&(p.flags|=4194308),M=!1)}else{$=p.stateNode,w2(f,p),ie=p.memoizedProps,Ne=p.type===p.elementType?ie:ps(p.type,ie),$.props=Ne,yt=p.pendingProps,dt=$.context,we=w.contextType,typeof we=="object"&&we!==null?we=Dr(we):(we=$i(w)?_o:Ht.current,we=wo(p,we));var Qt=w.getDerivedStateFromProps;(Ke=typeof Qt=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(ie!==yt||dt!==we)&&T2(p,$,M,we),ua=!1,dt=p.memoizedState,$.state=dt,Yp(p,M,$,C);var st=p.memoizedState;ie!==yt||dt!==st||ti.current||ua?(typeof Qt=="function"&&(Ry(p,w,Qt,M),st=p.memoizedState),(Ne=ua||E2(p,w,Ne,M,dt,st,we)||!1)?(Ke||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(M,st,we),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(M,st,we)),typeof $.componentDidUpdate=="function"&&(p.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof $.componentDidUpdate!="function"||ie===f.memoizedProps&&dt===f.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ie===f.memoizedProps&&dt===f.memoizedState||(p.flags|=1024),p.memoizedProps=M,p.memoizedState=st),$.props=M,$.state=st,$.context=we,M=Ne):(typeof $.componentDidUpdate!="function"||ie===f.memoizedProps&&dt===f.memoizedState||(p.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||ie===f.memoizedProps&&dt===f.memoizedState||(p.flags|=1024),M=!1)}return Qy(f,p,w,M,D,C)}function Qy(f,p,w,M,C,D){h3(f,p);var $=(p.flags&128)!==0;if(!M&&!$)return C&&g2(p,w,!1),To(f,p,D);M=p.stateNode,p4.current=p;var ie=$&&typeof w.getDerivedStateFromError!="function"?null:M.render();return p.flags|=1,f!==null&&$?(p.child=$u(p,f.child,null,D),p.child=$u(p,null,ie,D)):Di(f,p,ie,D),p.memoizedState=M.state,C&&g2(p,w,!0),p.child}function f3(f){var p=f.stateNode;p.pendingContext?p2(f,p.pendingContext,p.pendingContext!==p.context):p.context&&p2(f,p.context,!1),Fy(f,p.containerInfo)}function p3(f,p,w,M,C){return ju(),Uy(C),p.flags|=256,Di(f,p,w,M),p.child}var cm={dehydrated:null,treeContext:null,retryLane:0};function hm(f){return{baseLanes:f,cachePool:null}}function m3(f,p,w){var M=p.pendingProps,C=vn.current,D=!1,$=(p.flags&128)!==0,ie;if((ie=$)||(ie=f!==null&&f.memoizedState===null?!1:(C&2)!==0),ie?(D=!0,p.flags&=-129):(f===null||f.memoizedState!==null)&&(C|=1),Nt(vn,C&1),f===null)return By(p),f=p.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(p.mode&1?jh(f)?p.lanes=8:p.lanes=1073741824:p.lanes=1,null):(C=M.children,f=M.fallback,D?(M=p.mode,D=p.child,C={mode:"hidden",children:C},!(M&1)&&D!==null?(D.childLanes=0,D.pendingProps=C):D=Im(C,M,0,null),f=Ml(f,M,w,null),D.return=p,f.return=p,D.sibling=f,p.child=D,p.child.memoizedState=hm(w),p.memoizedState=cm,f):e1(p,C));if(C=f.memoizedState,C!==null){if(ie=C.dehydrated,ie!==null){if($)return p.flags&256?(p.flags&=-257,dm(f,p,w,Error(o(422)))):p.memoizedState!==null?(p.child=f.child,p.flags|=128,null):(D=M.fallback,C=p.mode,M=Im({mode:"visible",children:M.children},C,0,null),D=Ml(D,C,w,null),D.flags|=2,M.return=p,D.return=p,M.sibling=D,p.child=M,p.mode&1&&$u(p,f.child,null,w),p.child.memoizedState=hm(w),p.memoizedState=cm,D);if(!(p.mode&1))p=dm(f,p,w,null);else if(jh(ie))p=dm(f,p,w,Error(o(419)));else if(M=(w&f.childLanes)!==0,cr||M){if(M=Fn,M!==null){switch(w&-w){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}M=D&(M.suspendedLanes|w)?0:D,M!==0&&M!==C.retryLane&&(C.retryLane=M,kr(f,M,-1))}_1(),p=dm(f,p,w,Error(o(421)))}else kp(ie)?(p.flags|=128,p.child=f.child,p=T4.bind(null,f),j(ie,p),p=null):(w=C.treeContext,Q&&(ur=Ae(ie),lr=p,pn=!0,ms=null,Xh=!1,w!==null&&(Rr[Or++]=Mo,Rr[Or++]=Eo,Rr[Or++]=gl,Mo=w.id,Eo=w.overflow,gl=p)),p=e1(p,p.pendingProps.children),p.flags|=4096);return p}return D?(M=v3(f,p,M.children,M.fallback,w),D=p.child,C=f.child.memoizedState,D.memoizedState=C===null?hm(w):{baseLanes:C.baseLanes|w,cachePool:null},D.childLanes=f.childLanes&~w,p.memoizedState=cm,M):(w=g3(f,p,M.children,w),p.memoizedState=null,w)}return D?(M=v3(f,p,M.children,M.fallback,w),D=p.child,C=f.child.memoizedState,D.memoizedState=C===null?hm(w):{baseLanes:C.baseLanes|w,cachePool:null},D.childLanes=f.childLanes&~w,p.memoizedState=cm,M):(w=g3(f,p,M.children,w),p.memoizedState=null,w)}function e1(f,p){return p=Im({mode:"visible",children:p},f.mode,0,null),p.return=f,f.child=p}function g3(f,p,w,M){var C=f.child;return f=C.sibling,w=ma(C,{mode:"visible",children:w}),!(p.mode&1)&&(w.lanes=M),w.return=p,w.sibling=null,f!==null&&(M=p.deletions,M===null?(p.deletions=[f],p.flags|=16):M.push(f)),p.child=w}function v3(f,p,w,M,C){var D=p.mode;f=f.child;var $=f.sibling,ie={mode:"hidden",children:w};return!(D&1)&&p.child!==f?(w=p.child,w.childLanes=0,w.pendingProps=ie,p.deletions=null):(w=ma(f,ie),w.subtreeFlags=f.subtreeFlags&14680064),$!==null?M=ma($,M):(M=Ml(M,D,C,null),M.flags|=2),M.return=p,w.return=p,w.sibling=M,p.child=w,M}function dm(f,p,w,M){return M!==null&&Uy(M),$u(p,f.child,null,w),f=e1(p,p.pendingProps.children),f.flags|=2,p.memoizedState=null,f}function y3(f,p,w){f.lanes|=p;var M=f.alternate;M!==null&&(M.lanes|=p),Iy(f.return,p,w)}function t1(f,p,w,M,C){var D=f.memoizedState;D===null?f.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:M,tail:w,tailMode:C}:(D.isBackwards=p,D.rendering=null,D.renderingStartTime=0,D.last=M,D.tail=w,D.tailMode=C)}function x3(f,p,w){var M=p.pendingProps,C=M.revealOrder,D=M.tail;if(Di(f,p,M.children,w),M=vn.current,M&2)M=M&1|2,p.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=p.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&y3(f,w,p);else if(f.tag===19)y3(f,w,p);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===p)break e;for(;f.sibling===null;){if(f.return===null||f.return===p)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}M&=1}if(Nt(vn,M),!(p.mode&1))p.memoizedState=null;else switch(C){case"forwards":for(w=p.child,C=null;w!==null;)f=w.alternate,f!==null&&em(f)===null&&(C=w),w=w.sibling;w=C,w===null?(C=p.child,p.child=null):(C=w.sibling,w.sibling=null),t1(p,!1,C,w,D);break;case"backwards":for(w=null,C=p.child,p.child=null;C!==null;){if(f=C.alternate,f!==null&&em(f)===null){p.child=C;break}f=C.sibling,C.sibling=w,w=C,C=f}t1(p,!0,w,null,D);break;case"together":t1(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function To(f,p,w){if(f!==null&&(p.dependencies=f.dependencies),Ju|=p.lanes,!(w&p.childLanes))return null;if(f!==null&&p.child!==f.child)throw Error(o(153));if(p.child!==null){for(f=p.child,w=ma(f,f.pendingProps),p.child=w,w.return=p;f.sibling!==null;)f=f.sibling,w=w.sibling=ma(f,f.pendingProps),w.return=p;w.sibling=null}return p.child}function m4(f,p,w){switch(p.tag){case 3:f3(p),ju();break;case 5:z2(p);break;case 1:$i(p.type)&&Up(p);break;case 4:Fy(p,p.stateNode.containerInfo);break;case 10:_2(p,p.type._context,p.memoizedProps.value);break;case 13:var M=p.memoizedState;if(M!==null)return M.dehydrated!==null?(Nt(vn,vn.current&1),p.flags|=128,null):w&p.child.childLanes?m3(f,p,w):(Nt(vn,vn.current&1),f=To(f,p,w),f!==null?f.sibling:null);Nt(vn,vn.current&1);break;case 19:if(M=(w&p.childLanes)!==0,f.flags&128){if(M)return x3(f,p,w);p.flags|=128}var C=p.memoizedState;if(C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Nt(vn,vn.current),M)break;return null;case 22:case 23:return p.lanes=0,c3(f,p,w)}return To(f,p,w)}function g4(f,p){switch(Ny(p),p.tag){case 1:return $i(p.type)&&Bp(),f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 3:return Xu(),wt(ti),wt(Ht),Hy(),f=p.flags,f&65536&&!(f&128)?(p.flags=f&-65537|128,p):null;case 5:return Vy(p),null;case 13:if(wt(vn),f=p.memoizedState,f!==null&&f.dehydrated!==null){if(p.alternate===null)throw Error(o(340));ju()}return f=p.flags,f&65536?(p.flags=f&-65537|128,p):null;case 19:return wt(vn),null;case 4:return Xu(),null;case 10:return Ly(p.type._context),null;case 22:case 23:return x1(),null;case 24:return null;default:return null}}var fm=!1,xl=!1,v4=typeof WeakSet=="function"?WeakSet:Set,je=null;function pm(f,p){var w=f.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(M){Yi(f,p,M)}else w.current=null}function n1(f,p,w){try{w()}catch(M){Yi(f,p,M)}}var _3=!1;function y4(f,p){for(V(f.containerInfo),je=p;je!==null;)if(f=je,p=f.child,(f.subtreeFlags&1028)!==0&&p!==null)p.return=f,je=p;else for(;je!==null;){f=je;try{var w=f.alternate;if(f.flags&1024)switch(f.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var M=w.memoizedProps,C=w.memoizedState,D=f.stateNode,$=D.getSnapshotBeforeUpdate(f.elementType===f.type?M:ps(f.type,M),C);D.__reactInternalSnapshotBeforeUpdate=$}break;case 3:fe&&Ue(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ie){Yi(f,f.return,ie)}if(p=f.sibling,p!==null){p.return=f.return,je=p;break}je=f.return}return w=_3,_3=!1,w}function _l(f,p,w){var M=p.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var C=M=M.next;do{if((C.tag&f)===f){var D=C.destroy;C.destroy=void 0,D!==void 0&&n1(p,w,D)}C=C.next}while(C!==M)}}function od(f,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var w=p=p.next;do{if((w.tag&f)===f){var M=w.create;w.destroy=M()}w=w.next}while(w!==p)}}function i1(f){var p=f.ref;if(p!==null){var w=f.stateNode;switch(f.tag){case 5:f=ne(w);break;default:f=w}typeof p=="function"?p(f):p.current=f}}function w3(f,p,w){if(Vs&&typeof Vs.onCommitFiberUnmount=="function")try{Vs.onCommitFiberUnmount(Hp,p)}catch{}switch(p.tag){case 0:case 11:case 14:case 15:if(f=p.updateQueue,f!==null&&(f=f.lastEffect,f!==null)){var M=f=f.next;do{var C=M,D=C.destroy;C=C.tag,D!==void 0&&(C&2||C&4)&&n1(p,w,D),M=M.next}while(M!==f)}break;case 1:if(pm(p,w),f=p.stateNode,typeof f.componentWillUnmount=="function")try{f.props=p.memoizedProps,f.state=p.memoizedState,f.componentWillUnmount()}catch($){Yi(p,w,$)}break;case 5:pm(p,w);break;case 4:fe?T3(f,p,w):K&&K&&(p=p.stateNode.containerInfo,w=Ot(p),Fs(p,w))}}function S3(f,p,w){for(var M=p;;)if(w3(f,M,w),M.child===null||fe&&M.tag===4){if(M===p)break;for(;M.sibling===null;){if(M.return===null||M.return===p)return;M=M.return}M.sibling.return=M.return,M=M.sibling}else M.child.return=M,M=M.child}function b3(f){var p=f.alternate;p!==null&&(f.alternate=null,b3(p)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(p=f.stateNode,p!==null&&Te(p)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function M3(f){return f.tag===5||f.tag===3||f.tag===4}function E3(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||M3(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function A3(f){if(fe){e:{for(var p=f.return;p!==null;){if(M3(p))break e;p=p.return}throw Error(o(160))}var w=p;switch(w.tag){case 5:p=w.stateNode,w.flags&32&&($t(p),w.flags&=-33),w=E3(f),s1(f,w,p);break;case 3:case 4:p=w.stateNode.containerInfo,w=E3(f),r1(f,w,p);break;default:throw Error(o(161))}}}function r1(f,p,w){var M=f.tag;if(M===5||M===6)f=f.stateNode,p?ut(w,f,p):He(w,f);else if(M!==4&&(f=f.child,f!==null))for(r1(f,p,w),f=f.sibling;f!==null;)r1(f,p,w),f=f.sibling}function s1(f,p,w){var M=f.tag;if(M===5||M===6)f=f.stateNode,p?Xe(w,f,p):ht(w,f);else if(M!==4&&(f=f.child,f!==null))for(s1(f,p,w),f=f.sibling;f!==null;)s1(f,p,w),f=f.sibling}function T3(f,p,w){for(var M=p,C=!1,D,$;;){if(!C){C=M.return;e:for(;;){if(C===null)throw Error(o(160));switch(D=C.stateNode,C.tag){case 5:$=!1;break e;case 3:D=D.containerInfo,$=!0;break e;case 4:D=D.containerInfo,$=!0;break e}C=C.return}C=!0}if(M.tag===5||M.tag===6)S3(f,M,w),$?Lt(D,M.stateNode):ot(D,M.stateNode);else if(M.tag===18)$?En(D,M.stateNode):Dt(D,M.stateNode);else if(M.tag===4){if(M.child!==null){D=M.stateNode.containerInfo,$=!0,M.child.return=M,M=M.child;continue}}else if(w3(f,M,w),M.child!==null){M.child.return=M,M=M.child;continue}if(M===p)break;for(;M.sibling===null;){if(M.return===null||M.return===p)return;M=M.return,M.tag===4&&(C=!1)}M.sibling.return=M.return,M=M.sibling}}function o1(f,p){if(fe){switch(p.tag){case 0:case 11:case 14:case 15:_l(3,p,p.return),od(3,p),_l(5,p,p.return);return;case 1:return;case 5:var w=p.stateNode;if(w!=null){var M=p.memoizedProps;f=f!==null?f.memoizedProps:M;var C=p.type,D=p.updateQueue;p.updateQueue=null,D!==null&&et(w,D,C,f,M,p)}return;case 6:if(p.stateNode===null)throw Error(o(162));w=p.memoizedProps,Me(p.stateNode,f!==null?f.memoizedProps:w,w);return;case 3:Q&&f!==null&&f.memoizedState.isDehydrated&&zt(p.stateNode.containerInfo);return;case 12:return;case 13:mm(p);return;case 19:mm(p);return;case 17:return}throw Error(o(163))}switch(p.tag){case 0:case 11:case 14:case 15:_l(3,p,p.return),od(3,p),_l(5,p,p.return);return;case 12:return;case 13:mm(p);return;case 19:mm(p);return;case 3:Q&&f!==null&&f.memoizedState.isDehydrated&&zt(p.stateNode.containerInfo);break;case 22:case 23:return}e:if(K){switch(p.tag){case 1:case 5:case 6:break e;case 3:case 4:p=p.stateNode,Fs(p.containerInfo,p.pendingChildren);break e}throw Error(o(163))}}function mm(f){var p=f.updateQueue;if(p!==null){f.updateQueue=null;var w=f.stateNode;w===null&&(w=f.stateNode=new v4),p.forEach(function(M){var C=C4.bind(null,f,M);w.has(M)||(w.add(M),M.then(C,C))})}}function x4(f,p){for(je=p;je!==null;){p=je;var w=p.deletions;if(w!==null)for(var M=0;M<w.length;M++){var C=w[M];try{var D=f;fe?T3(D,C,p):S3(D,C,p);var $=C.alternate;$!==null&&($.return=null),C.return=null}catch(rt){Yi(C,p,rt)}}if(w=p.child,p.subtreeFlags&12854&&w!==null)w.return=p,je=w;else for(;je!==null;){p=je;try{var ie=p.flags;if(ie&32&&fe&&$t(p.stateNode),ie&512){var we=p.alternate;if(we!==null){var Ne=we.ref;Ne!==null&&(typeof Ne=="function"?Ne(null):Ne.current=null)}}if(ie&8192)switch(p.tag){case 13:if(p.memoizedState!==null){var Ke=p.alternate;(Ke===null||Ke.memoizedState===null)&&(f1=ni())}break;case 22:var yt=p.memoizedState!==null,dt=p.alternate,Qt=dt!==null&&dt.memoizedState!==null;if(w=p,fe){e:if(M=w,C=yt,D=null,fe)for(var st=M;;){if(st.tag===5){if(D===null){D=st;var _i=st.stateNode;C?Mn(_i):_e(st.stateNode,st.memoizedProps)}}else if(st.tag===6){if(D===null){var Ur=st.stateNode;C?re(Ur):Ie(Ur,st.memoizedProps)}}else if((st.tag!==22&&st.tag!==23||st.memoizedState===null||st===M)&&st.child!==null){st.child.return=st,st=st.child;continue}if(st===M)break;for(;st.sibling===null;){if(st.return===null||st.return===M)break e;D===st&&(D=null),st=st.return}D===st&&(D=null),st.sibling.return=st.return,st=st.sibling}}if(yt&&!Qt&&w.mode&1){je=w;for(var me=w.child;me!==null;){for(w=je=me;je!==null;){M=je;var oe=M.child;switch(M.tag){case 0:case 11:case 14:case 15:_l(4,M,M.return);break;case 1:pm(M,M.return);var xe=M.stateNode;if(typeof xe.componentWillUnmount=="function"){var $e=M.return;try{xe.props=M.memoizedProps,xe.state=M.memoizedState,xe.componentWillUnmount()}catch(rt){Yi(M,$e,rt)}}break;case 5:pm(M,M.return);break;case 22:if(M.memoizedState!==null){L3(w);continue}}oe!==null?(oe.return=M,je=oe):L3(w)}me=me.sibling}}}switch(ie&4102){case 2:A3(p),p.flags&=-3;break;case 6:A3(p),p.flags&=-3,o1(p.alternate,p);break;case 4096:p.flags&=-4097;break;case 4100:p.flags&=-4097,o1(p.alternate,p);break;case 4:o1(p.alternate,p)}}catch(rt){Yi(p,p.return,rt)}if(w=p.sibling,w!==null){w.return=p.return,je=w;break}je=p.return}}}function _4(f,p,w){je=f,C3(f)}function C3(f,p,w){for(var M=(f.mode&1)!==0;je!==null;){var C=je,D=C.child;if(C.tag===22&&M){var $=C.memoizedState!==null||fm;if(!$){var ie=C.alternate,we=ie!==null&&ie.memoizedState!==null||xl;ie=fm;var Ne=xl;if(fm=$,(xl=we)&&!Ne)for(je=C;je!==null;)$=je,we=$.child,$.tag===22&&$.memoizedState!==null?I3(C):we!==null?(we.return=$,je=we):I3(C);for(;D!==null;)je=D,C3(D),D=D.sibling;je=C,fm=ie,xl=Ne}P3(f)}else C.subtreeFlags&8772&&D!==null?(D.return=C,je=D):P3(f)}}function P3(f){for(;je!==null;){var p=je;if(p.flags&8772){var w=p.alternate;try{if(p.flags&8772)switch(p.tag){case 0:case 11:case 15:xl||od(5,p);break;case 1:var M=p.stateNode;if(p.flags&4&&!xl)if(w===null)M.componentDidMount();else{var C=p.elementType===p.type?w.memoizedProps:ps(p.type,w.memoizedProps);M.componentDidUpdate(C,w.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var D=p.updateQueue;D!==null&&b2(p,D,M);break;case 3:var $=p.updateQueue;if($!==null){if(w=null,p.child!==null)switch(p.child.tag){case 5:w=ne(p.child.stateNode);break;case 1:w=p.child.stateNode}b2(p,$,w)}break;case 5:var ie=p.stateNode;w===null&&p.flags&4&&We(ie,p.type,p.memoizedProps,p);break;case 6:break;case 4:break;case 12:break;case 13:if(Q&&p.memoizedState===null){var we=p.alternate;if(we!==null){var Ne=we.memoizedState;if(Ne!==null){var Ke=Ne.dehydrated;Ke!==null&&It(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}xl||p.flags&512&&i1(p)}catch(yt){Yi(p,p.return,yt)}}if(p===f){je=null;break}if(w=p.sibling,w!==null){w.return=p.return,je=w;break}je=p.return}}function L3(f){for(;je!==null;){var p=je;if(p===f){je=null;break}var w=p.sibling;if(w!==null){w.return=p.return,je=w;break}je=p.return}}function I3(f){for(;je!==null;){var p=je;try{switch(p.tag){case 0:case 11:case 15:var w=p.return;try{od(4,p)}catch(we){Yi(p,w,we)}break;case 1:var M=p.stateNode;if(typeof M.componentDidMount=="function"){var C=p.return;try{M.componentDidMount()}catch(we){Yi(p,C,we)}}var D=p.return;try{i1(p)}catch(we){Yi(p,D,we)}break;case 5:var $=p.return;try{i1(p)}catch(we){Yi(p,$,we)}}}catch(we){Yi(p,p.return,we)}if(p===f){je=null;break}var ie=p.sibling;if(ie!==null){ie.return=p.return,je=ie;break}je=p.return}}var gm=0,vm=1,ym=2,xm=3,_m=4;if(typeof Symbol=="function"&&Symbol.for){var ad=Symbol.for;gm=ad("selector.component"),vm=ad("selector.has_pseudo_class"),ym=ad("selector.role"),xm=ad("selector.test_id"),_m=ad("selector.text")}function a1(f){var p=he(f);if(p!=null){if(typeof p.memoizedProps["data-testname"]!="string")throw Error(o(364));return p}if(f=nt(f),f===null)throw Error(o(362));return f.stateNode.current}function l1(f,p){switch(p.$$typeof){case gm:if(f.type===p.value)return!0;break;case vm:e:{p=p.value,f=[f,0];for(var w=0;w<f.length;){var M=f[w++],C=f[w++],D=p[C];if(M.tag!==5||!ge(M)){for(;D!=null&&l1(M,D);)C++,D=p[C];if(C===p.length){p=!0;break e}else for(M=M.child;M!==null;)f.push(M,C),M=M.sibling}}p=!1}return p;case ym:if(f.tag===5&&Pe(f.stateNode,p.value))return!0;break;case _m:if((f.tag===5||f.tag===6)&&(f=B(f),f!==null&&0<=f.indexOf(p.value)))return!0;break;case xm:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===p.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function u1(f){switch(f.$$typeof){case gm:return"<"+(L(f.value)||"Unknown")+">";case vm:return":has("+(u1(f)||"")+")";case ym:return'[role="'+f.value+'"]';case _m:return'"'+f.value+'"';case xm:return'[data-testname="'+f.value+'"]';default:throw Error(o(365))}}function D3(f,p){var w=[];f=[f,0];for(var M=0;M<f.length;){var C=f[M++],D=f[M++],$=p[D];if(C.tag!==5||!ge(C)){for(;$!=null&&l1(C,$);)D++,$=p[D];if(D===p.length)w.push(C);else for(C=C.child;C!==null;)f.push(C,D),C=C.sibling}}return w}function c1(f,p){if(!Ye)throw Error(o(363));f=a1(f),f=D3(f,p),p=[],f=Array.from(f);for(var w=0;w<f.length;){var M=f[w++];if(M.tag===5)ge(M)||p.push(M.stateNode);else for(M=M.child;M!==null;)f.push(M),M=M.sibling}return p}var w4=Math.ceil,wm=a.ReactCurrentDispatcher,h1=a.ReactCurrentOwner,Rn=a.ReactCurrentBatchConfig,Tt=0,Fn=null,Vn=null,ci=0,hr=0,Zu=Lr(0),$n=0,ld=null,Ju=0,Sm=0,d1=0,ud=null,qi=null,f1=0,p1=1/0;function Ku(){p1=ni()+500}var bm=!1,m1=null,ha=null,Mm=!1,da=null,Em=0,cd=0,g1=null,Am=-1,Tm=0;function Ri(){return Tt&6?ni():Am!==-1?Am:Am=ni()}function fa(f){return f.mode&1?Tt&2&&ci!==0?ci&-ci:i4.transition!==null?(Tm===0&&(f=Fp,Fp<<=1,!(Fp&4194240)&&(Fp=64),Tm=f),Tm):(f=Ut,f!==0?f:be()):1}function kr(f,p,w){if(50<cd)throw cd=0,g1=null,Error(o(185));var M=Cm(f,p);return M===null?null:(qh(M,p,w),(!(Tt&2)||M!==Fn)&&(M===Fn&&(!(Tt&2)&&(Sm|=p),$n===4&&pa(M,ci)),Xi(M,w),p===1&&Tt===0&&!(f.mode&1)&&(Ku(),Wp&&Hs())),M)}function Cm(f,p){f.lanes|=p;var w=f.alternate;for(w!==null&&(w.lanes|=p),w=f,f=f.return;f!==null;)f.childLanes|=p,w=f.alternate,w!==null&&(w.childLanes|=p),w=f,f=f.return;return w.tag===3?w.stateNode:null}function Xi(f,p){var w=f.callbackNode;XN(f,p);var M=Gp(f,f===Fn?ci:0);if(M===0)w!==null&&y2(w),f.callbackNode=null,f.callbackPriority=0;else if(p=M&-M,f.callbackPriority!==p){if(w!=null&&y2(w),p===1)f.tag===0?n4(O3.bind(null,f)):x2(O3.bind(null,f)),Le?ze(function(){Tt===0&&Hs()}):My(Ey,Hs),w=null;else{switch(v2(M)){case 1:w=Ey;break;case 4:w=KN;break;case 16:w=Ay;break;case 536870912:w=QN;break;default:w=Ay}w=H3(w,R3.bind(null,f))}f.callbackPriority=p,f.callbackNode=w}}function R3(f,p){if(Am=-1,Tm=0,Tt&6)throw Error(o(327));var w=f.callbackNode;if(bl()&&f.callbackNode!==w)return null;var M=Gp(f,f===Fn?ci:0);if(M===0)return null;if(M&30||M&f.expiredLanes||p)p=Pm(f,M);else{p=M;var C=Tt;Tt|=2;var D=k3();(Fn!==f||ci!==p)&&(Ku(),wl(f,p));do try{M4();break}catch(ie){N3(f,ie)}while(1);Py(),wm.current=D,Tt=C,Vn!==null?p=0:(Fn=null,ci=0,p=$n)}if(p!==0){if(p===2&&(C=wy(f),C!==0&&(M=C,p=v1(f,C))),p===1)throw w=ld,wl(f,0),pa(f,M),Xi(f,ni()),w;if(p===6)pa(f,M);else{if(C=f.current.alternate,!(M&30)&&!S4(C)&&(p=Pm(f,M),p===2&&(D=wy(f),D!==0&&(M=D,p=v1(f,D))),p===1))throw w=ld,wl(f,0),pa(f,M),Xi(f,ni()),w;switch(f.finishedWork=C,f.finishedLanes=M,p){case 0:case 1:throw Error(o(345));case 2:Sl(f,qi);break;case 3:if(pa(f,M),(M&130023424)===M&&(p=f1+500-ni(),10<p)){if(Gp(f,0)!==0)break;if(C=f.suspendedLanes,(C&M)!==M){Ri(),f.pingedLanes|=f.suspendedLanes&C;break}f.timeoutHandle=se(Sl.bind(null,f,qi),p);break}Sl(f,qi);break;case 4:if(pa(f,M),(M&4194240)===M)break;for(p=f.eventTimes,C=-1;0<M;){var $=31-fs(M);D=1<<$,$=p[$],$>C&&(C=$),M&=~D}if(M=C,M=ni()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*w4(M/1960))-M,10<M){f.timeoutHandle=se(Sl.bind(null,f,qi),M);break}Sl(f,qi);break;case 5:Sl(f,qi);break;default:throw Error(o(329))}}}return Xi(f,ni()),f.callbackNode===w?R3.bind(null,f):null}function v1(f,p){var w=ud;return f.current.memoizedState.isDehydrated&&(wl(f,p).flags|=256),f=Pm(f,p),f!==2&&(p=qi,qi=w,p!==null&&y1(p)),f}function y1(f){qi===null?qi=f:qi.push.apply(qi,f)}function S4(f){for(var p=f;;){if(p.flags&16384){var w=p.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var M=0;M<w.length;M++){var C=w[M],D=C.getSnapshot;C=C.value;try{if(!Gs(D(),C))return!1}catch{return!1}}}if(w=p.child,p.subtreeFlags&16384&&w!==null)w.return=p,p=w;else{if(p===f)break;for(;p.sibling===null;){if(p.return===null||p.return===f)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function pa(f,p){for(p&=~d1,p&=~Sm,f.suspendedLanes|=p,f.pingedLanes&=~p,f=f.expirationTimes;0<p;){var w=31-fs(p),M=1<<w;f[w]=-1,p&=~M}}function O3(f){if(Tt&6)throw Error(o(327));bl();var p=Gp(f,0);if(!(p&1))return Xi(f,ni()),null;var w=Pm(f,p);if(f.tag!==0&&w===2){var M=wy(f);M!==0&&(p=M,w=v1(f,M))}if(w===1)throw w=ld,wl(f,0),pa(f,p),Xi(f,ni()),w;if(w===6)throw Error(o(345));return f.finishedWork=f.current.alternate,f.finishedLanes=p,Sl(f,qi),Xi(f,ni()),null}function z3(f){da!==null&&da.tag===0&&!(Tt&6)&&bl();var p=Tt;Tt|=1;var w=Rn.transition,M=Ut;try{if(Rn.transition=null,Ut=1,f)return f()}finally{Ut=M,Rn.transition=w,Tt=p,!(Tt&6)&&Hs()}}function x1(){hr=Zu.current,wt(Zu)}function wl(f,p){f.finishedWork=null,f.finishedLanes=0;var w=f.timeoutHandle;if(w!==ae&&(f.timeoutHandle=ae,le(w)),Vn!==null)for(w=Vn.return;w!==null;){var M=w;switch(Ny(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&Bp();break;case 3:Xu(),wt(ti),wt(Ht),Hy();break;case 5:Vy(M);break;case 4:Xu();break;case 13:wt(vn);break;case 19:wt(vn);break;case 10:Ly(M.type._context);break;case 22:case 23:x1()}w=w.return}if(Fn=f,Vn=f=ma(f.current,null),ci=hr=p,$n=0,ld=null,d1=Sm=Ju=0,qi=ud=null,Ws!==null){for(p=0;p<Ws.length;p++)if(w=Ws[p],M=w.interleaved,M!==null){w.interleaved=null;var C=M.next,D=w.pending;if(D!==null){var $=D.next;D.next=C,M.next=$}w.pending=M}Ws=null}return f}function N3(f,p){do{var w=Vn;try{if(Py(),tm.current=am,nm){for(var M=Tn.memoizedState;M!==null;){var C=M.queue;C!==null&&(C.pending=null),M=M.next}nm=!1}if(Yu=0,ii=vi=Tn=null,Qh=!1,ed=0,h1.current=null,w===null||w.return===null){$n=1,ld=p,Vn=null;break}e:{var D=f,$=w.return,ie=w,we=p;if(p=ci,ie.flags|=32768,we!==null&&typeof we=="object"&&typeof we.then=="function"){var Ne=we,Ke=ie,yt=Ke.tag;if(!(Ke.mode&1)&&(yt===0||yt===11||yt===15)){var dt=Ke.alternate;dt?(Ke.updateQueue=dt.updateQueue,Ke.memoizedState=dt.memoizedState,Ke.lanes=dt.lanes):(Ke.updateQueue=null,Ke.memoizedState=null)}var Qt=i3($);if(Qt!==null){Qt.flags&=-257,r3(Qt,$,ie,D,p),Qt.mode&1&&n3(D,Ne,p),p=Qt,we=Ne;var st=p.updateQueue;if(st===null){var _i=new Set;_i.add(we),p.updateQueue=_i}else st.add(we);break e}else{if(!(p&1)){n3(D,Ne,p),_1();break e}we=Error(o(426))}}else if(pn&&ie.mode&1){var Ur=i3($);if(Ur!==null){!(Ur.flags&65536)&&(Ur.flags|=256),r3(Ur,$,ie,D,p),Uy(we);break e}}D=we,$n!==4&&($n=2),ud===null?ud=[D]:ud.push(D),we=Zy(we,ie),ie=$;do{switch(ie.tag){case 3:ie.flags|=65536,p&=-p,ie.lanes|=p;var me=e3(ie,we,p);S2(ie,me);break e;case 1:D=we;var oe=ie.type,xe=ie.stateNode;if(!(ie.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||xe!==null&&typeof xe.componentDidCatch=="function"&&(ha===null||!ha.has(xe)))){ie.flags|=65536,p&=-p,ie.lanes|=p;var $e=t3(ie,D,p);S2(ie,$e);break e}}ie=ie.return}while(ie!==null)}U3(w)}catch(rt){p=rt,Vn===w&&w!==null&&(Vn=w=w.return);continue}break}while(1)}function k3(){var f=wm.current;return wm.current=am,f===null?am:f}function _1(){($n===0||$n===3||$n===2)&&($n=4),Fn===null||!(Ju&268435455)&&!(Sm&268435455)||pa(Fn,ci)}function Pm(f,p){var w=Tt;Tt|=2;var M=k3();Fn===f&&ci===p||wl(f,p);do try{b4();break}catch(C){N3(f,C)}while(1);if(Py(),Tt=w,wm.current=M,Vn!==null)throw Error(o(261));return Fn=null,ci=0,$n}function b4(){for(;Vn!==null;)B3(Vn)}function M4(){for(;Vn!==null&&!ZN();)B3(Vn)}function B3(f){var p=G3(f.alternate,f,hr);f.memoizedProps=f.pendingProps,p===null?U3(f):Vn=p,h1.current=null}function U3(f){var p=f;do{var w=p.alternate;if(f=p.return,p.flags&32768){if(w=g4(w,p),w!==null){w.flags&=32767,Vn=w;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{$n=6,Vn=null;return}}else if(w=f4(w,p,hr),w!==null){Vn=w;return}if(p=p.sibling,p!==null){Vn=p;return}Vn=p=f}while(p!==null);$n===0&&($n=5)}function Sl(f,p){var w=Ut,M=Rn.transition;try{Rn.transition=null,Ut=1,E4(f,p,w)}finally{Rn.transition=M,Ut=w}return null}function E4(f,p,w){do bl();while(da!==null);if(Tt&6)throw Error(o(327));var M=f.finishedWork,C=f.finishedLanes;if(M===null)return null;if(f.finishedWork=null,f.finishedLanes=0,M===f.current)throw Error(o(177));f.callbackNode=null,f.callbackPriority=0;var D=M.lanes|M.childLanes;if(YN(f,D),f===Fn&&(Vn=Fn=null,ci=0),!(M.subtreeFlags&2064)&&!(M.flags&2064)||Mm||(Mm=!0,H3(Ay,function(){return bl(),null})),D=(M.flags&15990)!==0,M.subtreeFlags&15990||D){D=Rn.transition,Rn.transition=null;var $=Ut;Ut=1;var ie=Tt;Tt|=4,h1.current=null,y4(f,M),x4(f,M),U(f.containerInfo),f.current=M,_4(M),JN(),Tt=ie,Ut=$,Rn.transition=D}else f.current=M;if(Mm&&(Mm=!1,da=f,Em=C),D=f.pendingLanes,D===0&&(ha=null),e4(M.stateNode),Xi(f,ni()),p!==null)for(w=f.onRecoverableError,M=0;M<p.length;M++)w(p[M]);if(bm)throw bm=!1,f=m1,m1=null,f;return Em&1&&f.tag!==0&&bl(),D=f.pendingLanes,D&1?f===g1?cd++:(cd=0,g1=f):cd=0,Hs(),null}function bl(){if(da!==null){var f=v2(Em),p=Rn.transition,w=Ut;try{if(Rn.transition=null,Ut=16>f?16:f,da===null)var M=!1;else{if(f=da,da=null,Em=0,Tt&6)throw Error(o(331));var C=Tt;for(Tt|=4,je=f.current;je!==null;){var D=je,$=D.child;if(je.flags&16){var ie=D.deletions;if(ie!==null){for(var we=0;we<ie.length;we++){var Ne=ie[we];for(je=Ne;je!==null;){var Ke=je;switch(Ke.tag){case 0:case 11:case 15:_l(8,Ke,D)}var yt=Ke.child;if(yt!==null)yt.return=Ke,je=yt;else for(;je!==null;){Ke=je;var dt=Ke.sibling,Qt=Ke.return;if(b3(Ke),Ke===Ne){je=null;break}if(dt!==null){dt.return=Qt,je=dt;break}je=Qt}}}var st=D.alternate;if(st!==null){var _i=st.child;if(_i!==null){st.child=null;do{var Ur=_i.sibling;_i.sibling=null,_i=Ur}while(_i!==null)}}je=D}}if(D.subtreeFlags&2064&&$!==null)$.return=D,je=$;else e:for(;je!==null;){if(D=je,D.flags&2048)switch(D.tag){case 0:case 11:case 15:_l(9,D,D.return)}var me=D.sibling;if(me!==null){me.return=D.return,je=me;break e}je=D.return}}var oe=f.current;for(je=oe;je!==null;){$=je;var xe=$.child;if($.subtreeFlags&2064&&xe!==null)xe.return=$,je=xe;else e:for($=oe;je!==null;){if(ie=je,ie.flags&2048)try{switch(ie.tag){case 0:case 11:case 15:od(9,ie)}}catch(rt){Yi(ie,ie.return,rt)}if(ie===$){je=null;break e}var $e=ie.sibling;if($e!==null){$e.return=ie.return,je=$e;break e}je=ie.return}}if(Tt=C,Hs(),Vs&&typeof Vs.onPostCommitFiberRoot=="function")try{Vs.onPostCommitFiberRoot(Hp,f)}catch{}M=!0}return M}finally{Ut=w,Rn.transition=p}}return!1}function F3(f,p,w){p=Zy(w,p),p=e3(f,p,1),ca(f,p),p=Ri(),f=Cm(f,1),f!==null&&(qh(f,1,p),Xi(f,p))}function Yi(f,p,w){if(f.tag===3)F3(f,f,w);else for(;p!==null;){if(p.tag===3){F3(p,f,w);break}else if(p.tag===1){var M=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(ha===null||!ha.has(M))){f=Zy(w,f),f=t3(p,f,1),ca(p,f),f=Ri(),p=Cm(p,1),p!==null&&(qh(p,1,f),Xi(p,f));break}}p=p.return}}function A4(f,p,w){var M=f.pingCache;M!==null&&M.delete(p),p=Ri(),f.pingedLanes|=f.suspendedLanes&w,Fn===f&&(ci&w)===w&&($n===4||$n===3&&(ci&130023424)===ci&&500>ni()-f1?wl(f,0):d1|=w),Xi(f,p)}function V3(f,p){p===0&&(f.mode&1?(p=Vp,Vp<<=1,!(Vp&130023424)&&(Vp=4194304)):p=1);var w=Ri();f=Cm(f,p),f!==null&&(qh(f,p,w),Xi(f,w))}function T4(f){var p=f.memoizedState,w=0;p!==null&&(w=p.retryLane),V3(f,w)}function C4(f,p){var w=0;switch(f.tag){case 13:var M=f.stateNode,C=f.memoizedState;C!==null&&(w=C.retryLane);break;case 19:M=f.stateNode;break;default:throw Error(o(314))}M!==null&&M.delete(p),V3(f,w)}var G3;G3=function(f,p,w){if(f!==null)if(f.memoizedProps!==p.pendingProps||ti.current)cr=!0;else{if(!(f.lanes&w)&&!(p.flags&128))return cr=!1,m4(f,p,w);cr=!!(f.flags&131072)}else cr=!1,pn&&p.flags&1048576&&C2(p,Kp,p.index);switch(p.lanes=0,p.tag){case 2:var M=p.type;f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2),f=p.pendingProps;var C=wo(p,Ht.current);Gu(p,w),C=jy(null,p,M,f,C,w);var D=$y();return p.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,$i(M)?(D=!0,Up(p)):D=!1,p.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,Dy(p),C.updater=Zp,p.stateNode=C,C._reactInternals=p,Oy(p,M,f,w),p=Qy(null,p,M,!0,D,w)):(p.tag=0,pn&&D&&zy(p),Di(null,p,C,w),p=p.child),p;case 16:M=p.elementType;e:{switch(f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2),f=p.pendingProps,C=M._init,M=C(M._payload),p.type=M,C=p.tag=L4(M),f=ps(M,f),C){case 0:p=Ky(null,p,M,f,w);break e;case 1:p=d3(null,p,M,f,w);break e;case 11:p=a3(null,p,M,f,w);break e;case 14:p=l3(null,p,M,ps(M.type,f),w);break e}throw Error(o(306,M,""))}return p;case 0:return M=p.type,C=p.pendingProps,C=p.elementType===M?C:ps(M,C),Ky(f,p,M,C,w);case 1:return M=p.type,C=p.pendingProps,C=p.elementType===M?C:ps(M,C),d3(f,p,M,C,w);case 3:e:{if(f3(p),f===null)throw Error(o(387));M=p.pendingProps,D=p.memoizedState,C=D.element,w2(f,p),Yp(p,M,null,w);var $=p.memoizedState;if(M=$.element,Q&&D.isDehydrated)if(D={element:M,isDehydrated:!1,cache:$.cache,transitions:$.transitions},p.updateQueue.baseState=D,p.memoizedState=D,p.flags&256){C=Error(o(423)),p=p3(f,p,M,w,C);break e}else if(M!==C){C=Error(o(424)),p=p3(f,p,M,w,C);break e}else for(Q&&(ur=de(p.stateNode.containerInfo),lr=p,pn=!0,ms=null,Xh=!1),w=O2(p,null,M,w),p.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(ju(),M===C){p=To(f,p,w);break e}Di(f,p,M,w)}p=p.child}return p;case 5:return z2(p),f===null&&By(p),M=p.type,C=p.pendingProps,D=f!==null?f.memoizedProps:null,$=C.children,ee(M,C)?$=null:D!==null&&ee(M,D)&&(p.flags|=32),h3(f,p),Di(f,p,$,w),p.child;case 6:return f===null&&By(p),null;case 13:return m3(f,p,w);case 4:return Fy(p,p.stateNode.containerInfo),M=p.pendingProps,f===null?p.child=$u(p,null,M,w):Di(f,p,M,w),p.child;case 11:return M=p.type,C=p.pendingProps,C=p.elementType===M?C:ps(M,C),a3(f,p,M,C,w);case 7:return Di(f,p,p.pendingProps,w),p.child;case 8:return Di(f,p,p.pendingProps.children,w),p.child;case 12:return Di(f,p,p.pendingProps.children,w),p.child;case 10:e:{if(M=p.type._context,C=p.pendingProps,D=p.memoizedProps,$=C.value,_2(p,M,$),D!==null)if(Gs(D.value,$)){if(D.children===C.children&&!ti.current){p=To(f,p,w);break e}}else for(D=p.child,D!==null&&(D.return=p);D!==null;){var ie=D.dependencies;if(ie!==null){$=D.child;for(var we=ie.firstContext;we!==null;){if(we.context===M){if(D.tag===1){we=bo(-1,w&-w),we.tag=2;var Ne=D.updateQueue;if(Ne!==null){Ne=Ne.shared;var Ke=Ne.pending;Ke===null?we.next=we:(we.next=Ke.next,Ke.next=we),Ne.pending=we}}D.lanes|=w,we=D.alternate,we!==null&&(we.lanes|=w),Iy(D.return,w,p),ie.lanes|=w;break}we=we.next}}else if(D.tag===10)$=D.type===p.type?null:D.child;else if(D.tag===18){if($=D.return,$===null)throw Error(o(341));$.lanes|=w,ie=$.alternate,ie!==null&&(ie.lanes|=w),Iy($,w,p),$=D.sibling}else $=D.child;if($!==null)$.return=D;else for($=D;$!==null;){if($===p){$=null;break}if(D=$.sibling,D!==null){D.return=$.return,$=D;break}$=$.return}D=$}Di(f,p,C.children,w),p=p.child}return p;case 9:return C=p.type,M=p.pendingProps.children,Gu(p,w),C=Dr(C),M=M(C),p.flags|=1,Di(f,p,M,w),p.child;case 14:return M=p.type,C=ps(M,p.pendingProps),C=ps(M.type,C),l3(f,p,M,C,w);case 15:return u3(f,p,p.type,p.pendingProps,w);case 17:return M=p.type,C=p.pendingProps,C=p.elementType===M?C:ps(M,C),f!==null&&(f.alternate=null,p.alternate=null,p.flags|=2),p.tag=1,$i(M)?(f=!0,Up(p)):f=!1,Gu(p,w),A2(p,M,C),Oy(p,M,C,w),Qy(null,p,M,!0,f,w);case 19:return x3(f,p,w);case 22:return c3(f,p,w)}throw Error(o(156,p.tag))};function H3(f,p){return My(f,p)}function P4(f,p,w,M){this.tag=f,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Br(f,p,w,M){return new P4(f,p,w,M)}function w1(f){return f=f.prototype,!(!f||!f.isReactComponent)}function L4(f){if(typeof f=="function")return w1(f)?1:0;if(f!=null){if(f=f.$$typeof,f===v)return 11;if(f===_)return 14}return 2}function ma(f,p){var w=f.alternate;return w===null?(w=Br(f.tag,p,f.key,f.mode),w.elementType=f.elementType,w.type=f.type,w.stateNode=f.stateNode,w.alternate=f,f.alternate=w):(w.pendingProps=p,w.type=f.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=f.flags&14680064,w.childLanes=f.childLanes,w.lanes=f.lanes,w.child=f.child,w.memoizedProps=f.memoizedProps,w.memoizedState=f.memoizedState,w.updateQueue=f.updateQueue,p=f.dependencies,w.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},w.sibling=f.sibling,w.index=f.index,w.ref=f.ref,w}function Lm(f,p,w,M,C,D){var $=2;if(M=f,typeof f=="function")w1(f)&&($=1);else if(typeof f=="string")$=5;else e:switch(f){case d:return Ml(w.children,C,D,p);case c:$=8,C|=8;break;case h:return f=Br(12,w,p,C|2),f.elementType=h,f.lanes=D,f;case x:return f=Br(13,w,p,C),f.elementType=x,f.lanes=D,f;case y:return f=Br(19,w,p,C),f.elementType=y,f.lanes=D,f;case b:return Im(w,C,D,p);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case m:$=10;break e;case g:$=9;break e;case v:$=11;break e;case _:$=14;break e;case S:$=16,M=null;break e}throw Error(o(130,f==null?f:typeof f,""))}return p=Br($,w,p,C),p.elementType=f,p.type=M,p.lanes=D,p}function Ml(f,p,w,M){return f=Br(7,f,M,p),f.lanes=w,f}function Im(f,p,w,M){return f=Br(22,f,M,p),f.elementType=b,f.lanes=w,f.stateNode={},f}function S1(f,p,w){return f=Br(6,f,null,p),f.lanes=w,f}function b1(f,p,w){return p=Br(4,f.children!==null?f.children:[],f.key,p),p.lanes=w,p.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},p}function I4(f,p,w,M,C){this.tag=p,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ae,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sy(0),this.expirationTimes=Sy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sy(0),this.identifierPrefix=M,this.onRecoverableError=C,Q&&(this.mutableSourceEagerHydrationData=null)}function W3(f,p,w,M,C,D,$,ie,we){return f=new I4(f,p,w,ie,we),p===1?(p=1,D===!0&&(p|=8)):p=0,D=Br(3,null,null,p),f.current=D,D.stateNode=f,D.memoizedState={element:M,isDehydrated:w,cache:null,transitions:null},Dy(D),f}function j3(f){if(!f)return Ir;f=f._reactInternals;e:{if(I(f)!==f||f.tag!==1)throw Error(o(170));var p=f;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if($i(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(o(171))}if(f.tag===1){var w=f.type;if($i(w))return m2(f,w,p)}return p}function $3(f){var p=f._reactInternals;if(p===void 0)throw typeof f.render=="function"?Error(o(188)):(f=Object.keys(f).join(","),Error(o(268,f)));return f=k(p),f===null?null:f.stateNode}function q3(f,p){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var w=f.retryLane;f.retryLane=w!==0&&w<p?w:p}}function M1(f,p){q3(f,p),(f=f.alternate)&&q3(f,p)}function D4(f){return f=k(f),f===null?null:f.stateNode}function R4(){return null}return n.attemptContinuousHydration=function(f){if(f.tag===13){var p=Ri();kr(f,134217728,p),M1(f,134217728)}},n.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var p=Ri(),w=fa(f);kr(f,w,p),M1(f,w)}},n.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var p=f.stateNode;if(p.current.memoizedState.isDehydrated){var w=$h(p.pendingLanes);w!==0&&(by(p,w|1),Xi(p,ni()),!(Tt&6)&&(Ku(),Hs()))}break;case 13:var M=Ri();z3(function(){return kr(f,1,M)}),M1(f,1)}},n.batchedUpdates=function(f,p){var w=Tt;Tt|=1;try{return f(p)}finally{Tt=w,Tt===0&&(Ku(),Wp&&Hs())}},n.createComponentSelector=function(f){return{$$typeof:gm,value:f}},n.createContainer=function(f,p,w,M,C,D,$){return W3(f,p,!1,null,w,M,C,D,$)},n.createHasPseudoClassSelector=function(f){return{$$typeof:vm,value:f}},n.createHydrationContainer=function(f,p,w,M,C,D,$,ie,we){return f=W3(w,M,!0,f,C,D,$,ie,we),f.context=j3(null),w=f.current,M=Ri(),C=fa(w),D=bo(M,C),D.callback=p??null,ca(w,D),f.current.lanes=C,qh(f,C,M),Xi(f,M),f},n.createPortal=function(f,p,w){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:M==null?null:""+M,children:f,containerInfo:p,implementation:w}},n.createRoleSelector=function(f){return{$$typeof:ym,value:f}},n.createTestNameSelector=function(f){return{$$typeof:xm,value:f}},n.createTextSelector=function(f){return{$$typeof:_m,value:f}},n.deferredUpdates=function(f){var p=Ut,w=Rn.transition;try{return Rn.transition=null,Ut=16,f()}finally{Ut=p,Rn.transition=w}},n.discreteUpdates=function(f,p,w,M,C){var D=Ut,$=Rn.transition;try{return Rn.transition=null,Ut=1,f(p,w,M,C)}finally{Ut=D,Rn.transition=$,Tt===0&&Ku()}},n.findAllNodes=c1,n.findBoundingRects=function(f,p){if(!Ye)throw Error(o(363));p=c1(f,p),f=[];for(var w=0;w<p.length;w++)f.push(H(p[w]));for(p=f.length-1;0<p;p--){w=f[p];for(var M=w.x,C=M+w.width,D=w.y,$=D+w.height,ie=p-1;0<=ie;ie--)if(p!==ie){var we=f[ie],Ne=we.x,Ke=Ne+we.width,yt=we.y,dt=yt+we.height;if(M>=Ne&&D>=yt&&C<=Ke&&$<=dt){f.splice(p,1);break}else if(M!==Ne||w.width!==we.width||dt<D||yt>$){if(!(D!==yt||w.height!==we.height||Ke<M||Ne>C)){Ne>M&&(we.width+=Ne-M,we.x=M),Ke<C&&(we.width=C-Ne),f.splice(p,1);break}}else{yt>D&&(we.height+=yt-D,we.y=D),dt<$&&(we.height=$-yt),f.splice(p,1);break}}}return f},n.findHostInstance=$3,n.findHostInstanceWithNoPortals=function(f){return f=O(f),f=f!==null?G(f):null,f===null?null:f.stateNode},n.findHostInstanceWithWarning=function(f){return $3(f)},n.flushControlled=function(f){var p=Tt;Tt|=1;var w=Rn.transition,M=Ut;try{Rn.transition=null,Ut=1,f()}finally{Ut=M,Rn.transition=w,Tt=p,Tt===0&&(Ku(),Hs())}},n.flushPassiveEffects=bl,n.flushSync=z3,n.focusWithin=function(f,p){if(!Ye)throw Error(o(363));for(f=a1(f),p=D3(f,p),p=Array.from(p),f=0;f<p.length;){var w=p[f++];if(!ge(w)){if(w.tag===5&&Oe(w.stateNode))return!0;for(w=w.child;w!==null;)p.push(w),w=w.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Ut},n.getFindAllNodesFailureDescription=function(f,p){if(!Ye)throw Error(o(363));var w=0,M=[];f=[a1(f),0];for(var C=0;C<f.length;){var D=f[C++],$=f[C++],ie=p[$];if((D.tag!==5||!ge(D))&&(l1(D,ie)&&(M.push(u1(ie)),$++,$>w&&(w=$)),$<p.length))for(D=D.child;D!==null;)f.push(D,$),D=D.sibling}if(w<p.length){for(f=[];w<p.length;w++)f.push(u1(p[w]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},n.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return ne(f.child.stateNode);default:return f.child.stateNode}},n.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:D4,findFiberByHostInstance:f.findFiberByHostInstance||R4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var p=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(p.isDisabled||!p.supportsFiber)f=!0;else{try{Hp=p.inject(f),Vs=p}catch{}f=!!p.checkDCE}}return f},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(f,p,w,M){if(!Ye)throw Error(o(363));f=c1(f,p);var C=Be(f,w,M).disconnect;return{disconnect:function(){C()}}},n.registerMutableSourceForHydration=function(f,p){var w=p._getVersion;w=w(p._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[p,w]:f.mutableSourceEagerHydrationData.push(p,w)},n.runWithPriority=function(f,p){var w=Ut;try{return Ut=f,p()}finally{Ut=w}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(f,p,w,M){var C=p.current,D=Ri(),$=fa(C);return w=j3(w),p.context===null?p.context=w:p.pendingContext=w,p=bo(D,$),p.payload={element:f},M=M===void 0?null:M,M!==null&&(p.callback=M),ca(C,p),f=kr(C,$,D),f!==null&&Xp(f,C,$),$},n};(function(t){t.exports=dW})(cW);const fW=jP(Xw);function eO(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}const Fo=[];function tO(t,e,n=!1,i={}){for(const s of Fo)if(eO(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,promise:t(...e).then(s=>r.response=s).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const s=Fo.indexOf(r);s!==-1&&Fo.splice(s,1)},i.lifespan)}).catch(s=>r.error=s)};if(Fo.push(r),!n)throw r.promise}const pW=(t,e,n)=>tO(t,e,!1,n),mW=(t,e,n)=>void tO(t,e,!0,n),gW=t=>{if(t===void 0||t.length===0)Fo.splice(0,Fo.length);else{const e=Fo.find(n=>eO(t,n.keys,n.equal));if(e){const n=Fo.indexOf(e);n!==-1&&Fo.splice(n,1)}}},_M={},vW=t=>void Object.assign(_M,t);function yW(t,e){function n(d,{args:c=[],attach:h,...m},g){let v=`${d[0].toUpperCase()}${d.slice(1)}`,x;if(d==="primitive"){if(m.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=m.object;x=Sc(y,{type:d,root:g,attach:h,primitive:!0})}else{const y=_M[v];if(!y)throw new Error(`R3F: ${v} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(c))throw new Error("R3F: The args prop must be an array!");x=Sc(new y(...c),{type:d,root:g,attach:h,memoizedProps:{args:c}})}return x.__r3f.attach===void 0&&(x instanceof Ze?x.__r3f.attach="geometry":x instanceof gi&&(x.__r3f.attach="material")),v!=="inject"&&Dx(x,m),x}function i(d,c){let h=!1;if(c){var m,g;(m=c.__r3f)!=null&&m.attach?Ix(d,c,c.__r3f.attach):c.isObject3D&&d.isObject3D&&(d.add(c),h=!0),h||(g=d.__r3f)==null||g.objects.push(c),c.__r3f||Sc(c,{}),c.__r3f.parent=d,Zw(c),bc(c)}}function r(d,c,h){let m=!1;if(c){var g,v;if((g=c.__r3f)!=null&&g.attach)Ix(d,c,c.__r3f.attach);else if(c.isObject3D&&d.isObject3D){c.parent=d,c.dispatchEvent({type:"added"});const x=d.children.filter(_=>_!==c),y=x.indexOf(h);d.children=[...x.slice(0,y),c,...x.slice(y)],m=!0}m||(v=d.__r3f)==null||v.objects.push(c),c.__r3f||Sc(c,{}),c.__r3f.parent=d,Zw(c),bc(c)}}function s(d,c,h=!1){d&&[...d].forEach(m=>o(c,m,h))}function o(d,c,h){if(c){var m,g,v;if(c.__r3f&&(c.__r3f.parent=null),(m=d.__r3f)!=null&&m.objects&&(d.__r3f.objects=d.__r3f.objects.filter(b=>b!==c)),(g=c.__r3f)!=null&&g.attach)CT(d,c,c.__r3f.attach);else if(c.isObject3D&&d.isObject3D){var x;d.remove(c),(x=c.__r3f)!=null&&x.root&&EW(c.__r3f.root,c)}const _=(v=c.__r3f)==null?void 0:v.primitive,S=h===void 0?c.dispose!==null&&!_:h;if(!_){var y;s((y=c.__r3f)==null?void 0:y.objects,c,S),s(c.children,c,S)}c.__r3f&&(delete c.__r3f.root,delete c.__r3f.objects,delete c.__r3f.handlers,delete c.__r3f.memoizedProps,_||delete c.__r3f),S&&c.dispose&&c.type!=="Scene"&&sp.unstable_scheduleCallback(sp.unstable_IdlePriority,()=>{try{c.dispose()}catch{}}),bc(d)}}function a(d,c,h,m){var g;const v=(g=d.__r3f)==null?void 0:g.parent;if(!v)return;const x=n(c,h,d.__r3f.root);if(d.children){for(const y of d.children)y.__r3f&&i(x,y);d.children=d.children.filter(y=>!y.__r3f)}d.__r3f.objects.forEach(y=>i(x,y)),d.__r3f.objects=[],d.__r3f.autoRemovedBeforeAppend||o(v,d),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),i(v,x),x.raycast&&x.__r3f.eventCount&&x.__r3f.root.getState().internal.interaction.push(x),[m,m.alternate].forEach(y=>{y!==null&&(y.stateNode=x,y.ref&&(typeof y.ref=="function"?y.ref(x):y.ref.current=x))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:fW({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,c)=>{if(!c)return;const h=d.getState().scene;h.__r3f&&(h.__r3f.root=d,i(h,c))},removeChildFromContainer:(d,c)=>{c&&o(d.getState().scene,c)},insertInContainerBefore:(d,c,h)=>{if(!c||!h)return;const m=d.getState().scene;m.__r3f&&r(m,c,h)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var c;return!!((c=d==null?void 0:d.__r3f)!=null?c:{}).handlers},prepareUpdate(d,c,h,m){if(d.__r3f.primitive&&m.object&&m.object!==d)return[!0];{const{args:g=[],children:v,...x}=m,{args:y=[],children:_,...S}=h;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((T,E)=>T!==y[E]))return[!0];const b=uO(d,x,S,!0);return b.changes.length?[!1,b]:null}},commitUpdate(d,[c,h],m,g,v,x){c?a(d,m,v,x):Dx(d,h)},commitMount(d,c,h,m){var g;const v=(g=d.__r3f)!=null?g:{};d.raycast&&v.handlers&&v.eventCount&&d.__r3f.root.getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>Sc(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var c;const{attach:h,parent:m}=(c=d.__r3f)!=null?c:{};h&&m&&CT(m,d,h),d.isObject3D&&(d.visible=!1),bc(d)},unhideInstance(d,c){var h;const{attach:m,parent:g}=(h=d.__r3f)!=null?h:{};m&&g&&Ix(g,d,m),(d.isObject3D&&c.visible==null||c.visible)&&(d.visible=!0),bc(d)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():za.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&cn.fun(performance.now)?performance.now:cn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:cn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:cn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Dx}}var MT,ET;const nO=()=>{var t;return(t=_M.ColorManagement)!=null?t:null},iO=t=>t&&t.isOrthographicCamera,xW=t=>t&&t.hasOwnProperty("current"),Pp=typeof window<"u"&&((MT=window.document)!=null&&MT.createElement||((ET=window.navigator)==null?void 0:ET.product)==="ReactNative")?Ce.useLayoutEffect:Ce.useEffect;function rO(t){const e=Ce.useRef(t);return Pp(()=>void(e.current=t),[t]),e}function _W({set:t}){return Pp(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class sO extends Ce.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}sO.getDerivedStateFromError=()=>({error:!0});const oO="__default",AT=new Map,wW=t=>t&&!!t.memoized&&!!t.changes;function aO(t){const e=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(t)?Math.min(Math.max(t[0],e),t[1]):t}const Id=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},cn={obj:t=>t===Object(t)&&!cn.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(cn.str(t)||cn.num(t))return t===e;const s=cn.obj(t);if(s&&i==="reference")return t===e;const o=cn.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!cn.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(cn.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function lO(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function SW(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function Sc(t,e){const n=t;return(e!=null&&e.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),t}function Yw(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}const TT=/-\d+$/;function Ix(t,e,n){if(cn.str(n)){if(TT.test(n)){const s=n.replace(TT,""),{target:o,key:a}=Yw(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=Yw(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function CT(t,e,n){var i,r;if(cn.str(n)){const{target:s,key:o}=Yw(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function uO(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},u=!1){var d;const c=(d=t==null?void 0:t.__r3f)!=null?d:{},h=Object.entries(r),m=[];if(u){const v=Object.keys(l);for(let x=0;x<v.length;x++)r.hasOwnProperty(v[x])||h.unshift([v[x],oO+"remove"])}h.forEach(([v,x])=>{var y;if((y=t.__r3f)!=null&&y.primitive&&v==="object"||cn.equ(x,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return m.push([v,x,!0,[]]);let _=[];v.includes("-")&&(_=v.split("-")),m.push([v,x,!1,_]);for(const S in r){const b=r[S];S.startsWith(`${v}-`)&&m.push([S,b,!1,S.split("-")])}});const g={...r};return c.memoizedProps&&c.memoizedProps.args&&(g.args=c.memoizedProps.args),c.memoizedProps&&c.memoizedProps.attach&&(g.attach=c.memoizedProps.attach),{memoized:g,changes:m}}function Dx(t,e){var n,i,r;const s=(n=t.__r3f)!=null?n:{},o=s.root,a=(i=o==null||o.getState==null?void 0:o.getState())!=null?i:{},{memoized:l,changes:u}=wW(e)?e:uO(t,e),d=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let h=0;h<u.length;h++){let[m,g,v,x]=u[h],y=t,_=y[m];if(x.length&&(_=x.reduce((S,b)=>S[b],t),!(_&&_.set))){const[S,...b]=x.reverse();y=b.reverse().reduce((T,E)=>T[E],t),m=S}if(g===oO+"remove")if(y.constructor){let S=AT.get(y.constructor);S||(S=new y.constructor,AT.set(y.constructor,S)),g=S[m]}else g=0;if(v)g?s.handlers[m]=g:delete s.handlers[m],s.eventCount=Object.keys(s.handlers).length;else if(_&&_.set&&(_.copy||_ instanceof uu)){if(Array.isArray(g))_.fromArray?_.fromArray(g):_.set(...g);else if(_.copy&&g&&g.constructor&&_.constructor===g.constructor)_.copy(g);else if(g!==void 0){const S=_ instanceof Ge;!S&&_.setScalar?_.setScalar(g):_ instanceof uu&&g instanceof uu?_.mask=g.mask:_.set(g),!nO()&&!a.linear&&S&&_.convertSRGBToLinear()}}else y[m]=g,!a.linear&&y[m]instanceof gn&&y[m].format===Ji&&y[m].type===na&&(y[m].encoding=jt);bc(t)}if(s.parent&&a.internal&&t.raycast&&d!==s.eventCount){const h=a.internal.interaction.indexOf(t);h>-1&&a.internal.interaction.splice(h,1),s.eventCount&&a.internal.interaction.push(t)}return!(u.length===1&&u[0][0]==="onUpdate")&&u.length&&(r=t.__r3f)!=null&&r.parent&&Zw(t),t}function bc(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function Zw(t){t.onUpdate==null||t.onUpdate(t)}function bW(t,e){t.manual||(iO(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function Og(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function MW(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return za.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return za.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return za.ContinuousEventPriority;default:return za.DefaultEventPriority}}function cO(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function EW(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{cO(n.capturedMap,e,i,r)})}function AW(t){function e(l){const{internal:u}=t.getState(),d=l.offsetX-u.initialClick[0],c=l.offsetY-u.initialClick[1];return Math.round(Math.sqrt(d*d+c*c))}function n(l){return l.filter(u=>["Move","Over","Enter","Out","Leave"].some(d=>{var c;return(c=u.__r3f)==null?void 0:c.handlers["onPointer"+d]}))}function i(l,u){const d=t.getState(),c=new Set,h=[],m=u?u(d.internal.interaction):d.internal.interaction;for(let y=0;y<m.length;y++){const _=Id(m[y]);_&&(_.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(l,d);function g(y){const _=Id(y);if(!_||!_.events.enabled||_.raycaster.camera===null)return[];if(_.raycaster.camera===void 0){var S;_.events.compute==null||_.events.compute(l,_,(S=_.previousRoot)==null?void 0:S.getState()),_.raycaster.camera===void 0&&(_.raycaster.camera=null)}return _.raycaster.camera?_.raycaster.intersectObject(y,!0):[]}let v=m.flatMap(g).sort((y,_)=>{const S=Id(y.object),b=Id(_.object);return!S||!b?y.distance-_.distance:b.events.priority-S.events.priority||y.distance-_.distance}).filter(y=>{const _=Og(y);return c.has(_)?!1:(c.add(_),!0)});d.events.filter&&(v=d.events.filter(v,d));for(const y of v){let _=y.object;for(;_;){var x;(x=_.__r3f)!=null&&x.eventCount&&h.push({...y,eventObject:_}),_=_.parent}}if("pointerId"in l&&d.internal.capturedMap.has(l.pointerId))for(let y of d.internal.capturedMap.get(l.pointerId).values())c.has(Og(y.intersection))||h.push(y.intersection);return h}function r(l,u,d,c){const h=t.getState();if(l.length){const m={stopped:!1};for(const g of l){const v=Id(g.object)||h,{raycaster:x,pointer:y,camera:_,internal:S}=v,b=new R(y.x,y.y,0).unproject(_),T=P=>{var O,k;return(O=(k=S.capturedMap.get(P))==null?void 0:k.has(g.eventObject))!=null?O:!1},E=P=>{const O={intersection:g,target:u.target};S.capturedMap.has(P)?S.capturedMap.get(P).set(g.eventObject,O):S.capturedMap.set(P,new Map([[g.eventObject,O]])),u.target.setPointerCapture(P)},L=P=>{const O=S.capturedMap.get(P);O&&cO(S.capturedMap,g.eventObject,O,P)};let A={};for(let P in u){let O=u[P];typeof O!="function"&&(A[P]=O)}let I={...g,...A,pointer:y,intersections:l,stopped:m.stopped,delta:d,unprojectedPoint:b,ray:x.ray,camera:_,stopPropagation(){const P="pointerId"in u&&S.capturedMap.get(u.pointerId);if((!P||P.has(g.eventObject))&&(I.stopped=m.stopped=!0,S.hovered.size&&Array.from(S.hovered.values()).find(O=>O.eventObject===g.eventObject))){const O=l.slice(0,l.indexOf(g));s([...O,g])}},target:{hasPointerCapture:T,setPointerCapture:E,releasePointerCapture:L},currentTarget:{hasPointerCapture:T,setPointerCapture:E,releasePointerCapture:L},nativeEvent:u};if(c(I),m.stopped===!0)break}}return l}function s(l){const{internal:u}=t.getState();for(const d of u.hovered.values())if(!l.length||!l.find(c=>c.object===d.object&&c.index===d.index&&c.instanceId===d.instanceId)){const h=d.eventObject.__r3f,m=h==null?void 0:h.handlers;if(u.hovered.delete(Og(d)),h!=null&&h.eventCount){const g={...d,intersections:l};m.onPointerOut==null||m.onPointerOut(g),m.onPointerLeave==null||m.onPointerLeave(g)}}}function o(l,u){for(let d=0;d<u.length;d++){const c=u[d].__r3f;c==null||c.handlers.onPointerMissed==null||c.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return u=>{const{internal:d}=t.getState();"pointerId"in u&&d.capturedMap.has(u.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(u.pointerId)&&(d.capturedMap.delete(u.pointerId),s([]))})}}return function(d){const{onPointerMissed:c,internal:h}=t.getState();h.lastEvent.current=d;const m=l==="onPointerMove",g=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",x=i(d,m?n:void 0),y=g?e(d):0;l==="onPointerDown"&&(h.initialClick=[d.offsetX,d.offsetY],h.initialHits=x.map(S=>S.eventObject)),g&&!x.length&&y<=2&&(o(d,h.interaction),c&&c(d)),m&&s(x);function _(S){const b=S.eventObject,T=b.__r3f,E=T==null?void 0:T.handlers;if(T!=null&&T.eventCount)if(m){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const L=Og(S),A=h.hovered.get(L);A?A.stopped&&S.stopPropagation():(h.hovered.set(L,S),E.onPointerOver==null||E.onPointerOver(S),E.onPointerEnter==null||E.onPointerEnter(S))}E.onPointerMove==null||E.onPointerMove(S)}else{const L=E[l];L?(!g||h.initialHits.includes(b))&&(o(d,h.interaction.filter(A=>!h.initialHits.includes(A))),L(S)):g&&h.initialHits.includes(b)&&o(d,h.interaction.filter(A=>!h.initialHits.includes(A)))}}r(x,d,y,_)}}return{handlePointer:a}}const hO=t=>!!(t!=null&&t.render),dO=Ce.createContext(null),TW=(t,e)=>{const n=uW((a,l)=>{const u=new R,d=new R,c=new R;function h(y=l().camera,_=d,S=l().size){const{width:b,height:T,top:E,left:L}=S,A=b/T;_ instanceof R?c.copy(_):c.set(..._);const I=y.getWorldPosition(u).distanceTo(c);if(iO(y))return{width:b/y.zoom,height:T/y.zoom,top:E,left:L,factor:1,distance:I,aspect:A};{const P=y.fov*Math.PI/180,O=2*Math.tan(P/2)*I,k=O*(b/T);return{width:k,height:O,top:E,left:L,factor:b/k,distance:I,aspect:A}}}let m;const g=y=>a(_=>({performance:{..._.performance,current:y}})),v=new te;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>t(l(),y),advance:(y,_)=>e(y,_,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new mM,pointer:v,mouse:v,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();m&&clearTimeout(m),y.performance.current!==y.performance.min&&g(y.performance.min),m=setTimeout(()=>g(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:y=>a(_=>({..._,events:{..._.events,...y}})),setSize:(y,_,S,b,T)=>{const E=l().camera,L={width:y,height:_,top:b||0,left:T||0,updateStyle:S};a(A=>({size:L,viewport:{...A.viewport,...h(E,d,L)}}))},setDpr:y=>a(_=>{const S=aO(y);return{viewport:{..._.viewport,dpr:S,initialDpr:_.viewport.initialDpr||S}}}),setFrameloop:(y="always")=>{const _=l().clock;_.stop(),_.elapsedTime=0,y!=="never"&&(_.start(),_.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:Ce.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,_,S)=>{const b=l().internal;return b.priority=b.priority+(_>0?1:0),b.subscribers.push({ref:y,priority:_,store:S}),b.subscribers=b.subscribers.sort((T,E)=>T.priority-E.priority),()=>{const T=l().internal;T!=null&&T.subscribers&&(T.priority=T.priority-(_>0?1:0),T.subscribers=T.subscribers.filter(E=>E.ref!==y))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:u,gl:d,set:c}=n.getState();if(l!==r||u.dpr!==s){var h;r=l,s=u.dpr,bW(a,l),d.setPixelRatio(u.dpr);const m=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(l.width,l.height,m)}a!==o&&(o=a,c(m=>({viewport:{...m.viewport,...m.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};let zg,CW=new Set,PW=new Set,LW=new Set;function Rx(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function Dd(t,e){switch(t){case"before":return Rx(CW,e);case"after":return Rx(PW,e);case"tail":return Rx(LW,e)}}let Ox,zx;function Nx(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),Ox=e.internal.subscribers,zg=0;zg<Ox.length;zg++)zx=Ox[zg],zx.ref.current(zx.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function IW(t){let e=!1,n,i,r;function s(l){i=requestAnimationFrame(s),e=!0,n=0,Dd("before",l);for(const d of t.values()){var u;r=d.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((u=r.gl.xr)!=null&&u.isPresenting)&&(n+=Nx(l,r))}if(Dd("after",l),n===0)return Dd("tail",l),e=!1,cancelAnimationFrame(i)}function o(l,u=1){var d;if(!l)return t.forEach(c=>o(c.store.getState()),u);(d=l.gl.xr)!=null&&d.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+u),e||(e=!0,requestAnimationFrame(s)))}function a(l,u=!0,d,c){if(u&&Dd("before",l),d)Nx(l,d,c);else for(const h of t.values())Nx(l,h.store.getState());u&&Dd("after",l)}return{loop:s,invalidate:o,advance:a}}function fO(){const t=Ce.useContext(dO);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function vf(t=n=>n,e){return fO()(t,e)}function pO(t,e=0){const n=fO(),i=n.getState().internal.subscribe,r=rO(t);return Pp(()=>i(r,e,n),[e,i,n]),null}function DW(t){return Ce.useMemo(()=>lO(t),[t])}function mO(t,e){return function(n,...i){const r=new n;return t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,lO(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function wM(t,e,n,i){const r=Array.isArray(e)?e:[e],s=pW(mO(n,i),[t,...r],{equal:cn.equ});return Array.isArray(e)?s:s[0]}wM.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return mW(mO(n),[t,...i])};wM.clear=function(t,e){const n=Array.isArray(e)?e:[e];return gW([t,...n])};const vh=new Map,{invalidate:PT,advance:LT}=IW(vh),{reconciler:nv,applyProps:Rd}=yW(vh,MW),yc={objects:"shallow",strict:!1},RW=(t,e)=>{const n=typeof t=="function"?t(e):t;return hO(n)?n:new qb({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function OW(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function zW(t){const e=vh.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||TW(PT,LT),o=n||nv.createContainer(s,za.ConcurrentRoot,null,!1,null,"",r,null);e||vh.set(t,{fiber:o,store:s});let a,l=!1,u;return{configure(d={}){let{gl:c,size:h,scene:m,events:g,onCreated:v,shadows:x=!1,linear:y=!1,flat:_=!1,legacy:S=!1,orthographic:b=!1,frameloop:T="always",dpr:E=[1,2],performance:L,raycaster:A,camera:I,onPointerMissed:P}=d,O=s.getState(),k=O.gl;O.gl||O.set({gl:k=RW(c,t)});let F=O.raycaster;F||O.set({raycaster:F=new xM});const{params:G,...Z}=A||{};if(cn.equ(Z,F,yc)||Rd(F,{...Z}),cn.equ(G,F.params,yc)||Rd(F,{params:{...F.params,...G}}),!O.camera||O.camera===u&&!cn.equ(u,I,yc)){u=I;const X=I instanceof Lu,N=X?I:b?new ia(0,0,0,0,.1,1e3):new Un(75,0,.1,1e3);X||(N.position.z=5,I&&Rd(N,I),!O.camera&&!(I!=null&&I.rotation)&&N.lookAt(0,0,0)),O.set({camera:N})}if(!O.scene){let X;m instanceof Yf?X=m:(X=new Yf,m&&Rd(X,m)),O.set({scene:Sc(X)})}if(!O.xr){const X=(Y,ee)=>{const W=s.getState();W.frameloop!=="never"&&LT(Y,!0,W,ee)},N=()=>{const Y=s.getState();Y.gl.xr.enabled=Y.gl.xr.isPresenting,Y.gl.xr.setAnimationLoop(Y.gl.xr.isPresenting?X:null),Y.gl.xr.isPresenting||PT(Y)},q={connect(){const Y=s.getState().gl;Y.xr.addEventListener("sessionstart",N),Y.xr.addEventListener("sessionend",N)},disconnect(){const Y=s.getState().gl;Y.xr.removeEventListener("sessionstart",N),Y.xr.removeEventListener("sessionend",N)}};k.xr&&q.connect(),O.set({xr:q})}if(k.shadowMap){const X=k.shadowMap.enabled,N=k.shadowMap.type;if(k.shadowMap.enabled=!!x,cn.boo(x))k.shadowMap.type=hf;else if(cn.str(x)){var ne;const q={basic:nD,percentage:jv,soft:hf,variance:Zl};k.shadowMap.type=(ne=q[x])!=null?ne:hf}else cn.obj(x)&&Object.assign(k.shadowMap,x);(X!==k.shadowMap.enabled||N!==k.shadowMap.type)&&(k.shadowMap.needsUpdate=!0)}const J=nO();J&&("enabled"in J?J.enabled=!S:"legacyMode"in J&&(J.legacyMode=S));const z=y?ls:jt,V=_?Ps:zb;k.outputEncoding!==z&&(k.outputEncoding=z),k.toneMapping!==V&&(k.toneMapping=V),O.legacy!==S&&O.set(()=>({legacy:S})),O.linear!==y&&O.set(()=>({linear:y})),O.flat!==_&&O.set(()=>({flat:_})),c&&!cn.fun(c)&&!hO(c)&&!cn.equ(c,k,yc)&&Rd(k,c),g&&!O.events.handlers&&O.set({events:g(s)});const U=OW(t,h);return cn.equ(U,O.size,yc)||O.setSize(U.width,U.height,U.updateStyle,U.top,U.left),E&&O.viewport.dpr!==aO(E)&&O.setDpr(E),O.frameloop!==T&&O.setFrameloop(T),O.onPointerMissed||O.set({onPointerMissed:P}),L&&!cn.equ(L,O.performance,yc)&&O.set(X=>({performance:{...X.performance,...L}})),a=v,l=!0,this},render(d){return l||this.configure(),nv.updateContainer(Ce.createElement(NW,{store:s,children:d,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){gO(t)}}}function NW({store:t,children:e,onCreated:n,rootElement:i}){return Pp(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Ce.createElement(dO.Provider,{value:t},e)}function gO(t,e){const n=vh.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),nv.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),SW(r),vh.delete(t),e&&e(t)}catch{}},500)})}}nv.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:Ce.version});function yh(){return yh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},yh.apply(this,arguments)}function Jw(t,e,n){var i,r,s,o,a;e==null&&(e=100);function l(){var d=Date.now()-o;d<e&&d>=0?i=setTimeout(l,e-d):(i=null,n||(a=t.apply(s,r),s=r=null))}var u=function(){s=this,r=arguments,o=Date.now();var d=n&&!i;return i||(i=setTimeout(l,e)),d&&(a=t.apply(s,r),s=r=null),a};return u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(a=t.apply(s,r),s=r=null,clearTimeout(i),i=null)},u}Jw.debounce=Jw;var IT=Jw;function kW(t){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=Ce.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=Ce.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),u=e?typeof e=="number"?e:e.scroll:null,d=e?typeof e=="number"?e:e.resize:null,c=Ce.useRef(!1);Ce.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[h,m,g]=Ce.useMemo(()=>{const _=()=>{if(!l.current.element)return;const{left:S,top:b,width:T,height:E,bottom:L,right:A,x:I,y:P}=l.current.element.getBoundingClientRect(),O={left:S,top:b,width:T,height:E,bottom:L,right:A,x:I,y:P};l.current.element instanceof HTMLElement&&r&&(O.height=l.current.element.offsetHeight,O.width=l.current.element.offsetWidth),Object.freeze(O),c.current&&!VW(l.current.lastBounds,O)&&a(l.current.lastBounds=O)};return[_,d?IT(_,d):_,u?IT(_,u):_]},[a,r,u,d]);function v(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",g,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function x(){l.current.element&&(l.current.resizeObserver=new s(g),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(_=>_.addEventListener("scroll",g,{capture:!0,passive:!0})))}const y=_=>{!_||_===l.current.element||(v(),l.current.element=_,l.current.scrollContainers=vO(_),x())};return UW(g,!!n),BW(m),Ce.useEffect(()=>{v(),x()},[n,g,m]),Ce.useEffect(()=>v,[]),[y,o,h]}function BW(t){Ce.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function UW(t,e){Ce.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function vO(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...vO(t.parentElement)]}const FW=["x","y","top","bottom","left","right","width","height"],VW=(t,e)=>FW.every(n=>t[n]===e[n]);var GW=Object.defineProperty,HW=Object.defineProperties,WW=Object.getOwnPropertyDescriptors,DT=Object.getOwnPropertySymbols,jW=Object.prototype.hasOwnProperty,$W=Object.prototype.propertyIsEnumerable,RT=(t,e,n)=>e in t?GW(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,OT=(t,e)=>{for(var n in e||(e={}))jW.call(e,n)&&RT(t,n,e[n]);if(DT)for(var n of DT(e))$W.call(e,n)&&RT(t,n,e[n]);return t},qW=(t,e)=>HW(t,WW(e));function yO(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=yO(i,e,n);if(r)return r;i=e?null:i.sibling}}function xO(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const SM=xO(Ce.createContext(null));class _O extends Ce.Component{render(){return Ce.createElement(SM.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:zT,ReactCurrentDispatcher:NT}=Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function XW(){const t=Ce.useContext(SM);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ce.useId();return Ce.useMemo(()=>{var i;return(i=zT==null?void 0:zT.current)!=null?i:yO(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}})},[t,e])}function YW(){var t,e;const n=XW(),[i]=Ce.useState(()=>new Map);i.clear();let r=n;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==SM&&!i.has(s)&&i.set(s,(e=NT==null?void 0:NT.current)==null?void 0:e.readContext(xO(s))),r=r.return}return i}function ZW(){const t=YW();return Ce.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>Ce.createElement(e,null,Ce.createElement(n.Provider,qW(OT({},i),{value:t.get(n)}))),e=>Ce.createElement(_O,OT({},e))),[t])}const kx={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function JW(t){const{handlePointer:e}=AW(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(kx).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,u]=kx[o];n.addEventListener(l,a,{passive:u})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=kx[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}const KW=Ce.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=JW,eventSource:a,eventPrefix:l,shadows:u,linear:d,flat:c,legacy:h,orthographic:m,frameloop:g,dpr:v,performance:x,raycaster:y,camera:_,onPointerMissed:S,onCreated:b,...T},E){Ce.useMemo(()=>vW(sW),[]);const L=ZW(),[A,I]=kW({scroll:!0,debounce:{scroll:50,resize:0},...i}),P=Ce.useRef(null),O=Ce.useRef(null);Ce.useImperativeHandle(E,()=>P.current);const k=rO(S),[F,G]=Ce.useState(!1),[Z,ne]=Ce.useState(!1);if(F)throw F;if(Z)throw Z;const J=Ce.useRef(null);Pp(()=>{const V=P.current;I.width>0&&I.height>0&&V&&(J.current||(J.current=zW(V)),J.current.configure({gl:s,events:o,shadows:u,linear:d,flat:c,legacy:h,orthographic:m,frameloop:g,dpr:v,performance:x,raycaster:y,camera:_,size:I,onPointerMissed:(...U)=>k.current==null?void 0:k.current(...U),onCreated:U=>{U.events.connect==null||U.events.connect(a?xW(a)?a.current:a:O.current),l&&U.setEvents({compute:(X,N)=>{const q=X[l+"X"],Y=X[l+"Y"];N.pointer.set(q/N.size.width*2-1,-(Y/N.size.height)*2+1),N.raycaster.setFromCamera(N.pointer,N.camera)}}),b==null||b(U)}}),J.current.render(Ce.createElement(L,null,Ce.createElement(sO,{set:ne},Ce.createElement(Ce.Suspense,{fallback:Ce.createElement(_W,{set:G})},e)))))}),Ce.useEffect(()=>{const V=P.current;if(V)return()=>gO(V)},[]);const z=a?"none":"auto";return Ce.createElement("div",yh({ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:z,...r}},T),Ce.createElement("div",{ref:A,style:{width:"100%",height:"100%"}},Ce.createElement("canvas",{ref:P,style:{display:"block"}},n)))}),QW=Ce.forwardRef(function(e,n){return Ce.createElement(_O,null,Ce.createElement(KW,yh({},e,{ref:n})))}),Lp=new R,bM=new R,e9=new R;function t9(t,e,n){const i=Lp.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}function n9(t,e){const n=Lp.setFromMatrixPosition(t.matrixWorld),i=bM.setFromMatrixPosition(e.matrixWorld),r=n.sub(i),s=e.getWorldDirection(e9);return r.angleTo(s)>Math.PI/2}function i9(t,e,n,i){const r=Lp.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),n.setFromCamera(s,e);const o=n.intersectObjects(i,!0);if(o.length){const a=o[0].distance;return r.distanceTo(n.ray.origin)<a}return!0}function r9(t,e){if(e instanceof ia)return e.zoom;if(e instanceof Un){const n=Lp.setFromMatrixPosition(t.matrixWorld),i=bM.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function s9(t,e,n){if(e instanceof Un||e instanceof ia){const i=Lp.setFromMatrixPosition(t.matrixWorld),r=bM.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(e.far-e.near),a=n[1]-o*e.far;return Math.round(o*s+a)}}const Kw=t=>Math.abs(t)<1e-10?0:t;function wO(t,e,n=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=Kw(e[r]*t.elements[r])+(r!==15?",":")");return n+i}const o9=(t=>e=>wO(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),a9=(t=>(e,n)=>wO(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function l9(t){return t&&typeof t=="object"&&"current"in t}const kT=Ce.forwardRef(({children:t,eps:e=.001,style:n,className:i,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:u=!1,transform:d=!1,occlude:c,onOcclude:h,castShadow:m,receiveShadow:g,material:v,geometry:x,zIndexRange:y=[16777271,0],calculatePosition:_=t9,as:S="div",wrapperClass:b,pointerEvents:T="auto",...E},L)=>{const{gl:A,camera:I,scene:P,size:O,raycaster:k,events:F,viewport:G}=vf(),[Z]=Ce.useState(()=>document.createElement(S)),ne=Ce.useRef(),J=Ce.useRef(null),z=Ce.useRef(0),V=Ce.useRef([0,0]),U=Ce.useRef(null),X=Ce.useRef(null),N=(a==null?void 0:a.current)||F.connected||A.domElement.parentNode,q=Ce.useRef(null),Y=Ce.useRef(!1),ee=Ce.useMemo(()=>c&&c!=="blending"||Array.isArray(c)&&c.length&&l9(c[0]),[c]);Ce.useLayoutEffect(()=>{const ue=A.domElement;c&&c==="blending"?(ue.style.zIndex=`${Math.floor(y[0]/2)}`,ue.style.position="absolute",ue.style.pointerEvents="none"):(ue.style.zIndex=null,ue.style.position=null,ue.style.pointerEvents=null)},[c]),Ce.useLayoutEffect(()=>{if(J.current){const ue=ne.current=Db(Z);if(P.updateMatrixWorld(),d)Z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const fe=_(J.current,I,O);Z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${fe[0]}px,${fe[1]}px,0);transform-origin:0 0;`}return N&&(r?N.prepend(Z):N.appendChild(Z)),()=>{N&&N.removeChild(Z),ue.unmount()}}},[N,d]),Ce.useLayoutEffect(()=>{b&&(Z.className=b)},[b]);const W=Ce.useMemo(()=>d?{position:"absolute",top:0,left:0,width:O.width,height:O.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-O.height/2,left:-O.width/2,width:O.width,height:O.height},...n},[n,s,o,O,d]),se=Ce.useMemo(()=>({position:"absolute",pointerEvents:T}),[T]);Ce.useLayoutEffect(()=>{if(Y.current=!1,d){var ue;(ue=ne.current)==null||ue.render(Ce.createElement("div",{ref:U,style:W},Ce.createElement("div",{ref:X,style:se},Ce.createElement("div",{ref:L,className:i,style:n,children:t}))))}else{var fe;(fe=ne.current)==null||fe.render(Ce.createElement("div",{ref:L,style:W,className:i,children:t}))}});const le=Ce.useRef(!0);pO(ue=>{if(J.current){I.updateMatrixWorld(),J.current.updateWorldMatrix(!0,!1);const fe=d?V.current:_(J.current,I,O);if(d||Math.abs(z.current-I.zoom)>e||Math.abs(V.current[0]-fe[0])>e||Math.abs(V.current[1]-fe[1])>e){const K=n9(J.current,I);let Q=!1;ee&&(c!=="blending"?Q=[P]:Array.isArray(c)&&(Q=c.map(Te=>Te.current)));const he=le.current;if(Q){const Te=i9(J.current,I,k,Q);le.current=Te&&!K}else le.current=!K;he!==le.current&&(h?h(!le.current):Z.style.display=le.current?"block":"none");const ye=Math.floor(y[0]/2),be=c?ee?[y[0],ye]:[ye-1,0]:y;if(Z.style.zIndex=`${s9(J.current,I,be)}`,d){const[Te,Le]=[O.width/2,O.height/2],ze=I.projectionMatrix.elements[5]*Le,{isOrthographicCamera:Ye,top:nt,left:H,bottom:B,right:ge}=I,Pe=o9(I.matrixWorldInverse),Oe=Ye?`scale(${ze})translate(${Kw(-(ge+H)/2)}px,${Kw((nt+B)/2)}px)`:`translateZ(${ze}px)`;let Be=J.current.matrixWorld;u&&(Be=I.matrixWorldInverse.clone().transpose().copyPosition(Be).scale(J.current.scale),Be.elements[3]=Be.elements[7]=Be.elements[11]=0,Be.elements[15]=1),Z.style.width=O.width+"px",Z.style.height=O.height+"px",Z.style.perspective=Ye?"":`${ze}px`,U.current&&X.current&&(U.current.style.transform=`${Oe}${Pe}translate(${Te}px,${Le}px)`,X.current.style.transform=a9(Be,1/((l||10)/400)))}else{const Te=l===void 0?1:r9(J.current,I)*l;Z.style.transform=`translate3d(${fe[0]}px,${fe[1]}px,0) scale(${Te})`}V.current=fe,z.current=I.zoom}}if(!ee&&q.current&&!Y.current)if(d){if(U.current){const fe=U.current.children[0];if(fe!=null&&fe.clientWidth&&fe!=null&&fe.clientHeight){const{isOrthographicCamera:K}=I;if(K||x)E.scale&&(Array.isArray(E.scale)?E.scale instanceof R?q.current.scale.copy(E.scale.clone().divideScalar(1)):q.current.scale.set(1/E.scale[0],1/E.scale[1],1/E.scale[2]):q.current.scale.setScalar(1/E.scale));else{const Q=(l||10)/400,he=fe.clientWidth*Q,ye=fe.clientHeight*Q;q.current.scale.set(he,ye,1)}Y.current=!0}}}else{const fe=Z.children[0];if(fe!=null&&fe.clientWidth&&fe!=null&&fe.clientHeight){const K=1/G.factor,Q=fe.clientWidth*K,he=fe.clientHeight*K;q.current.scale.set(Q,he,1),Y.current=!0}q.current.lookAt(ue.camera.position)}});const ae=Ce.useMemo(()=>({vertexShader:d?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[d]);return Ce.createElement("group",yh({},E,{ref:J}),c&&!ee&&Ce.createElement("mesh",{castShadow:m,receiveShadow:g,ref:q},x||Ce.createElement("planeGeometry",null),v||Ce.createElement("shaderMaterial",{side:so,vertexShader:ae.vertexShader,fragmentShader:ae.fragmentShader})))});function u9(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}function c9(t,e,n){const{gl:i,size:r,viewport:s}=vf(),o=typeof t=="number"?t:r.width*s.dpr,a=typeof e=="number"?e:r.height*s.dpr,l=(typeof t=="number"?n:t)||{},{samples:u=0,depth:d,...c}=l,h=Ce.useMemo(()=>{let m;return m=new us(o,a,{minFilter:xn,magFilter:xn,encoding:i.outputEncoding,type:yu,...c}),d&&(m.depthTexture=new $b(o,a,oo)),m.samples=u,m},[]);return Ce.useLayoutEffect(()=>{h.setSize(o,a),u&&(h.samples=u)},[u,h,o,a]),Ce.useEffect(()=>()=>h.dispose(),[]),h}const h9=t=>typeof t=="function",d9=Ce.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,children:i,makeDefault:r,...s},o)=>{const a=vf(({set:x})=>x),l=vf(({camera:x})=>x),u=vf(({size:x})=>x),d=Ce.useRef(null),c=Ce.useRef(null),h=c9(e);Ce.useLayoutEffect(()=>{s.manual||d.current.updateProjectionMatrix()},[u,s]),Ce.useLayoutEffect(()=>{d.current.updateProjectionMatrix()}),Ce.useLayoutEffect(()=>{if(r){const x=l;return a(()=>({camera:d.current})),()=>a(()=>({camera:x}))}},[d,r,a]);let m=0,g=null;const v=h9(i);return pO(x=>{v&&(n===1/0||m<n)&&(c.current.visible=!1,x.gl.setRenderTarget(h),g=x.scene.background,t&&(x.scene.background=t),x.gl.render(x.scene,d.current),x.scene.background=g,x.gl.setRenderTarget(null),c.current.visible=!0,m++)}),Ce.createElement(Ce.Fragment,null,Ce.createElement("orthographicCamera",yh({left:u.width/-2,right:u.width/2,top:u.height/2,bottom:u.height/-2,ref:u9([d,o])},s),!v&&i),Ce.createElement("group",{ref:c},v&&i(h.texture)))}),f9="modulepreload",p9=function(t){return"/"+t},BT={},SO=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=p9(s),s in BT)return;BT[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let d=r.length-1;d>=0;d--){const c=r[d];if(c.href===s&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":f9,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((d,c)=>{u.addEventListener("load",d),u.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};function bO(t,e=!1){const n=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Ze;let u=0;for(let d=0;d<t.length;++d){const c=t[d];let h=0;if(n!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const m in c.attributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;s[m]===void 0&&(s[m]=[]),s[m].push(c.attributes[m]),h++}if(h!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(a!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const m in c.morphAttributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[m]===void 0&&(o[m]=[]),o[m].push(c.morphAttributes[m])}if(e){let m;if(n)m=c.index.count;else if(c.attributes.position!==void 0)m=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,m,d),u+=m}}if(n){let d=0;const c=[];for(let h=0;h<t.length;++h){const m=t[h].index;for(let g=0;g<m.count;++g)c.push(m.getX(g)+d);d+=t[h].attributes.position.count}l.setIndex(c)}for(const d in s){const c=UT(s[d]);if(!c)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" attribute."),null;l.setAttribute(d,c)}for(const d in o){const c=o[d][0].length;if(c===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[d]=[];for(let h=0;h<c;++h){const m=[];for(let v=0;v<o[d].length;++v)m.push(o[d][v][h]);const g=UT(m);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+d+" morphAttribute."),null;l.morphAttributes[d].push(g)}}return l}function UT(t){let e,n,i,r=0;for(let a=0;a<t.length;++a){const l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=l.itemSize),n!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}const s=new e(r);let o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new pt(s,n,i)}const Bx=new WeakMap;class m9 extends Wi{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,i,r){const s=new cs(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.decodeDracoFile(o,n).catch(r)},i,r)}decodeDracoFile(e,n,i,r){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,s).then(n)}decodeGeometry(e,n){const i=JSON.stringify(n);if(Bx.has(e)){const l=Bx.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((u,d)=>{r._callbacks[s]={resolve:u,reject:d},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Bx.set(e,{key:i,promise:a}),a}_createGeometry(e){const n=new Ze;e.index&&n.setIndex(new pt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize;n.setAttribute(s,new pt(o,a))}return n}_loadLibrary(e,n){const i=new cs(this.manager);return i.setPath(this.decoderPath),i.setResponseType(n),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=g9.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=n,i._taskLoad+=n,i})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function g9(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(d){t.onModuleLoaded=function(c){d({draco:c})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,u=a.taskConfig;e.then(d=>{const c=d.draco,h=new c.Decoder,m=new c.DecoderBuffer;m.Init(new Int8Array(l),l.byteLength);try{const g=n(c,h,m,u),v=g.attributes.map(x=>x.array.buffer);g.index&&v.push(g.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:g},v)}catch(g){console.error(g),self.postMessage({type:"error",id:a.id,error:g.message})}finally{c.destroy(m),c.destroy(h)}});break}};function n(o,a,l,u){const d=u.attributeIDs,c=u.attributeTypes;let h,m;const g=a.GetEncodedGeometryType(l);if(g===o.TRIANGULAR_MESH)h=new o.Mesh,m=a.DecodeBufferToMesh(l,h);else if(g===o.POINT_CLOUD)h=new o.PointCloud,m=a.DecodeBufferToPointCloud(l,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!m.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+m.error_msg());const v={index:null,attributes:[]};for(const x in d){const y=self[c[x]];let _,S;if(u.useUniqueIDs)S=d[x],_=a.GetAttributeByUniqueId(h,S);else{if(S=a.GetAttributeId(h,o[d[x]]),S===-1)continue;_=a.GetAttribute(h,S)}v.attributes.push(r(o,a,h,x,y,_))}return g===o.TRIANGULAR_MESH&&(v.index=i(o,a,h)),o.destroy(h),v}function i(o,a,l){const d=l.num_faces()*3,c=d*4,h=o._malloc(c);a.GetTrianglesUInt32Array(l,c,h);const m=new Uint32Array(o.HEAPF32.buffer,h,d).slice();return o._free(h),{array:m,itemSize:1}}function r(o,a,l,u,d,c){const h=c.num_components(),g=l.num_points()*h,v=g*d.BYTES_PER_ELEMENT,x=s(o,d),y=o._malloc(v);a.GetAttributeDataArrayForAllPoints(l,c,x,v,y);const _=new d(o.HEAPF32.buffer,y,g).slice();return o._free(y),{name:u,array:_,itemSize:h}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var v9=Object.create,MM=Object.defineProperty,y9=Object.getOwnPropertyDescriptor,x9=Object.getOwnPropertyNames,_9=Object.getPrototypeOf,w9=Object.prototype.hasOwnProperty,sy=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),S9=(t,e)=>{for(var n in e)MM(t,n,{get:e[n],enumerable:!0})},b9=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of x9(e))!w9.call(t,r)&&r!==n&&MM(t,r,{get:()=>e[r],enumerable:!(i=y9(e,r))||i.enumerable});return t},oy=(t,e,n)=>(n=t!=null?v9(_9(t)):{},b9(e||!t||!t.__esModule?MM(n,"default",{value:t,enumerable:!0}):n,t)),M9=sy((t,e)=>{(function(n,i){typeof t=="object"?e.exports=i():typeof define=="function"&&define.amd?define(i):n.Alea=i()})(t,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var u=i();s=u(" "),o=u(" "),a=u(" ");for(var d=0;d<r.length;d++)s-=u(r[d]),s<0&&(s+=1),o-=u(r[d]),o<0&&(o+=1),a-=u(r[d]),a<0&&(a+=1);u=null;var c=function(){var h=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=h-(l=h|0)};return c.next=c,c.uint32=function(){return c()*4294967296},c.fract53=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.version="Alea 0.9",c.args=r,c.exportState=function(){return[s,o,a,l]},c.importState=function(h){s=+h[0]||0,o=+h[1]||0,a=+h[2]||0,l=+h[3]||0},c}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),E9=sy((t,e)=>{(function(n,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})(t,function(n){n.SVD=function(i,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,u,d,c,h,m,g,v,x,y,_,S,b=i[0].length,T=i.length;if(T<b)throw new TypeError("Invalid matrix: m < n");for(var E=[],L=[],A=[],I=r==="f"?T:b,P=y=g=0;P<T;P++)L[P]=new Array(I).fill(0);for(P=0;P<b;P++)A[P]=new Array(b).fill(0);var O,k=new Array(b).fill(0);for(P=0;P<T;P++)for(l=0;l<b;l++)L[P][l]=i[P][l];for(P=0;P<b;P++){for(E[P]=g,x=0,d=P+1,l=P;l<T;l++)x+=Math.pow(L[l][P],2);if(x<a)g=0;else for(v=(m=L[P][P])*(g=m<0?Math.sqrt(x):-Math.sqrt(x))-x,L[P][P]=m-g,l=d;l<b;l++){for(x=0,u=P;u<T;u++)x+=L[u][P]*L[u][l];for(m=x/v,u=P;u<T;u++)L[u][l]=L[u][l]+m*L[u][P]}for(k[P]=g,x=0,l=d;l<b;l++)x+=Math.pow(L[P][l],2);if(x<a)g=0;else{for(v=(m=L[P][P+1])*(g=m<0?Math.sqrt(x):-Math.sqrt(x))-x,L[P][P+1]=m-g,l=d;l<b;l++)E[l]=L[P][l]/v;for(l=d;l<T;l++){for(x=0,u=d;u<b;u++)x+=L[l][u]*L[P][u];for(u=d;u<b;u++)L[l][u]=L[l][u]+x*E[u]}}y<(_=Math.abs(k[P])+Math.abs(E[P]))&&(y=_)}if(s)for(P=b-1;0<=P;P--){if(g!==0){for(v=L[P][P+1]*g,l=d;l<b;l++)A[l][P]=L[P][l]/v;for(l=d;l<b;l++){for(x=0,u=d;u<b;u++)x+=L[P][u]*A[u][l];for(u=d;u<b;u++)A[u][l]=A[u][l]+x*A[u][P]}}for(l=d;l<b;l++)A[P][l]=0,A[l][P]=0;A[P][P]=1,g=E[P],d=P}if(r){if(r==="f")for(P=b;P<T;P++){for(l=b;l<T;l++)L[P][l]=0;L[P][P]=1}for(P=b-1;0<=P;P--){for(d=P+1,g=k[P],l=d;l<I;l++)L[P][l]=0;if(g!==0){for(v=L[P][P]*g,l=d;l<I;l++){for(x=0,u=d;u<T;u++)x+=L[u][P]*L[u][l];for(m=x/v,u=P;u<T;u++)L[u][l]=L[u][l]+m*L[u][P]}for(l=P;l<T;l++)L[l][P]=L[l][P]/g}else for(l=P;l<T;l++)L[l][P]=0;L[P][P]=L[P][P]+1}}for(o*=y,u=b-1;0<=u;u--)for(var F=0;F<50;F++){for(O=!1,d=u;0<=d;d--){if(Math.abs(E[d])<=o){O=!0;break}if(Math.abs(k[d-1])<=o)break}if(!O){for(h=0,c=d-(x=1),P=d;P<u+1&&(m=x*E[P],E[P]=h*E[P],!(Math.abs(m)<=o));P++)if(g=k[P],k[P]=Math.sqrt(m*m+g*g),h=g/(v=k[P]),x=-m/v,r)for(l=0;l<T;l++)_=L[l][c],S=L[l][P],L[l][c]=_*h+S*x,L[l][P]=-_*x+S*h}if(S=k[u],d===u){if(S<0&&(k[u]=-S,s))for(l=0;l<b;l++)A[l][u]=-A[l][u];break}for(y=k[d],m=(((_=k[u-1])-S)*(_+S)+((g=E[u-1])-(v=E[u]))*(g+v))/(2*v*_),g=Math.sqrt(m*m+1),m=((y-S)*(y+S)+v*(_/(m<0?m-g:m+g)-v))/y,P=d+(x=h=1);P<u+1;P++){if(g=E[P],_=k[P],v=x*g,g*=h,S=Math.sqrt(m*m+v*v),m=y*(h=m/(E[P-1]=S))+g*(x=v/S),g=-y*x+g*h,v=_*x,_*=h,s)for(l=0;l<b;l++)y=A[l][P-1],S=A[l][P],A[l][P-1]=y*h+S*x,A[l][P]=-y*x+S*h;if(S=Math.sqrt(m*m+v*v),m=(h=m/(k[P-1]=S))*g+(x=v/S)*_,y=-x*g+h*_,r)for(l=0;l<T;l++)_=L[l][P-1],S=L[l][P],L[l][P-1]=_*h+S*x,L[l][P]=-_*x+S*h}E[d]=0,E[u]=m,k[u]=y}for(P=0;P<b;P++)k[P]<o&&(k[P]=0);return{u:L,q:k,v:A}},n.VERSION="1.1.1",Object.defineProperty(n,"__esModule",{value:!0})})}),A9=sy(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var c=this||n;return c._counter=1e3,c._html5AudioPool=[],c.html5PoolSize=10,c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c._canPlayEvent="canplaythrough",c._navigator=typeof window<"u"&&window.navigator?window.navigator:null,c.masterGain=null,c.noAudio=!1,c.usingWebAudio=!0,c.autoSuspend=!0,c.ctx=null,c.autoUnlock=!0,c._setup(),c},volume:function(c){var h=this||n;if(c=parseFloat(c),h.ctx||d(),typeof c<"u"&&c>=0&&c<=1){if(h._volume=c,h._muted)return h;h.usingWebAudio&&h.masterGain.gain.setValueAtTime(c,n.ctx.currentTime);for(var m=0;m<h._howls.length;m++)if(!h._howls[m]._webAudio)for(var g=h._howls[m]._getSoundIds(),v=0;v<g.length;v++){var x=h._howls[m]._soundById(g[v]);x&&x._node&&(x._node.volume=x._volume*c)}return h}return h._volume},mute:function(c){var h=this||n;h.ctx||d(),h._muted=c,h.usingWebAudio&&h.masterGain.gain.setValueAtTime(c?0:h._volume,n.ctx.currentTime);for(var m=0;m<h._howls.length;m++)if(!h._howls[m]._webAudio)for(var g=h._howls[m]._getSoundIds(),v=0;v<g.length;v++){var x=h._howls[m]._soundById(g[v]);x&&x._node&&(x._node.muted=c?!0:x._muted)}return h},stop:function(){for(var c=this||n,h=0;h<c._howls.length;h++)c._howls[h].stop();return c},unload:function(){for(var c=this||n,h=c._howls.length-1;h>=0;h--)c._howls[h].unload();return c.usingWebAudio&&c.ctx&&typeof c.ctx.close<"u"&&(c.ctx.close(),c.ctx=null,d()),c},codecs:function(c){return(this||n)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||n;if(c.state=c.ctx&&c.ctx.state||"suspended",c._autoSuspend(),!c.usingWebAudio)if(typeof Audio<"u")try{var h=new Audio;typeof h.oncanplaythrough>"u"&&(c._canPlayEvent="canplay")}catch{c.noAudio=!0}else c.noAudio=!0;try{var h=new Audio;h.muted&&(c.noAudio=!0)}catch{}return c.noAudio||c._setupCodecs(),c},_setupCodecs:function(){var c=this||n,h=null;try{h=typeof Audio<"u"?new Audio:null}catch{return c}if(!h||typeof h.canPlayType!="function")return c;var m=h.canPlayType("audio/mpeg;").replace(/^no$/,""),g=c._navigator?c._navigator.userAgent:"",v=g.match(/OPR\/([0-6].)/g),x=v&&parseInt(v[0].split("/")[1],10)<33,y=g.indexOf("Safari")!==-1&&g.indexOf("Chrome")===-1,_=g.match(/Version\/(.*?) /),S=y&&_&&parseInt(_[1],10)<15;return c._codecs={mp3:!!(!x&&(m||h.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!m,opus:!!h.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!h.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(h.canPlayType('audio/wav; codecs="1"')||h.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!h.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!h.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(h.canPlayType("audio/x-m4a;")||h.canPlayType("audio/m4a;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(h.canPlayType("audio/x-m4b;")||h.canPlayType("audio/m4b;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(h.canPlayType("audio/x-mp4;")||h.canPlayType("audio/mp4;")||h.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!S&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!S&&h.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!h.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(h.canPlayType("audio/x-flac;")||h.canPlayType("audio/flac;")).replace(/^no$/,"")},c},_unlockAudio:function(){var c=this||n;if(!(c._audioUnlocked||!c.ctx)){c._audioUnlocked=!1,c.autoUnlock=!1,!c._mobileUnloaded&&c.ctx.sampleRate!==44100&&(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var h=function(m){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var g=new Audio;g._unlocked=!0,c._releaseHtml5Audio(g)}catch{c.noAudio=!0;break}for(var v=0;v<c._howls.length;v++)if(!c._howls[v]._webAudio)for(var x=c._howls[v]._getSoundIds(),y=0;y<x.length;y++){var _=c._howls[v]._soundById(x[y]);_&&_._node&&!_._node._unlocked&&(_._node._unlocked=!0,_._node.load())}c._autoResume();var S=c.ctx.createBufferSource();S.buffer=c._scratchBuffer,S.connect(c.ctx.destination),typeof S.start>"u"?S.noteOn(0):S.start(0),typeof c.ctx.resume=="function"&&c.ctx.resume(),S.onended=function(){S.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",h,!0),document.removeEventListener("touchend",h,!0),document.removeEventListener("click",h,!0),document.removeEventListener("keydown",h,!0);for(var b=0;b<c._howls.length;b++)c._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",h,!0),document.addEventListener("touchend",h,!0),document.addEventListener("click",h,!0),document.addEventListener("keydown",h,!0),c}},_obtainHtml5Audio:function(){var c=this||n;if(c._html5AudioPool.length)return c._html5AudioPool.pop();var h=new Audio().play();return h&&typeof Promise<"u"&&(h instanceof Promise||typeof h.then=="function")&&h.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(c){var h=this||n;return c._unlocked&&h._html5AudioPool.push(c),h},_autoSuspend:function(){var c=this;if(!(!c.autoSuspend||!c.ctx||typeof c.ctx.suspend>"u"||!n.usingWebAudio)){for(var h=0;h<c._howls.length;h++)if(c._howls[h]._webAudio){for(var m=0;m<c._howls[h]._sounds.length;m++)if(!c._howls[h]._sounds[m]._paused)return c}return c._suspendTimer&&clearTimeout(c._suspendTimer),c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null,c.state="suspending";var g=function(){c.state="suspended",c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(g,g)}},3e4),c}},_autoResume:function(){var c=this;if(!(!c.ctx||typeof c.ctx.resume>"u"||!n.usingWebAudio))return c.state==="running"&&c.ctx.state!=="interrupted"&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):c.state==="suspended"||c.state==="running"&&c.ctx.state==="interrupted"?(c.ctx.resume().then(function(){c.state="running";for(var h=0;h<c._howls.length;h++)c._howls[h]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):c.state==="suspending"&&(c._resumeAfterSuspend=!0),c}};var n=new e,i=function(c){var h=this;if(!c.src||c.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}h.init(c)};i.prototype={init:function(c){var h=this;return n.ctx||d(),h._autoplay=c.autoplay||!1,h._format=typeof c.format!="string"?c.format:[c.format],h._html5=c.html5||!1,h._muted=c.mute||!1,h._loop=c.loop||!1,h._pool=c.pool||5,h._preload=typeof c.preload=="boolean"||c.preload==="metadata"?c.preload:!0,h._rate=c.rate||1,h._sprite=c.sprite||{},h._src=typeof c.src!="string"?c.src:[c.src],h._volume=c.volume!==void 0?c.volume:1,h._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1},h._duration=0,h._state="unloaded",h._sounds=[],h._endTimers={},h._queue=[],h._playLock=!1,h._onend=c.onend?[{fn:c.onend}]:[],h._onfade=c.onfade?[{fn:c.onfade}]:[],h._onload=c.onload?[{fn:c.onload}]:[],h._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],h._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[],h._onpause=c.onpause?[{fn:c.onpause}]:[],h._onplay=c.onplay?[{fn:c.onplay}]:[],h._onstop=c.onstop?[{fn:c.onstop}]:[],h._onmute=c.onmute?[{fn:c.onmute}]:[],h._onvolume=c.onvolume?[{fn:c.onvolume}]:[],h._onrate=c.onrate?[{fn:c.onrate}]:[],h._onseek=c.onseek?[{fn:c.onseek}]:[],h._onunlock=c.onunlock?[{fn:c.onunlock}]:[],h._onresume=[],h._webAudio=n.usingWebAudio&&!h._html5,typeof n.ctx<"u"&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(h),h._autoplay&&h._queue.push({event:"play",action:function(){h.play()}}),h._preload&&h._preload!=="none"&&h.load(),h},load:function(){var c=this,h=null;if(n.noAudio){c._emit("loaderror",null,"No audio support.");return}typeof c._src=="string"&&(c._src=[c._src]);for(var m=0;m<c._src.length;m++){var g,v;if(c._format&&c._format[m])g=c._format[m];else{if(v=c._src[m],typeof v!="string"){c._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}g=/^data:audio\/([^;,]+);/i.exec(v),g||(g=/\.([^.]+)$/.exec(v.split("?",1)[0])),g&&(g=g[1].toLowerCase())}if(g||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),g&&n.codecs(g)){h=c._src[m];break}}if(!h){c._emit("loaderror",null,"No codec support for selected audio sources.");return}return c._src=h,c._state="loading",window.location.protocol==="https:"&&h.slice(0,5)==="http:"&&(c._html5=!0,c._webAudio=!1),new r(c),c._webAudio&&o(c),c},play:function(c,h){var m=this,g=null;if(typeof c=="number")g=c,c=null;else{if(typeof c=="string"&&m._state==="loaded"&&!m._sprite[c])return null;if(typeof c>"u"&&(c="__default",!m._playLock)){for(var v=0,x=0;x<m._sounds.length;x++)m._sounds[x]._paused&&!m._sounds[x]._ended&&(v++,g=m._sounds[x]._id);v===1?c=null:g=null}}var y=g?m._soundById(g):m._inactiveSound();if(!y)return null;if(g&&!c&&(c=y._sprite||"__default"),m._state!=="loaded"){y._sprite=c,y._ended=!1;var _=y._id;return m._queue.push({event:"play",action:function(){m.play(_)}}),_}if(g&&!y._paused)return h||m._loadQueue("play"),y._id;m._webAudio&&n._autoResume();var S=Math.max(0,y._seek>0?y._seek:m._sprite[c][0]/1e3),b=Math.max(0,(m._sprite[c][0]+m._sprite[c][1])/1e3-S),T=b*1e3/Math.abs(y._rate),E=m._sprite[c][0]/1e3,L=(m._sprite[c][0]+m._sprite[c][1])/1e3;y._sprite=c,y._ended=!1;var A=function(){y._paused=!1,y._seek=S,y._start=E,y._stop=L,y._loop=!!(y._loop||m._sprite[c][2])};if(S>=L){m._ended(y);return}var I=y._node;if(m._webAudio){var P=function(){m._playLock=!1,A(),m._refreshBuffer(y);var G=y._muted||m._muted?0:y._volume;I.gain.setValueAtTime(G,n.ctx.currentTime),y._playStart=n.ctx.currentTime,typeof I.bufferSource.start>"u"?y._loop?I.bufferSource.noteGrainOn(0,S,86400):I.bufferSource.noteGrainOn(0,S,b):y._loop?I.bufferSource.start(0,S,86400):I.bufferSource.start(0,S,b),T!==1/0&&(m._endTimers[y._id]=setTimeout(m._ended.bind(m,y),T)),h||setTimeout(function(){m._emit("play",y._id),m._loadQueue()},0)};n.state==="running"&&n.ctx.state!=="interrupted"?P():(m._playLock=!0,m.once("resume",P),m._clearTimer(y._id))}else{var O=function(){I.currentTime=S,I.muted=y._muted||m._muted||n._muted||I.muted,I.volume=y._volume*n.volume(),I.playbackRate=y._rate;try{var G=I.play();if(G&&typeof Promise<"u"&&(G instanceof Promise||typeof G.then=="function")?(m._playLock=!0,A(),G.then(function(){m._playLock=!1,I._unlocked=!0,h?m._loadQueue():m._emit("play",y._id)}).catch(function(){m._playLock=!1,m._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),y._ended=!0,y._paused=!0})):h||(m._playLock=!1,A(),m._emit("play",y._id)),I.playbackRate=y._rate,I.paused){m._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}c!=="__default"||y._loop?m._endTimers[y._id]=setTimeout(m._ended.bind(m,y),T):(m._endTimers[y._id]=function(){m._ended(y),I.removeEventListener("ended",m._endTimers[y._id],!1)},I.addEventListener("ended",m._endTimers[y._id],!1))}catch(Z){m._emit("playerror",y._id,Z)}};I.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(I.src=m._src,I.load());var k=window&&window.ejecta||!I.readyState&&n._navigator.isCocoonJS;if(I.readyState>=3||k)O();else{m._playLock=!0,m._state="loading";var F=function(){m._state="loaded",O(),I.removeEventListener(n._canPlayEvent,F,!1)};I.addEventListener(n._canPlayEvent,F,!1),m._clearTimer(y._id)}}return y._id},pause:function(c){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"pause",action:function(){h.pause(c)}}),h;for(var m=h._getSoundIds(c),g=0;g<m.length;g++){h._clearTimer(m[g]);var v=h._soundById(m[g]);if(v&&!v._paused&&(v._seek=h.seek(m[g]),v._rateSeek=0,v._paused=!0,h._stopFade(m[g]),v._node))if(h._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),h._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===1/0)&&v._node.pause();arguments[1]||h._emit("pause",v?v._id:null)}return h},stop:function(c,h){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"stop",action:function(){m.stop(c)}}),m;for(var g=m._getSoundIds(c),v=0;v<g.length;v++){m._clearTimer(g[v]);var x=m._soundById(g[v]);x&&(x._seek=x._start||0,x._rateSeek=0,x._paused=!0,x._ended=!0,m._stopFade(g[v]),x._node&&(m._webAudio?x._node.bufferSource&&(typeof x._node.bufferSource.stop>"u"?x._node.bufferSource.noteOff(0):x._node.bufferSource.stop(0),m._cleanBuffer(x._node)):(!isNaN(x._node.duration)||x._node.duration===1/0)&&(x._node.currentTime=x._start||0,x._node.pause(),x._node.duration===1/0&&m._clearSound(x._node))),h||m._emit("stop",x._id))}return m},mute:function(c,h){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"mute",action:function(){m.mute(c,h)}}),m;if(typeof h>"u")if(typeof c=="boolean")m._muted=c;else return m._muted;for(var g=m._getSoundIds(h),v=0;v<g.length;v++){var x=m._soundById(g[v]);x&&(x._muted=c,x._interval&&m._stopFade(x._id),m._webAudio&&x._node?x._node.gain.setValueAtTime(c?0:x._volume,n.ctx.currentTime):x._node&&(x._node.muted=n._muted?!0:c),m._emit("mute",x._id))}return m},volume:function(){var c=this,h=arguments,m,g;if(h.length===0)return c._volume;if(h.length===1||h.length===2&&typeof h[1]>"u"){var v=c._getSoundIds(),x=v.indexOf(h[0]);x>=0?g=parseInt(h[0],10):m=parseFloat(h[0])}else h.length>=2&&(m=parseFloat(h[0]),g=parseInt(h[1],10));var y;if(typeof m<"u"&&m>=0&&m<=1){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,h)}}),c;typeof g>"u"&&(c._volume=m),g=c._getSoundIds(g);for(var _=0;_<g.length;_++)y=c._soundById(g[_]),y&&(y._volume=m,h[2]||c._stopFade(g[_]),c._webAudio&&y._node&&!y._muted?y._node.gain.setValueAtTime(m,n.ctx.currentTime):y._node&&!y._muted&&(y._node.volume=m*n.volume()),c._emit("volume",y._id))}else return y=g?c._soundById(g):c._sounds[0],y?y._volume:0;return c},fade:function(c,h,m,g){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(c,h,m,g)}}),v;c=Math.min(Math.max(0,parseFloat(c)),1),h=Math.min(Math.max(0,parseFloat(h)),1),m=parseFloat(m),v.volume(c,g);for(var x=v._getSoundIds(g),y=0;y<x.length;y++){var _=v._soundById(x[y]);if(_){if(g||v._stopFade(x[y]),v._webAudio&&!_._muted){var S=n.ctx.currentTime,b=S+m/1e3;_._volume=c,_._node.gain.setValueAtTime(c,S),_._node.gain.linearRampToValueAtTime(h,b)}v._startFadeInterval(_,c,h,m,x[y],typeof g>"u")}}return v},_startFadeInterval:function(c,h,m,g,v,x){var y=this,_=h,S=m-h,b=Math.abs(S/.01),T=Math.max(4,b>0?g/b:g),E=Date.now();c._fadeTo=m,c._interval=setInterval(function(){var L=(Date.now()-E)/g;E=Date.now(),_+=S*L,_=Math.round(_*100)/100,S<0?_=Math.max(m,_):_=Math.min(m,_),y._webAudio?c._volume=_:y.volume(_,c._id,!0),x&&(y._volume=_),(m<h&&_<=m||m>h&&_>=m)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,y.volume(m,c._id),y._emit("fade",c._id))},T)},_stopFade:function(c){var h=this,m=h._soundById(c);return m&&m._interval&&(h._webAudio&&m._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(m._interval),m._interval=null,h.volume(m._fadeTo,c),m._fadeTo=null,h._emit("fade",c)),h},loop:function(){var c=this,h=arguments,m,g,v;if(h.length===0)return c._loop;if(h.length===1)if(typeof h[0]=="boolean")m=h[0],c._loop=m;else return v=c._soundById(parseInt(h[0],10)),v?v._loop:!1;else h.length===2&&(m=h[0],g=parseInt(h[1],10));for(var x=c._getSoundIds(g),y=0;y<x.length;y++)v=c._soundById(x[y]),v&&(v._loop=m,c._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=m,m&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop,c.playing(x[y])&&(c.pause(x[y],!0),c.play(x[y],!0)))));return c},rate:function(){var c=this,h=arguments,m,g;if(h.length===0)g=c._sounds[0]._id;else if(h.length===1){var v=c._getSoundIds(),x=v.indexOf(h[0]);x>=0?g=parseInt(h[0],10):m=parseFloat(h[0])}else h.length===2&&(m=parseFloat(h[0]),g=parseInt(h[1],10));var y;if(typeof m=="number"){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"rate",action:function(){c.rate.apply(c,h)}}),c;typeof g>"u"&&(c._rate=m),g=c._getSoundIds(g);for(var _=0;_<g.length;_++)if(y=c._soundById(g[_]),y){c.playing(g[_])&&(y._rateSeek=c.seek(g[_]),y._playStart=c._webAudio?n.ctx.currentTime:y._playStart),y._rate=m,c._webAudio&&y._node&&y._node.bufferSource?y._node.bufferSource.playbackRate.setValueAtTime(m,n.ctx.currentTime):y._node&&(y._node.playbackRate=m);var S=c.seek(g[_]),b=(c._sprite[y._sprite][0]+c._sprite[y._sprite][1])/1e3-S,T=b*1e3/Math.abs(y._rate);(c._endTimers[g[_]]||!y._paused)&&(c._clearTimer(g[_]),c._endTimers[g[_]]=setTimeout(c._ended.bind(c,y),T)),c._emit("rate",y._id)}}else return y=c._soundById(g),y?y._rate:c._rate;return c},seek:function(){var c=this,h=arguments,m,g;if(h.length===0)c._sounds.length&&(g=c._sounds[0]._id);else if(h.length===1){var v=c._getSoundIds(),x=v.indexOf(h[0]);x>=0?g=parseInt(h[0],10):c._sounds.length&&(g=c._sounds[0]._id,m=parseFloat(h[0]))}else h.length===2&&(m=parseFloat(h[0]),g=parseInt(h[1],10));if(typeof g>"u")return 0;if(typeof m=="number"&&(c._state!=="loaded"||c._playLock))return c._queue.push({event:"seek",action:function(){c.seek.apply(c,h)}}),c;var y=c._soundById(g);if(y)if(typeof m=="number"&&m>=0){var _=c.playing(g);_&&c.pause(g,!0),y._seek=m,y._ended=!1,c._clearTimer(g),!c._webAudio&&y._node&&!isNaN(y._node.duration)&&(y._node.currentTime=m);var S=function(){_&&c.play(g,!0),c._emit("seek",g)};if(_&&!c._webAudio){var b=function(){c._playLock?setTimeout(b,0):S()};setTimeout(b,0)}else S()}else if(c._webAudio){var T=c.playing(g)?n.ctx.currentTime-y._playStart:0,E=y._rateSeek?y._rateSeek-y._seek:0;return y._seek+(E+T*Math.abs(y._rate))}else return y._node.currentTime;return c},playing:function(c){var h=this;if(typeof c=="number"){var m=h._soundById(c);return m?!m._paused:!1}for(var g=0;g<h._sounds.length;g++)if(!h._sounds[g]._paused)return!0;return!1},duration:function(c){var h=this,m=h._duration,g=h._soundById(c);return g&&(m=h._sprite[g._sprite][1]/1e3),m},state:function(){return this._state},unload:function(){for(var c=this,h=c._sounds,m=0;m<h.length;m++)h[m]._paused||c.stop(h[m]._id),c._webAudio||(c._clearSound(h[m]._node),h[m]._node.removeEventListener("error",h[m]._errorFn,!1),h[m]._node.removeEventListener(n._canPlayEvent,h[m]._loadFn,!1),h[m]._node.removeEventListener("ended",h[m]._endFn,!1),n._releaseHtml5Audio(h[m]._node)),delete h[m]._node,c._clearTimer(h[m]._id);var g=n._howls.indexOf(c);g>=0&&n._howls.splice(g,1);var v=!0;for(m=0;m<n._howls.length;m++)if(n._howls[m]._src===c._src||c._src.indexOf(n._howls[m]._src)>=0){v=!1;break}return s&&v&&delete s[c._src],n.noAudio=!1,c._state="unloaded",c._sounds=[],c=null,null},on:function(c,h,m,g){var v=this,x=v["_on"+c];return typeof h=="function"&&x.push(g?{id:m,fn:h,once:g}:{id:m,fn:h}),v},off:function(c,h,m){var g=this,v=g["_on"+c],x=0;if(typeof h=="number"&&(m=h,h=null),h||m)for(x=0;x<v.length;x++){var y=m===v[x].id;if(h===v[x].fn&&y||!h&&y){v.splice(x,1);break}}else if(c)g["_on"+c]=[];else{var _=Object.keys(g);for(x=0;x<_.length;x++)_[x].indexOf("_on")===0&&Array.isArray(g[_[x]])&&(g[_[x]]=[])}return g},once:function(c,h,m){var g=this;return g.on(c,h,m,1),g},_emit:function(c,h,m){for(var g=this,v=g["_on"+c],x=v.length-1;x>=0;x--)(!v[x].id||v[x].id===h||c==="load")&&(setTimeout(function(y){y.call(this,h,m)}.bind(g,v[x].fn),0),v[x].once&&g.off(c,v[x].fn,v[x].id));return g._loadQueue(c),g},_loadQueue:function(c){var h=this;if(h._queue.length>0){var m=h._queue[0];m.event===c&&(h._queue.shift(),h._loadQueue()),c||m.action()}return h},_ended:function(c){var h=this,m=c._sprite;if(!h._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(h._ended.bind(h,c),100),h;var g=!!(c._loop||h._sprite[m][2]);if(h._emit("end",c._id),!h._webAudio&&g&&h.stop(c._id,!0).play(c._id),h._webAudio&&g){h._emit("play",c._id),c._seek=c._start||0,c._rateSeek=0,c._playStart=n.ctx.currentTime;var v=(c._stop-c._start)*1e3/Math.abs(c._rate);h._endTimers[c._id]=setTimeout(h._ended.bind(h,c),v)}return h._webAudio&&!g&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,h._clearTimer(c._id),h._cleanBuffer(c._node),n._autoSuspend()),!h._webAudio&&!g&&h.stop(c._id,!0),h},_clearTimer:function(c){var h=this;if(h._endTimers[c]){if(typeof h._endTimers[c]!="function")clearTimeout(h._endTimers[c]);else{var m=h._soundById(c);m&&m._node&&m._node.removeEventListener("ended",h._endTimers[c],!1)}delete h._endTimers[c]}return h},_soundById:function(c){for(var h=this,m=0;m<h._sounds.length;m++)if(c===h._sounds[m]._id)return h._sounds[m];return null},_inactiveSound:function(){var c=this;c._drain();for(var h=0;h<c._sounds.length;h++)if(c._sounds[h]._ended)return c._sounds[h].reset();return new r(c)},_drain:function(){var c=this,h=c._pool,m=0,g=0;if(!(c._sounds.length<h)){for(g=0;g<c._sounds.length;g++)c._sounds[g]._ended&&m++;for(g=c._sounds.length-1;g>=0;g--){if(m<=h)return;c._sounds[g]._ended&&(c._webAudio&&c._sounds[g]._node&&c._sounds[g]._node.disconnect(0),c._sounds.splice(g,1),m--)}}},_getSoundIds:function(c){var h=this;if(typeof c>"u"){for(var m=[],g=0;g<h._sounds.length;g++)m.push(h._sounds[g]._id);return m}else return[c]},_refreshBuffer:function(c){var h=this;return c._node.bufferSource=n.ctx.createBufferSource(),c._node.bufferSource.buffer=s[h._src],c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node),c._node.bufferSource.loop=c._loop,c._loop&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0),c._node.bufferSource.playbackRate.setValueAtTime(c._rate,n.ctx.currentTime),h},_cleanBuffer:function(c){var h=this,m=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=null,c.bufferSource.disconnect(0),m))try{c.bufferSource.buffer=n._scratchBuffer}catch{}return c.bufferSource=null,h},_clearSound:function(c){var h=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);h||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(c){this._parent=c,this.init()};r.prototype={init:function(){var c=this,h=c._parent;return c._muted=h._muted,c._loop=h._loop,c._volume=h._volume,c._rate=h._rate,c._seek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++n._counter,h._sounds.push(c),c.create(),c},create:function(){var c=this,h=c._parent,m=n._muted||c._muted||c._parent._muted?0:c._volume;return h._webAudio?(c._node=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),c._node.gain.setValueAtTime(m,n.ctx.currentTime),c._node.paused=!0,c._node.connect(n.masterGain)):n.noAudio||(c._node=n._obtainHtml5Audio(),c._errorFn=c._errorListener.bind(c),c._node.addEventListener("error",c._errorFn,!1),c._loadFn=c._loadListener.bind(c),c._node.addEventListener(n._canPlayEvent,c._loadFn,!1),c._endFn=c._endListener.bind(c),c._node.addEventListener("ended",c._endFn,!1),c._node.src=h._src,c._node.preload=h._preload===!0?"auto":h._preload,c._node.volume=m*n.volume(),c._node.load()),c},reset:function(){var c=this,h=c._parent;return c._muted=h._muted,c._loop=h._loop,c._volume=h._volume,c._rate=h._rate,c._seek=0,c._rateSeek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++n._counter,c},_errorListener:function(){var c=this;c._parent._emit("loaderror",c._id,c._node.error?c._node.error.code:0),c._node.removeEventListener("error",c._errorFn,!1)},_loadListener:function(){var c=this,h=c._parent;h._duration=Math.ceil(c._node.duration*10)/10,Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue()),c._node.removeEventListener(n._canPlayEvent,c._loadFn,!1)},_endListener:function(){var c=this,h=c._parent;h._duration===1/0&&(h._duration=Math.ceil(c._node.duration*10)/10,h._sprite.__default[1]===1/0&&(h._sprite.__default[1]=h._duration*1e3),h._ended(c)),c._node.removeEventListener("ended",c._endFn,!1)}};var s={},o=function(c){var h=c._src;if(s[h]){c._duration=s[h].duration,u(c);return}if(/^data:[^;]+;base64,/.test(h)){for(var m=atob(h.split(",")[1]),g=new Uint8Array(m.length),v=0;v<m.length;++v)g[v]=m.charCodeAt(v);l(g.buffer,c)}else{var x=new XMLHttpRequest;x.open(c._xhr.method,h,!0),x.withCredentials=c._xhr.withCredentials,x.responseType="arraybuffer",c._xhr.headers&&Object.keys(c._xhr.headers).forEach(function(y){x.setRequestHeader(y,c._xhr.headers[y])}),x.onload=function(){var y=(x.status+"")[0];if(y!=="0"&&y!=="2"&&y!=="3"){c._emit("loaderror",null,"Failed loading audio file with status: "+x.status+".");return}l(x.response,c)},x.onerror=function(){c._webAudio&&(c._html5=!0,c._webAudio=!1,c._sounds=[],delete s[h],c.load())},a(x)}},a=function(c){try{c.send()}catch{c.onerror()}},l=function(c,h){var m=function(){h._emit("loaderror",null,"Decoding audio data failed.")},g=function(v){v&&h._sounds.length>0?(s[h._src]=v,u(h,v)):m()};typeof Promise<"u"&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(c).then(g).catch(m):n.ctx.decodeAudioData(c,g,m)},u=function(c,h){h&&!c._duration&&(c._duration=h.duration),Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue())},d=function(){if(n.usingWebAudio){try{typeof AudioContext<"u"?n.ctx=new AudioContext:typeof webkitAudioContext<"u"?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var c=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),h=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),m=h?parseInt(h[1],10):null;if(c&&m&&m<9){var g=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!g&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:n,Howl:i}}),typeof t<"u"&&(t.Howler=n,t.Howl=i),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=n,global.Howl=i,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var r=i._howls.length-1;r>=0;r--)i._howls[r].stereo(n);return i},HowlerGlobal.prototype.pos=function(n,i,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,r=typeof r!="number"?s._pos[2]:r,typeof n=="number")s._pos=[n,i,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(n,i,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var u=l._orientation;if(i=typeof i!="number"?u[1]:i,r=typeof r!="number"?u[2]:r,s=typeof s!="number"?u[3]:s,o=typeof o!="number"?u[4]:o,a=typeof a!="number"?u[5]:a,typeof n=="number")l._orientation=[n,i,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(n,i,r,s,o,a);else return u;return l},Howl.prototype.init=function(n){return function(i){var r=this;return r._orientation=i.orientation||[1,0,0],r._stereo=i.stereo||null,r._pos=i.pos||null,r._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},r._onstereo=i.onstereo?[{fn:i.onstereo}]:[],r._onpos=i.onpos?[{fn:i.onpos}]:[],r._onorientation=i.onorientation?[{fn:i.onorientation}]:[],n.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,i){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(n,i)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof n=="number")r._stereo=n,r._pos=[n,0,0];else return r._stereo;for(var o=r._getSoundIds(i),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof n=="number")l._stereo=n,l._pos=[n,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(n,0,0):l._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(n,i,r,s)}}),o;if(i=typeof i!="number"?0:i,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof n=="number")o._pos=[n,i,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof n=="number")u._pos=[n,i,r],u._node&&((!u._panner||u._panner.pan)&&e(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setPosition(n,i,r)),o._emit("pos",u._id);else return u._pos}return o},Howl.prototype.orientation=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(n,i,r,s)}}),o;if(i=typeof i!="number"?o._orientation[1]:i,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof n=="number")o._orientation=[n,i,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var u=o._soundById(a[l]);if(u)if(typeof n=="number")u._orientation=[n,i,r],u._node&&(u._panner||(u._pos||(u._pos=o._pos||[0,0,-.5]),e(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):u._panner.setOrientation(n,i,r)),o._emit("orientation",u._id);else return u._orientation}return o},Howl.prototype.pannerAttr=function(){var n=this,i=arguments,r,s,o;if(!n._webAudio)return n;if(i.length===0)return n._pannerAttr;if(i.length===1)if(typeof i[0]=="object")r=i[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),n._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:n._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:n._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:n._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:n._panningModel});else return o=n._soundById(parseInt(i[0],10)),o?o._pannerAttr:n._pannerAttr;else i.length===2&&(r=i[0],s=parseInt(i[1],10));for(var a=n._getSoundIds(s),l=0;l<a.length;l++)if(o=n._soundById(a[l]),o){var u=o._pannerAttr;u={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:u.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:u.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:u.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:u.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:u.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:u.panningModel};var d=o._panner;d?(d.coneInnerAngle=u.coneInnerAngle,d.coneOuterAngle=u.coneOuterAngle,d.coneOuterGain=u.coneOuterGain,d.distanceModel=u.distanceModel,d.maxDistance=u.maxDistance,d.refDistance=u.refDistance,d.rolloffFactor=u.rolloffFactor,d.panningModel=u.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),e(o,"spatial"))}return n},Sound.prototype.init=function(n){return function(){var i=this,r=i._parent;i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,n.call(this),i._stereo?r.stereo(i._stereo):i._pos&&r.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var i=this,r=i._parent;return i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,i._stereo?r.stereo(i._stereo):i._pos?r.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,r._refreshBuffer(i)),n.call(this)}}(Sound.prototype.reset);var e=function(n,i){i=i||"spatial",i==="spatial"?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.panningModel=n._pannerAttr.panningModel,typeof n._panner.positionX<"u"?(n._panner.positionX.setValueAtTime(n._pos[0],Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(n._pos[1],Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(n._pos[2],Howler.ctx.currentTime)):n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),typeof n._panner.orientationX<"u"?(n._panner.orientationX.setValueAtTime(n._orientation[0],Howler.ctx.currentTime),n._panner.orientationY.setValueAtTime(n._orientation[1],Howler.ctx.currentTime),n._panner.orientationZ.setValueAtTime(n._orientation[2],Howler.ctx.currentTime)):n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.setValueAtTime(n._stereo,Howler.ctx.currentTime)),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id,!0)}}()}),T9=sy((t,e)=>{e.exports=function(n,i){for(var r=n.split("."),s=i.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),Hn=class{modifyById(t,e){let n=this;if(n[t]===void 0)throw new Error("not expected");{let i={...n,[t]:e};return Object.setPrototypeOf(i,Hn.prototype),i}}add(t,e){var n;return((n=this.runOp({type:1,id:t,data:e}))==null?void 0:n.data)??this}runOp(t){let e=this;if(t.type===1){let n=e[t.id],i;n===void 0?i={type:2,id:t.id}:i={type:1,id:t.id,data:n};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,Hn.prototype),{data:o,actual:t,reverse:i}}else if(t.type===2){let{id:n}=t,i=e[n];if(i===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,Hn.prototype),delete r[n],{data:r,actual:t,reverse:{type:1,id:n,data:i}}}}return null}};function EM(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let n of e){let i=t[n];i&&typeof i=="object"&&EM(i)}return Object.freeze(t)}function C9(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var MO=class extends Error{};function Ux(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function Na(t,e,n){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;i.push(o)}return i}function AM(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function P9(){return typeof process<"u"}function EO(t,e){for(let n of t)e(n.id,n.data)!==!0&&EO(n.children,e)}function AO(t,e){if(e(t.id,t.data)!==!0)for(let n of t.children)AO(n,e)}var Ds=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Ds.prototype)}deepFreeze(){let t=0;for(;t<this.length;)EM(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let n of t.children)this.fillCaches0(n,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}isDescendantOf(t,e){for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let n=this.get(t);n&&AO(n,e)}}traverse(t){EO(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this.parent(t),i=this.childrenArray(n),r=i.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:e},this.modifyArrayBy(n,i)}}modifyArrayBy(t,e){let n=t,i=e;for(;n!==null;){let s=i,o=n;if(n=this.parent(n),n===void 0)throw new Error;i=this.childrenArray(n);let a=i.findIndex(l=>l.id===o);if(a<0)throw new Error;i=[...i],i[a]={...i[a],children:s}}Object.setPrototypeOf(i,Ds.prototype);let r=i;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let n of e)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(t){let{parent:e,fi:n,id:i,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:n,id:i,data:r,children:s};return a=[...a,l],a.sort((u,d)=>u.fi-d.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:i}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let n=this.parent(e);if(n===void 0)return null;let i=this.childrenArray(n),r=i.findIndex(o=>o.id===e);t.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:t,reverse:{type:7,...s,parent:n}}}}moveOp(t){let{parent:e,fi:n,id:i}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:i});if(e!==null){let c=e;for(;c!==null;){if(c===void 0)throw new Error;if(c===i)throw new MO("cyclic tree");c=this.parent(c)}}let r=this.parent(i);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(c=>c.id===i);o=[...o];let l=o.splice(a,1)[0],u=this.modifyArrayBy(r,o);r=e,o=u.childrenArray(r);let d=l.fi;return l={...l,fi:n},o=[...o,l],o.sort((c,h)=>c.fi-h.fi),t.localIndex=o.indexOf(l),u=u.modifyArrayBy(r,o),{data:u,actual:t,reverse:{type:9,parent:s,fi:d,id:i}}}previous(t,e){if(e===null){let i=this.childrenArray(t);return i.length===0?null:i[i.length-1].id}let n=null;for(let i of this.childrenArray(t)){if(i.id===e)return n;n=i.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)+1;if(i<n.length)return n[i].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)-1;return i>=0?this.traverseSortPrevious(n[i].id):e}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push({...n,...i})}e.sort((n,i)=>C9(n.sortKey,i.sortKey));for(let n of e)delete n.sortKey;return e}getWithSortKey(t){var e=t;let n=[],i=this.get(e),r=i;if(i!==void 0){for(;e;)n.splice(0,0,i.fi),e=this.parent(e),e!==null&&(i=this.get(e));return{...r,sortKey:n}}}insertBeforeHelper(t,e,n){return this.insertAfterHelper(t,this.previous(t,e),n)}insertAfterHelper(t,e,n){let i=this.childrenArray(t);if(e===null){if(i.length===0)return Na(0,n,n);{let r=i[0].fi;return Na(r-n,r,n)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return Na(o,o+n,n)}else return Na(r.fi,s.fi,n)}}},iv;(t=>{function e(n,i){if(i.type!==0)return null;if(Array.isArray(n)){let r=i.props,s={},o=[...n],a=!1;if(r)for(let l of Object.keys(r)){let u=parseInt(l);if(isNaN(u))throw new Error("wrong index");s[l]=o[u],o[u]=r[l],a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}else{let r=i.props,s={},o={...n},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let u=r[l];u===void 0?delete o[l]:o[l]=u,a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}}t.runOp=e})(iv||(iv={}));var tn=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,tn.prototype)}deepFreeze(){let t=0;for(;t<this.length;)EM(this[t]),t++}fillCaches0(t){this.objCaches.set(t.id,t)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let t of this)this.fillCaches0(t)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}data(t){var e;return(e=this.get(t))==null?void 0:e.data}get(t){return this.fillCaches(),this.objCaches.get(t)}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this,i=n.findIndex(s=>s.id===t);if(i<0)throw new Error("not expected");let r=n[i];return n=[...n],n[i]={...r,data:e},this.modifyArrayBy(n)}}modifyArrayBy(t){Object.setPrototypeOf(t,tn.prototype);let e=t;return P9()||e.fillCaches(),e}runOp(t){switch(t.type){case 4:return this.addOp(t);case 5:return this.deleteOp(t);case 6:return this.moveOp(t)}return null}addOp(t){let{fi:e,id:n,data:i}=t,r=this,s={fi:e,id:n,data:i};return r=[...r,s],r.sort((o,a)=>o.fi-a.fi),t.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:t,reverse:{type:5,id:n}}}deleteOp(t){let{id:e}=t,n=this,i=n.findIndex(s=>s.id===e);if(i===-1)return null;t.localIndex=i,n=[...n];let r=n.splice(i,1)[0];return{data:this.modifyArrayBy(n),actual:t,reverse:{type:4,...r}}}moveOp(t){let{fi:e,id:n}=t,i=this;i=[...i];let r=i.findIndex(a=>a.id===n);if(r===-1)return null;let s=i[r].fi,o={...i[r],fi:e};return i[r]=o,i.sort((a,l)=>a.fi-l.fi),t.localIndex=i.indexOf(o),{data:this.modifyArrayBy(i),actual:t,reverse:{type:6,fi:s,id:n}}}previous(t){if(t===null)return this.length===0?null:this[this.length-1].id;let e=null;for(let n of this){if(n.id===t)return e;e=n.id}return null}insertBeforeHelper(t,e){return this.insertAfterHelper(this.previous(t),e)}insertAfterHelper(t,e){let n=this;if(t===null){if(n.length===0)return Na(0,e,e);{let i=n[0].fi;return Na(i-e,i,e)}}else{let i=this.get(t);if(i===void 0)throw new Error("illegal args");let r=n.find(s=>s.fi>i.fi);if(r===void 0){let s=n[n.length-1].fi;return Na(s,s+e,e)}else return Na(i.fi,r.fi,e)}}};function xh(t){return t&&typeof t=="object"&&t instanceof pi}var pi=class{unusedFunOverridesTable(t){}runOp(t){let e=[],n=this,i=0,r={};for(;i<t.path.length;){if(e.push(n),n=n===void 0?void 0:n[t.path[i]],n!==void 0&&!xh(n))return null;i+=1}n=n?Ux(n):new pi;for(let[a,l]of Object.entries(t.props)){let u=n[a];r[a]=u,l===void 0?delete n[a]:n[a]=l}for(;i>0;){if(Object.keys(n).length===0){let a=e[i-1];a&&(n=Ux(a),delete n[t.path[i-1]])}else{let a=e[i-1];if(a){let l=Ux(a);l[t.path[i-1]]=n,n=l}else{let l=new pi;l[t.path[i-1]]=n,n=l}}i-=1}let s=Object.setPrototypeOf(n,pi.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},cu;(t=>{function e(r,s){return op(r,s)??r}t.apply=e;function n(r,s){return CM(r,s)}t.merge=n;function i(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=ho.zoomOnce(l,a[o]),l===void 0)return s;if(!xh(l))return;o+=1}if(l===void 0)return s;if(xh(l))if(s.type===0){let u={...s.props};for(let d of Object.keys(l))delete u[d];return{...s,props:u}}else if(s.type===1||s.type===4||s.type===7){let u=TM([s],l);return u?(console.log(u),u):s}else return s}t.filterOp=i})(cu||(cu={}));function TM(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=op(r.data,e[s]);if(n=n||o!==void 0,o===void 0&&(o=r.data),r.children){let a=TM(r.children,e);return a!==void 0?n=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(n)return i}function L9(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=op(r.data,e[s]);return n=n||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}function op(t,e){if(!xh(e))return e;if(t instanceof Ds){let n=TM(t,e);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof tn)return L9(t,e);if(Array.isArray(t)){let n=!1,i=t.map((r,s)=>{let o=op(r,e[s]);return n=n||o!==void 0,o===void 0&&(o=r),o});return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else{if(t instanceof pi)return CM(t,e);if(t&&typeof t=="object"){let n={},i=!1;for(let[r,s]of Object.entries(t)){let o=op(s,e[r]);i=i||o!==void 0,o===void 0&&(o=s),n[r]=o}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}}}}function CM(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!xh(e))return e;if(!xh(t))return cu.apply(t,e);let n=new Set;for(let r of Object.keys(t))n.add(r);for(let r of Object.keys(e))n.add(r);let i=new pi;for(let r of n){let s=CM(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);i[r]=s}return i}function I9(t,e){let n={cur:[],result:[],len:0};return t=ap(t,e,n)??t,[t,n.result]}function rv(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function sv(t){t&&(t.len-=1)}function D9(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function TO(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=ap(s.data,e,rv(n,o));sv(n),i=i||l!==void 0,l===void 0&&(l=s.data);let u=TO(s.children,e,n);return u!==void 0?i=!0:u=s.children,{...s,id:o,data:l,children:u}});if(i)return r}function R9(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=ap(s.data,e,rv(n,o));return sv(n),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function ap(t,e,n){if(t instanceof Ds){let i=TO(t,e,n);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof tn)return R9(t,e,n);if(Array.isArray(t)){let i=!1,r=t.map((s,o)=>{let a=ap(s,e,rv(n,o));return sv(n),i=i||a!==void 0,a===void 0&&(a=s),a});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!AM(t)){let i={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"&&s!=="text"){let a=e[s];if(typeof a=="string"){if(n!==null)throw new Error("not supported");r=!0,s=a}let l=ap(o,e,rv(n,s));sv(n),r=r||l!==void 0,l===void 0&&(l=o),i[s]=l}else i[s]=o;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else if(typeof t=="string"){let i=e[t];if(i!==void 0){if(t.length!==36)throw new Error("for now you should only call this method when the key is a uuid");D9(n)}return i}else return}}var Qw;(t=>{function e(n,i){let r=ho.zoom(i,n.path);if(typeof r=="object"){let s={};for(let o of Object.keys(n.props))s[o]=r[o];return{...n,props:s}}else return{...n,props:{}}}t.replaceProps=e})(Qw||(Qw={}));var vr;(t=>{function e(l,u){return{...l,path:l.path.slice(u)}}t.drop=e;function n(l,u){var d;return((d=i(l,u))==null?void 0:d.data)??l}t.applySimple=n;function i(l,u){var h,m;let d=u.path;for(var c=[];;){let g;if(l instanceof pi&&u.type===0&&(g=l.runOp({...u,path:d.slice(c.length)}),g===null&&(g=void 0)),c.length===d.length&&(l instanceof Ds||l instanceof tn||l instanceof Hn?g=l.runOp(u):g=iv.runOp(l,u)),g!==void 0)if(g!==null){let y=g.data;for(let _=c.length-1;_>=0;_--){let S=d[_],b=c[_];if(b instanceof Ds){if(typeof S=="number")throw new Error("illegal arg");y=b.modifyById(S,y)}else if(b instanceof tn){if(typeof S=="number")throw new Error("illegal arg");y=b.modifyById(S,y)}else if(b instanceof Hn){if(typeof S=="number")throw new Error("illegal arg");y=b.modifyById(S,y)}else if(b instanceof pi){let T={...b,[S]:y};y=Object.setPrototypeOf(T,pi.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof S=="string"&&(S=parseInt(S),isNaN(S)))throw new Error("Invalid path");let T=y;y=[...b],y[S]=T}else y={...b,[S]:y};else return null}return{data:y,actual:{...g.actual,path:d},reverse:{...g.reverse,path:d}}}else return null;let v=d[c.length],x;if(l instanceof Ds){if(typeof v=="number")throw new Error("");x=(h=l.get(v))==null?void 0:h.data}else if(l instanceof tn){if(typeof v=="number")throw new Error("");x=(m=l.get(v))==null?void 0:m.data}else l!==null&&(x=l[v]);if(x!==void 0)c.push(l),l=x;else return null}}t.apply=i;function r(l,u){for(let d=0;d<l.length&&d<u.length;d++)if(l[d]!==u[d])return!0;return!1}t.pathDisjoint=r;function s(l,u){if(l.length!==u.length)return!1;for(let d=0;d<l.length;d++)if(l[d]!==u[d])return!1;return!0}t.pathEq=s;function o(l,u){return r(l.path,u.path)}t.commutative=o;function a(l,u){return l.type===0&&u.type===0&&s(l.path,u.path)?Object.keys(l.props).every(d=>u.props[d]!==void 0):!1}t.subsumed=a})(vr||(vr={}));var FT;(t=>{function e(){return[]}t.empty=e;function n(u,d){let c=[];for(let h of u){let[m,...g]=h.path;m===d&&c.push({...h,path:g})}return c}t.removePrefix=n;function i(u,d){return u.map(c=>({...c,path:[d,...c.path]}))}t.addPrefix=i;function r(u,d){return[...u,...d]}t.concat=r;function s(u,d){return[...u.filter(c=>!d.some(h=>vr.subsumed(c,h))),...d]}t.compress=s;function o(u,d){return u.every(c=>d.every(h=>vr.commutative(c,h)))}t.commutative=o;function a(u,d){for(let c of d){let h=l(u,c);h!==null&&(u=h.data)}return u}t.applyAll=a;function l(u,d){var c=u;let h=[],m=[];for(let g of d)try{if(g.type===3){let v=ho.zoom(c,[...g.path,g.id]),x=vr.apply(c,{...g,type:2});if(x!==null){c=x.data;let[y,_]=I9(c,{[g.id]:v});c=y;for(let S of _){let b=S[S.length-1];S.splice(S.length-1,1),h.push({type:0,path:S,props:{[b]:v}}),m.push({type:0,path:S,props:{[b]:g.id}})}m.push(x.reverse),h.push(x.actual)}}else{let v=vr.apply(c,g);v!==null&&(h.push(v.actual),c=v.data,m.push(v.reverse))}}catch(v){if(v instanceof MO)return null;throw v}return{data:c,actual:h,reverse:m.reverse()}}t.apply=l})(FT||(FT={}));var CO=Symbol(),O9=Symbol(),ay=Symbol(),Ip=class{reportOp(t,e,n=[]){let i=this;if(e===null)return;i._current=e.data;let r=n;for(;!(i instanceof LO);){let s=i._path,o=i._current;if(s!==""&&r.splice(0,0,s),i=i._parent,i===null)return;i.update(s,o)}i.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let n=e[ay];n&&n(),delete this._children[t]}}}},z9=class extends Ip{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,iv.runOp(this._current,t),t.path)}},N9=class extends Ip{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,Hn.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},PO={get(t,e){if(e===ay)return()=>{t._parent=null};if(e===CO)return t._current;if(e===O9)return t;let{_current:n,_children:i}=t;if(e==="push"&&Array.isArray(n))throw new Error("not supported to expand array");let r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=n[e],o=ly(t,e,s);return o!==s?(i===void 0&&(i={},t._children=i),i[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let n=t._current,i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[e]}}},k9={...PO,set(t,e,n){let i={type:0,props:{[e]:Ci(n)??n}};return t.deleteChildren(e),t.runOp(i),!0},deleteProperty(t,e){let n={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(n),!0}},B9={...PO,set(t,e,n){return n===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:n})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},PM=class extends Ip{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[ay]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,n)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=ly(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}add(t,e,n,i,r){this.runOp({type:7,parent:t,fi:e,id:n,data:i,children:r})}move(t,e,n){this.runOp({type:9,parent:t,fi:e,id:n})}insertAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}insertBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}moveAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}moveBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},LM=class extends Ip{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[ay]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id,r=this._current[n].fi;t(this.data(this._current[n].id),i,r)}}find(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id;if(t(this.data(i),i))return this.get(i)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=ly(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,n){this.runOp({type:4,fi:t,id:e,data:n})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}insertBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}moveAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}moveBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function Fx(t,e,n){if(t.length>0){let i=t[t.length-1];if(i.type===0&&e.type===0&&ho.equal(i.path,n)){Object.assign(i.props,e.props);return}}t.push({...e,path:n})}var LO=class extends Ip{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,n,i){Fx(this.ts,e,t),Fx(this.actual,n,t),Fx(this.reverse,i,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function ly(t,e,n){return n instanceof Ds?new PM(t,e,n):n instanceof tn?new LM(t,e,n):n instanceof Hn?new Proxy(new N9(t,e,n),B9):n!==null&&typeof n=="object"?AM(n)?n:new Proxy(new z9(t,e,n),k9):n}function IO(t){let e=new LO(t);return[ly(e,"",t),e]}function ov(t,e){let[n,i]=IO(t);return e(n),i.result()}function Ci(t){return t instanceof PM||t instanceof LM?t._current:t!==null&&typeof t=="object"?t[CO]:t}var ho;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function n(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let u={...o};return Object.keys(l).forEach(d=>{delete u[d]}),u}else return o}t.removeOverridden=n;function i(s,o){if((s instanceof Ds||s instanceof PM)&&typeof o=="string"||(s instanceof tn||s instanceof LM)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=i;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=i(s,o[a]),a+=1;return s}t.zoom=r})(ho||(ho={}));function U9(t,e){let n=[];if(e.length===t.length)for(var i=0;i<t.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}function La(t,e){let n=[];if(e.length<=t.length)for(var i=0;i<e.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}var DO=class{},VT=class extends DO{constructor(t){super(),this.id=t}},GT=class extends DO{constructor(t){super(),this.data=t}},eS;try{eS=new TextDecoder}catch{}var qe,Ka,ce=0,Ki={},Gt,ka,jr=0,ro=0,mr,Xo,Vi=[],Wt,HT={useRecords:!1,mapsAsObjects:!0},RO=class{},OO=new RO;OO.name="MessagePack 0xC1";var _h=!1,av=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(qe)return FO(()=>(nS(),this?this.unpack(t,e):av.prototype.unpack.call(HT,t,e)));Ka=e>-1?e:t.length,ce=0,ro=0,ka=null,mr=null,qe=t;try{Wt=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(n){throw qe=null,t instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof av){if(Ki=this,this.structures)return Gt=this.structures,Ng();(!Gt||Gt.length>0)&&(Gt=[])}else Ki=HT,(!Gt||Gt.length>0)&&(Gt=[]);return Ng()}unpackMultiple(t,e){let n,i=0;try{_h=!0;let r=t.length,s=this?this.unpack(t,r):cy.unpack(t,r);if(e){for(e(s);ce<r;)if(i=ce,e(Ng())===!1)return}else{for(n=[s];ce<r;)i=ce,n.push(Ng());return n}}catch(r){throw r.lastPosition=i,r.values=n,r}finally{_h=!1,nS()}}_mergeStructures(t,e){t=t||[];for(let n=0,i=t.length;n<i;n++){let r=t[n];r&&(r.isShared=!0,n>=32&&(r.highByte=n-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let i=t[n],r=e[n];r&&(i&&((t.restoreStructures||(t.restoreStructures=[]))[n]=i),t[n]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function Ng(){try{if(!Ki.trusted&&!_h){let e=Gt.sharedLength||0;e<Gt.length&&(Gt.length=e)}let t=Ln();if(ce==Ka)Gt.restoreStructures&&WT(),Gt=null,qe=null,Xo&&(Xo=null);else if(ce>Ka){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!_h)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Gt.restoreStructures&&WT(),nS(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function WT(){for(let t in Gt.restoreStructures)Gt[t]=Gt.restoreStructures[t];Gt.restoreStructures=null}function Ln(){let t=qe[ce++];if(t<160)if(t<128){if(t<64)return t;{let e=Gt[t&63]||Ki.getStructures&&zO()[t&63];return e?(e.read||(e.read=IM(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Ki.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[kO()]=Ln();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Ln(),Ln());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Ln();return e}else if(t<192){let e=t-160;if(ro>=ce)return ka.slice(ce-jr,(ce+=e)-jr);if(ro==0&&Ka<140){let n=e<16?DM(e):NO(e);if(n!=null)return n}return tS(e)}else{let e;switch(t){case 192:return null;case 193:return mr?(e=Ln(),e>0?mr[1].slice(mr.position1,mr.position1+=e):mr[0].slice(mr.position0,mr.position0-=e)):OO;case 194:return!1;case 195:return!0;case 196:return Vx(qe[ce++]);case 197:return e=Wt.getUint16(ce),ce+=2,Vx(e);case 198:return e=Wt.getUint32(ce),ce+=4,Vx(e);case 199:return Rl(qe[ce++]);case 200:return e=Wt.getUint16(ce),ce+=2,Rl(e);case 201:return e=Wt.getUint32(ce),ce+=4,Rl(e);case 202:if(e=Wt.getFloat32(ce),Ki.useFloat32>2){let n=RM[(qe[ce]&127)<<1|qe[ce+1]>>7];return ce+=4,(n*e+(e>0?.5:-.5)>>0)/n}return ce+=4,e;case 203:return e=Wt.getFloat64(ce),ce+=8,e;case 204:return qe[ce++];case 205:return e=Wt.getUint16(ce),ce+=2,e;case 206:return e=Wt.getUint32(ce),ce+=4,e;case 207:return Ki.int64AsNumber?(e=Wt.getUint32(ce)*4294967296,e+=Wt.getUint32(ce+4)):e=Wt.getBigUint64(ce),ce+=8,e;case 208:return Wt.getInt8(ce++);case 209:return e=Wt.getInt16(ce),ce+=2,e;case 210:return e=Wt.getInt32(ce),ce+=4,e;case 211:return Ki.int64AsNumber?(e=Wt.getInt32(ce)*4294967296,e+=Wt.getUint32(ce+4)):e=Wt.getBigInt64(ce),ce+=8,e;case 212:if(e=qe[ce++],e==114)return YT(qe[ce++]&63);{let n=Vi[e];if(n)return n.read?(ce++,n.read(Ln())):n.noBuffer?(ce++,n()):n(qe.subarray(ce,++ce));throw new Error("Unknown extension "+e)}case 213:return e=qe[ce],e==114?(ce++,YT(qe[ce++]&63,qe[ce++])):Rl(2);case 214:return Rl(4);case 215:return Rl(8);case 216:return Rl(16);case 217:return e=qe[ce++],ro>=ce?ka.slice(ce-jr,(ce+=e)-jr):V9(e);case 218:return e=Wt.getUint16(ce),ce+=2,ro>=ce?ka.slice(ce-jr,(ce+=e)-jr):G9(e);case 219:return e=Wt.getUint32(ce),ce+=4,ro>=ce?ka.slice(ce-jr,(ce+=e)-jr):H9(e);case 220:return e=Wt.getUint16(ce),ce+=2,$T(e);case 221:return e=Wt.getUint32(ce),ce+=4,$T(e);case 222:return e=Wt.getUint16(ce),ce+=2,qT(e);case 223:return e=Wt.getUint32(ce),ce+=4,qT(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}var F9=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function IM(t,e){function n(){if(n.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>F9.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Ln);return t.highByte===0&&(t.read=jT(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let o=t[r];i[o]=Ln()}return i}return n.count=0,t.highByte===0?jT(e,n):n}var jT=(t,e)=>function(){let n=qe[ce++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=Gt[i]||zO()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=IM(r,t)),r.read()};function zO(){let t=FO(()=>(qe=null,Ki.getStructures()));return Gt=Ki._mergeStructures(t,Gt)}var tS=uy,V9=uy,G9=uy,H9=uy;function uy(t){let e;if(t<16&&(e=DM(t)))return e;if(t>64&&eS)return eS.decode(qe.subarray(ce,ce+=t));let n=ce+t,i=[];for(e="";ce<n;){let r=qe[ce++];if(!(r&128))i.push(r);else if((r&224)===192){let s=qe[ce++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){let s=qe[ce++]&63,o=qe[ce++]&63;i.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=qe[ce++]&63,o=qe[ce++]&63,a=qe[ce++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(r);i.length>=4096&&(e+=oi.apply(String,i),i.length=0)}return i.length>0&&(e+=oi.apply(String,i)),e}function $T(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Ln();return e}function qT(t){if(Ki.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[kO()]=Ln();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Ln(),Ln());return e}}var oi=String.fromCharCode;function NO(t){let e=ce,n=new Array(t);for(let i=0;i<t;i++){let r=qe[ce++];if((r&128)>0){ce=e;return}n[i]=r}return oi.apply(String,n)}function DM(t){if(t<4)if(t<2){if(t===0)return"";{let e=qe[ce++];if((e&128)>1){ce-=1;return}return oi(e)}}else{let e=qe[ce++],n=qe[ce++];if((e&128)>0||(n&128)>0){ce-=2;return}if(t<3)return oi(e,n);let i=qe[ce++];if((i&128)>0){ce-=3;return}return oi(e,n,i)}else{let e=qe[ce++],n=qe[ce++],i=qe[ce++],r=qe[ce++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){ce-=4;return}if(t<6){if(t===4)return oi(e,n,i,r);{let s=qe[ce++];if((s&128)>0){ce-=5;return}return oi(e,n,i,r,s)}}else if(t<8){let s=qe[ce++],o=qe[ce++];if((s&128)>0||(o&128)>0){ce-=6;return}if(t<7)return oi(e,n,i,r,s,o);let a=qe[ce++];if((a&128)>0){ce-=7;return}return oi(e,n,i,r,s,o,a)}else{let s=qe[ce++],o=qe[ce++],a=qe[ce++],l=qe[ce++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){ce-=8;return}if(t<10){if(t===8)return oi(e,n,i,r,s,o,a,l);{let u=qe[ce++];if((u&128)>0){ce-=9;return}return oi(e,n,i,r,s,o,a,l,u)}}else if(t<12){let u=qe[ce++],d=qe[ce++];if((u&128)>0||(d&128)>0){ce-=10;return}if(t<11)return oi(e,n,i,r,s,o,a,l,u,d);let c=qe[ce++];if((c&128)>0){ce-=11;return}return oi(e,n,i,r,s,o,a,l,u,d,c)}else{let u=qe[ce++],d=qe[ce++],c=qe[ce++],h=qe[ce++];if((u&128)>0||(d&128)>0||(c&128)>0||(h&128)>0){ce-=12;return}if(t<14){if(t===12)return oi(e,n,i,r,s,o,a,l,u,d,c,h);{let m=qe[ce++];if((m&128)>0){ce-=13;return}return oi(e,n,i,r,s,o,a,l,u,d,c,h,m)}}else{let m=qe[ce++],g=qe[ce++];if((m&128)>0||(g&128)>0){ce-=14;return}if(t<15)return oi(e,n,i,r,s,o,a,l,u,d,c,h,m,g);let v=qe[ce++];if((v&128)>0){ce-=15;return}return oi(e,n,i,r,s,o,a,l,u,d,c,h,m,g,v)}}}}}function Vx(t){return Ki.copyBuffers?Uint8Array.prototype.slice.call(qe,ce,ce+=t):qe.subarray(ce,ce+=t)}function Rl(t){let e=qe[ce++];if(Vi[e])return Vi[e](qe.subarray(ce,ce+=t));throw new Error("Unknown extension type "+e)}var XT=new Array(4096);function kO(){let t=qe[ce++];if(t>=160&&t<192){if(t=t-160,ro>=ce)return ka.slice(ce-jr,(ce+=t)-jr);if(!(ro==0&&Ka<180))return tS(t)}else return ce--,Ln();let e=(t<<5^(t>1?Wt.getUint16(ce):t>0?qe[ce]:0))&4095,n=XT[e],i=ce,r=ce+t-3,s,o=0;if(n&&n.bytes==t){for(;i<r;){if(s=Wt.getUint32(i),s!=n[o++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=qe[i++],s!=n[o++]){i=1879048192;break}if(i===r)return ce=i,n.string;r-=3,i=ce}for(n=[],XT[e]=n,n.bytes=t;i<r;)s=Wt.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=qe[i++],n.push(s);let a=t<16?DM(t):NO(t);return a!=null?n.string=a:n.string=tS(t)}var YT=(t,e)=>{var n=Ln();let i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=Gt[t];return r&&r.isShared&&((Gt.restoreStructures||(Gt.restoreStructures=[]))[t]=r),Gt[t]=n,n.read=IM(n,i),n.read()},BO=typeof self=="object"?self:global;Vi[0]=()=>{};Vi[0].noBuffer=!0;Vi[101]=()=>{let t=Ln();return(BO[t[0]]||Error)(t[1])};Vi[105]=t=>{let e=Wt.getUint32(ce-4);Xo||(Xo=new Map);let n=qe[ce],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};Xo.set(e,r);let s=Ln();return r.used?Object.assign(i,s):(r.target=s,s)};Vi[112]=t=>{let e=Wt.getUint32(ce-4),n=Xo.get(e);return n.used=!0,n.target};Vi[115]=()=>new Set(Ln());var UO=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");Vi[116]=t=>{let e=t[0],n=UO[e];if(!n)throw new Error("Could not find typed array for code "+e);return new BO[n](Uint8Array.prototype.slice.call(t,1).buffer)};Vi[120]=()=>{let t=Ln();return new RegExp(t[0],t[1])};Vi[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=ce;ce+=e-4,mr=[Ln(),Ln()],mr.position0=0,mr.position1=0;let i=ce;ce=n;try{return Ln()}finally{ce=i}};Vi[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function FO(t){let e=Ka,n=ce,i=jr,r=ro,s=ka,o=Xo,a=mr,l=new Uint8Array(qe.slice(0,Ka)),u=Gt,d=Gt.slice(0,Gt.length),c=Ki,h=_h,m=t();return Ka=e,ce=n,jr=i,ro=r,ka=s,Xo=o,mr=a,qe=l,_h=h,Gt=u,Gt.splice(0,Gt.length,...d),Ki=c,Wt=new DataView(qe.buffer,qe.byteOffset,qe.byteLength),m}function nS(){qe=null,Xo=null,Gt=null}function W9(t){t.unpack?Vi[t.type]=t.unpack:Vi[t.type]=t}var RM=new Array(147);for(let t=0;t<256;t++)RM[t]=+("1e"+Math.floor(45.15-t*.30103));var cy=new av({useRecords:!1});cy.unpack;cy.unpackMultiple;cy.unpack;var j9=new Float32Array(1);new Uint8Array(j9.buffer,0,4);var S0;try{S0=new TextEncoder}catch{}var lv,OM,hy=typeof Buffer<"u",Gx=hy?Buffer.allocUnsafeSlow:Uint8Array,VO=hy?Buffer:Uint8Array,ZT=hy?4294967296:2144337920,Ee,zn,ve=0,Ys,Zs=null,$9=/[\u0080-\uFFFF]/,Od=Symbol("record-id"),GO=class extends av{constructor(t){super(t),this.offset=0;let e,n,i,r,s,o=0,a=VO.prototype.utf8Write?function(E,L,A){return Ee.utf8Write(E,L,A)}:S0&&S0.encodeInto?function(E,L){return S0.encodeInto(E,Ee.subarray(L)).written}:!1,l=this;t||(t={});let u=t&&t.sequential,d=t.structures||t.saveStructures,c=t.maxSharedStructures;if(c==null&&(c=d?32:0),c>8160)throw new Error("Maximum maxSharedStructure is 8160");let h=t.maxOwnStructures;h==null&&(h=d?32:64),u&&!t.saveStructures&&(this.structures=[]);let m=c>32||h+c>64,g=c+64,v=c+h+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let x=[],y=0,_=0;this.pack=this.encode=function(E,L){if(Ee||(Ee=new Gx(8192),zn=new DataView(Ee.buffer,0,8192),ve=0),Ys=Ee.length-10,Ys-ve<2048?(Ee=new Gx(Ee.length),zn=new DataView(Ee.buffer,0,Ee.length),Ys=Ee.length-10,ve=0):ve=ve+7&2147483640,e=ve,s=l.structuredClone?new Map:null,l.bundleStrings?(Zs=["",""],Ee[ve++]=214,Ee[ve++]=98,Zs.position=ve-e,ve+=4):Zs=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let A=n.sharedLength||0;if(A>c)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let I=0;I<A;I++){let P=n[I];if(!P)continue;let O,k=n.transitions;for(let F=0,G=P.length;F<G;F++){let Z=P[F];O=k[Z],O||(O=k[Z]=Object.create(null)),k=O}k[Od]=I+64}o=A}u||(n.nextId=A+64)}i&&(i=!1),r=n||[];try{if(S(E),Zs){zn.setUint32(Zs.position+e,ve-Zs.position-e);let A=Zs;Zs=null,S(A[0]),S(A[1])}if(l.offset=ve,s&&s.idsToInsert){ve+=s.idsToInsert.length*6,ve>Ys&&T(ve),l.offset=ve;let A=X9(Ee.subarray(e,ve),s.idsToInsert);return s=null,A}return L&Y9?(Ee.start=e,Ee.end=ve,Ee):Ee.subarray(e,ve)}finally{if(n){if(_<10&&_++,y>1e4)n.transitions=null,_=0,y=0,x.length>0&&(x=[]);else if(x.length>0&&!u){for(let A=0,I=x.length;A<I;A++)x[A][Od]=0;x=[]}if(i&&l.saveStructures){let A=n.sharedLength||c;n.length>A&&(n=n.slice(0,A));let I=Ee.subarray(e,ve);return l.saveStructures(n,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(E)):(o=A,I)}}L&Z9&&(ve=e)}};let S=E=>{ve>Ys&&(Ee=T(ve));var L=typeof E,A;if(L==="string"){let I=E.length;if(Zs&&I>=8&&I<4096){let k=$9.test(E);Zs[k?0:1]+=E,Ee[ve++]=193,S(k?-I:I);return}let P;I<32?P=1:I<256?P=2:I<65536?P=3:P=5;let O=I*3;if(ve+O>Ys&&(Ee=T(ve+O)),I<64||!a){let k,F,G,Z=ve+P;for(k=0;k<I;k++)F=E.charCodeAt(k),F<128?Ee[Z++]=F:F<2048?(Ee[Z++]=F>>6|192,Ee[Z++]=F&63|128):(F&64512)===55296&&((G=E.charCodeAt(k+1))&64512)===56320?(F=65536+((F&1023)<<10)+(G&1023),k++,Ee[Z++]=F>>18|240,Ee[Z++]=F>>12&63|128,Ee[Z++]=F>>6&63|128,Ee[Z++]=F&63|128):(Ee[Z++]=F>>12|224,Ee[Z++]=F>>6&63|128,Ee[Z++]=F&63|128);A=Z-ve-P}else A=a(E,ve+P,O);A<32?Ee[ve++]=160|A:A<256?(P<2&&Ee.copyWithin(ve+2,ve+1,ve+1+A),Ee[ve++]=217,Ee[ve++]=A):A<65536?(P<3&&Ee.copyWithin(ve+3,ve+2,ve+2+A),Ee[ve++]=218,Ee[ve++]=A>>8,Ee[ve++]=A&255):(P<5&&Ee.copyWithin(ve+5,ve+3,ve+3+A),Ee[ve++]=219,zn.setUint32(ve,A),ve+=4),ve+=A}else if(L==="number")if(E>>>0===E)E<64?Ee[ve++]=E:E<256?(Ee[ve++]=204,Ee[ve++]=E):E<65536?(Ee[ve++]=205,Ee[ve++]=E>>8,Ee[ve++]=E&255):(Ee[ve++]=206,zn.setUint32(ve,E),ve+=4);else if(E>>0===E)E>=-32?Ee[ve++]=256+E:E>=-128?(Ee[ve++]=208,Ee[ve++]=E+256):E>=-32768?(Ee[ve++]=209,zn.setInt16(ve,E),ve+=2):(Ee[ve++]=210,zn.setInt32(ve,E),ve+=4);else{let I;if((I=this.useFloat32)>0&&E<4294967296&&E>=-2147483648){Ee[ve++]=202,zn.setFloat32(ve,E);let P;if(I<4||(P=E*RM[(Ee[ve]&127)<<1|Ee[ve+1]>>7])>>0===P){ve+=4;return}else ve--}Ee[ve++]=203,zn.setFloat64(ve,E),ve+=8}else if(L==="object")if(!E)Ee[ve++]=192;else{if(s){let P=s.get(E);if(P){if(!P.id){let O=s.idsToInsert||(s.idsToInsert=[]);P.id=O.push(P)}Ee[ve++]=214,Ee[ve++]=112,zn.setUint32(ve,P.id),ve+=4;return}else s.set(E,{offset:ve-e})}let I=E.constructor;if(I===Object)b(E,!0);else if(I===Array){A=E.length,A<16?Ee[ve++]=144|A:A<65536?(Ee[ve++]=220,Ee[ve++]=A>>8,Ee[ve++]=A&255):(Ee[ve++]=221,zn.setUint32(ve,A),ve+=4);for(let P=0;P<A;P++)S(E[P])}else if(I===Map){A=E.size,A<16?Ee[ve++]=128|A:A<65536?(Ee[ve++]=222,Ee[ve++]=A>>8,Ee[ve++]=A&255):(Ee[ve++]=223,zn.setUint32(ve,A),ve+=4);for(let[P,O]of E)S(P),S(O)}else{for(let P=0,O=lv.length;P<O;P++){let k=OM[P];if(E instanceof k){let F=lv[P];if(F.write){F.type&&(Ee[ve++]=212,Ee[ve++]=F.type,Ee[ve++]=0),S(F.write.call(this,E));return}let G=Ee,Z=zn,ne=ve;Ee=null;let J;try{J=F.pack.call(this,E,z=>(Ee=G,G=null,ve+=z,ve>Ys&&T(ve),{target:Ee,targetView:zn,position:ve-z}),S)}finally{G&&(Ee=G,zn=Z,ve=ne,Ys=Ee.length-10)}J&&(J.length+ve>Ys&&T(J.length+ve),ve=q9(J,Ee,ve,F.type));return}}b(E,!E.hasOwnProperty)}}else if(L==="boolean")Ee[ve++]=E?195:194;else if(L==="bigint"){if(E<BigInt(1)<<BigInt(63)&&E>=-(BigInt(1)<<BigInt(63)))Ee[ve++]=211,zn.setBigInt64(ve,E);else if(E<BigInt(1)<<BigInt(64)&&E>0)Ee[ve++]=207,zn.setBigUint64(ve,E);else if(this.largeBigIntToFloat)Ee[ve++]=203,zn.setFloat64(ve,Number(E));else throw new RangeError(E+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ve+=8}else if(L==="undefined")this.encodeUndefinedAsNil?Ee[ve++]=192:(Ee[ve++]=212,Ee[ve++]=0,Ee[ve++]=0);else if(L==="function")S(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+L)},b=this.useRecords===!1?this.variableMapSize?E=>{let L=Object.keys(E),A=L.length;A<16?Ee[ve++]=128|A:A<65536?(Ee[ve++]=222,Ee[ve++]=A>>8,Ee[ve++]=A&255):(Ee[ve++]=223,zn.setUint32(ve,A),ve+=4);let I;for(let P=0;P<A;P++)S(I=L[P]),S(E[I])}:(E,L)=>{Ee[ve++]=222;let A=ve-e;ve+=2;let I=0;for(let P in E)(L||E.hasOwnProperty(P))&&(S(P),S(E[P]),I++);Ee[A+++e]=I>>8,Ee[A+e]=I&255}:E=>{let L=Object.keys(E),A,I=r.transitions||(r.transitions=Object.create(null)),P=0;for(let k=0,F=L.length;k<F;k++){let G=L[k];A=I[G],A||(A=I[G]=Object.create(null),P++),I=A}let O=I[Od];if(O)O>=96&&m?(Ee[ve++]=((O-=96)&31)+96,Ee[ve++]=O>>5):Ee[ve++]=O;else{O=r.nextId,O||(O=64),O<g&&this.shouldShareStructure&&!this.shouldShareStructure(L)?(O=r.nextOwnId,O<v||(O=g),r.nextOwnId=O+1):(O>=v&&(O=g),r.nextId=O+1);let k=L.highByte=O>=96&&m?O-96>>5:-1;I[Od]=O,r[O-64]=L,O<g?(L.isShared=!0,r.sharedLength=O-63,i=!0,k>=0?(Ee[ve++]=(O&31)+96,Ee[ve++]=k):Ee[ve++]=O):(k>=0?(Ee[ve++]=213,Ee[ve++]=114,Ee[ve++]=(O&31)+96,Ee[ve++]=k):(Ee[ve++]=212,Ee[ve++]=114,Ee[ve++]=O),P&&(y+=_*P),x.length>=h&&(x.shift()[Od]=0),x.push(I),S(L))}for(let k=0,F=L.length;k<F;k++)S(E[L[k]])},T=E=>{let L;if(E>16777216){if(E-e>ZT)throw new Error("Packed buffer would be larger than maximum buffer size");L=Math.min(ZT,Math.round(Math.max((E-e)*(E>67108864?1.25:2),4194304)/4096)*4096)}else L=(Math.max(E-e<<2,Ee.length-1)>>12)+1<<12;let A=new Gx(L);return zn=new DataView(A.buffer,0,L),Ee.copy?Ee.copy(A,0,e,E):A.set(Ee.slice(e,E)),ve-=e,e=0,Ys=A.length-10,Ee=A}}useBuffer(t){Ee=t,zn=new DataView(Ee.buffer,Ee.byteOffset,Ee.byteLength),ve=0}};OM=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,RO];lv=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){let i=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.structuredClone?JT(t,16,e):KT(hy?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==VO&&this.structuredClone?JT(t,UO.indexOf(n.name),e):KT(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function JT(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=n(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=n(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=n(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function KT(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function q9(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function X9(t,e){let n,i=e.length*6,r=t.length-i;for(e.sort((s,o)=>s.offset>o.offset?1:-1);n=e.pop();){let s=n.offset,o=n.id;t.copyWithin(s+i,s,r),i-=6;let a=s+i;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function Bh(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");OM.unshift(t.Class),lv.unshift(t)}W9(t)}var HO=new GO({useRecords:!1});HO.pack;HO.pack;var Y9=512,Z9=1024,QT=new GO({structuredClone:!0});Bh({Class:Hn.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Hn.prototype),t}});Bh({Class:tn.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,tn.prototype),t}});Bh({Class:Ds.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,Ds.prototype),t}});Bh({Class:VT.prototype.constructor,type:4,write(t){return t.id},read(t){return new VT(t)}});Bh({Class:GT.prototype.constructor,type:5,write(t){return t.data},read(t){return new GT(t)}});Bh({Class:pi.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,pi.prototype),t}});function J9(t){var e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){let i=t[n];e=(e<<5)-e+i,e=e&e}return e}function iS(t){if(AM(t))return t;if(Array.isArray(t))return t.map(iS);if(typeof t=="object"&&t!==null){let e={};for(let n of Object.keys(t).sort())e[n]=iS(t[n]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var rS;(t=>{function e(r){return QT.pack(r)}t.serialize=e;function n(r){return QT.unpack(r)}t.deserialize=n;function i(r){return J9(e(iS(r))).toString()}t.checksum=i})(rS||(rS={}));var eC;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s]}t.lerp=n})(eC||(eC={}));var Kc;(t=>{function e(l,u){return l[0]===u[0]&&l[1]===u[1]&&l[2]===u[2]}t.isEqual=e;function n(l,u){return[l[0]+u[0],l[1]+u[1],l[2]+u[2]]}t.add=n;function i(l,u){return[l[0]-u[0],l[1]-u[1],l[2]-u[2]]}t.sub=i;function r(l,u){return[l[0]/u[0],l[1]/u[1],l[2]/u[2]]}t.div=r;function s(l,u){return[l[0]*u[0],l[1]*u[1],l[2]*u[2]]}t.mul=s;function o(l,u){return Math.hypot(l[0]-u[0],l[1]-u[1],l[2]-u[2])}t.dist=o;function a(l,u,d){return[l[0]+(u[0]-l[0])*d,l[1]+(u[1]-l[1])*d,l[2]+(u[2]-l[2])*d]}t.lerp=a})(Kc||(Kc={}));var tC;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s,i[2]+(r[2]-i[2])*s,i[3]+(r[3]-i[3])*s]}t.lerp=n})(tC||(tC={}));var wh;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function n(r){return r??t.identity}t.simplify=n;function i(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let u=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/u,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/u,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/u}return o}t.applyMatrix4=i})(wh||(wh={}));var Qr;(t=>{function e(a){return typeof a=="object"&&typeof a.r=="number"&&typeof a.g=="number"&&typeof a.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function n(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:1}}t.toRgb255a1=n;function i(a){return{r:a.r,g:a.g,b:a.b}}t.clone=i;function r(a){return a=Math.floor(a),{r:(a>>16&255)/255,g:(a>>8&255)/255,b:(a&255)/255}}t.fromHex=r;function s(a,l){return a.r===l.r&&a.g===l.g&&a.b===l.b}t.equals=s;function o(a,l,u){return{r:a.r+(l.r-a.r)*u,g:a.g+(l.g-a.g)*u,b:a.b+(l.b-a.b)*u}}t.lerp=o})(Qr||(Qr={}));var Wo;(t=>{t.white={...Qr.white,a:1},t.transparent={...Qr.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function n(o,a){return{...Qr.fromHex(o),a}}t.fromHexAndA=n;function i(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=i;function r(o,a){return Qr.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(Wo||(Wo={}));var sS;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(sS||(sS={}));var nC;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(nC||(nC={}));var iC;(t=>t.defaultData={control1:[.5,.05],control2:[.1,.3]})(iC||(iC={}));var Mu;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(n){return t.all.includes(n)}t.is=e})(Mu||(Mu={}));var lp;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1,autoZoom:!1,autoZoomFrustumSize:790},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(n){return n.type==="PerspectiveCamera"?n.perspective.zoom:n.orthographic.zoom}t.getZoom=e})(lp||(lp={}));var Ba;(t=>{function e(i,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*r,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function n(i,r){let s={...i};if(K9.forEach(o=>{Object.assign(s,{[o]:r[o]??i[o]})}),s.radial={...i.radial},r.radial){let o=i.radial,a=r.radial;Q9.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...i.linear},r.linear){let o=i.linear,a=r.linear;ej.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...i.grid},r.grid){let o=i.grid,a=r.grid;tj.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...i.toObject},r.toObject){let o=i.toObject,a=r.toObject;nj.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...i.randomnessObject},r.randomnessObject){let o=i.randomnessObject,a=r.randomnessObject;ij.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=n})(Ba||(Ba={}));var oS;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function n(i,r){let s=[];i.count!==void 0&&s.push({type:0,path:r,props:{count:i.count}});for(let o of e){let a=i[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=n})(oS||(oS={}));var K9=["count"],Q9=["radius","start","end","position","scale","rotation"],ej=["position","scale","rotation"],tj=["count","size"],nj=["count","position","scale","rotation"],ij=["strength","scale","rotation","position","movement","seed","freqScale"],aS;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(n){return t.all.includes(n)}t.is=e})(aS||(aS={}));var lS;(t=>{function e(i){return n(i)}t.defaultData=e;function n(i){if(i==="PointLight")return{type:i,color:Wo.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,depth:1e5};if(i==="SpotLight")return{type:i,color:Wo.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Wo.white,intensity:1,shadows:!0,size:1e3,depth:1e5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(lS||(lS={}));var uS;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(n,i){return n.castShadow===i.castShadow&&n.receiveShadow===i.receiveShadow}t.equals=e})(uS||(uS={}));var cS;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(n,i){return n.flatShading===i.flatShading&&n.side===i.side&&n.wireframe===i.wireframe}t.equals=e})(cS||(cS={}));var hS;(t=>t.defaultData={...cS.defaultData,...uS.defaultData})(hS||(hS={}));var uv;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(uv||(uv={}));var rj=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],sj=["wrapping","image","video"],Jr;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let u=s.texture;u&&Object.assign(u,a)}}t.patch=e;function n(s,o){return s==="light"&&o?i(o):r(s)}t.defaultData=n;function i(s){switch(s){case"phong":return{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",alpha:.6,visible:!0,mode:0};case"toon":return{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1,visible:!0,mode:0};case"lambert":return{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0};case"physical":return{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0}}}function r(s){switch(s){case"texture":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"texture",projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"video",projection:0,texture:{video:uv.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!0};case"color":return{type:"color",alpha:1,visible:!0,mode:0,color:Qr.fromHex(4737101)};case"depth":return{type:"depth",alpha:1,visible:!0,mode:0,gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{type:"normal",alpha:1,visible:!0,mode:0,cnormal:[1,1,1]};case"gradient":return{type:"gradient",alpha:1,visible:!0,mode:0,gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{type:"noise",alpha:1,visible:!0,mode:0,size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...Qr.fromHex(6710886),a:1},colorB:{...Qr.fromHex(6710886),a:1},colorC:{...Qr.fromHex(16777215),a:1},colorD:{...Qr.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8]};case"fresnel":return{type:"fresnel",alpha:1,visible:!0,mode:0,color:Wo.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{type:"rainbow",alpha:1,visible:!0,mode:0,filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{type:"toon",alpha:1,visible:!0,mode:0,positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Wo.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{type:"outline",alpha:1,visible:!0,mode:0,outlineColor:Wo.fromHexAndA(0,1),contourColor:Wo.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{type:"matcap",alpha:1,visible:!0,mode:0,texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{type:"transmission",alpha:1,visible:!0,mode:0,thickness:10,ior:1.5,roughness:1};case"displace":return{type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,visible:!0}}}})(Jr||(Jr={}));var fo;(t=>{function e(u){return!u.layers.some(d=>d.data.type==="texture"&&d.data.projection!==0||d.data.type==="depth"&&!d.data.isWorldSpace||d.data.type==="noise"||d.data.type==="displace")}t.isMergable=e;function n(u){let d="";return u.layers.forEach(c=>{Object.entries(c.data).forEach(([h,m])=>{d+=`${h}${m}`,Array.isArray(m)?m.forEach(g=>d+=`${g}`):typeof m=="object"?Object.values(m).forEach(g=>{typeof g=="number"?d+=`${g.toFixed(4)}`:d+=`${g}`}):d+=`${m}`})}),d}t.getHash=n;function i(){return{layers:new tn}}t.defaultEmptyData=i;function r(u="layer1",d="layer2"){return o("phong",u,d)}t.defaultData=r;function s(u,d){return{...u,name:d}}t.withName=s;function o(u,d="layer1",c="layer2"){let h=new tn;return h.push({fi:0,data:Jr.defaultData("light",u),id:d}),h.push({fi:1,data:Jr.defaultData("color"),id:c}),{layers:h}}t.defaultTwoLayerData=o;function a(u,d="phong",c="layer1",h="layer2"){let m=Jr.defaultData("texture");Object.assign(m.texture,{image:u});let g=new tn;return g.push({fi:0,data:m,id:c}),g.push({fi:1,data:Jr.defaultData("light",d),id:h}),{layers:g}}t.defaultTwoLayerTextureData=a;function l(u,d="phong",c="layer1",h="layer2"){let m=Jr.defaultData("video");Object.assign(m.texture,{video:u});let g=new tn;return g.push({fi:0,data:m,id:c}),g.push({fi:1,data:Jr.defaultData("light",d),id:h}),{layers:g}}t.defaultTwoLayerVideoTextureData=l})(fo||(fo={}));var cv;(t=>{function e(){return{points:new tn,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(cv||(cv={}));var hv;(t=>{function e(){return{points:new tn,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(hv||(hv={}));var WO={type:"Ellipse",width:100,height:100,spikes:64,angle:360,innerRadius:0},dS;(t=>{function e(n,i){let r={...n};return oj.forEach(s=>{Object.assign(r,{[s]:i[s]??n[s]})}),r}t.merge=e})(dS||(dS={}));var jO={shape:WO,depth:1,offset:0,bevel:0,bevelSides:1,angle:0,twist:0,startScale:1,endScale:1},oj=["depth","offset","angle","twist","startScale","endScale"],dv;(t=>{function e(n){return n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"}t.is2DParametricMesh=e})(dv||(dv={}));var fS;(t=>{function e(n,i){let r={...n};return Object.assign(r,i),r.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(r.extrusion={...n.extrusion},Object.assign(r.extrusion,dS.merge(r.extrusion,i.extrusion))),r}t.merge=e})(fS||(fS={}));var Qc;(t=>{function e(n){if(n==="RectangleGeometry")return{width:320,height:320,type:n,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="PathGeometry")return{type:n,width:1,height:1,depth:1,path:hv.defaultData(),extrusion:jO};if(n==="VectorGeometry")return{width:1,height:1,type:n,subdivisions:12,shape:cv.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="BooleanGeometry")return{type:n,operation:2,width:0,height:0,depth:0,phongAngle:35};if(n==="TextGeometry")return{type:n,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};throw new Error("not implemented")}t.defaultData=e})(Qc||(Qc={}));var rC;(t=>{function e(i){return i==="Component"||i==="Instance"}t.isComponentRelated=e;function n(i){return i==="Empty"||i==="Instance"}t.isEmptyOrComponent=n})(rC||(rC={}));var Sh;(t=>{t.identity={...sS.identity,hiddenMatrix:wh.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function n(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=n;function i(r,s){return{position:Kc.isEqual(r.position,s.position)?null:s.position,rotation:Kc.isEqual(r.rotation,s.rotation)?null:s.rotation,scale:Kc.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:wh.isEqual(r.hiddenMatrix,s.hiddenMatrix)?null:s.hiddenMatrix}}t.diff=i})(Sh||(Sh={}));var pS;(t=>t.defaultData={fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(pS||(pS={}));var ss;(t=>t.defaultData={states:new tn,events:new tn,visible:!0,raycastLock:!1,physics:null,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Sh.identity,cloner:null})(ss||(ss={}));var sC;(t=>t.defaultData={type:"Empty",...ss.defaultData})(sC||(sC={}));var oC;(t=>t.defaultData={type:"Component",...ss.defaultData})(oC||(oC={}));var eh;(t=>t.defaultData={type:"Mesh",...ss.defaultData,...hS.defaultData})(eh||(eh={}));var fv;(t=>t.defaultData={...ss.defaultData,...Sh.identity,...lp.defaultData})(fv||(fv={}));var aC;(t=>{function e(n){return{...ss.defaultData,...lS.defaultData(n)}}t.defaultData=e})(aC||(aC={}));var pv;(t=>{function e(i,r,s=0){for(;s<r.length;){let o=i?i[r[s]]:void 0;if(r.length===s+1)return o;if(o)i=o.descendants,s+=1;else return}}t.resolveWithDes=e;function n(i,r,s=0){let o=e(i,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=n})(pv||(pv={}));var bh;(t=>{t.rootOverrideProps=["physics"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(i,r){return{...ss.defaultData,...r,component:i,overrides:new pi,physics:void 0,type:"Instance"}}t.ofComponent=e;function n(i){let r=Sh.fromObject(i.data);return e(i.id,r)}t.fromComponentData=n})(bh||(bh={}));var lC;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:wh.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:pS.defaultData,states:new tn,events:new tn,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...lp.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...ss.defaultData,...eh.defaultData,geometry:Qc.defaultData("RectangleGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...ss.defaultData,...eh.defaultData,geometry:Qc.defaultData("BooleanGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...ss.defaultData,...eh.defaultData,geometry:Qc.defaultData("TextGeometry"),material:fo.defaultTwoLayerData("phong","layer1","layer2")}))(lC||(lC={}));var Gc;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new pi}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new pi})))):Mu.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function n(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=ov(a.material,l=>{if(typeof l!="string")for(let[u,d]of Object.entries(o.material.layers)){let c=l.layers.data(u);c&&Jr.patch(c,d)}}).data),a.materials&&o.materials&&(a.materials=ov(a.materials,l=>{var u,d;for(let c=0;c<a.materials.length;c++){let h=o.materials[c];if(typeof h!="string")for(let[m,g]of Object.entries(h.layers)){let v=(d=(u=l[c])==null?void 0:u.layers)==null?void 0:d.data(m);v&&Jr.patch(v,g)}}}).data),a}function i(s,o){let a,l=[],u={orthographic:0,perspective:0,geometry:0};function d(c,h){for(let[m,g]of Object.entries(h.layers)){let{texture:v,...x}=g;if(v!==void 0&&Object.keys(v).length>0){let y={path:[...c,"layers",m,"texture"],props:v,type:0};l.push(y)}if(Object.keys(x).length>0){let y={path:[...c,"layers",m],props:x,type:0};l.push(y)}}}for(let[c,h]of Object.entries(o))if(c!=="name")if(c==="cloner")l.push(...oS.toOps(h,["cloner"]));else if(c==="pathSnapping")l.push({path:[c],props:{slide:h.slide,offset:h.offset},type:0});else if(c==="material")d(["material"],h);else if(c==="materials")for(let[m,g]of Object.entries(h))d(["materials",m],g);else if(u[c]===0){if(c==="geometry"&&h.extrusion!==void 0){let m={path:[c,"extrusion"],props:h.extrusion,type:0};l.push(m),h={...h},delete h.extrusion}if(Object.keys(h).length>0){let m={path:[c],props:h,type:0};l.push(m)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[c]=h;return l}t.toOps=i;function r(s,o){var l,u,d,c,h,m;if(o===void 0)return s;let a={...s};if(Object.assign(a,Sh.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((u=a.pathSnapping)==null?void 0:u.slide)??0,offset:((d=o.pathSnapping)==null?void 0:d.offset)??((c=a.pathSnapping)==null?void 0:c.offset)??0})}),Mu.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let g=o;((h=g.orthographic)==null?void 0:h.zoom)!==void 0&&(a.orthographic.zoom=g.orthographic.zoom),((m=g.perspective)==null?void 0:m.zoom)!==void 0&&(a.perspective.zoom=g.perspective.zoom),g.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=g.isUpVectorFlipped),g.targetOffset!==void 0&&(a.targetOffset=g.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:fS.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=n(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:Ba.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:Ba.merge(a.cloner,o.cloner)});else if(aS.is(s.type)){let g=o;g.intensity!==void 0&&(a.intensity=g.intensity),g.color!==void 0&&(typeof g.color=="string"?a.color=g.color:a.color=Qr.clone(g.color))}return a}t.patch=r})(Gc||(Gc={}));var mv;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0,autoZoom:!1})(mv||(mv={}));var mS;(t=>t.defaultData={orbitControls:mv.defaultData,playCamera:null,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:typeof window<"u"?Math.floor(window.devicePixelRatio):1,stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,joystickSizeAndXYOffset:Array(12).fill(0).map((e,n)=>{let i=0,r=0;return n<5?r=-30:n<10&&(r=30),n===0||n===10||n===5?i=30:(n===4||n===11||n===9)&&(i=-30),[120,[i,r],"show"]}),gameControlObject:null})(mS||(mS={}));function Mh(t,e){return Object.setPrototypeOf(t,e),t}function $O(t){return Array.isArray(t)?t:[t]}function aj(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var gv;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="})(gv||(gv={}));var gS;(t=>{function e(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Mh(r,Hn.prototype)}t.defaultColors=e;function n(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...gv.emptyImage,name:"AI generated image"}),Mh(s,Hn.prototype)}t.defaultImages=n;function i(){return{materials:new Hn,images:new Hn,videos:new Hn,colors:new Hn,audios:new Hn,fonts:new Hn,penumbraSize:[.5,.5,.5]}}t.emptyData=i})(gS||(gS={}));var lj=typeof global=="object"&&global&&global.Object===Object&&global,qO=lj,uj=typeof self=="object"&&self&&self.Object===Object&&self,cj=qO||uj||Function("return this")(),go=cj,hj=go.Symbol,hs=hj,XO=Object.prototype,dj=XO.hasOwnProperty,fj=XO.toString,zd=hs?hs.toStringTag:void 0;function pj(t){var e=dj.call(t,zd),n=t[zd];try{t[zd]=void 0;var i=!0}catch{}var r=fj.call(t);return i&&(e?t[zd]=n:delete t[zd]),r}var mj=pj,gj=Object.prototype,vj=gj.toString;function yj(t){return vj.call(t)}var xj=yj,_j="[object Null]",wj="[object Undefined]",uC=hs?hs.toStringTag:void 0;function Sj(t){return t==null?t===void 0?wj:_j:uC&&uC in Object(t)?mj(t):xj(t)}var Nu=Sj;function bj(t){return t!=null&&typeof t=="object"}var sa=bj,Mj="[object Symbol]";function Ej(t){return typeof t=="symbol"||sa(t)&&Nu(t)==Mj}var zM=Ej;function Aj(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var YO=Aj,Tj=Array.isArray,Ns=Tj,Cj=1/0,cC=hs?hs.prototype:void 0,hC=cC?cC.toString:void 0;function ZO(t){if(typeof t=="string")return t;if(Ns(t))return YO(t,ZO)+"";if(zM(t))return hC?hC.call(t):"";var e=t+"";return e=="0"&&1/t==-Cj?"-0":e}var Pj=ZO;function Lj(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Eu=Lj;function Ij(t){return t}var Dj=Ij,Rj="[object AsyncFunction]",Oj="[object Function]",zj="[object GeneratorFunction]",Nj="[object Proxy]";function kj(t){if(!Eu(t))return!1;var e=Nu(t);return e==Oj||e==zj||e==Rj||e==Nj}var JO=kj,Bj=go["__core-js_shared__"],Hx=Bj,dC=function(){var t=/[^.]+$/.exec(Hx&&Hx.keys&&Hx.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Uj(t){return!!dC&&dC in t}var Fj=Uj,Vj=Function.prototype,Gj=Vj.toString;function Hj(t){if(t!=null){try{return Gj.call(t)}catch{}try{return t+""}catch{}}return""}var ku=Hj,Wj=/[\\^$.*+?()[\]{}|]/g,jj=/^\[object .+?Constructor\]$/,$j=Function.prototype,qj=Object.prototype,Xj=$j.toString,Yj=qj.hasOwnProperty,Zj=RegExp("^"+Xj.call(Yj).replace(Wj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Jj(t){if(!Eu(t)||Fj(t))return!1;var e=JO(t)?Zj:jj;return e.test(ku(t))}var Kj=Jj;function Qj(t,e){return t==null?void 0:t[e]}var e7=Qj;function t7(t,e){var n=e7(t,e);return Kj(n)?n:void 0}var Bu=t7,n7=Bu(go,"WeakMap"),vS=n7,fC=Object.create,i7=function(){function t(){}return function(e){if(!Eu(e))return{};if(fC)return fC(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),r7=i7;function s7(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var o7=s7;function a7(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var l7=a7,u7=800,c7=16,h7=Date.now;function d7(t){var e=0,n=0;return function(){var i=h7(),r=c7-(i-n);if(n=i,r>0){if(++e>=u7)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var f7=d7;function p7(t){return function(){return t}}var m7=p7,g7=function(){try{var t=Bu(Object,"defineProperty");return t({},"",{}),t}catch{}}(),vv=g7,v7=vv?function(t,e){return vv(t,"toString",{configurable:!0,enumerable:!1,value:m7(e),writable:!0})}:Dj,y7=v7,x7=f7(y7),_7=x7;function w7(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var S7=w7,b7=9007199254740991,M7=/^(?:0|[1-9]\d*)$/;function E7(t,e){var n=typeof t;return e=e??b7,!!e&&(n=="number"||n!="symbol"&&M7.test(t))&&t>-1&&t%1==0&&t<e}var NM=E7;function A7(t,e,n){e=="__proto__"&&vv?vv(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var KO=A7;function T7(t,e){return t===e||t!==t&&e!==e}var kM=T7,C7=Object.prototype,P7=C7.hasOwnProperty;function L7(t,e,n){var i=t[e];(!(P7.call(t,e)&&kM(i,n))||n===void 0&&!(e in t))&&KO(t,e,n)}var BM=L7;function I7(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?KO(n,a,l):BM(n,a,l)}return n}var Dp=I7,pC=Math.max;function D7(t,e,n){return e=pC(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=pC(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),o7(t,this,a)}}var R7=D7,O7=9007199254740991;function z7(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=O7}var UM=z7;function N7(t){return t!=null&&UM(t.length)&&!JO(t)}var QO=N7,k7=Object.prototype;function B7(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||k7;return t===n}var FM=B7;function U7(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var F7=U7,V7="[object Arguments]";function G7(t){return sa(t)&&Nu(t)==V7}var mC=G7,ez=Object.prototype,H7=ez.hasOwnProperty,W7=ez.propertyIsEnumerable,j7=mC(function(){return arguments}())?mC:function(t){return sa(t)&&H7.call(t,"callee")&&!W7.call(t,"callee")},VM=j7;function $7(){return!1}var q7=$7,tz=typeof xr=="object"&&xr&&!xr.nodeType&&xr,gC=tz&&typeof _r=="object"&&_r&&!_r.nodeType&&_r,X7=gC&&gC.exports===tz,vC=X7?go.Buffer:void 0,Y7=vC?vC.isBuffer:void 0,Z7=Y7||q7,yv=Z7,J7="[object Arguments]",K7="[object Array]",Q7="[object Boolean]",e$="[object Date]",t$="[object Error]",n$="[object Function]",i$="[object Map]",r$="[object Number]",s$="[object Object]",o$="[object RegExp]",a$="[object Set]",l$="[object String]",u$="[object WeakMap]",c$="[object ArrayBuffer]",h$="[object DataView]",d$="[object Float32Array]",f$="[object Float64Array]",p$="[object Int8Array]",m$="[object Int16Array]",g$="[object Int32Array]",v$="[object Uint8Array]",y$="[object Uint8ClampedArray]",x$="[object Uint16Array]",_$="[object Uint32Array]",ln={};ln[d$]=ln[f$]=ln[p$]=ln[m$]=ln[g$]=ln[v$]=ln[y$]=ln[x$]=ln[_$]=!0;ln[J7]=ln[K7]=ln[c$]=ln[Q7]=ln[h$]=ln[e$]=ln[t$]=ln[n$]=ln[i$]=ln[r$]=ln[s$]=ln[o$]=ln[a$]=ln[l$]=ln[u$]=!1;function w$(t){return sa(t)&&UM(t.length)&&!!ln[Nu(t)]}var S$=w$;function b$(t){return function(e){return t(e)}}var GM=b$,nz=typeof xr=="object"&&xr&&!xr.nodeType&&xr,yf=nz&&typeof _r=="object"&&_r&&!_r.nodeType&&_r,M$=yf&&yf.exports===nz,Wx=M$&&qO.process,E$=function(){try{var t=yf&&yf.require&&yf.require("util").types;return t||Wx&&Wx.binding&&Wx.binding("util")}catch{}}(),Eh=E$,yC=Eh&&Eh.isTypedArray,A$=yC?GM(yC):S$,iz=A$,T$=Object.prototype,C$=T$.hasOwnProperty;function P$(t,e){var n=Ns(t),i=!n&&VM(t),r=!n&&!i&&yv(t),s=!n&&!i&&!r&&iz(t),o=n||i||r||s,a=o?F7(t.length,String):[],l=a.length;for(var u in t)(e||C$.call(t,u))&&!(o&&(u=="length"||r&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||NM(u,l)))&&a.push(u);return a}var rz=P$;function L$(t,e){return function(n){return t(e(n))}}var sz=L$,I$=sz(Object.keys,Object),D$=I$,R$=Object.prototype,O$=R$.hasOwnProperty;function z$(t){if(!FM(t))return D$(t);var e=[];for(var n in Object(t))O$.call(t,n)&&n!="constructor"&&e.push(n);return e}var N$=z$;function k$(t){return QO(t)?rz(t):N$(t)}var HM=k$;function B$(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var U$=B$,F$=Object.prototype,V$=F$.hasOwnProperty;function G$(t){if(!Eu(t))return U$(t);var e=FM(t),n=[];for(var i in t)i=="constructor"&&(e||!V$.call(t,i))||n.push(i);return n}var H$=G$;function W$(t){return QO(t)?rz(t,!0):H$(t)}var WM=W$,j$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$$=/^\w*$/;function q$(t,e){if(Ns(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||zM(t)?!0:$$.test(t)||!j$.test(t)||e!=null&&t in Object(e)}var X$=q$,Y$=Bu(Object,"create"),up=Y$;function Z$(){this.__data__=up?up(null):{},this.size=0}var J$=Z$;function K$(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Q$=K$,eq="__lodash_hash_undefined__",tq=Object.prototype,nq=tq.hasOwnProperty;function iq(t){var e=this.__data__;if(up){var n=e[t];return n===eq?void 0:n}return nq.call(e,t)?e[t]:void 0}var rq=iq,sq=Object.prototype,oq=sq.hasOwnProperty;function aq(t){var e=this.__data__;return up?e[t]!==void 0:oq.call(e,t)}var lq=aq,uq="__lodash_hash_undefined__";function cq(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=up&&e===void 0?uq:e,this}var hq=cq;function Uh(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Uh.prototype.clear=J$;Uh.prototype.delete=Q$;Uh.prototype.get=rq;Uh.prototype.has=lq;Uh.prototype.set=hq;var xC=Uh;function dq(){this.__data__=[],this.size=0}var fq=dq;function pq(t,e){for(var n=t.length;n--;)if(kM(t[n][0],e))return n;return-1}var dy=pq,mq=Array.prototype,gq=mq.splice;function vq(t){var e=this.__data__,n=dy(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():gq.call(e,n,1),--this.size,!0}var yq=vq;function xq(t){var e=this.__data__,n=dy(e,t);return n<0?void 0:e[n][1]}var _q=xq;function wq(t){return dy(this.__data__,t)>-1}var Sq=wq;function bq(t,e){var n=this.__data__,i=dy(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var Mq=bq;function Fh(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Fh.prototype.clear=fq;Fh.prototype.delete=yq;Fh.prototype.get=_q;Fh.prototype.has=Sq;Fh.prototype.set=Mq;var fy=Fh,Eq=Bu(go,"Map"),cp=Eq;function Aq(){this.size=0,this.__data__={hash:new xC,map:new(cp||fy),string:new xC}}var Tq=Aq;function Cq(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Pq=Cq;function Lq(t,e){var n=t.__data__;return Pq(e)?n[typeof e=="string"?"string":"hash"]:n.map}var py=Lq;function Iq(t){var e=py(this,t).delete(t);return this.size-=e?1:0,e}var Dq=Iq;function Rq(t){return py(this,t).get(t)}var Oq=Rq;function zq(t){return py(this,t).has(t)}var Nq=zq;function kq(t,e){var n=py(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var Bq=kq;function Vh(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Vh.prototype.clear=Tq;Vh.prototype.delete=Dq;Vh.prototype.get=Oq;Vh.prototype.has=Nq;Vh.prototype.set=Bq;var my=Vh,Uq="Expected a function";function jM(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Uq);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(jM.Cache||my),n}jM.Cache=my;var Fq=jM,Vq=500;function Gq(t){var e=Fq(t,function(i){return n.size===Vq&&n.clear(),i}),n=e.cache;return e}var Hq=Gq,Wq=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,jq=/\\(\\)?/g,$q=Hq(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Wq,function(n,i,r,s){e.push(r?s.replace(jq,"$1"):i||n)}),e}),qq=$q;function Xq(t){return t==null?"":Pj(t)}var Yq=Xq;function Zq(t,e){return Ns(t)?t:X$(t,e)?[t]:qq(Yq(t))}var Gh=Zq,Jq=1/0;function Kq(t){if(typeof t=="string"||zM(t))return t;var e=t+"";return e=="0"&&1/t==-Jq?"-0":e}var gy=Kq;function Qq(t,e){e=Gh(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[gy(e[n++])];return n&&n==i?t:void 0}var oz=Qq;function eX(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var $M=eX,_C=hs?hs.isConcatSpreadable:void 0;function tX(t){return Ns(t)||VM(t)||!!(_C&&t&&t[_C])}var nX=tX;function az(t,e,n,i,r){var s=-1,o=t.length;for(n||(n=nX),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?az(a,e-1,n,i,r):$M(r,a):i||(r[r.length]=a)}return r}var iX=az;function rX(t){var e=t==null?0:t.length;return e?iX(t,1):[]}var sX=rX;function oX(t){return _7(R7(t,void 0,sX),t+"")}var lz=oX,aX=sz(Object.getPrototypeOf,Object),qM=aX,lX="[object Object]",uX=Function.prototype,cX=Object.prototype,uz=uX.toString,hX=cX.hasOwnProperty,dX=uz.call(Object);function fX(t){if(!sa(t)||Nu(t)!=lX)return!1;var e=qM(t);if(e===null)return!0;var n=hX.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&uz.call(n)==dX}var pX=fX;function mX(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}var gX=mX;function vX(){this.__data__=new fy,this.size=0}var yX=vX;function xX(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var _X=xX;function wX(t){return this.__data__.get(t)}var SX=wX;function bX(t){return this.__data__.has(t)}var MX=bX,EX=200;function AX(t,e){var n=this.__data__;if(n instanceof fy){var i=n.__data__;if(!cp||i.length<EX-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new my(i)}return n.set(t,e),this.size=n.size,this}var TX=AX;function Hh(t){var e=this.__data__=new fy(t);this.size=e.size}Hh.prototype.clear=yX;Hh.prototype.delete=_X;Hh.prototype.get=SX;Hh.prototype.has=MX;Hh.prototype.set=TX;var b0=Hh;function CX(t,e){return t&&Dp(e,HM(e),t)}var PX=CX;function LX(t,e){return t&&Dp(e,WM(e),t)}var IX=LX,cz=typeof xr=="object"&&xr&&!xr.nodeType&&xr,wC=cz&&typeof _r=="object"&&_r&&!_r.nodeType&&_r,DX=wC&&wC.exports===cz,SC=DX?go.Buffer:void 0,bC=SC?SC.allocUnsafe:void 0;function RX(t,e){if(e)return t.slice();var n=t.length,i=bC?bC(n):new t.constructor(n);return t.copy(i),i}var OX=RX;function zX(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var NX=zX;function kX(){return[]}var hz=kX,BX=Object.prototype,UX=BX.propertyIsEnumerable,MC=Object.getOwnPropertySymbols,FX=MC?function(t){return t==null?[]:(t=Object(t),NX(MC(t),function(e){return UX.call(t,e)}))}:hz,XM=FX;function VX(t,e){return Dp(t,XM(t),e)}var GX=VX,HX=Object.getOwnPropertySymbols,WX=HX?function(t){for(var e=[];t;)$M(e,XM(t)),t=qM(t);return e}:hz,dz=WX;function jX(t,e){return Dp(t,dz(t),e)}var $X=jX;function qX(t,e,n){var i=e(t);return Ns(t)?i:$M(i,n(t))}var fz=qX;function XX(t){return fz(t,HM,XM)}var yS=XX;function YX(t){return fz(t,WM,dz)}var pz=YX,ZX=Bu(go,"DataView"),xS=ZX,JX=Bu(go,"Promise"),_S=JX,KX=Bu(go,"Set"),wS=KX,EC="[object Map]",QX="[object Object]",AC="[object Promise]",TC="[object Set]",CC="[object WeakMap]",PC="[object DataView]",eY=ku(xS),tY=ku(cp),nY=ku(_S),iY=ku(wS),rY=ku(vS),Bl=Nu;(xS&&Bl(new xS(new ArrayBuffer(1)))!=PC||cp&&Bl(new cp)!=EC||_S&&Bl(_S.resolve())!=AC||wS&&Bl(new wS)!=TC||vS&&Bl(new vS)!=CC)&&(Bl=function(t){var e=Nu(t),n=e==QX?t.constructor:void 0,i=n?ku(n):"";if(i)switch(i){case eY:return PC;case tY:return EC;case nY:return AC;case iY:return TC;case rY:return CC}return e});var hp=Bl,sY=Object.prototype,oY=sY.hasOwnProperty;function aY(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&oY.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var lY=aY,uY=go.Uint8Array,xv=uY;function cY(t){var e=new t.constructor(t.byteLength);return new xv(e).set(new xv(t)),e}var YM=cY;function hY(t,e){var n=e?YM(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var dY=hY,fY=/\w*$/;function pY(t){var e=new t.constructor(t.source,fY.exec(t));return e.lastIndex=t.lastIndex,e}var mY=pY,LC=hs?hs.prototype:void 0,IC=LC?LC.valueOf:void 0;function gY(t){return IC?Object(IC.call(t)):{}}var vY=gY;function yY(t,e){var n=e?YM(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var xY=yY,_Y="[object Boolean]",wY="[object Date]",SY="[object Map]",bY="[object Number]",MY="[object RegExp]",EY="[object Set]",AY="[object String]",TY="[object Symbol]",CY="[object ArrayBuffer]",PY="[object DataView]",LY="[object Float32Array]",IY="[object Float64Array]",DY="[object Int8Array]",RY="[object Int16Array]",OY="[object Int32Array]",zY="[object Uint8Array]",NY="[object Uint8ClampedArray]",kY="[object Uint16Array]",BY="[object Uint32Array]";function UY(t,e,n){var i=t.constructor;switch(e){case CY:return YM(t);case _Y:case wY:return new i(+t);case PY:return dY(t,n);case LY:case IY:case DY:case RY:case OY:case zY:case NY:case kY:case BY:return xY(t,n);case SY:return new i;case bY:case AY:return new i(t);case MY:return mY(t);case EY:return new i;case TY:return vY(t)}}var FY=UY;function VY(t){return typeof t.constructor=="function"&&!FM(t)?r7(qM(t)):{}}var GY=VY,HY="[object Map]";function WY(t){return sa(t)&&hp(t)==HY}var jY=WY,DC=Eh&&Eh.isMap,$Y=DC?GM(DC):jY,qY=$Y,XY="[object Set]";function YY(t){return sa(t)&&hp(t)==XY}var ZY=YY,RC=Eh&&Eh.isSet,JY=RC?GM(RC):ZY,KY=JY,QY=1,eZ=2,tZ=4,mz="[object Arguments]",nZ="[object Array]",iZ="[object Boolean]",rZ="[object Date]",sZ="[object Error]",gz="[object Function]",oZ="[object GeneratorFunction]",aZ="[object Map]",lZ="[object Number]",vz="[object Object]",uZ="[object RegExp]",cZ="[object Set]",hZ="[object String]",dZ="[object Symbol]",fZ="[object WeakMap]",pZ="[object ArrayBuffer]",mZ="[object DataView]",gZ="[object Float32Array]",vZ="[object Float64Array]",yZ="[object Int8Array]",xZ="[object Int16Array]",_Z="[object Int32Array]",wZ="[object Uint8Array]",SZ="[object Uint8ClampedArray]",bZ="[object Uint16Array]",MZ="[object Uint32Array]",sn={};sn[mz]=sn[nZ]=sn[pZ]=sn[mZ]=sn[iZ]=sn[rZ]=sn[gZ]=sn[vZ]=sn[yZ]=sn[xZ]=sn[_Z]=sn[aZ]=sn[lZ]=sn[vz]=sn[uZ]=sn[cZ]=sn[hZ]=sn[dZ]=sn[wZ]=sn[SZ]=sn[bZ]=sn[MZ]=!0;sn[sZ]=sn[gz]=sn[fZ]=!1;function M0(t,e,n,i,r,s){var o,a=e&QY,l=e&eZ,u=e&tZ;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!Eu(t))return t;var d=Ns(t);if(d){if(o=lY(t),!a)return l7(t,o)}else{var c=hp(t),h=c==gz||c==oZ;if(yv(t))return OX(t,a);if(c==vz||c==mz||h&&!r){if(o=l||h?{}:GY(t),!a)return l?$X(t,IX(o,t)):GX(t,PX(o,t))}else{if(!sn[c])return r?t:{};o=FY(t,c,a)}}s||(s=new b0);var m=s.get(t);if(m)return m;s.set(t,o),KY(t)?t.forEach(function(x){o.add(M0(x,e,n,x,t,s))}):qY(t)&&t.forEach(function(x,y){o.set(y,M0(x,e,n,y,t,s))});var g=u?l?pz:yS:l?WM:HM,v=d?void 0:g(t);return S7(v||t,function(x,y){v&&(y=x,x=t[y]),BM(o,y,M0(x,e,n,y,t,s))}),o}var yz=M0,EZ=1,AZ=4;function TZ(t){return yz(t,EZ|AZ)}var vy=TZ,CZ="__lodash_hash_undefined__";function PZ(t){return this.__data__.set(t,CZ),this}var LZ=PZ;function IZ(t){return this.__data__.has(t)}var DZ=IZ;function _v(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new my;++e<n;)this.add(t[e])}_v.prototype.add=_v.prototype.push=LZ;_v.prototype.has=DZ;var RZ=_v;function OZ(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var zZ=OZ;function NZ(t,e){return t.has(e)}var kZ=NZ,BZ=1,UZ=2;function FZ(t,e,n,i,r,s){var o=n&BZ,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var u=s.get(t),d=s.get(e);if(u&&d)return u==e&&d==t;var c=-1,h=!0,m=n&UZ?new RZ:void 0;for(s.set(t,e),s.set(e,t);++c<a;){var g=t[c],v=e[c];if(i)var x=o?i(v,g,c,e,t,s):i(g,v,c,t,e,s);if(x!==void 0){if(x)continue;h=!1;break}if(m){if(!zZ(e,function(y,_){if(!kZ(m,_)&&(g===y||r(g,y,n,i,s)))return m.push(_)})){h=!1;break}}else if(!(g===v||r(g,v,n,i,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var xz=FZ;function VZ(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var GZ=VZ;function HZ(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var WZ=HZ,jZ=1,$Z=2,qZ="[object Boolean]",XZ="[object Date]",YZ="[object Error]",ZZ="[object Map]",JZ="[object Number]",KZ="[object RegExp]",QZ="[object Set]",eJ="[object String]",tJ="[object Symbol]",nJ="[object ArrayBuffer]",iJ="[object DataView]",OC=hs?hs.prototype:void 0,jx=OC?OC.valueOf:void 0;function rJ(t,e,n,i,r,s,o){switch(n){case iJ:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case nJ:return!(t.byteLength!=e.byteLength||!s(new xv(t),new xv(e)));case qZ:case XZ:case JZ:return kM(+t,+e);case YZ:return t.name==e.name&&t.message==e.message;case KZ:case eJ:return t==e+"";case ZZ:var a=GZ;case QZ:var l=i&jZ;if(a||(a=WZ),t.size!=e.size&&!l)return!1;var u=o.get(t);if(u)return u==e;i|=$Z,o.set(t,e);var d=xz(a(t),a(e),i,r,s,o);return o.delete(t),d;case tJ:if(jx)return jx.call(t)==jx.call(e)}return!1}var sJ=rJ,oJ=1,aJ=Object.prototype,lJ=aJ.hasOwnProperty;function uJ(t,e,n,i,r,s){var o=n&oJ,a=yS(t),l=a.length,u=yS(e),d=u.length;if(l!=d&&!o)return!1;for(var c=l;c--;){var h=a[c];if(!(o?h in e:lJ.call(e,h)))return!1}var m=s.get(t),g=s.get(e);if(m&&g)return m==e&&g==t;var v=!0;s.set(t,e),s.set(e,t);for(var x=o;++c<l;){h=a[c];var y=t[h],_=e[h];if(i)var S=o?i(_,y,h,e,t,s):i(y,_,h,t,e,s);if(!(S===void 0?y===_||r(y,_,n,i,s):S)){v=!1;break}x||(x=h=="constructor")}if(v&&!x){var b=t.constructor,T=e.constructor;b!=T&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof T=="function"&&T instanceof T)&&(v=!1)}return s.delete(t),s.delete(e),v}var cJ=uJ,hJ=1,zC="[object Arguments]",NC="[object Array]",kg="[object Object]",dJ=Object.prototype,kC=dJ.hasOwnProperty;function fJ(t,e,n,i,r,s){var o=Ns(t),a=Ns(e),l=o?NC:hp(t),u=a?NC:hp(e);l=l==zC?kg:l,u=u==zC?kg:u;var d=l==kg,c=u==kg,h=l==u;if(h&&yv(t)){if(!yv(e))return!1;o=!0,d=!1}if(h&&!d)return s||(s=new b0),o||iz(t)?xz(t,e,n,i,r,s):sJ(t,e,l,n,i,r,s);if(!(n&hJ)){var m=d&&kC.call(t,"__wrapped__"),g=c&&kC.call(e,"__wrapped__");if(m||g){var v=m?t.value():t,x=g?e.value():e;return s||(s=new b0),r(v,x,n,i,s)}}return h?(s||(s=new b0),cJ(t,e,n,i,r,s)):!1}var pJ=fJ;function _z(t,e,n,i,r){return t===e?!0:t==null||e==null||!sa(t)&&!sa(e)?t!==t&&e!==e:pJ(t,e,n,i,_z,r)}var mJ=_z;function gJ(t,e){return t!=null&&e in Object(t)}var vJ=gJ;function yJ(t,e,n){e=Gh(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=gy(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&UM(r)&&NM(o,r)&&(Ns(t)||VM(t)))}var xJ=yJ;function _J(t,e){return t!=null&&xJ(t,e,vJ)}var wJ=_J;function SJ(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var bJ=SJ;function MJ(t,e){return e.length<2?t:oz(t,gX(e,0,-1))}var EJ=MJ;function AJ(t,e){return mJ(t,e)}var wz=AJ;function TJ(t,e){return e=Gh(e,t),t=EJ(t,e),t==null||delete t[gy(bJ(e))]}var CJ=TJ;function PJ(t){return pX(t)?void 0:t}var LJ=PJ,IJ=1,DJ=2,RJ=4,OJ=lz(function(t,e){var n={};if(t==null)return n;var i=!1;e=YO(e,function(s){return s=Gh(s,t),i||(i=s.length>1),s}),Dp(t,pz(t),n),i&&(n=yz(n,IJ|DJ|RJ,LJ));for(var r=e.length;r--;)CJ(n,e[r]);return n}),SS=OJ;function zJ(t,e,n,i){if(!Eu(t))return t;e=Gh(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=gy(e[r]),u=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var d=a[l];u=i?i(d,l,a):void 0,u===void 0&&(u=Eu(d)?d:NM(e[r+1])?[]:{})}BM(a,l,u),a=a[l]}return t}var NJ=zJ;function kJ(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var o=e[i],a=oz(t,o);n(a,o)&&NJ(s,Gh(o,t),a)}return s}var BJ=kJ;function UJ(t,e){return BJ(t,e,function(n,i){return wJ(t,i)})}var FJ=UJ,VJ=lz(function(t,e){return t==null?{}:FJ(t,e)}),wv=VJ;function BC(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let n=e.colorA,i=e.colorB,r=[[n.r,n.g,n.b,n.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...wv(Ci(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let n={...Ci(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,n)}})}function E0(t,e){Object.values(t.shared.materials).forEach(n=>e(n))}function A0(t,e){t.scene.objects.traverse((n,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&e(r)}):"material"in i&&typeof i.material!="string"&&e(i.material)})}function GJ(t){Object.assign(t.scene.publish,{orbitControls:{...mv.defaultData,...Ci(t.scene.publish.orbitControls)}})}function HJ(t){Object.assign(t.scene.publish.settings,{video:{...mS.defaultData.settings.video,...Ci(t.scene.publish.settings.video)}})}function WJ(t){function e(n){if(n.layers){for(let i of Object.values(n.layers))if(i){for(let[r,s]of Object.entries(i))if((rj.includes(r)||typeof s=="boolean")&&delete i[r],r==="texture")for(let[o,a]of Object.entries(s))(sj.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((n,i)=>{i.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function jJ(t){t.scene.publish.withBackground=!0}function $J(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function qJ(t){t.scene.objects.traverse((e,n)=>{let i=n.cloner;i&&(i.radial.scale=i.radial.scale.map(r=>r+1),i.linear.scale=i.linear.scale.map(r=>r+1))})}function XJ(t){t.scene.objects.traverse((e,n)=>{let i=n.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function YJ(t){t.scene.objects.traverse((e,n)=>{let i=t.scene.objects.unproxy().parent(e);if(i){let r=Ci(t.scene.objects.data(i));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&n.type==="Mesh"&&(n.visible=Ci(n).booleanExclude!==!0)}})}function ZJ(t){t.scene.objects.traverse((e,n)=>{if(n.type==="Mesh"){let i=n;n.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function JJ(t){function e(i){Object.setPrototypeOf(i,pi.prototype),i.texture&&Object.setPrototypeOf(i.texture,pi.prototype)}function n(i){Object.setPrototypeOf(i,pi.prototype);for(let r in i)e(i[r])}t.scene.objects.traverse((i,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=Ci(o.material).layers;n(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],u=Ci(l).layers;n(u),l.layers=u}})})}function UC(t){t.layers===void 0&&Object.assign(t,fo.defaultTwoLayerData("lambert"))}function $x(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let n=[...e.colors];n.push(e.colors[9]);let i=[...e.steps];i.push(e.steps[9]);let r={...Ci(e),colors:n,steps:i};Object.assign(e,r)}})}function KJ(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&(n.geometry.type==="BooleanGeometry"||n.geometry.type==="SubdivGeometry")&&(n.geometry.phongAngle=35)})}function FC(t){t.scene.objects.traverse((e,n)=>{"materials"in n?n.materials.forEach(i=>{typeof i!="string"&&$x(i)}):"material"in n&&typeof n.material!="string"&&$x(n.material)}),Object.values(t.shared.materials).forEach(e=>$x(e))}function QJ(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,n)=>{(n.type==="DirectionalLight"||n.type==="SpotLight")&&(n.shadowResolution=1024,n.shadowRadius=1,n.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function eK(t){t.shared.audios=Mh({},Hn.prototype)}function tK(t){t.shared.videos=Mh({},Hn.prototype)}function nK(t){let e=t.shared.materials;Object.entries(e).forEach(([n,i])=>{if(!i.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[n]:r})}})}function iK(t){Object.entries(Ci(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(Ci(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function rK(t){t.scene.publish.settings.web.preload=!1}function VC(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function sK(t){t.shared.fonts=Mh({},Hn.prototype)}function oK(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function aK(t){let e=[];t.scene.objects.traverse((n,i)=>{let r=i;if(r.type==="TextFrame"){let s=fo.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=oK(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,...ss.defaultData,...eh.defaultData,flatShading:!1,wireframe:!1,geometry:{...Qc.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Ci(r.states),events:Ci(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},u=Ci(t.scene.objects).parent(n);t.scene.objects.insertAfter(u??null,n,[{id:n+"new",data:l,children:[]}]),e.push(n)}}),e.forEach(n=>{t.scene.objects.delete(n)})}function lK(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((n,i)=>{i.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new tn,move:new tn,jump:new tn}});else{let s=new tn;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:Sn.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let u={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},d={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(d,wv(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(d,{control1:{...o.control1},control2:{...o.control2}});let c={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},h={state:o.state,...c,...d},m={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new tn({fi:0,id:Sn.generateUUID(),data:u},{fi:1,id:Sn.generateUUID(),data:h})};s.push({fi:l,id:a,data:m})}),delete r.targets)}})})}function uK(t){t.scene.objects.traverse((e,n)=>{function i(r,s){var l;let o=new tn,a=[];if(n.events.forEach((u,d,c)=>{if(u.type==="Audio"&&u.trigger===s){let h;a.push(d),u.interaction==="play"?h={...wv(u,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in u?u.after:void 0,toggle:"after"in u?u.toggle:void 0,type:"Audio"}:(u.interaction==="pause"||u.interaction==="stop")&&(h={...wv(u,"interaction","delay","object","playAudio"),type:"Audio"}),h&&o.push({fi:c,id:d,data:h})}}),a.forEach(u=>n.events.delete(u)),o.length){let u=(l=n.events.find(d=>d.type===r))==null?void 0:l.data;u?"actions"in u&&u.actions.insertBefore(null,o):n.events.insertBefore(null,[{id:Sn.generateUUID(),data:{type:r,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function GC(t){var n;let e=(n=t.layers.find(i=>i.type==="light"))==null?void 0:n.data;if((e==null?void 0:e.category)==="basic"){let i=Jr.defaultData("light","phong"),r=e;Object.assign(r,i),r.visible=!1}}function HC(t){E0(t,GC),A0(t,GC)}function cK(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(n.geometry.scaleBaked||(n.geometry.scaleBaked=[1,1,1]))})}function hK(t){t.scene.objects.traverse((e,n)=>{(n.type==="Empty"||n.type==="Mesh")&&n.cloner&&!n.cloner.randomnessObject&&!n.cloner.toObject&&!n.cloner.randomness&&(n.cloner={...n.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function dK(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="NonParametricGeometry"&&!("material"in n)&&!("materials"in n)&&(n.material=fo.defaultTwoLayerData("phong"))})}function fK(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,n)=>{(n.type==="OrthographicCamera"||n.type==="PerspectiveCamera")&&(n.orthographic.autoZoom===void 0&&(n.orthographic.autoZoom=!1),n.orthographic.autoZoomFrustumSize===void 0&&(n.orthographic.autoZoomFrustumSize=790))})}function pK(t){t.scene.objects.traverse((e,n)=>{n.pathSnapping===void 0&&(n.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),n.pathSnapping.offset===void 0&&(n.pathSnapping.offset=0)})}function mK(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function gK(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function vK(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-n.position[1]))})})}var WC=36;function yK(t){let e=t.schema??0;e!==WC&&(console.warn("updating from ",e,"to ",WC),e<1&&(A0(t,BC),E0(t,BC),t.schema=1),e<2&&(GJ(t),t.schema=2),e<3&&(WJ(t),t.schema=3),e<4&&(jJ(t),t.schema=4),e<5&&($J(t),t.schema=5),e<6&&(qJ(t),t.schema=6),e<7&&(XJ(t),t.schema=7),e<8&&(t.schema=8),e<9&&(FC(t),t.schema=9),e<10&&(KJ(t),t.schema=10),e<11&&(QJ(t),t.schema=11),e<12&&(FC(t),t.schema=12),e<13&&(eK(t),t.schema=13),e<14&&(nK(t),t.schema=14),e<15&&(iK(t),t.schema=15),e<16&&(rK(t),t.schema=16),e<17&&(A0(t,VC),E0(t,VC),t.schema=17),e<18&&(A0(t,UC),E0(t,UC),t.schema=18),e<19&&(HJ(t),t.schema=19),e<20&&(sK(t),aK(t),t.schema=20),e<21&&(lK(t),uK(t),t.schema=21),e<22&&(HC(t),t.schema=22),e<23&&(cK(t),t.schema=23),e<24&&(hK(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(tK(t),e<25&&(t.schema=25)),e<26&&(YJ(t),t.schema=26),e<27&&(ZJ(t),t.schema=27),e<28&&(HC(t),t.schema=28),e<29&&(JJ(t),t.schema=29),e<30&&(dK(t),t.schema=30),e<31&&(fK(t),t.schema=31),e<33&&(pK(t),t.schema=33),e<34&&(mK(t),t.schema=34),e<35&&(gK(t),t.schema=35),e<36&&(vK(t),t.schema=36))}var Nd=oy(M9()),xK=.5*(Math.sqrt(3)-1),kd=(3-Math.sqrt(3))/6,_K=1/3,Js=1/6,xf=t=>Math.floor(t)|0,jC=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),qx=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function Xx(t=Math.random){let e=Sz(t),n=new Float64Array(e).map(r=>jC[r%12*2]),i=new Float64Array(e).map(r=>jC[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,u=(r+s)*xK,d=xf(r+u),c=xf(s+u),h=(d+c)*kd,m=d-h,g=c-h,v=r-m,x=s-g,y,_;v>x?(y=1,_=0):(y=0,_=1);let S=v-y+kd,b=x-_+kd,T=v-1+2*kd,E=x-1+2*kd,L=d&255,A=c&255,I=.5-v*v-x*x;if(I>=0){let k=L+e[A],F=n[k],G=i[k];I*=I,o=I*I*(F*v+G*x)}let P=.5-S*S-b*b;if(P>=0){let k=L+y+e[A+_],F=n[k],G=i[k];P*=P,a=P*P*(F*S+G*b)}let O=.5-T*T-E*E;if(O>=0){let k=L+1+e[A+1],F=n[k],G=i[k];O*=O,l=O*O*(F*T+G*E)}return 70*(o+a+l)}}function wK(t=Math.random){let e=Sz(t),n=new Float64Array(e).map(s=>qx[s%12*3]),i=new Float64Array(e).map(s=>qx[s%12*3+1]),r=new Float64Array(e).map(s=>qx[s%12*3+2]);return function(s,o,a){let l,u,d,c,h=(s+o+a)*_K,m=xf(s+h),g=xf(o+h),v=xf(a+h),x=(m+g+v)*Js,y=m-x,_=g-x,S=v-x,b=s-y,T=o-_,E=a-S,L,A,I,P,O,k;b>=T?T>=E?(L=1,A=0,I=0,P=1,O=1,k=0):b>=E?(L=1,A=0,I=0,P=1,O=0,k=1):(L=0,A=0,I=1,P=1,O=0,k=1):T<E?(L=0,A=0,I=1,P=0,O=1,k=1):b<E?(L=0,A=1,I=0,P=0,O=1,k=1):(L=0,A=1,I=0,P=1,O=1,k=0);let F=b-L+Js,G=T-A+Js,Z=E-I+Js,ne=b-P+2*Js,J=T-O+2*Js,z=E-k+2*Js,V=b-1+3*Js,U=T-1+3*Js,X=E-1+3*Js,N=m&255,q=g&255,Y=v&255,ee=.6-b*b-T*T-E*E;if(ee<0)l=0;else{let ae=N+e[q+e[Y]];ee*=ee,l=ee*ee*(n[ae]*b+i[ae]*T+r[ae]*E)}let W=.6-F*F-G*G-Z*Z;if(W<0)u=0;else{let ae=N+L+e[q+A+e[Y+I]];W*=W,u=W*W*(n[ae]*F+i[ae]*G+r[ae]*Z)}let se=.6-ne*ne-J*J-z*z;if(se<0)d=0;else{let ae=N+P+e[q+O+e[Y+k]];se*=se,d=se*se*(n[ae]*ne+i[ae]*J+r[ae]*z)}let le=.6-V*V-U*U-X*X;if(le<0)c=0;else{let ae=N+1+e[q+1+e[Y+1]];le*=le,c=le*le*(n[ae]*V+i[ae]*U+r[ae]*X)}return 32*(l+u+d+c)}}function Sz(t){let e=new Uint8Array(512);for(let n=0;n<512/2;n++)e[n]=n;for(let n=0;n<512/2-1;n++){let i=n+~~(t()*(256-n)),r=e[n];e[n]=e[i],e[i]=r}for(let n=256;n<512;n++)e[n]=e[n-256];return e}var _s=new Ui,SK=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let i=0;i<t.count;i+=3){let r=1;_s.a.fromBufferAttribute(t,i),_s.b.fromBufferAttribute(t,i+1),_s.c.fromBufferAttribute(t,i+2),r*=_s.getArea(),e[i/3]=r}this.distribution=new Float32Array(t.count/3);let n=0;for(let i=0;i<e.length;i++)n+=e[i],this.distribution[i]=n;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,n=0,i=e.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?i=s-1:n=s+1}return r}sampleFace(t,e,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),_s.a.fromBufferAttribute(this.positionAttribute,t*3),_s.b.fromBufferAttribute(this.positionAttribute,t*3+1),_s.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(_s.a,i).addScaledVector(_s.b,r).addScaledVector(_s.c,1-(i+r)),_s.getNormal(n),this}},bK=oy(E9()),MK=new Fe,EK=new Fe,AK=new Fe,Sv;(t=>{function e(n){return n&&n.__isSPEObject}t.is=e})(Sv||(Sv={}));var ZM=t=>class extends t{constructor(){super(...arguments),this.hiddenMatrix=new Fe,this.matrixWorldRigid=new Fe,this.shearScale=new Fe,this.shearScaleInv=new Fe}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof Pt&&(e=e.uuid);let n=this;for(;n.parent;){if(n.parent.uuid===e)return!0;n=n.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let n of this.children)n.updateMatrixWorld(e)}updateWorldMatrix(e,n){let i=this.parent;if(e&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),n)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseObject(e,n=0){if(e(this,n)!==!0)for(let i of this.children)Sv.is(i)&&i.traverseObject(e,n+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,n=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:i,v:r,q:s}=(0,bK.SVD)(n),o=MK.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=EK.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=AK.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(u=>Math.abs(s[0]-u)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,n){this.updateWorldMatrix(!0,!1);let i=new Fe().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof Fe?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),n!==void 0&&(this.children.pop(),this.children.splice(n,0,e)),this}},TK=class extends ZM(Pt){},CK=t=>t.type==="Mesh",Jd=class extends TK{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let n=this.children[t];(n==null?void 0:n.object)!==e&&(n&&this.remove(n),n=new Jd(e),this.add(n),n.matrixAutoUpdate=!1,n.matrix=e.matrix,n.hiddenMatrix=e.hiddenMatrix),n.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return CK(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Hl=new R,Wl=new R,th=new Fe,bz=[new R(-1,1,1),new R(-1,-1,1),new R(1,-1,1),new R(1,1,1),new R(-1,1,-1),new R(-1,-1,-1),new R(1,-1,-1),new R(1,1,-1)],PK=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],LK=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],$C=(t,e,n)=>{t.updateEntityBoxSize(Hl,Wl),th.copy(e).multiply(t.matrixWorld),Wl.x===0&&Wl.y===0&&Wl.z===0?n.push(new R(Hl.x,Hl.y,Hl.z).applyMatrix4(th)):bz.forEach(i=>{n.push(i.clone().multiply(Wl).add(Hl).applyMatrix4(th))})},qC=class extends ar{constructor(){super(...arguments),this.matrix=new Fe,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let n=new Fe().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,n,e)}expandByObjectSize(t,e,n=!1){let i=[];return n===!0?t.traverseEntity(r=>{(r.visible||r.cloner&&r.data.visible)&&$C(r,e,i)}):$C(t,e,i),this.setFromPoints(i)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(th.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(Wl).multiplyScalar(.5),this.getCenter(Hl),th.copy(this.matrix).setPosition(Hl),this.vertices=bz.map(t=>t.clone().multiply(Wl).applyMatrix4(th))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=PK.map(([t,e])=>new qR(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new R))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=LK.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},Ua={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},IK=class extends nM{constructor(){super()}getPoints(t=12){let e=[],n,i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?i[s]:i[s]-i[s-1],u=Math.ceil(t*l/r),d=a.getPoints(u);for(let c=0;c<d.length;c++){let h=d[c];n&&n.equals(h)||(e.push(h),n=h)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},bS=.001;function MS(t,e,n){return e.clone().sub(t).cross(e.clone().sub(n)).length()<=bS}function Yx(t,e){let n=new R(...t.position),i=new R(...t.controlNext.position),r=new R(...e.controlPrevious.position),s=new R(...e.position);return MS(n,i,s)&&MS(n,r,s)}function Mz(t){let e=t.points.map(d=>new R(...d.data.position)),n=[t.points[0]],i=new R(...n[0].data.position);for(let d=0;d<t.points.length-1;d++)MS(i,e[d],e[d+1])||(n.push(t.points[d]),i=e[d]);n.push(t.points[t.points.length-1]);let r=t.isClosed,s=n.length-(r?0:1),o=n.length,a=[];for(let d=0;d<o;d++){let c=n[d].data,h=new R(...c.position),m=new R(...c.controlPrevious.position),g=new R(...c.controlNext.position),v={position:h,baseRoundness:c.roundness,controlPrevious:m,controlNext:g};if(c.roundness===0||!t.isClosed&&(d===0||d===o-1)){a[d]={...v,removedLength:0};continue}let x=r&&d==0?o-1:d-1,y=r&&d==o-1?0:d+1,_=n[x].data,S=n[y].data,b=new R(..._.position),T=new R(...S.position),E=b.clone().sub(h).normalize(),L=T.clone().sub(h).normalize();Object.assign(v,{prevDir:E,nextDir:L});let A=Yx(_,c),I=Yx(c,S);if(!A||!I)a[d]={...v,removedLength:0};else{let P=E.clone().add(L).normalize(),O=P.clone().cross(E).length()/E.dot(P);a[d]={...v,tan:O,removedLength:c.roundness/O}}}for(let d=0;d<s;d++){let c=d,h=r&&d===o-1?0:d+1,m=a[c],g=a[h];if(m.removedLength!==0||g.removedLength!==0){let v=m.position.distanceTo(g.position);m.removedLength=Math.min(m.removedLength,v/2),g.removedLength=Math.min(g.removedLength,v/2)}}let l=[];for(let d=0;d<s;d++){let c=d,h=r&&d===o-1?0:d+1,m=a[c],g=a[h],v=null;if(!Yx(n[c].data,n[h].data))m.position.distanceTo(g.position)>bS&&(v=new gf(m.position,m.controlNext,g.controlPrevious,g.position));else{let x=m.position.clone(),y=g.position.clone();(m.removedLength!==0||g.removedLength!==0)&&(m.nextDir&&x.add(m.nextDir.clone().setLength(m.removedLength)),g.prevDir&&y.add(g.prevDir.clone().setLength(g.removedLength))),x.distanceTo(y)>bS&&(v=new gf(x,x.clone().lerp(y,.3),y.clone().lerp(x,.3),y))}l[2*d+1]=v}for(let d=0;d<o;d++){let c=a[d];if(c.removedLength===0){l[2*d]=null;continue}let h=c.position,m=c.prevDir.clone().multiplyScalar(c.removedLength).add(h),g=c.nextDir.clone().multiplyScalar(c.removedLength).add(h),v=c.tan*c.removedLength,x=c.prevDir.clone().add(c.nextDir).normalize(),y=m.clone().lerp(g,.5),_=m.distanceTo(g)/2,S=x.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(_,2))).add(y),b=x.clone().multiplyScalar(-v).add(S),T=h.distanceTo(b)/h.distanceTo(y),E=c.prevDir.clone().multiplyScalar(T*h.distanceTo(m)).add(h),L=E.clone().lerp(b,2),A=m.clone().lerp(E,4/3),I=g.clone().lerp(L,4/3);l[2*d]=new gf(m,A,I,g)}let u=new IK;return l.forEach(d=>{d&&u.add(d)}),u}var hn;(t=>{function e(n){return n&&n.__isEntity}t.is=e})(hn||(hn={}));var Bd=t=>hn.is(t),Ez=t=>class extends ZM(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new qC,this._recursiveBBox=new qC,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let n=this.children[e];if(hn.is(n))return n}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let n=e.parent;if(hn.is(n))e=n;else return}return e}forInstancesRec(e){this.instances.forEach(n=>{n.disposed||e(n),n.forInstancesRec(e)})}super_Entity(e,n){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=n,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,n,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)Gc.toOps(this.data,r.data).forEach(s=>{let o=Qw.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,n)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=Gc.patch(this.data,r),Gc.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,n)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,n){e.setScalar(0),n.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{Bd(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let n;return this.traverseEntity(i=>{i.uuid===e&&(n=i)}),n}traverseSortNextHelper(){let e=this.parent;if(e){let n=e.children,i=n.indexOf(this)+1;if(hn.is(n[i]))return n[i];if(hn.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&hn.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let n=this;for(;e>0&&n!==null;)n=n.parent,e-=1;return n}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let n=this.parent;for(;n;){if(e===n)return!0;n=n.parent}return!1}countToAccestor(e){let n=0,i=this;for(;i!==e;){if(i===null)return-1;i=i.parent,n+=1}return n}forEachEntity(e){for(let n of this.children)Bd(n)&&e(n)}traverseEntityAncestors(e){this.traverseAncestors(n=>{hn.is(n)&&e(n)})}traverseEntity(e,n=0){if(e(this,n)!==!0)for(let i of this.children)Bd(i)&&i.traverseEntity(e,n+1)}traverseVisibleEntity(e){e(this);for(let n of this.children)Bd(n)&&n.visible&&n.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(e,n=!0){return super.copy(e,!1),this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>Bd(e))}isAncestorOf(e){if(this.uuid===e)return!1;let n=!1;return this.traverseEntity(i=>{i.uuid===e&&(n=!0)}),n}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let n={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return SS(n,e)}updateTransformState(e){let n=!1;return e.position&&(this.position.fromArray(e.position),n=!0),e.rotation&&(this.rotation.fromArray(e.rotation),n=!0),e.scale&&(n=!0,this.scale.fromArray(e.scale)),e.hiddenMatrix!==void 0&&(n=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??wh.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),n}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)hn.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{hn.is(e)&&e.disposeRecursively()})}toState(e=[]){let n={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return SS(n,e)}updateByOp(e,n,i,r){let s=this.data;this.data=n;let o=e,a=La(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let u={...e.props};if(Object.values(e.props).some(d=>d===void 0)){let d=this.data;if(d!==void 0){let c=ho.zoom(d,e.path.slice(2));if(c)for(let h in e.props)e.props[h]===void 0&&h in c&&(u[h]=c[h])}}o={...e,props:u,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:d,...c}=l;l=c}if(e.props.material!==void 0&&"material"in l){let{material:d,...c}=l;l=c}let u=ho.removeOverridden(e.path,e.props,l);o={...e,props:u}}}if(this.updateByPatchedOpBase(o,Gc.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),La(e.path,["overrides"])){let l=[],u=[...e.path];for(l.push(u[1]),u.splice(0,2);u.length>0&&u[0]==="descendants";)l.push(u[1]),u.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let d of Object.keys(e.props)){l[l.length-1]=d;let c=i.scene.findInstance([this.uuid,...l]);c&&(c.overrideData=e.props[d],c.updateState(cu.apply(c.component.data,c.overrideData),i))}}else{let d=i.scene.findInstance([this.uuid,...l]);if(d){let c=ho.zoom(d.component.data,u);if(e={...e,path:u},e.type===0){let h=e.props;if(c)for(let[m,g]of Object.entries(e.props))g===void 0&&(h===e.props&&(h={...e.props}),h[m]=c[m]);e={...e,props:h}}d.overrideData=pv.resolve(n.overrides,l),d.updateByOp(e,vr.applySimple(d.data,e),i,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let u;for(let d of bh.rootOverrideProps)d in e.props&&(u===void 0&&(u={}),u[d]=e.props[d]);u&&(l={...e,props:u})}else for(let u of bh.rootOverrideProps)if(La(e.path,[u])){l=e;break}l!==void 0&&this.instances.forEach(u=>{if(u.isInstanceRoot){let d=cu.filterOp(u.overrideData,l);d&&u.updateByOp(d,vr.applySimple(u.data,d),i,!0)}}),this.instances.forEach(u=>{if(!u.isInstanceRoot){let d=cu.filterOp(u.overrideData,e);if(d){let c;s===u.data&&e===d?c=n:c=vr.applySimple(u.data,d),u.updateByOp(d,c,i,!0)}}})}}updateByPatchedOpBase(e,n,i){if(this.dataPatched=n,e.path.length===0&&e.type===0)e.props.type!==void 0&&!Mu.is(e.props.type)&&Ua.changeEntityProptotype(this,n,i);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){Ua.changeEntityProptotype(this,n,i);for(let r of this.children)hn.is(r)&&r.updateVisible()}this.updateByPatchedOp(e,n,i)}updateByPatchedOp(e,n,i){if(e.path.length===0&&e.type===0&&this.updateState(e.props,i),La(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(n.pathSnapping),La(e.path,["cloner"])!==null){let r=vr.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(n.cloner,i.scene):(this.setFromClonerState(n.cloner,i),this.expandCloner(i.scene)),this.updateVisible()}}updatePathSnapping(e){this._updatedPathSnapping=e}applyPathSnapping(e){var c;let n=this._updatedPathSnapping||this.dataPatched.pathSnapping;if(n.pathId===null)return;let i=e.find(n.pathId);if(!i)return;let r=i.data,s=Mz(r.geometry.path),o=(n.slide+n.offset)%1,a=s.getPointAt(o),l=this.parent?(c=this.parent)==null?void 0:c.matrixWorld:new Fe;i.updateMatrixWorld();let u=new Fe().multiplyMatrices(l.clone().invert(),i.matrixWorld);a.applyMatrix4(u);let d={position:a.toArray(),rotation:r.rotation};if(n.orientation==="tangential"){let h=new Fe().extractRotation(i.matrixWorld),m=s.getTangentAt(o).applyMatrix4(h).add(a),g=new Fe().lookAt(a,m,new R(0,1,0)),v=new qo().setFromRotationMatrix(g);d={...d,rotation:[v.x,v.y,v.z]}}this.updateTransformState(d)}updateVisible(){var e;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((e=this.dataPatched.cloner)==null?void 0:e.hideBase)!==!0)}updateState_Entity(e,n){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,n),this.updateVisible()),this.updateTransformState(e)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof Ua.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,n){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):(this.cloner===void 0&&(this.cloner=new Ua.Cloner(this,e),n.scene.addPendingExpandCloner(this)),this.cloner.updateState(e,n.scene)))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},DK=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:0,cornerSegments:8,hollow:0},t.parameters),i=n.width/2,r=n.radiusTop??i,s=n.radiusBottom??i;return r===s?(r=i,s=i):r>s?(r=i,s=s*i/r):(r=r*i/s,s=i),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:u,radiusBottom:d,cornerRadius:c,cornerSegments:h,hollow:m}=t.parameters,g;return c||m?g=new Az(u,d,i,r,s,o,a,l*Math.PI/180,c,c,h,m):g=new fl(u,d,i,r,s,o,a,l*Math.PI/180),g.scale(1,1,n/e),Object.assign(g,{userData:{...t,type:"CylinderGeometry"}})}};function ba(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function XC(t){return new te(t.y,-t.x)}var Az=class extends Ze{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,u=0);let m=[],g=[],v=[],x=[],y=0,_=n/2,S=new R,b=new R;h&&t==0&&(t=l),h&&e==0&&(e=u);let T=new te(t,_),E=new te(e,-_),L=null,A=null,I=null,P=null,O=T.clone().sub(E),k=0,F=0,G=0;c>0&&(k=Math.min(t,e)*(1-c),F=t-k,G=e-k);let Z=T.clone();Z.x-=k;let ne=Math.PI-O.angle(),J=O.angle(),z=Math.tan(J/2),V=Math.tan(ne/2),U=z+V,X=c?U:V,N=c?U:z;if(l=Math.min(l,(t-F)/X,O.length()/U),u=Math.min(u,(e-G)/N,O.length()/U),l>0){let le=l/z;L=T.clone().sub(new te(le,l)),c&&(I=L.clone(),I.x-=k-U*l),T.sub(O.clone().setLength(le))}if(u>0){let le=u/V;A=E.clone().sub(new te(le,-u)),E.add(O.clone().setLength(le)),c&&(P=A.clone(),P.x-=k-U*u,Z.sub(O.clone().setLength(le)))}O=T.clone().sub(E);let q=O.length()<.5,Y=[];for(let le=0;le<=i;le++){let ae=[],ue=le/i,fe=ue*a+o,K=new te(Math.sin(fe),Math.cos(fe));P&&A?(ee(ae,ue,K,ne,u,P,-1,!0),ee(ae,ue,K,J,u,A,-1,!1)):A?(W(ae,K,A.x,0,-1),ee(ae,ue,K,J,u,A,-1,!1)):s||W(ae,K,e,G,-1);let Q=XC(O).normalize();if(ba(Q,K,S),!q)for(let he=0;he<=r;he++){let ye=he/r,be=O.clone().multiplyScalar(ye).add(E);ba(be,K,b),g.push(b.x,b.y,b.z),v.push(S.x,S.y,S.z),x.push(ue,.5+b.y/n),ae.push(y++)}if(I&&L?(ee(ae,ue,K,ne,l,L,1,!1),ee(ae,ue,K,J,l,I,1,!0)):L?(ee(ae,ue,K,ne,l,L,1,!1),W(ae,K,L.x,0,1)):s||W(ae,K,t,F,1),c&&!q){let he=XC(O).multiplyScalar(-1).normalize();ba(he,K,S);for(let ye=0;ye<=r;ye++){let be=ye/r,Te=O.clone().multiplyScalar(-be).add(Z);ba(Te,K,b),g.push(b.x,b.y,b.z),v.push(S.x,S.y,S.z),x.push(ue,.5+b.y/n),ae.push(y++)}}c&&!s&&ae.push(ae[0]),Y.push(ae)}for(let le=0;le<Y.length-1;le++)for(let ae=0;ae<Y[0].length-1;ae++){if(s&&c&&ae==r)continue;let ue=Y[le][ae],fe=Y[le+1][ae],K=Y[le+1][ae+1],Q=Y[le][ae+1],he=g[K*3+0],ye=g[K*3+2];m.push(ue,fe,Q),(he!=0||ye!=0)&&m.push(fe,K,Q)}a<Math.PI*2&&(se(-1,Y[0],o),se(1,Y[Y.length-1],o+a)),this.setIndex(m),this.setAttribute("position",new De(g,3)),this.setAttribute("normal",new De(v,3)),this.setAttribute("uv",new De(x,2));function ee(le,ae,ue,fe,K,Q,he,ye){for(let be=0;be<d+1;be++){let Te=be/d,Le=he<0?Te:1-Te;ye&&(Le-=1),Le*=fe;let ze=new te(Math.sin(Le),Math.cos(Le)*he),Ye=ze.clone().multiplyScalar(K).add(Q);ba(Ye,ue,b),g.push(b.x,b.y,b.z),ba(ze,ue,S),v.push(S.x,S.y,S.z),x.push(ae,.5+b.y/n),le.push(y++)}}function W(le,ae,ue,fe,K){let Q=new R,he=new te,ye=[ue,fe];K<0&&ye.reverse();for(let be of ye)he.set(be,_*K),ba(he,ae,Q),g.push(Q.x,Q.y,Q.z),v.push(0,K,0),x.push(.5,.5),le.push(y++)}function se(le,ae,ue){let fe=new te(Math.sin(ue),Math.cos(ue)),K=new te(-Math.cos(ue),Math.sin(ue)),Q=new R,he=le<0?(Te,Le,ze)=>m.push(Te,Le,ze):(Te,Le,ze)=>m.push(Te,ze,Le),ye=new te((t+e+F+G)/4,0);ba(ye,fe,Q),g.push(Q.x,Q.y,Q.z),v.push(K.x,0,K.y),x.push(.5,.5);let be=y++;for(let Te of ae){let Le=g.slice(Te*3,Te*3+3);g.push(...Le),v.push(K.x,0,K.y);let ze=x.slice(Te*2,Te*2+2);x.push(...ze),y++}for(let Te=be+1;Te<y-1;Te++)he(be,Te,Te+1);he(be,y-1,be+1)}}},RK=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:0,cornerRadiusBottom:0,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:u,cornerRadiusBottom:d,cornerSegments:c}=t.parameters,h;return u>0||d>0||l<360?h=new Az(0,e/2,i,r,s,o,a,l*Math.PI/180,u,d,c,0,!0):h=new Dh(e/2,i,r,s,o),h.scale(1,1,n/e),Object.assign(h,{userData:{...t,type:"ConeGeometry"}})}},OK=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:0,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,u;return a==0?u=new or(e,n,i,r,s,o):u=new zK(e,n,i,r,s,o,a,l),Object.assign(u,{userData:{...t,type:"CubeGeometry"}})}},Zx=Math.PI/2,zK=class extends Ze{constructor(t=1,e=1,n=1,i=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,n/2);let u=[],d=[],c=[],h=[],m=0,g=0;v("z","y","x",-1,-1,n,e,t,s,r,0),v("z","y","x",1,-1,n,e,-t,s,r,1),v("x","z","y",1,1,t,n,e,i,s,2),v("x","z","y",1,-1,t,n,-e,i,s,3),v("x","y","z",1,-1,t,e,n,i,r,4),v("x","y","z",-1,-1,t,e,-n,i,r,5),o>0&&(x("z","y","x",-1,-1,1,n,e,t,s,0),x("z","y","x",1,-1,-1,n,e,t,s,1),x("z","y","x",-1,1,-1,n,e,t,s,1),x("z","y","x",1,1,1,n,e,t,s,0),x("x","y","z",-1,-1,-1,t,e,n,i,0),x("x","y","z",1,-1,1,t,e,n,i,1),x("x","y","z",-1,1,1,t,e,n,i,0),x("x","y","z",1,1,-1,t,e,n,i,1),x("y","x","z",-1,-1,1,e,t,n,r,0),x("y","x","z",1,-1,-1,e,t,n,r,1),x("y","x","z",1,1,1,e,t,n,r,1),x("y","x","z",-1,1,-1,e,t,n,r,0),y(1,1,1),y(-1,1,1),y(1,-1,1),y(-1,-1,1),y(1,1,-1),y(-1,1,-1),y(1,-1,-1),y(-1,-1,-1)),this.setIndex(u),this.setAttribute("position",new De(d,3)),this.setAttribute("normal",new De(c,3)),this.setAttribute("uv",new De(h,2));function v(_,S,b,T,E,L,A,I,P,O,k){let F=(L-2*o)/P,G=(A-2*o)/O,Z=L/2-o,ne=A/2-o,J=I/2,z=P+1,V=O+1,U=0,X=0,N=new R;for(let q=0;q<V;q++){let Y=q*G-ne;for(let ee=0;ee<z;ee++){let W=ee*F-Z;N[_]=W*T,N[S]=Y*E,N[b]=J,d.push(N.x,N.y,N.z),N[_]=0,N[S]=0,N[b]=I>0?1:-1,c.push(N.x,N.y,N.z),h.push(ee/P),h.push(1-q/O),U+=1}}for(let q=0;q<O;q++)for(let Y=0;Y<P;Y++){let ee=m+Y+z*q,W=m+Y+z*(q+1),se=m+(Y+1)+z*(q+1),le=m+(Y+1)+z*q;u.push(ee,W,le),u.push(W,se,le),X+=6}l.addGroup(g,X,k),g+=X,m+=U}function x(_,S,b,T,E,L,A,I,P,O,k){let F=(A-2*o)/O,G=A/2-o,Z=I/2-o,ne=P/2,J=O+1,z=0,V=0,U=new R,X=new R;for(let N=0;N<a+1;N++){let q=N/a*Zx,Y=Math.sin(q)*o,ee=(1-Math.cos(q))*o,W=Math.sin(q),se=Math.cos(q);U[S]=(Z+Y)*E,U[b]=(ne-ee)*L,X[_]=0,X[S]=W*Math.sign(U[S]),X[b]=se*Math.sign(U[b]);for(let le=0;le<J;le++){let ae=le*F-G;U[_]=ae*T,d.push(U.x,U.y,U.z),c.push(X.x,X.y,X.z),h.push(le/O),h.push(0),z+=1}}for(let N=0;N<a;N++)for(let q=0;q<O;q++){let Y=m+q+J*N,ee=m+q+J*(N+1),W=m+(q+1)+J*(N+1),se=m+(q+1)+J*N;u.push(Y,ee,se),u.push(ee,W,se),V+=6}l.addGroup(g,V,k),g+=V,m+=z}function y(_,S,b){let T=new R,E=new R(t/2,e/2,n/2);E.subScalar(o);let L=[],A=_*S*b>0?(P,O,k)=>u.push(P,O,k):(P,O,k)=>u.push(P,k,O);for(let P=0;P<=a;P++){let O=[],k=Zx*(1-P/a),F=Math.cos(k),G=Math.sin(k),Z=0;for(let ne=0;ne<=P;ne++){let J=Math.cos(Z),z=Math.sin(Z);T.x=F*J,T.y=G,T.z=F*z;let V=E.clone().addScaledVector(T,o);d.push(_*V.x,S*V.y,b*V.z),c.push(_*T.x,S*T.y,b*T.z),h.push(0,0),O.push(m++),Z+=Zx/P}L.push(O)}let I=L.length-1;for(let P=0;P<I;P++){let O=L[P],k=L[P+1],F=O.length-1;A(O[0],k[1],k[0]);for(let G=1;G<=F;G++)A(O[G-1],O[G],k[G]),A(O[G],k[G+1],k[G])}}}},JM=class extends Ze{constructor(t=[],e=[],n="",i=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];u(),d(),this.setAttribute("position",new De(o,3)),this.setAttribute("normal",new De(l,3)),this.setAttribute("uv",new De(a,2));return;function u(){var J;r=Math.min(1-1e-5,r),r==0&&(s=0);let c={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],h=new R,m=h.clone(),g=new Ui,v=r*i,x=i-v,y=s+1,_=new R,S=(z,V)=>_.subVectors(z,V).normalize(),b=(z,V)=>Array(z).fill(void 0).map(V),T=b(t.length/3,(z,V)=>new R().fromArray(t,V*3).setLength(i)),E=[],L=1e6;for(let z=0;z<T.length;z++){let V=T[z],U=[],X,N,q,Y=1e10,ee=-1;for(;(ee=e.indexOf(z,ee+1))!=-1;){let ae=ee-ee%3;X=e[ae+(ee+1)%3],N=e[ae+(ee+2)%3],q=V.distanceToSquared(T[X]),Y=Math.min(Y,q),U.push([X,N,q])}Y+=1e-6;let W=[],se=0,le=U.length;for(let ae=0;ae<le;ae++){[X,N,q]=U[se];let ue=((J=E[X])==null?void 0:J.includes(z))==!0;q<=Y&&W.push(X+ +ue*L),se=U.findIndex(fe=>fe[0]==N)}E.push(W)}let A=[];{let z=0,V=0,U,X,N=c==3;for(let q=0;q<=s;q++){U=q*(q+1)/2,X=(q+1)*(q+2)/2;for(let Y=0;Y<s-q;Y++)[z,V]=[U+Y+q+2,X+Y+q+3],A.push(U,X,...N?[V,U]:[z,X],V,z),[U,X]=[z,V];A.push(U,X,U+s+2)}}let I=h.clone(),P=h.clone(),O=h.clone(),k=h.clone(),F=h.clone(),G=[],Z=b(T.length,()=>b(c,()=>h.clone()));for(let z=0;z<T.length;z++){h.copy(T[z]).normalize(),I.copy(h).multiplyScalar(x);let V=E[z];for(let W=0;W<V.length;W++){let se=V[W],le=V[(W+1)%c];g.setFromPointsAndIndices(T,z,se%L,le%L),g.b.sub(g.a).setLength(1e10).add(g.a),g.c.sub(g.a).setLength(1e10).add(g.a),g.closestPointToPoint(I,Z[z][W])}let U=[],X=[],N=[],q=new R;s==0&&[...Z[z]].reduce((W,se)=>W.add(se),q).multiplyScalar(1/c);for(let W=0;W<c;W++){let se=[],le=(W-1+c)%c,ae=Z[z][le],ue=Z[z][W];h.copy(ae).sub(I),m.copy(ue).sub(I);let fe=I.angleTo(h),K=h.angleTo(m),Q=Math.cos(fe)*v;s==0?P.copy(q):P.copy(I).setLength(x+Q),X.push(Q);let he=[P,ae,ue];for(let ye=0;ye<2;ye++){let be=he[ye],Te=he[ye+1];k.subVectors(be,I),F.subVectors(Te,I),O.crossVectors(k,F).normalize();for(let Le=0;Le<y;Le++){let ze=[fe,K][ye]*Le/y;h.copy(k).applyAxisAngle(O,ze).add(I),U.push(h.clone()),ye&&(S(h,I),se.push([Le==0?be:h.clone(),_.clone()]))}ye&&(S(Te,I),se.push([Te,_.clone()]))}N.push(se)}G.push(N);let Y=2*y,ee=2;for(let W=0;W<c;W++){let se=Y*W,le=Y*((W+1)%c),ae=[U[se]];for(let fe=1;fe<y;fe++){k=U[se+fe],F=U[le+fe],ae.push(k);for(let K=1,Q=fe-ee+1;K<=Q;K++)h.lerpVectors(k,F,K/(Q+1)),h.sub(I).setLength(X[W]).add(I),ae.push(h.clone());ae.push(F)}for(let fe=0;fe<y;fe++)ae.push(U[fe+y+se]);ae.push(U[le+y]);let ue=A.map(fe=>ae[fe]);o.push(...ue.map(fe=>[fe.x,fe.y,fe.z]).flat()),l.push(...ue.map(fe=>(S(fe,I),[_.x,_.y,_.z])).flat())}}let ne=[];for(let z=0;z<E.length;z++)for(let V=0;V<c;V++){let U=E[z][V];if(U<L){let X=E[U].findIndex(Y=>Y%L==z),N=G[z][V],q=G[U][X];for(let Y=0;Y<y;Y++){let ee=N[Y],W=q[y-Y],se=N[Y+1],le=q[y-(Y+1)];[ee,W,se,se,W,le].forEach(ae=>{o.push(ae[0].x,ae[0].y,ae[0].z),l.push(ae[1].x,ae[1].y,ae[1].z)})}ne.push(N[0][0],q[y][0],N[y][0],q[0][0])}}for(;ne.length;){let z,V,U,X;[z,V]=ne.splice(0,2);let N=[z];for(;z!=V;)N.push(V),U=ne.indexOf(V),X=U%2,V=ne.splice(U-X,2)[1-X];_.subVectors(N[0],N[1]).cross(h.subVectors(N[0],N[2])).normalize();let q=_.dot(N[0])<0;q&&_.negate();for(let Y=1;Y<=N.length-2;Y++)[N[Y+ +q],N[Y+1-+q],N[0]].forEach(ee=>{o.push(ee.x,ee.y,ee.z),l.push(_.x,_.y,_.z)})}}function d(){let c=new R;for(let E=0;E<o.length;E+=3){c.x=o[E+0],c.y=o[E+1],c.z=o[E+2];let L=b(c)/2/Math.PI+.5,A=T(c)/Math.PI+.5;a.push(L,1-A)}let h=new R,m=new R,g=new R,v=new R,x=new te,y=new te,_=new te,S=(E,L,A,I)=>{I<0&&E.x===1&&(a[L]=E.x-1),A.x===0&&A.z===0&&(a[L]=I/2/Math.PI+.5)};for(let E=0,L=0;E<o.length;E+=9,L+=6){h.set(o[E+0],o[E+1],o[E+2]),m.set(o[E+3],o[E+4],o[E+5]),g.set(o[E+6],o[E+7],o[E+8]),x.set(a[L+0],a[L+1]),y.set(a[L+2],a[L+3]),_.set(a[L+4],a[L+5]),v.copy(h).add(m).add(g).divideScalar(3);let A=b(v);S(x,L+0,h,A),S(y,L+2,m,A),S(_,L+4,g,A)}for(let E=0;E<a.length;E+=6){let L=a[E+0],A=a[E+2],I=a[E+4],P=Math.max(L,A,I),O=Math.min(L,A,I);P>.9&&O<.1&&(L<.2&&(a[E+0]+=1),A<.2&&(a[E+2]+=1),I<.2&&(a[E+4]+=1))}function b(E){return Math.atan2(E.z,-E.x)}function T(E){return Math.atan2(-E.y,Math.sqrt(E.x*E.x+E.z*E.z))}}}static fromJSON(t){return new JM(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},NK=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new Tz(e*.5,s,o):new Rh(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},Tz=class extends JM{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,n),this.type=a}static fromJSON(t){return new Tz(t.radius,t.corner,t.cornerSides)}},Ud=1e-12,KM=class{constructor(t){this.position=new te,this.startPosition=new te,this.uuid=Sn.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new KM(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},ES=class extends KM{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new ES(this.parent).copy(this)}},nh=class extends KM{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new ES(this),new ES(this))}static create(t,e){let n=new nh(t,new te(...e.position));return n.controls[0].position.set(...e.controlPrevious.position),n.controls[1].position.set(...e.controlNext.position),n.roundness=e.roundness,n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,n}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let n=0,i=this.controls.length;n<i;n++){let r=this.controls[n];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new nh(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var n,i;let t=(n=this.curveBefore)==null?void 0:n.getTangentAt(1),e=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[t,e]}computeNormals(t=new te,e=new te){let[n,i]=this.computeTangents();return n&&i&&(YC(n,t),YC(i,e)),[t,e]}computeTangent(t=new te){let[e,n]=this.computeTangents();return e&&n&&t.copy(e).add(n).normalize(),t}computeNormal(t=new te){let[e,n]=this.computeNormals();return t.copy(e).add(n).normalize(),t}};function YC(t,e=new te){let n=t.length();return e.set(-t.y/n,t.x/n)}var QM=t=>t,Wh=new te,yy=new te,kK=new te,BK=new te,UK=new te,FK=new te,Cz=new R,Pz=new R;function VK(t){let e=new te;e.addVectors(t.v0,Wh.subVectors(t.v1,t.v0).multiplyScalar(2/3));let n=new te;return n.addVectors(t.v2,yy.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new ns(t.v0,e,n,t.v2)}function Kd(t,e,n=Number.EPSILON){return Math.abs(t-e)<n}function GK(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function HK(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function Lz(t,e,n){let i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function WK(t,e,n){return JC(t,e)&&JC(e,n)&&AS(t.position,e.position,n.position)}function AS(t,e,n){return Wh.copy(e).sub(t).cross(yy.copy(n).sub(t))===0}function jK(t,e,n,i,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.y-e.y)/s,u=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return i.set(a+l,o+u),r.set(a-l,o-u),[i,r]}function $K(t,e,n){let i=t.distanceTo(n),r=e.distanceTo(n);return i<r?e:t}function qK(t,e,n,i,r,s){let o=e.x-t.x,a=e.y-t.y,l=n.x-t.x,u=n.y-t.y,d=Math.sqrt((o+l)*(o+l)+(a+u)*(a+u)),c;return Lz(e,t,n)>Math.PI&&(d*=-1),Kd(u,a)?c=(a+u)*(i/d-.5)*8/3/(o-l):c=(o+l)*(i/d-.5)*8/3/(u-a),r.set(e.x-c*a,e.y+c*o),s.set(n.x+c*u,n.y-c*l),[r,s]}function ZC(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function JC(t,e){return AS(t.position,t.controls[1].position,e.position)&&AS(t.position,e.controls[0].position,e.position)}function XK(t,e,n,i,r=.5){let s=Wh.subVectors(e,t).multiplyScalar(r).add(t),o=yy.subVectors(n,e).multiplyScalar(r).add(e),a=kK.subVectors(i,n).multiplyScalar(r).add(n),l=s,u=BK.subVectors(o,s).multiplyScalar(r).add(s),d=UK.subVectors(a,o).multiplyScalar(r).add(o),c=a,h=FK.subVectors(d,u).multiplyScalar(r).add(u);return[t.x,t.y,l.x,l.y,u.x,u.y,h.x,h.y,d.x,d.y,c.x,c.y,i.x,i.y]}function YK(t,e,n=12,i=!0){let r=Pz.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=QM(e[a]),u=Wh,d=hu(l,n);for(let c=0;c<=d;c++)if(l instanceof ns||l instanceof ra||l instanceof rs){if(l.getPoint(c/d,u),r.set(u.x,u.y,0),s!==void 0&&HK(s,r))continue;s===void 0&&(s=Cz),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return i&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function ZK(t,e,n,i=12,r=!0){let s=Pz.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(n[l]===!1)continue;let u,d=QM(e[l]),c=Wh,h=hu(d,i);a.push(h);for(let m=0;m<=h;m++)if(d instanceof ns||d instanceof ra||d instanceof rs){if(d.getPoint(m/h,c),s.set(c.x,c.y,0),u==null?void 0:u.equals(s))continue;u===void 0?u=Cz:(t.setXYZ(o,u.x,u.y,u.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),u.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function KC(t,e=12,n=!1){let i=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(n&&o.roundedCurveCorner!==void 0){let l=hu(o.roundedCurveCorner,e)*.5;r>0&&(i[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=hu(o.curveAfter,e)),i.push(a)}return t.length>0&&n&&t[0].roundedCurveCorner!==void 0&&(i[t.length-1]+=hu(t[0].roundedCurveCorner,e)*.5),i}function hu(t,e=12){return t&&t instanceof xp?e*2:t&&(t instanceof rs||t instanceof Qb)?1:t&&t instanceof ey?e*t.points.length:e}function JK(t,e,n=12,i=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=QM(e[o]),l=hu(a,n),u=Wh;for(let d=0;d<=l;d++)if(a instanceof ns||a instanceof ra||a instanceof rs){if(a.getPoint(d/l,u),r!==void 0&&GK(r,u,Ud))continue;r===void 0&&(r=yy),r.copy(u),t.push(u.x,u.y),s++}}return Kd(t[0],t[t.length-2],Ud)&&Kd(t[1],t[t.length-1],Ud)&&(t.pop(),t.pop()),i&&s>1&&!(Kd(t[s-1],t[1],Ud)&&Kd(t[s-2],t[0],Ud))&&(t.push(t[0],t[1]),s++),t}var Jx=new te,KK=new te,QK=new te,eQ=new te,tQ=new te,nQ=new te,In=class extends Ls{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Bo(new R(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Sn.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,n){let i=new In;return i.isClosed=t.isClosed,i.points=t.points.map(r=>nh.create(r.id,r.data)),typeof t.roundness=="number"&&(i.roundness=t.roundness),i.shapeHoles=t.shapeHoles.map(r=>In.createFromState(r)),e!==void 0&&n!==void 0&&i.applySize(e,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,n=this.points.length;e<n;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,n=this.points.findIndex(i=>i.uuid===t);if(n<0){let i=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)i+=a;else return l+i}}return n}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let n=Jx.set(t,e);for(let i=0,r=this.points.length;i<r;i++){let s=this.points[i];s.position.multiply(n),s.controls[0].position.multiply(n),s.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(t,e);this._update()}createPoint(t,e=0,n=Sn.generateUUID()){let i;t instanceof te?i=t:i=new te(t,e);let r=new nh(n,i);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(i.uuid===t)return i}for(let e=0,n=this.shapeHoles.length;e<n;e++){let i=this.shapeHoles[e].getPointByUuid(t);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(n=>n.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,n=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let i=n?this.roundedCurveDivisions:this.curveDivisions;return YK(t,n?this.roundedCurves:this.curves,e,this.autoClose),i.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=KC(this.points,t,!1),this.roundedCurveDivisions=KC(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,n=12){return ZK(t,this.curves,e,n,this.autoClose).reduce((i,r)=>i+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),JK(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let n=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=hu(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=i.reduce((o,a)=>o+a,0));for(let o=0,a=i.length;o<a;o++){let l=i[o];if(s<n+l)return[o,(s-n+1)/l];n+=l}return[0,1]}getCurveT(t,e,n){let i=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(ZC(i,r)){let l=i.position.distanceTo(r.position);return i.position.distanceTo(Jx.set(n.x,n.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){ZC(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let n=this.curves[this.curves.length-1];t.curveBefore=n,e.curveAfter=n;let i=n.clone();t.roundedCurveBefore=i,e.roundedCurveAfter=i,t.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(e===0)this.moveTo(i.position.x,i.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(i,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],n=this.points[this.points.length-1];this._applyCurveForPoint(e,n)}if(this.points.length>2){let e=0;for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n],s=this.points[n-1]??this.points[this.points.length-1],o=this.points[n+1]??this.points[0],a=r.roundness,l=s&&o&&WK(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let u=r.curveBefore,d=r.curveAfter;if(u===void 0||d===void 0)continue;let c=r.roundedCurveBefore,h=r.roundedCurveAfter,m=u.getLength(),g=d.getLength(),v=Math.min(a,m*.499),x=Math.min(a,g*.499),y=Math.min(v,x),_=1-y/m,S=y/g,b=u.getPointAt(_,Jx),T=d.getPointAt(S,KK);this._subSplitCurve(u,c,_,b,void 0),this._subSplitCurve(d,h,S,void 0,T);let E;if(this.useCubicForRoundedCorners){let L=Lz(b,r.position,T)/2,A=Math.tan(L)*b.distanceTo(r.position),[I,P]=jK(b,T,A,QK,eQ),O=$K(I,P,r.position),[k,F]=qK(O,b,T,A,tQ,nQ);E=new ns(b.clone(),k.clone(),F.clone(),T.clone())}else E=new ra(b.clone(),r.position.clone(),T.clone());r.roundedCurveCorner=E,this.roundedCurves.splice(n+e,0,E),e++}}}}_subSplitCurve(t,e,n,i,r){if(t instanceof rs)i!==void 0&&e.v2.copy(i),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(n,0),l=XK(s.v0,s.v1,s.v2,s.v3,a);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new In(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var n;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let i=0;i<e;i++){let r=i*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],u=t.points[r+4],d=t.points[r+5],c=t.points[r+6],h=new nh(Sn.generateUUID(),new te(s,o));h.controls[0].position.set(a,l),h.controls[1].position.set(u,d),h.roundness=c,this.points.push(h)}return this.shapeHoles=(n=t.shapeHoles)!=null&&n.length?t.shapeHoles.map(i=>{let r=new In;return r.fromJSON(i),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t){let e=(i,r)=>{r instanceof ns&&r.v3.equals(i.position)&&i.controls[0].position.copy(r.v2)},n=i=>{let r=[],s,o;for(s=0,o=i.length;s<o;s++)i[s]instanceof ra&&(i[s]=VK(i[s]));for(s=0,o=i.length;s<o;s++){let u=i[s],d=s>0?i[s-1]:null,c;u instanceof ns?(c=this.createPoint(u.v0),c.controls[1].position.copy(u.v1)):u instanceof rs&&(c=this.createPoint(u.v1)),c!==void 0&&(d!==null&&e(c,d),r.push(c))}let a=i[i.length-1],l=!1;return a instanceof ns?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof rs&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=n(t.curves),t instanceof Ls&&(this.shapeHoles=t.holes.map(i=>{let r=new In;return r.fromShape(i),r})),this.update(),this}updatePoint(t,e){let n=this.getPointByUuid(t);n&&(e.position!==void 0&&n.position.fromArray(e.position),e.roundness!==void 0&&(n.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[0];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[1];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}},TS=Math.PI*2;function Kx({x:t,y:e},n,i,r,s){return{x:t*n+r,y:e*i+s}}function iQ(t,e){let n=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:i-r*n,y:r+i*n},{x:s+o*n,y:o-s*n},{x:s,y:o}]}function QC(t,e,n,i){let r=t*i-e*n<0?-1:1,s=Math.min(1,Math.max(-1,t*n+e*i));return r*Math.acos(s)}function rQ(t,e,n,i,r,s,o,a,l,u){let d=Math.pow(r,2),c=Math.pow(s,2),h=Math.pow(o,2),m=Math.pow(a,2),g=d*c-d*m-c*h;g<0&&(g=0),g/=d*m+c*h,g=Math.sqrt(g)*(l===u?-1:1);let v=g*r/s*a,x=g*-s/r*o,y=v+(t+n)/2,_=x+(e+i)/2,S=(o-v)/r,b=(a-x)/s,T=(-o-v)/r,E=(-a-x)/s,L=QC(1,0,S,b),A=QC(S,b,T,E);return!u&&A>0&&(A-=TS),u&&A<0&&(A+=TS),{centerx:y,centery:_,ang1:L,ang2:A}}function sQ({px:t,py:e,cx:n,cy:i,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let u=(t-n)/2,d=(e-i)/2;if(u===0&&d===0)return[];r=Math.abs(r),s=Math.abs(s);let c=Math.pow(u,2)/Math.pow(r,2)+Math.pow(d,2)/Math.pow(s,2);c>1&&(r*=Math.sqrt(c),s*=Math.sqrt(c));let h=rQ(t,e,n,i,r,s,u,d,o,a),{ang1:m,ang2:g}=h,{centerx:v,centery:x}=h,y=Math.abs(g)/(TS/4);Math.abs(1-y)<1e-7&&(y=1);let _=Math.max(Math.ceil(y),1);g/=_;for(let S=0;S<_;S++)l.push(iQ(m,g)),m+=g;return l.map(S=>{let{x:b,y:T}=Kx(S[0],r,s,v,x),{x:E,y:L}=Kx(S[1],r,s,v,x),{x:A,y:I}=Kx(S[2],r,s,v,x);return{x1:b,y1:T,x2:E,y2:L,x:A,y:I}})}var Yt;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Yt||(Yt={}));var jn;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(jn||(jn={}));function ft(t,e){if(!t)throw e||"Assertion Failed!"}var at=function(){function t(){}return t.vertEq=function(e,n){return e.s===n.s&&e.t===n.t},t.vertLeq=function(e,n){return e.s<n.s||e.s===n.s&&e.t<=n.t},t.transLeq=function(e,n){return e.t<n.t||e.t===n.t&&e.s<=n.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,n){return Math.abs(e.s-n.s)+Math.abs(e.t-n.t)},t.edgeEval=function(e,n,i){ft(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?r<s?n.t-e.t+(e.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,n,i){ft(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-e.t)*s:0},t.transEval=function(e,n,i){ft(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?r<s?n.s-e.s+(e.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-e.s)*(s/(r+s)):0},t.transSign=function(e,n,i){ft(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-e.s)*s:0},t.vertCCW=function(e,n,i){return e.s*(n.t-i.t)+n.s*(i.t-e.t)+i.s*(e.t-n.t)>=0},t.interpolate=function(e,n,i,r){return e=e<0?0:e,i=i<0?0:i,e<=i?i===0?(n+r)/2:n+(r-n)*(e/(e+i)):r+(n-r)*(i/(e+i))},t.intersect=function(e,n,i,r,s){var o,a,l;t.vertLeq(e,n)||(l=e,e=n,n=l),t.vertLeq(i,r)||(l=i,i=r,r=l),t.vertLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.vertLeq(i,n)?t.vertLeq(n,r)?(o=t.edgeEval(e,i,n),a=t.edgeEval(i,n,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,n.s)):(o=t.edgeSign(e,i,n),a=-t.edgeSign(e,r,n),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,r.s)):s.s=(i.s+n.s)/2,t.transLeq(e,n)||(l=e,e=n,n=l),t.transLeq(i,r)||(l=i,i=r,r=l),t.transLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.transLeq(i,n)?t.transLeq(n,r)?(o=t.transEval(e,i,n),a=t.transEval(i,n,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,n.t)):(o=t.transSign(e,i,n),a=-t.transSign(e,r,n),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,r.t)):s.t=(i.t+n.t)/2},t}(),Fd=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),Bg=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),Mc=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),eP=function(){function t(){var e=new Mc,n=new Fd,i=new Bg(0),r=new Bg(1);e.next=e.prev=e,e.anEdge=null,n.next=n.prev=n,i.next=i,i.Sym=r,r.next=r,r.Sym=i,this.vHead=e,this.fHead=n,this.eHead=i,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var n=new Bg(0),i=new Bg(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return i.next=r,r.Sym.next=n,n.next=e,e.Sym.next=i,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n},t.prototype.splice_=function(e,n){var i=e.Onext,r=n.Onext;i.Sym.Lnext=n,r.Sym.Lnext=e,e.Onext=r,n.Onext=i},t.prototype.makeVertex_=function(e,n,i){var r=e;ft(r,"Vertex can't be null!");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n;var o=n;do o.Org=r,o=o.Onext;while(o!==n)},t.prototype.makeFace_=function(e,n,i){var r=e;ft(r,"Face can't be null");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n,r.trail=null,r.marked=!1,r.inside=i.inside;var o=n;do o.Lface=r,o=o.Lnext;while(o!==n)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var n=e.next,i=e.Sym.next;n.Sym.next=i,i.Sym.next=n},t.prototype.killVertex_=function(e,n){var i=e.anEdge,r=i;do r.Org=n,r=r.Onext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,n){var i=e.anEdge,r=i;do r.Lface=n,r=r.Lnext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new Mc,n=new Mc,i=new Fd,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(n,r.Sym,this.vHead),this.makeFace_(i,r,this.fHead),r},t.prototype.splice=function(e,n){var i=!1,r=!1;if(e!==n){if(n.Org!==e.Org&&(r=!0,this.killVertex_(n.Org,e.Org)),n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(n,e),!r){var s=new Mc;this.makeVertex_(s,n,e.Org),e.Org.anEdge=e}if(!i){var o=new Fd;this.makeFace_(o,n,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var n=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var r=new Fd;this.makeFace_(r,e,e.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(e.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var n=this.makeEdge_(e),i=n.Sym;this.splice_(n,e.Lnext),n.Org=e.Dst;var r=new Mc;return this.makeVertex_(r,i,n.Org),n.Lface=i.Lface=e.Lface,n},t.prototype.splitEdge=function(e){var n=this.addEdgeVertex(e),i=n.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,i),e.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=e.Rface,i.winding=e.winding,i.Sym.winding=e.Sym.winding,i.idx=e.idx,i.Sym.idx=e.Sym.idx,i},t.prototype.connect=function(e,n){var i=!1,r=this.makeEdge_(e),s=r.Sym;if(n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,n),r.Org=e.Dst,s.Org=n.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!i){var o=new Fd;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var n=e.anEdge,i,r,s,o,a;r=n.Lnext;do i=r,r=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=n);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var n=e.anEdge,i=0;do i++,n=n.Lnext;while(n!==e.anEdge);return i},t.prototype.mergeConvexFaces=function(e){var n,i,r,s,o,a,l;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(i=n.anEdge,o=i.Org;r=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(n),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&at.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&at.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===o);)i=r;return!0},t.prototype.check=function(){var e=this.fHead,n=this.vHead,i=this.eHead,r,s,o,a,l,u;for(s=e,s=e;(r=s.next)!==e;s=r){ft(r.prev===s),l=r.anEdge;do ft(l.Sym!==l),ft(l.Sym.Sym===l),ft(l.Lnext.Onext.Sym===l),ft(l.Onext.Sym.Lnext===l),ft(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(ft(r.prev===s&&r.anEdge===null),a=n,a=n;(o=a.next)!==n;a=o){ft(o.prev===a),l=o.anEdge;do ft(l.Sym!==l),ft(l.Sym.Sym===l),ft(l.Lnext.Onext.Sym===l),ft(l.Onext.Sym.Lnext===l),ft(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(ft(o.prev===a&&o.anEdge===null),u=i,u=i;(l=u.next)!==i;u=l)ft(l.Sym.next===u.Sym),ft(l.Sym!==l),ft(l.Sym.Sym===l),ft(l.Org!==null),ft(l.Dst!==null),ft(l.Lnext.Onext.Sym===l),ft(l.Onext.Sym.Lnext===l);ft(l.Sym.next===u.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),tP=function(){function t(){this.handle=null}return t}(),nP=function(){function t(){this.key=null,this.node=0}return t}(),oQ=function(){function t(e,n){this.leq=n,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var i=0;i<e+1;i++)this.nodes[i]=new tP,this.handles[i]=new nP;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e<<1,o<this.size&&this.leq(i[n[o+1].handle].key,i[n[o].handle].key)&&++o,ft(o<=this.max),s=n[o].handle,o>this.size||this.leq(i[r].key,i[s].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.floatUp_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e>>1,s=n[o].handle,o===0||this.leq(i[s].key,i[r].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var n,i;if(n=++this.size,n*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new tP;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new nP}return this.freeList===0?i=n:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[n].handle=i,this.handles[i].node=n,this.handles[i].key=e,this.initialized&&this.floatUp_(n),i},t.prototype.extractMin=function(){var e=this.nodes,n=this.handles,i=e[1].handle,r=n[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,n[e[1].handle].node=1,n[i].key=null,n[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var n=this.nodes,i=this.handles,r;ft(e>=1&&e<=this.max&&i[e].key!==null),r=i[e].node,n[r].handle=n[this.size].handle,i[n[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(i[n[r>>1].handle].key,i[n[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},t}(),Qx=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),iP=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),aQ=function(){function t(e,n){this.frame=e,this.leq=n,this.head=new iP,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,e,n.key));return n},t.prototype.insertBefore=function(e,n){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,n));var i=new iP;return i.key=n,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),lQ=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.edgeLeq=function(e,n,i){var r=e.event,s=n.eUp,o=i.eUp;if(s.Dst===r)return o.Dst===r?at.vertLeq(s.Org,o.Org)?at.edgeSign(o.Dst,s.Org,o.Org)<=0:at.edgeSign(s.Dst,o.Org,s.Org)>=0:at.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return at.edgeSign(s.Dst,r,s.Org)>=0;var a=at.edgeEval(s.Dst,r,s.Org),l=at.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,n){n.fixUpperEdge&&ft(n.eUp.winding===0),n.eUp.activeRegion=null,e.dict.delete(n.nodeUp)},t.fixUpperEdge=function(e,n,i){ft(n.fixUpperEdge),e.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=i,i.activeRegion=n},t.topLeftRegion=function(e,n){var i=n.eUp.Org,r;do n=t.regionAbove(n);while(n.eUp.Org===i);if(n.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(n).eUp.Sym,n.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,n,r),n=t.regionAbove(n)}return n},t.topRightRegion=function(e){var n=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===n);return e},t.addRegionBelow=function(e,n,i){var r=new Qx;return r.eUp=i,r.nodeUp=e.dict.insertBefore(n.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,i.activeRegion=r,r},t.isWindingInside=function(e,n){switch(e.windingRule){case Yt.ODD:return(n&1)!==0;case Yt.NONZERO:return n!==0;case Yt.POSITIVE:return n>0;case Yt.NEGATIVE:return n<0;case Yt.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,n){n.windingNumber=t.regionAbove(n).windingNumber+n.eUp.winding,n.inside=t.isWindingInside(e,n.windingNumber)},t.finishRegion=function(e,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,t.deleteRegion(e,n)},t.finishLeftRegions=function(e,n,i){for(var r,s=null,o=n,a=n.eUp;o!==i;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,n,i,r,s,o){var a,l,u,d,c=!0;u=i;do ft(at.vertLeq(u.Org,u.Dst)),t.addRegionBelow(e,n,u.Sym),u=u.Onext;while(u!==r);for(s===null&&(s=t.regionBelow(n).eUp.Rprev),l=n,d=s;a=t.regionBelow(l),u=a.eUp.Sym,u.Org===d.Org;)u.Onext!==d&&(e.mesh.splice(u.Oprev,u),e.mesh.splice(d.Oprev,u)),a.windingNumber=l.windingNumber-u.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!c&&t.checkForRightSplice(e,l)&&(t.addWinding(u,d),t.deleteRegion(e,l),e.mesh.delete(d)),c=!1,l=a,d=u;l.dirty=!0,ft(l.windingNumber-u.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,n,i){e.mesh.splice(n,i)},t.vertexWeights=function(e,n,i){var r=at.vertL1dist(n,e),s=at.vertL1dist(i,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*n.coords[0]+a*i.coords[0],e.coords[1]+=o*n.coords[1]+a*i.coords[1],e.coords[2]+=o*n.coords[2]+a*i.coords[2]},t.getIntersectData=function(e,n,i,r,s,o){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,t.vertexWeights(n,i,r),t.vertexWeights(n,s,o)},t.checkForRightSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp;if(at.vertLeq(r.Org,s.Org)){if(at.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;at.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(at.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o;if(ft(!at.vertEq(r.Dst,s.Dst)),at.vertLeq(r.Dst,s.Dst)){if(at.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=n.inside}else{if(at.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;n.dirty=i.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=n.inside}return!0},t.checkForIntersect=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o=r.Org,a=s.Org,l=r.Dst,u=s.Dst,d,c,h=new Mc,m,g;if(ft(!at.vertEq(u,l)),ft(at.edgeSign(l,e.event,o)<=0),ft(at.edgeSign(u,e.event,a)>=0),ft(o!==e.event&&a!==e.event),ft(!n.fixUpperEdge&&!i.fixUpperEdge),o===a||(d=Math.min(o.t,l.t),c=Math.max(a.t,u.t),d>c))return!1;if(at.vertLeq(o,a)){if(at.edgeSign(u,o,a)>0)return!1}else if(at.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),at.intersect(l,o,u,a,h),ft(Math.min(o.t,l.t)<=h.t),ft(h.t<=Math.max(a.t,u.t)),ft(Math.min(u.s,l.s)<=h.s),ft(h.s<=Math.max(a.s,o.s)),at.vertLeq(h,e.event)&&(h.s=e.event.s,h.t=e.event.t),m=at.vertLeq(o,a)?o:a,at.vertLeq(m,h)&&(h.s=m.s,h.t=m.t),at.vertEq(h,o)||at.vertEq(h,a)?(t.checkForRightSplice(e,n),!1):!at.vertEq(l,e.event)&&at.edgeSign(l,e.event,h)>=0||!at.vertEq(u,e.event)&&at.edgeSign(u,e.event,h)<=0?u===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),n=t.topLeftRegion(e,n),r=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),i),t.addRightEdges(e,n,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),i=n,n=t.topRightRegion(n),g=t.regionBelow(n).eUp.Rprev,i.eUp=s.Oprev,s=t.finishLeftRegions(e,i,null),t.addRightEdges(e,n,s.Onext,r.Rprev,g,!0),!0):(at.edgeSign(l,e.event,h)>=0&&(t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),at.edgeSign(u,e.event,h)<=0&&(n.dirty=i.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=h.s,r.Org.t=h.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,u),t.regionAbove(n).dirty=n.dirty=i.dirty=!0,!1)},t.walkDirtyRegions=function(e,n){for(var i=t.regionBelow(n),r,s;;){for(;i.dirty;)n=i,i=t.regionBelow(i);if(!n.dirty&&(i=n,n=t.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,r=n.eUp,s=i.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,n)&&(i.fixUpperEdge?(t.deleteRegion(e,i),e.mesh.delete(s),i=t.regionBelow(n),s=i.eUp):n.fixUpperEdge&&(t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i),r=n.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!n.fixUpperEdge&&!i.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,n))return}else t.checkForRightSplice(e,n);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i))}},t.connectRightVertex=function(e,n,i){var r,s=i.Onext,o=t.regionBelow(n),a=n.eUp,l=o.eUp,u=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,n),at.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),n=t.topLeftRegion(e,n),s=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),o),u=!0),at.vertEq(l.Org,e.event)&&(e.mesh.splice(i,l.Oprev),i=t.finishLeftRegions(e,o,null),u=!0),u){t.addRightEdges(e,n,i.Onext,s,s,!0);return}at.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(i.Lprev,r),t.addRightEdges(e,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,n)},t.connectLeftDegenerate=function(e,n,i){var r,s,o,a,l;if(r=n.eUp,at.vertEq(r.Org,i)){ft(!1),t.spliceMergeVertices(e,r,i.anEdge);return}if(!at.vertEq(r.Dst,i)){e.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(e.mesh.delete(r.Onext),n.fixUpperEdge=!1),e.mesh.splice(i.anEdge,r),t.sweepEvent(e,i);return}ft(!1),n=t.topRightRegion(n),l=t.regionBelow(n),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(ft(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(i.anEdge,o),at.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,n,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,n){var i,r,s,o,a,l,u=new Qx;if(u.eUp=n.anEdge.Sym,i=e.dict.search(u).key,r=t.regionBelow(i),!!r){if(o=i.eUp,a=r.eUp,at.edgeSign(o.Dst,n,o.Org)===0){t.connectLeftDegenerate(e,i,n);return}if(s=at.vertLeq(a.Dst,o.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=e.mesh.connect(n.anEdge.Sym,o.Lnext);else{var d=e.mesh.connect(a.Dnext,n.anEdge);l=d.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,i,l)),t.sweepEvent(e,n)}else t.addRightEdges(e,i,n.anEdge,n.anEdge,null,!0)}},t.sweepEvent=function(e,n){e.event=n,t.debugEvent(e);for(var i=n.anEdge;i.activeRegion===null;)if(i=i.Onext,i===n.anEdge){t.connectLeftVertex(e,n);return}var r=t.topLeftRegion(e,i.activeRegion);ft(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,n,i,r){var s=new Qx,o=e.mesh.makeEdge();o.Org.s=i,o.Org.t=r,o.Dst.s=n,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new aQ(e,t.edgeLeq);var n=e.bmax[0]-e.bmin[0],i=e.bmax[1]-e.bmin[1],r=e.bmin[0]-n,s=e.bmax[0]+n,o=e.bmin[1]-i,a=e.bmax[1]+i;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var n,i=0;(n=e.dict.min().key)!==null;)n.sentinel||(ft(n.fixUpperEdge),ft(++i===1)),ft(n.windingNumber===0),t.deleteRegion(e,n)},t.removeDegenerateEdges=function(e){var n,i,r,s=e.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,at.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(t.spliceMergeVertices(e,r,n),e.mesh.delete(n),n=r,r=n.Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),e.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),e.mesh.delete(n))},t.initPriorityQ=function(e){var n,i,r,s=0;for(r=e.mesh.vHead,i=r.next;i!==r;i=i.next)s++;for(s+=8,n=e.pq=new oQ(s,at.vertLeq),r=e.mesh.vHead,i=r.next;i!==r;i=i.next)i.pqHandle=n.insert(i);return i!==r?!1:(n.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,s=i.anEdge,ft(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,n){n===void 0&&(n=!0);var i,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(i=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!at.vertEq(r,i));)r=e.pq.extractMin(),t.spliceMergeVertices(e,i.anEdge,r.anEdge);t.sweepEvent(e,i)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(n&&e.mesh.check(),!0):!1},t}(),uQ=function(){function t(){this.mesh=new eP,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Yt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},t.prototype.normalize_=function(e){var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),e[0]/=n,e[1]/=n,e[2]/=n},t.prototype.longAxis_=function(e){var n=0;return Math.abs(e[1])>Math.abs(e[0])&&(n=1),Math.abs(e[2])>Math.abs(e[n])&&(n=2),n},t.prototype.computeNormal_=function(e){var n,i,r,s,o,a,l=[0,0,0],u=[0,0,0],d=[0,0,0],c=[0,0,0],h=[0,0,0],m=[null,null,null],g=[null,null,null],v=this.mesh.vHead;n=v.next;for(var x=0;x<3;++x)s=n.coords[x],u[x]=s,g[x]=n,l[x]=s,m[x]=n;for(n=v.next;n!==v;n=n.next)for(var y=0;y<3;++y)s=n.coords[y],s<u[y]&&(u[y]=s,g[y]=n),s>l[y]&&(l[y]=s,m[y]=n);var _=0;if(l[1]-u[1]>l[0]-u[0]&&(_=1),l[2]-u[2]>l[_]-u[_]&&(_=2),u[_]>=l[_]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,i=g[_],r=m[_],d[0]=i.coords[0]-r.coords[0],d[1]=i.coords[1]-r.coords[1],d[2]=i.coords[2]-r.coords[2],n=v.next;n!==v;n=n.next)c[0]=n.coords[0]-r.coords[0],c[1]=n.coords[1]-r.coords[1],c[2]=n.coords[2]-r.coords[2],h[0]=d[1]*c[2]-d[2]*c[1],h[1]=d[2]*c[0]-d[0]*c[2],h[2]=d[0]*c[1]-d[1]*c[0],o=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],o>a&&(a=o,e[0]=h[0],e[1]=h[1],e[2]=h[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(d)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,n,i=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(n=i.next;n!==i;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,n=[0,0,0],i,r,s=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),s=!0),i=this.sUnit,r=this.tUnit;var o=this.longAxis_(n);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=n[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,i),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,u=e.next;u!==e;u=u.next)l?(this.bmin[0]=this.bmax[0]=u.s,this.bmin[1]=this.bmax[1]=u.t,l=!1):(u.s<this.bmin[0]&&(this.bmin[0]=u.s),u.s>this.bmax[0]&&(this.bmax[0]=u.s),u.t<this.bmin[1]&&(this.bmin[1]=u.t),u.t>this.bmax[1]&&(this.bmax[1]=u.t))},t.prototype.addWinding_=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,n){var i,r;if(i=n.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;at.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;at.vertLeq(i.Org,i.Dst);i=i.Lnext);r=i.Lprev;for(var s=void 0;i.Lnext!==r;)if(at.vertLeq(i.Dst,r.Org)){for(;r.Lnext!==i&&(at.edgeGoesLeft(r.Lnext)||at.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==i&&(at.edgeGoesRight(i.Lprev)||at.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=e.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(r.Lnext===i)throw"Mono region invalid";for(;r.Lnext.Lnext!==i;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)if(n=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0},t.prototype.discardExterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)n=i.next,i.inside||e.zapFace(i)},t.prototype.setWindingNumber_=function(e,n,i){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?n:-n:i?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,n,i,r){var s,o=0,a=0,l;i>3&&e.mergeConvexFaces(i);for(var u=e.vHead.next;u!==e.vHead;u=u.next)u.n=-1;for(var d=e.fHead.next;d!==e.fHead;d=d.next)if(d.n=-1,!!d.inside){s=d.anEdge,l=0;do{var u=s.Org;u.n===-1&&(u.n=a,a++),l++,s=s.Lnext}while(s!==d.anEdge);if(l>i)throw"Face vertex greater that support polygon";d.n=o,++o}this.elementCount=o,n===jn.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var u=e.vHead.next;u!==e.vHead;u=u.next)if(u.n!==-1){var c=u.n*r;this.vertices[c+0]=u.coords[0],this.vertices[c+1]=u.coords[1],r>2&&(this.vertices[c+2]=u.coords[2]),this.vertexIndices[u.n]=u.idx}for(var h=0,d=e.fHead.next;d!==e.fHead;d=d.next)if(d.inside){s=d.anEdge,l=0;do{var u=s.Org;this.elements[h++]=u.n,l++,s=s.Lnext}while(s!==d.anEdge);for(var m=l;m<i;++m)this.elements[h++]=-1;if(n===jn.CONNECTED_POLYGONS){s=d.anEdge;do this.elements[h++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==d.anEdge);for(var g=l;g<i;++g)this.elements[h++]=-1}}},t.prototype.outputContours_=function(e,n){var i,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=i=a.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,u=0,d=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=i=a.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],n>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[u++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==r);this.elements[d++]=s,this.elements[d++]=o,s+=o}},t.prototype.addContour=function(e,n){this.mesh===null&&(this.mesh=new eP),e<2&&(e=2),e>3&&(e=3);for(var i=null,r=0;r<n.length;r+=e)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=n[r+0],i.Org.coords[1]=n[r+1],e>2?i.Org.coords[2]=n[r+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},t.prototype.tesselate=function(e,n,i,r,s,o){if(e===void 0&&(e=Yt.ODD),n===void 0&&(n=jn.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),lQ.computeInterior(this,o);var a=this.mesh;return n===jn.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),n===jn.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,n,i,r),!0},t}();function Fa(t){var e=t.windingRule,n=e===void 0?Yt.ODD:e,i=t.elementType,r=i===void 0?jn.POLYGONS:i,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,u=t.normal,d=u===void 0?[0,0,1]:u,c=t.contours,h=c===void 0?[]:c,m=t.strict,g=m===void 0?!0:m,v=t.debug,x=v===void 0?!1:v;if(!h&&g)throw new Error("Contours can't be empty");if(h){var y=new uQ;t.edgeCreateCallback&&(y.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(y.vertexIdCallback=t.vertexIdCallback);for(var _=0;_<h.length;_++)y.addContour(l||2,h[_]);return y.tesselate(n,r,o,l,d,g),{vertices:y.vertices,vertexIndices:y.vertexIndices,vertexCount:y.vertexCount,elements:y.elements,elementCount:y.elementCount,mesh:x?y.mesh:void 0}}}Yt.ODD;Yt.NONZERO;Yt.POSITIVE;Yt.NEGATIVE;Yt.ABS_GEQ_TWO;jn.POLYGONS;jn.CONNECTED_POLYGONS;jn.BOUNDARY_CONTOURS;var Iz=class extends Ze{constructor(t,e=12,n={}){super(),this.type="ShapeGeometry",this.windingRule=Yt.ODD,this.elementType=jn.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:Yt.ODD,elementType:jn.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(h=>h.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,u;for(let h=0,m=i.length/2;h<m;h++){let g=h*2,v=i[g+0],x=i[g+1];if(l!==void 0&&v!==l&&(o=!1),u!==void 0&&x!==u&&(a=!1),l=v,u=x,!o&&!a)break}!o&&!a&&(s=Fa({contours:[i,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict}));let d=(s==null?void 0:s.vertexCount)??1,c=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new pt(new Float32Array(d*3),3),this._normalAttribute=new pt(new Float32Array(d*3),3),this._uvAttribute=new pt(new Float32Array(d*2),2),this._indexAttribute=new pt(new Uint32Array(c*3),1),s){let h=1/0,m=-1/0,g=1/0,v=-1/0;for(let _=0,S=d;_<S;_++){let b=_*2,T=s.vertices[b+0],E=s.vertices[b+1];T<h&&(h=T),T>m&&(m=T),E<g&&(g=E),E>v&&(v=E)}let x=m-h,y=v-g;for(let _=0,S=d;_<S;_++){let b=_*2,T=s.vertices[b+0],E=s.vertices[b+1],L=(T-h)/x,A=(E-g)/y;this._positionAttribute.setXYZ(_,T,E,0),this._normalAttribute.setXYZ(_,0,0,1),this._uvAttribute.setXY(_,L,A)}for(let _=0,S=c;_<S;_++){let b=_*3,T=s.elements[b+0],E=s.elements[b+1],L=s.elements[b+2];this._indexAttribute.setX(b+0,T),this._indexAttribute.setX(b+1,E),this._indexAttribute.setX(b+2,L)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new Iz(this._shape,this._curveSegments);return t.userData=vy(this.userData),t}},CS=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let n=t*CS.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*i,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let n=t*CS.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(i,s*r,3*t);s+=3*t;let a=new Float32Array(i,s*r,3*t);s+=3*t;let l=new Float32Array(i,s*r,2*t);o.set(this.positions.slice(0,this.size*3)),a.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=i,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let i=this.capacity;for(;e>i;)i*=2;this.realloc(i)}let n=this.size;return this.size=e,n}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},Dz=CS;Dz.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var e_=(t,e)=>([n,i])=>(i<n&&(i+=e),(t>=n?t:t+e)<=i),Rz=class extends Ze{constructor(t,e,n=0,i=12,r=3,s=Yt.ODD){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._bevel=n,this._curveSegments=i,this._bevelSegmentsInput=r,n<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(n,e/2-1e-12),this._bevelSegments=Math.floor(r));let o=this._shape.extractShapePointsToFlatArray([],i),a=this._shape.shapeHoles.map(T=>{let E=T.extractShapePointsToFlatArray([],i),L=[];for(let A=E.length-1;A>=1;A-=2){let I=E[A-1],P=E[A-0];L.push(I,P)}return L}),l=Fa({windingRule:s,elementType:jn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]}),u=Fa({windingRule:Yt.ODD,elementType:jn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]});if(!l)throw new Error("error generating geometry");let d=l.elementCount;if(u){l.elementCount+=u.elementCount;for(let T=0;T<u.elements.length;T++){let E=u.elements[T],L=T%2===0?l.vertexCount:0;l.elements.push(E+L)}for(let T=0;T<u.vertexIndices.length;T++){let E=u.vertexIndices[T],L=l.vertexCount;l.vertexIndices.push(E+L)}for(let T=0;T<u.vertices.length;T++){let E=u.vertices[T];l.vertices.push(E)}}let c=1/0,h=-1/0,m=1/0,g=-1/0;for(let T=0,E=l.vertexCount;T<E;T++){let L=T*2,A=l.vertices[L+0],I=l.vertices[L+1];A<c&&(c=A),A>h&&(h=A),I<m&&(m=I),I>g&&(g=I)}this._minX=c,this._minY=m,this._width=h-c,this._height=g-m,this._buffer=new Dz(this._computeBufferEstimatedSize(l));let v=[],x=[];for(let T=l.elementCount-1;T>=0;T--){let E=T>=d,L=T*2,A=l.elements[L+0],I=l.elements[L+1],P=A+I,O={start:A,count:I,normals:[],continuous:[],concave:[]},k=A,F=P-1,G=A+1,Z=this._shape.roundedCurves.length;do{let V=k-A,U=l.vertices[F*2+0],X=l.vertices[F*2+1],N=l.vertices[k*2+0],q=l.vertices[k*2+1],Y=l.vertices[G*2+0],ee=l.vertices[G*2+1],W=N-U,se=q-X,le=Math.sqrt(W*W+se*se);W/=le,se/=le;let ae=N-Y,ue=q-ee,fe=Math.sqrt(ae*ae+ue*ue);ae/=fe,ue/=fe,O.normals[V*2+0]=-ue,O.normals[V*2+1]=ae,O.concave[V]=W*ue-se*ae>0;let K=l.vertexIndices[k];if(Array.isArray(K))O.continuous[V]=!1;else{let[Q,he]=this._shape.getCurveIndexFromVertexId(K-1,!0);if(he>0&&he<1)O.continuous[V]=!0;else{let ye=he===1?Q+1:Q-1;ye=(ye+Z)%Z;let be=he===1?0:1,Te=this._shape.roundedCurves[Q].getTangent(he),Le=this._shape.roundedCurves[ye].getTangent(be);O.continuous[V]=Te.dot(Le)>.95}}E&&(O.normals[V*2+0]*=-1,O.normals[V*2+1]*=-1),[F,k,G]=[k,G,G+1],G>=P&&(G-=I)}while(G!==A+1);let ne=[];ne.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(A*2,P*2),vertexCount:I,vertexIndices:new Array(I).fill(!0).map((V,U)=>[U,U]),elements:[0,I],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(A*2,P*2)});for(let V=1;V<=this._bevelSegments;V++){let U=V/this._bevelSegments*Math.PI/2,X=(1-Math.cos(U))*this._bevelSize,N=[],q=[],Y=0;for(let W=0;W<I;W++){let se=W*2,le=(W-1+I)%I*2,ae=l.vertices[O.start*2+se+0],ue=l.vertices[O.start*2+se+1],fe=-O.normals[le+0]*X,K=-O.normals[le+1]*X,Q=-O.normals[se+0]*X,he=-O.normals[se+1]*X;if(O.concave[W]||!O.concave[W]&&E){let ye=Math.atan2(K,fe),be=Math.atan2(he,Q);be>ye&&(be-=Math.PI*2);let Te=be-ye;if(O.continuous[W]||E){let Le=ye+Te/2,ze=Math.cos(Le)*X,Ye=Math.sin(Le)*X;N[2*Y+0]=ae+ze*(E?-1:1),N[2*Y+1]=ue+Ye*(E?-1:1),q[Y]=W,Y++}else{let Le=Math.max(1,Math.floor(i/4*Math.abs(Te)/Math.PI));for(let ze=0;ze<=Le;ze++){let Ye=ye+Te*(ze/Le),nt=Math.cos(Ye)*X,H=Math.sin(Ye)*X;N[2*Y+0]=ae+nt,N[2*Y+1]=ue+H,q[Y]=W,Y++}}}else N[2*Y+0]=ae+fe,N[2*Y+1]=ue+K,q[Y]=W,Y++,N[2*Y+0]=ae,N[2*Y+1]=ue,q[Y]=W,Y++,N[2*Y+0]=ae+Q,N[2*Y+1]=ue+he,q[Y]=W,Y++}let ee=Fa({windingRule:Yt.POSITIVE,elementType:jn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[N],edgeCreateCallback:W=>{let se=W.Org.idx,le=q[se],ae=q[(se+1)%q.length];W.idx=[le,ae],W.Sym.idx=[ae,le]},vertexIdCallback:W=>{let se=W.Lprev.idx;return[se?se[1]:0,W.idx?W.idx[0]:0]}});if(!ee)throw console.log("Error"),new Error(`error generating bevel geometry for ${V}'th loop`);if(!ee.vertexCount)break;for(let W=0;W<ee.vertexIndices.length;W++){let[se,le]=ee.vertexIndices[W];if(se===le)continue;let ae=le;le<se&&(ae+=I);for(let ue=se;ue<ae;ue++){let fe=ue%I,K=(ue+1)%I;if(!O.continuous[fe]||!O.continuous[K]){ee.vertexIndices[W]=[se,fe],ee.vertexIndices.splice(W+1,0,[K,le]),ee.vertices.splice((W+1)*2,0,ee.vertices[W*2],ee.vertices[W*2+1]);break}}}ne.push({bevelI:V,angle:U,size:X,boundary:ee,reverseMap:q,insetPoints:N})}let J=(V,U,X)=>{let N=0,q=V.boundary.vertexIndices.length;for(;N<q&&X(V.boundary.vertexIndices[U]);)U=(U+1)%q,N++;return N},z=v.length;for(let V=1;V<ne.length;V++){let U=ne[V-1],X=ne[V],N=U.boundary.vertexIndices.length,q=X.boundary.vertexIndices.length;if(!N||!q)break;let Y=O.concave.length,ee=0,W=e_(ee,I);for(;!U.boundary.vertexIndices.filter(W).length||!X.boundary.vertexIndices.filter(W).length;)ee++,W=e_(ee,I);let se=U.boundary.vertexIndices.findIndex(W),le=X.boundary.vertexIndices.findIndex(W);do se=(se+1)%N;while(W(U.boundary.vertexIndices[se]));do le=(le+1)%q;while(W(X.boundary.vertexIndices[le]));ee=(ee+1)%I;let ae=ee,ue=this._buildBevelVert(O,U,(se-1+N)%N),fe=this._buildBevelVert(O,X,(le-1+q)%q),K=ue,Q=fe,he,ye,be=!1;do{W=e_(ee,I);let Te=J(U,se,W),Le=J(X,le,W),ze=be;if(be=!1,Te&&!Le){for(let Ye=0;Ye<Te;Ye++)he=this._buildBevelVert(O,U,(se+Ye)%N,Ye/(Te-1)),v.push(K.topN,he.topP,Q.topN),v.push(he.bottomP,K.bottomN,Q.bottomN),K=he;be=!0}else if(!Te&&Le)for(let Ye=0;Ye<Le;Ye++)ye=this._buildBevelVert(O,X,(le+Ye)%q,Ye/(Le-1)),v.push(Q.topN,K.topP,ye.topP),v.push(K.bottomP,Q.bottomN,ye.bottomP),Q=ye;else if(Te&&Le)if(he=this._buildBevelVert(O,U,se,0),ye=this._buildBevelVert(O,X,le,0),ze?(v.push(K.topN,ye.topP,Q.topN),v.push(K.topN,he.topP,ye.topP),v.push(ye.bottomP,K.bottomN,Q.bottomN),v.push(ye.bottomP,he.bottomP,K.bottomN)):(v.push(Q.topN,K.topN,he.topP),v.push(Q.topN,he.topP,ye.topP),v.push(he.bottomP,K.bottomN,Q.bottomN),v.push(he.bottomP,Q.bottomN,ye.bottomP)),K=he,Q=ye,Te===Le)for(let Ye=1;Ye<Te;Ye++)he=this._buildBevelVert(O,U,(se+Ye)%N,Ye/(Te-1)),ye=this._buildBevelVert(O,X,(le+Ye)%q,Ye/(Le-1)),v.push(K.topN,he.topP,Q.topN),v.push(Q.topN,he.topP,ye.topP),v.push(he.bottomP,K.bottomN,Q.bottomN),v.push(he.bottomP,Q.bottomN,ye.bottomP),K=he,Q=ye;else if(Te>Le){let Ye=Te/Le,nt=0;for(let H=1;H<Te;H++)he=this._buildBevelVert(O,U,(se+H)%N,H/(Te-1)),v.push(K.topN,he.topP,Q.topN),v.push(he.bottomP,K.bottomN,Q.bottomN),K=he,H>(nt+1)*Ye&&(nt++,ye=this._buildBevelVert(O,X,(le+nt)%q,nt/(Le-1)),v.push(Q.topN,he.topP,ye.topP),v.push(he.bottomP,Q.bottomN,ye.bottomP),Q=ye)}else{let Ye=Le/Te,nt=0;for(let H=1;H<Le;H++)ye=this._buildBevelVert(O,X,(le+H)%q,H/(Le-1)),v.push(Q.topN,he.topP,ye.topP),v.push(he.bottomP,Q.bottomN,ye.bottomP),Q=ye,H>(nt+1)*Ye&&(nt++,he=this._buildBevelVert(O,U,(se+nt)%N,nt/(Te-1)),v.push(K.topN,he.topP,Q.topN),v.push(he.bottomP,K.bottomN,Q.bottomN),K=he)}se=(se+Te)%N,le=(le+Le)%q,ee=(ee+1)%Y}while(ee!==ae)}if(this._buildWall(ne,O,v),E){let V=[];for(let U=v.length-1;U>=z+2;U-=3){let X=v[U-2],N=v[U-1],q=v[U-0];V.push(q,N,X)}v.splice(z,v.length-z,...V)}if(E){let V=[];for(let U=ne[ne.length-1].boundary.vertices.length-1;U>=1;U-=2){let X=ne[ne.length-1].boundary.vertices[U-1],N=ne[ne.length-1].boundary.vertices[U-0];V.push(X,N)}x.push(V)}if(!E){let V=ne[ne.length-1],U=Fa({windingRule:ne.length>1?Yt.POSITIVE:Yt.ODD,elementType:jn.POLYGONS,vertexSize:2,strict:!0,contours:[V.insetPoints,...x]});if(!U)throw new Error("Error generating geometry for surface");a.length===0&&Object.assign(this,{capStartIndex:v.length});for(let X=0;X<U.elementCount*3;X+=3){let N=this._buildSurfaceVert(U,U.elements[X+0]),q=this._buildSurfaceVert(U,U.elements[X+1]),Y=this._buildSurfaceVert(U,U.elements[X+2]);v.push(N.top,q.top,Y.top),v.push(Y.bottom,q.bottom,N.bottom)}}this.vertexCache={}}this._buffer.shrink();let y=new pt(Uint32Array.from(v),1),_=new pt(this._buffer.positions,3),S=new pt(this._buffer.normals,3),b=new pt(this._buffer.uvs,2);_.needsUpdate=!0,S.needsUpdate=!0,b.needsUpdate=!0,y.needsUpdate=!0,this.setAttribute("position",_),this.setAttribute("normal",S),this.setAttribute("uv",b),this.setIndex(y)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e){let n=e.toString();if(n in this.vertexCache)return this.vertexCache[n];let i=t.vertices[e*2+0],r=t.vertices[e*2+1],s=(i-this._minX)/this._width,o=(r-this._minY)/this._height,a=this._buffer.get(2),l=a*3,u=a*2,d={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=i,this._buffer.positions[l+1]=r,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[u+0]=s,this._buffer.uvs[u+1]=o,this._buffer.positions[l+3]=i,this._buffer.positions[l+4]=r,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[u+2]=s,this._buffer.uvs[u+3]=o,this.vertexCache[n]=d,d}_buildBevelVert(t,e,n,i=1){let r=`${e.bevelI}:${n}`;if(r in this.vertexCache)return this.vertexCache[r];let[s,o]=e.boundary.vertexIndices[n],a,l,u,d;s!==o?(l=s,a=o,d=!1,u=t.continuous[l]&&t.continuous[a]):(a=s,l=(a-1+t.count)%t.count,d=t.concave[a]&&e.bevelI>0,u=t.continuous[a]||d);let c=Math.cos(e.angle),h=Math.sin(e.angle),m=n*2,g=a*2,v=l*2,x=e.boundary.vertices[m+0],y=e.boundary.vertices[m+1],_=(1-h)*this._bevelSize,S=(x-this._minX)/this._width,b=(y-this._minY)/this._height,T=t.normals[g+0],E=t.normals[g+1],L=t.normals[v+0],A=t.normals[v+1];if(d){let F=L-T,G=A-E;T=T+F*(1-i),E=E+G*(1-i);let Z=Math.sqrt(T*T+E*E);T/=Z,E/=Z}let I=this._buffer.get(u?2:4),P=I*3,O=I*2,k={i:n,fi:a,topP:I+0,topN:I+0,bottomP:I+1,bottomN:I+1};return this._buffer.positions[P+0]=x,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=this._depth-_,this._buffer.normals[P+0]=T*c,this._buffer.normals[P+1]=E*c,this._buffer.normals[P+2]=h,this._buffer.uvs[O+0]=S,this._buffer.uvs[O+1]=b,this._buffer.positions[P+3]=x,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=_,this._buffer.normals[P+3]=T*c,this._buffer.normals[P+4]=E*c,this._buffer.normals[P+5]=-h,this._buffer.uvs[O+2]=b,this._buffer.uvs[O+3]=S,u||(I+=2,P+=6,O+=4,k.topP=I+0,k.bottomP=I+1,this._buffer.positions[P+0]=x,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=this._depth-_,this._buffer.normals[P+0]=L*c,this._buffer.normals[P+1]=A*c,this._buffer.normals[P+2]=h,this._buffer.uvs[O+0]=S,this._buffer.uvs[O+1]=b,this._buffer.positions[P+3]=x,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=_,this._buffer.normals[P+3]=L*c,this._buffer.normals[P+4]=A*c,this._buffer.normals[P+5]=-h,this._buffer.uvs[O+2]=b,this._buffer.uvs[O+3]=S),this.vertexCache[r]=k,k}clone(){let t=new Rz(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=vy(this.userData),t}},Oz=class extends Rz{constructor(t,e,n=0,i=12,r=3,s=Yt.ODD){super(t,e,n,i,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new Oz(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=vy(this.userData),t}},Uu=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var u,d;let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Yt.ODD},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??n.roundness;o!==void 0&&(o instanceof In?(o.width!==i||o.height!==r)&&o.applySize(i,r):o=new In(i,r).fromJSON(o),((u=t.parameters)==null?void 0:u.roundness)!==void 0&&((d=t.parameters)==null?void 0:d.roundness)>0&&o.update());let l=o??new In(i,r);return{parameters:Object.assign(n,{width:i,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new Iz(t.shape,r,{windingRule:o}):a=new Oz(t.shape,e,n,r,i,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},zz=Math.PI*2,e2=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof In?t.shape:new In,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u=t.shape,d=e*.5,c=n*.5,h=cQ(u,d,c,r*Math.PI/180,i,s);u.isClosed=!0,u.update();let m=Uu.create({shape:u,parameters:{subdivisions:h,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(m,{userData:{...t,type:"EllipseGeometry"}})}};function cQ(t,e,n,i,r,s){if(i>=zz)return r>30||r%4===0?(dQ(t,e,n,s),Math.round(r/4)):rP(t,i,r,e,n,s);i=Math.max(i,.001);let o={x:0,y:n},a=i+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*n},u=sQ({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%u.length===0?hQ(t,o.x,o.y,u,r,e,n,s):rP(t,i,r,e,n,s)}function hQ(t,e,n,i,r,s,o,a){let l=Math.round(r/i.length);t.addPoint(ih(e,n));for(let u=0,d=i.length;u<d;u++){let c=i[u],h=t.points[u],m=ih(c.x,c.y);h.controls[1].position.set(c.x1,c.y1),m.controls[0].position.set(c.x2,c.y2),t.addPoint(m)}return a>0?Nz(t,s,o,a):t.addPoint(ih(0,0)),l}function rP(t,e,n,i,r,s){let o=-e/n;for(let a=0;a<=n;a++){let l=o*a,u=Math.sin(l)*i,d=Math.cos(l)*r;t.addPoint(ih(u,d))}return e<zz?s>0?Nz(t,i,r,s):t.addPoint(ih(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&kz(t,i,r,s)),1}function dQ(t,e,n,i=0,r=0,s=0){let o=.5522847498,a=e*o,l=n*o;t.addPoint(Ug(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(Ug(r,s+n,r-a,s+n,r+a,s+n)),t.addPoint(Ug(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(Ug(r,s-n,r+a,s-n,r-a,s-n)),i>0&&kz(t,e,n,i)}function ih(t,e){return new nh(Sn.generateUUID(),new te(t,e))}function Ug(t,e,n,i,r,s){let o=ih(t,e);return o.controls[0].position.set(n,i),o.controls[1].position.set(r,s),o}function Nz(t,e,n,i){Bz(t,e,n,i).forEach(r=>t.addPoint(r))}function kz(t,e,n,i){let r=Bz(t,e,n,i),s=new In;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function Bz(t,e,n,i){let r=i*e/100,s=r*(Math.abs(n)/Math.abs(e)),o=new te(r/e,s/n),a=t.points.map(l=>{let u=l.clone();return u.uuid=Sn.generateUUID(),u}).reverse();return a.forEach(l=>{l.position.multiply(o);let u=l.controls[0].position.clone().multiply(o),d=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(d),l.controls[1].position.copy(u)}),a}var fQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??i),s=Math.abs(n.depth??i),o=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(n,{width:i,height:r,depth:s,radius:o,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(t){let{width:e,height:n,depth:i,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:u,cornerRadius:d,cornerSegments:c}=t.parameters,h=new t2(!1,e,n,i,r,s,o,a,l,u,d,c);return Object.assign(h,{userData:{...t,type:"HelixGeometry"}})}},t2=class extends Ze{constructor(t=!0,e=1,n=1,i=1,r=1,s=1,o=1,a=1,l=1,u=1,d=1,c=1,h=!1){super();let m=t&&s===1;m&&(c=0),d>100&&(d=100);let g=()=>new R,v=new R,x=g(),y=g(),_=g(),S,b,T,E,L,A,I,P,O=g(),k=g(),F=g(),G=g(),Z=g(),ne=g(),J=g(),z=g(),V=n-2*a+.001,U=V/s,X=Math.ceil(o*s),N=X+1,q=V/X,Y=-V/2,ee=u+1,W=2*Math.PI/u,se=Math.PI/2/c,le=.01,ae=Math.min((1-d/100)*a,a-le),ue=a-ae,fe=0,K=2,Q=c*K+K,he=ee*Q/K,ye=he+ee*N,be=ee*(N+Q),[Te,Le,ze]=[3,3,2].map(We=>Array(be*We).fill(0)),Ye=[],nt=r-a;function H(We,et){let Xe=Math.PI/2;A=et*q,P=2*Math.PI*(A%U)/U+Xe,A+=Y,I=Math.sin(P)*nt,L=Math.cos(P)*nt,t?We.set(L,I,A):We.set(L,A,I)}H(v,-1e-10),H(x,0),O.copy(v),H(v,1);let B=v.distanceTo(x),ge=m?0:ue+ae,Pe=B*X+2*ge,Oe=ae,Be=Pe-ge;for(let We=0;We<=X;We++){H(y,We),z.subVectors(y,O).normalize(),O.copy(y),ne.copy(y).setComponent(+t+1,0).normalize(),J.crossVectors(z,ne).normalize();let et=We===0,Xe=We===X,ut=et?3*Math.PI/2:se,ot=et?Oe:Be,Lt=et?ee:ye,$t=et?0:be-ee,Mn=z.clone().multiplyScalar(et?-ue:ue).add(y),re=z.clone().multiplyScalar(et?-1:1).normalize();for(let _e=0;_e<ee;_e++){let Ie=_e*W;if(k.addVectors(v.copy(ne).multiplyScalar(a*Math.cos(Ie)),x.copy(J).multiplyScalar(a*Math.sin(Ie))),F.copy(k).normalize(),et||Xe){m||(fe=$t+_e,[0,1,2].forEach(Ue=>{Te[fe*3+Ue]=Mn.getComponent(Ue),Le[fe*3+Ue]=re.getComponent(Ue)}),ze[fe*2]=+Xe,ze[fe*2+1]=_e/u),x.copy(F).multiplyScalar(ae),_.addVectors(y,x);for(let Ue=0;Ue<c;Ue++){let tt=Ue*se+ut;G.addVectors(v.copy(z).multiplyScalar(ue*Math.sin(tt)),x.copy(F).multiplyScalar(ue*Math.cos(tt))),Z.copy(G).normalize(),x.addVectors(_,G),G.normalize(),fe=Lt+Ue*ee+_e,[0,1,2].forEach(rn=>{Te[fe*3+rn]=x.getComponent(rn),Le[fe*3+rn]=Z.getComponent(rn)});let Ot=+et+Math.sin(tt);ze[fe*2]=(ot+ue*Ot)/Pe,ze[fe*2+1]=_e/u}}x.addVectors(y,k),fe=he+We*ee+_e,[0,1,2].forEach(Ue=>{Te[fe*3+Ue]=x.getComponent(Ue),Le[fe*3+Ue]=F.getComponent(Ue)}),ze[fe*2]=(ge+We*B)/Pe,ze[fe*2+1]=_e/u}}let ht=N+2*c+K,[He,Me]=[+m,ht-1];h&&(Me-=1);for(let We=He;We<=Me-1;We++){let et=m&&We===Me-1;for(let Xe=0;Xe<ee-1;Xe++)S=We*ee+Xe,b=S+1,T=(et?Xe:S)+ee,E=(et?Xe+1:b)+ee,We===0?Ye.push(b,E,T):We===ht-2?Ye.push(S,b,T):Ye.push(S,b,T,b,E,T)}this.setIndex(Ye),this.setAttribute("position",new De(Te,3)),this.setAttribute("normal",new De(Le,3)),this.setAttribute("uv",new De(ze,2))}},pQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new Uz(e*.5,s,o):new Oh(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},Uz=class extends JM{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,n),this.type=o}static fromJSON(t){return new Uz(t.radius,t.corner,t.cornerSides)}},mQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var i;(((i=t.parameters)==null?void 0:i.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{points:e,segments:n,verticalSegments:i}=t.parameters,r=new Ls;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new Iu(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},Ks=new Fe,t_=new Pt,Fg=new R,bv=class extends po{constructor(){super(),this.uuid=Sn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new Jn().getNormalMatrix(t);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return Ks.makeRotationX(t),this.applyMatrix4(Ks),this}rotateY(t){return Ks.makeRotationY(t),this.applyMatrix4(Ks),this}rotateZ(t){return Ks.makeRotationZ(t),this.applyMatrix4(Ks),this}translate(t,e,n){return Ks.makeTranslation(t,e,n),this.applyMatrix4(Ks),this}scale(t,e,n){return Ks.makeScale(t,e,n),this.applyMatrix4(Ks),this}lookAt(t){return t_.lookAt(t),t_.updateMatrix(),this.applyMatrix4(t_.matrix),this}fromBufferGeometry(t){let e=this,n=t.index!==null?t.index:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,o=i.color,a=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let c=0;c<r.count;c++)e.vertices.push(new R().fromBufferAttribute(r,c)),o!==void 0&&e.colors.push(new Ge().fromBufferAttribute(o,c));function u(c,h,m,g){let v=o===void 0?[]:[e.colors[c].clone(),e.colors[h].clone(),e.colors[m].clone()],x=s===void 0?[]:[new R().fromBufferAttribute(s,c),new R().fromBufferAttribute(s,h),new R().fromBufferAttribute(s,m)],y=new PS(c,h,m,x,v,g);e.faces.push(y),a!==void 0&&e.faceVertexUvs[0].push([new te().fromBufferAttribute(a,c),new te().fromBufferAttribute(a,h),new te().fromBufferAttribute(a,m)]),l!==void 0&&e.faceVertexUvs[1].push([new te().fromBufferAttribute(l,c),new te().fromBufferAttribute(l,h),new te().fromBufferAttribute(l,m)])}let d=t.groups;if(d.length>0)for(let c=0;c<d.length;c++){let h=d[c],m=h.start,g=h.count;for(let v=m,x=m+g;v<x;v+=3)n!==void 0?u(n.getX(v),n.getX(v+1),n.getX(v+2),h.materialIndex):u(v,v+1,v+2,h.materialIndex)}else if(n!==void 0)for(let c=0;c<n.count;c+=3)u(n.getX(c),n.getX(c+1),n.getX(c+2));else for(let c=0;c<r.count;c+=3)u(c,c+1,c+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Fg).negate(),this.translate(Fg.x,Fg.y,Fg.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,n=e===0?1:1/e,i=new Fe;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let t=new R,e=new R;for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)e[n]=new R;if(t){let n=new R,i=new R;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],u=this.vertices[o.c];n.subVectors(u,l),i.subVectors(a,l),n.cross(i),e[o.a].add(n),e[o.b].add(n),e[o.c].add(n)}}else{this.computeFaceNormals();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)e[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let r=0,s=i.vertexNormals.length;r<s;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}let t=new bv;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new R,u={a:new R,b:new R,c:new R};r.push(l),s.push(u)}}let i=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=i.faceNormals[r],l=i.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ar),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mr),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,n=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let i,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,u=this.colors,d=t.colors;e!==void 0&&(i=new Jn().getNormalMatrix(e));for(let c=0,h=o.length;c<h;c++){let m=o[c].clone();e!==void 0&&m.applyMatrix4(e),s.push(m)}for(let c=0,h=d.length;c<h;c++)u.push(d[c].clone());for(let c=0,h=l.length;c<h;c++){let m=l[c],g,v,x=m.vertexNormals,y=m.vertexColors,_=new PS(m.a+r,m.b+r,m.c+r);_.normal.copy(m.normal),i!==void 0&&_.normal.applyMatrix3(i).normalize();for(let S=0,b=x.length;S<b;S++)g=x[S].clone(),i!==void 0&&g.applyMatrix3(i).normalize(),_.vertexNormals.push(g);_.color.copy(m.color);for(let S=0,b=y.length;S<b;S++)v=y[S],_.vertexColors.push(v.clone());_.materialIndex=m.materialIndex+n,a.push(_)}for(let c=0,h=t.faceVertexUvs.length;c<h;c++){let m=t.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let g=0,v=m.length;g<v;g++){let x=m[g],y=[];for(let _=0,S=x.length;_<S;_++)y.push(x[_].clone());this.faceVertexUvs[c].push(y)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},n=[],i=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let u=this.vertices[a],d=Math.round(u.x*r)+"_"+Math.round(u.y*r)+"_"+Math.round(u.z*r);e[d]===void 0?(e[d]=a,n.push(this.vertices[a]),i[a]=n.length-1):i[a]=i[e[d]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let u=this.faces[a];u.a=i[u.a],u.b=i[u.b],u.c=i[u.c];let d=[u.a,u.b,u.c];for(let c=0;c<3;c++)if(d[c]===d[(c+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let u=0,d=this.faceVertexUvs.length;u<d;u++)this.faceVertexUvs[u].splice(l,1)}let o=this.vertices.length-n.length;return this.vertices=n,o}setFromPoints(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){let i=t[e];this.vertices.push(new R(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function n(a,l){return a.materialIndex-l.materialIndex}t.sort(n);let i=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;i&&i.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(i[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let m=this.parameters;for(let g in m)m[g]!==void 0&&(t[g]=m[g]);return t}let e=[];for(let m=0;m<this.vertices.length;m++){let g=this.vertices[m];e.push(g.x,g.y,g.z)}let n=[],i=[],r={},s=[],o={},a=[],l={};for(let m=0;m<this.faces.length;m++){let g=this.faces[m],v=!0,x=!1,y=this.faceVertexUvs[0][m]!==void 0,_=g.normal.length()>0,S=g.vertexNormals.length>0,b=g.color.r!==1||g.color.g!==1||g.color.b!==1,T=g.vertexColors.length>0,E=0;if(E=u(E,0,0),E=u(E,1,v),E=u(E,2,x),E=u(E,3,y),E=u(E,4,_),E=u(E,5,S),E=u(E,6,b),E=u(E,7,T),n.push(E),n.push(g.a,g.b,g.c),n.push(g.materialIndex),y){let L=this.faceVertexUvs[0][m];n.push(h(L[0]),h(L[1]),h(L[2]))}if(_&&n.push(d(g.normal)),S){let L=g.vertexNormals;n.push(d(L[0]),d(L[1]),d(L[2]))}if(b&&n.push(c(g.color)),T){let L=g.vertexColors;n.push(c(L[0]),c(L[1]),c(L[2]))}}function u(m,g,v){return v?m|1<<g:m&~(1<<g)}function d(m){let g=m.x.toString()+m.y.toString()+m.z.toString();return r[g]!==void 0||(r[g]=i.length/3,i.push(m.x,m.y,m.z)),r[g]}function c(m){let g=m.r.toString()+m.g.toString()+m.b.toString();return o[g]!==void 0||(o[g]=s.length,s.push(m.getHex())),o[g]}function h(m){let g=m.x.toString()+m.y.toString();return l[g]!==void 0||(l[g]=a.length/2,a.push(m.x,m.y)),l[g]}return t.data={},t.data.vertices=e,t.data.normals=i,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=n,t}clone(){return new bv().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let c=0,h=e.length;c<h;c++)this.vertices.push(e[c].clone());let n=t.colors;for(let c=0,h=n.length;c<h;c++)this.colors.push(n[c].clone());let i=t.faces;for(let c=0,h=i.length;c<h;c++)this.faces.push(i[c].clone());for(let c=0,h=t.faceVertexUvs.length;c<h;c++){let m=t.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let g=0,v=m.length;g<v;g++){let x=m[g],y=[];for(let _=0,S=x.length;_<S;_++){let b=x[_];y.push(b.clone())}this.faceVertexUvs[c].push(y)}}let r=t.morphTargets;for(let c=0,h=r.length;c<h;c++){let m={};if(m.name=r[c].name,r[c].vertices!==void 0){m.vertices=[];for(let g=0,v=r[c].vertices.length;g<v;g++)m.vertices.push(r[c].vertices[g].clone())}if(r[c].normals!==void 0){m.normals=[];for(let g=0,v=r[c].normals.length;g<v;g++)m.normals.push(r[c].normals[g].clone())}this.morphTargets.push(m)}let s=t.morphNormals;for(let c=0,h=s.length;c<h;c++){let m={};if(s[c].vertexNormals!==void 0){m.vertexNormals=[];for(let g=0,v=s[c].vertexNormals.length;g<v;g++){let x=s[c].vertexNormals[g],y={};y.a=x.a.clone(),y.b=x.b.clone(),y.c=x.c.clone(),m.vertexNormals.push(y)}}if(s[c].faceNormals!==void 0){m.faceNormals=[];for(let g=0,v=s[c].faceNormals.length;g<v;g++)m.faceNormals.push(s[c].faceNormals[g].clone())}this.morphNormals.push(m)}let o=t.skinWeights;for(let c=0,h=o.length;c<h;c++)this.skinWeights.push(o[c].clone());let a=t.skinIndices;for(let c=0,h=a.length;c<h;c++)this.skinIndices.push(a[c].clone());let l=t.lineDistances;for(let c=0,h=l.length;c<h;c++)this.lineDistances.push(l[c]);let u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());let d=t.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new gQ().fromGeometry(this),e=new Ze,n=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",Vg.call(new pt(n,3),t.vertices)),t.normals.length>0){let i=new Float32Array(t.normals.length*3);e.setAttribute("normal",Vg.call(new pt(i,3),t.normals))}if(t.colors.length>0){let i=new Float32Array(t.colors.length*3);e.setAttribute("color",sP.call(new pt(i,3),t.colors))}if(t.uvs.length>0){let i=new Float32Array(t.uvs.length*2);e.setAttribute("uv",oP.call(new pt(i,2),t.uvs))}if(t.uvs2.length>0){let i=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",oP.call(new pt(i,2),t.uvs2))}e.groups=t.groups;for(let i in t.morphTargets){let r=[],s=t.morphTargets[i];for(let o=0,a=s.length;o<a;o++){let l=s[o],u=new De(l.data.length*3,3);u.name=l.name,r.push(Vg.call(u,l.data))}e.morphAttributes[i]=r}if(t.skinIndices.length>0){let i=new De(t.skinIndices.length*4,4);e.setAttribute("skinIndex",aP.call(i,t.skinIndices))}if(t.skinWeights.length>0){let i=new De(t.skinWeights.length*4,4);e.setAttribute("skinWeight",aP.call(i,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Ze,n=t.geometry;if(t.isPoints||t.isLine){let i=new De(n.vertices.length*3,3),r=new De(n.colors.length*3,3);if(e.setAttribute("position",Vg.call(i,n.vertices)),e.setAttribute("color",sP.call(r,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let s=new De(n.lineDistances.length,1);e.setAttribute("lineDistance",vQ.call(s,n.lineDistances))}n.boundingSphere!==null&&(e.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(e.boundingBox=n.boundingBox.clone())}else t.isMesh&&(e=n.toBufferGeometry());return e}};bv.prototype.isGeometry=!0;var gQ=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],n,i,r,s=t.faces;for(i=0;i<s.length;i++){let o=s[i];o.materialIndex!==r&&(r=o.materialIndex,n!==void 0&&(n.count=i*3-n.start,e.push(n)),n={start:i*3,materialIndex:r})}n!==void 0&&(n.count=i*3-n.start,e.push(n)),this.groups=e}fromGeometry(t){let e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let x=0;x<a;x++)l[x]={name:o[x].name,data:[]};this.morphTargets.position=l}let u=t.morphNormals,d=u.length,c;if(d>0){c=[];for(let x=0;x<d;x++)c[x]={name:u[x].name,data:[]};this.morphTargets.normal=c}let h=t.skinIndices,m=t.skinWeights,g=h.length===n.length,v=m.length===n.length;n.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let x=0;x<e.length;x++){let y=e[x];this.vertices.push(n[y.a],n[y.b],n[y.c]);let _=y.vertexNormals;if(_.length===3)this.normals.push(_[0],_[1],_[2]);else{let b=y.normal;this.normals.push(b,b,b)}let S=y.vertexColors;if(S.length===3)this.colors.push(S[0],S[1],S[2]);else{let b=y.color;this.colors.push(b,b,b)}if(r===!0){let b=i[0][x];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",x),this.uvs.push(new te,new te,new te))}if(s===!0){let b=i[1][x];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",x),this.uvs2.push(new te,new te,new te))}for(let b=0;b<a;b++){let T=o[b].vertices;l[b].data.push(T[y.a],T[y.b],T[y.c])}for(let b=0;b<d;b++){let T=u[b].vertexNormals[x];c[b].data.push(T.a,T.b,T.c)}g&&this.skinIndices.push(h[y.a],h[y.b],h[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},PS=class{constructor(t,e,n,i,r,s=0){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new R,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Ge,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function vQ(t){return this.array.set(t),this}function sP(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Ge),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}function oP(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new te),e[n++]=s.x,e[n++]=s.y}return this}function Vg(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new R),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}function aP(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new _t),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}var yQ=["a","b","c"];function xQ(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function n_(t,e,n){let i=Math.min(t,e),r=Math.max(t,e),s=i+"_"+r;return n.get(s)}function i_(t,e,n,i,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,u;if(i.has(l))u=i.get(l);else{let d=n[o],c=n[a];u={a:d,b:c,newEdge:null,faces:[]},i.set(l,u)}u.faces.push(r),s[t].edges.push(u),s[e].edges.push(u)}function _Q(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;r++)n[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],i_(o.a,o.b,t,i,o,n),i_(o.b,o.c,t,i,o,n),i_(o.c,o.a,t,i,o,n)}function Gg(t,e,n,i,r){t.push(new PS(e,n,i,void 0,void 0,r))}function xc(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function Hg(t,e,n,i){t.push([e.clone(),n.clone(),i.clone()])}var wQ=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Ze?t=new bv().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new R,n,i,r,s,o,a=t.vertices,l=t.faces,u=t.faceVertexUvs[0],d=u!==void 0&&u.length>0,c=[],h=new Map;_Q(a,l,c,h);let m=[],g,v,x,y,_,S,b;for(let se of Array.from(h.keys())){for(v=h.get(se),x=new R,_=3/8,S=1/8,b=v.faces.length,b!=2&&(_=.5,S=0,b!=1),x.addVectors(v.a,v.b).multiplyScalar(_),e.set(0,0,0),s=0;s<b;s++){for(y=v.faces[s],o=0;o<3&&(g=a[xQ(y,yQ[o])],!(g!==v.a&&g!==v.b));o++);g&&e.add(g)}e.multiplyScalar(S),x.add(e),v.newEdge=m.length,m.push(x)}let T,E,L,A,I,P,O,k=[];for(i=0,r=a.length;i<r;i++){for(P=a[i],I=c[i].edges,n=I.length,n==3?T=3/16:n>3&&(T=3/(8*n)),E=1-n*Number(T),L=T,n<=2&&(n==2?(E=3/4,L=1/8):n==1||n==0),O=P.clone().multiplyScalar(E),e.set(0,0,0),s=0;s<n;s++)A=I[s],g=A.a!==P?A.a:A.b,e.add(g);e.multiplyScalar(Number(L)),O.add(e),k.push(O)}let F=k.concat(m),G=k.length,Z,ne,J,z=[],V=[],U,X,N,q,Y=new te,ee=new te,W=new te;for(i=0,r=l.length;i<r;i++)y=l[i],Z=Number(n_(y.a,y.b,h).newEdge)+G,ne=Number(n_(y.b,y.c,h).newEdge)+G,J=Number(n_(y.c,y.a,h).newEdge)+G,Gg(z,Z,ne,J,y.materialIndex),Gg(z,y.a,Z,J,y.materialIndex),Gg(z,y.b,ne,Z,y.materialIndex),Gg(z,y.c,J,ne,y.materialIndex),d&&(U=u[i],X=U[0],N=U[1],q=U[2],Y.set(xc(X.x,N.x),xc(X.y,N.y)),ee.set(xc(N.x,q.x),xc(N.y,q.y)),W.set(xc(X.x,q.x),xc(X.y,q.y)),Hg(V,Y,ee,W),Hg(V,X,Y,W),Hg(V,N,ee,Y),Hg(V,q,W,ee));t.vertices=F,t.faces=z,d&&(t.faceVertexUvs[0]=V)}},Xn=new R,SQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=t.geometry??(e==null?void 0:e.geometry)??new Ze().copy(new or(100,100,100)),i;e===void 0?(n.computeBoundingBox(),n.boundingBox.getSize(Xn),i={width:Xn.x,height:Xn.y,depth:Xn.z,subdivisions:0}):i=e.parameters;let r={...i,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:n}}static build(t){let{width:e,height:n,depth:i,subdivisions:r}=t.parameters,s=t.geometry??new Ze().copy(new or(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Xn)):Xn.set(o.width,o.height,o.depth),(e!==Xn.x||n!==Xn.y||i!==Xn.z)&&s.scale(Xn.x===0?1:e/Xn.x,Xn.y===0?1:n/Xn.y,Xn.z===0?1:i/Xn.z);let a=s.originalGeometry;return r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new wQ(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()),a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,n){new ry(n).load(t,i=>{let r=this.normalizeInputs({geometry:i});i.boundingBox.getSize(Xn);let s=100/Xn.x;Object.assign(r.parameters,{width:100,height:Xn.y*s,depth:Xn.z*s}),e(this.build(r))})}},Fz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof In?t.shape:new In,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,u=e*.5,d=n*.5,c=0,h=0,m=2*Math.PI/i;for(let v=0;v<i;v++){let x=m*v,y=c+Math.sin(x)*u,_=h+Math.cos(x)*d;l.addPoint(l.createPoint(y,_))}l.isClosed=!0;for(let v=0,x=l.points.length;v<x;v++)l.points[v].roundness=r;l.roundness=r,l.update();let g=Uu.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(g,{userData:{...t,type:"PolygonGeometry"}})}},bQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=new EQ(e*.5,n,r,s,o,a,l);return u.scale(1,1,i/e),Object.assign(u,{userData:{...t,type:"PyramidGeometry"}})}};function Vd(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function r_(t,e,n,i,r,s){let o=e.clone().sub(t),a=n.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),i===r){let u=o.add(a).normalize();s.copy(t).addScaledVector(u,i/Math.sin(l/2))}else{let u=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(u)),s.addScaledVector(a,i/Math.sin(u))}}function MQ(t,e,n){let i=t.clone().sub(e),r=n.clone().sub(e);return i.projectOnVector(r),i.add(e)}var EQ=class extends Ze{constructor(t=.5,e=1,n=4,i=1,r=!1,s=0,o=4){super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),o=Math.floor(o);let a=[],l=[],u=[],d=[],c=0,h=e/2,m=Math.PI/n,g=t*Math.cos(Math.PI/n),v=2*Math.PI/n,x=(n-2)*Math.PI/n,y=Math.PI-x,_=new R(0,-h,0),S=new R(0,h,0),b=new te(t,-h),T=new te(g,-h),E=new te(0,S.y).sub(T),L=new te(0,S.y).sub(b),A=new te(E.y,-E.x).normalize(),I=new te(L.y,-L.x).normalize(),P=t*Math.cos(Math.PI/n)*Math.tan((Math.PI-E.angle())/2)-1e-8;s=Math.min(s,P);let O;{let J=new R(A.x,A.y,0),z=new R(Math.cos(v)*J.x,J.y,Math.sin(v)*J.x);O=J.angleTo(z)}let k=s/Math.tan((Math.PI-E.angle())/2),F=s/Math.tan((Math.PI-O)/2),G=new R;if(!r){l.push(_.x,_.y,_.z),u.push(0,-1,0),d.push(0,0);let J=c++,z=[],V=b.clone(),U=k/Math.cos(Math.PI/n);V.x-=U;for(let X=0;X<n;X++){let N=X/n*Math.PI*2+m,q=new te(Math.sin(N),Math.cos(N));Vd(V,q,G),l.push(G.x,G.y,G.z),u.push(0,-1,0),d.push(0,0),z.push(c++)}for(let X=0;X<z.length;X++)a.push(z[X],J,z[(X+1)%z.length])}{let J=new R,z=new R,V=new R,U=new R,X=new R,N=new R;for(let q=0;q<n;q++){let Y=q/n*Math.PI*2+m,ee=(q+.5)/n*Math.PI*2+m,W=(q+1)/n*Math.PI*2+m,se=new te(Math.sin(Y),Math.cos(Y)),le=new te(Math.sin(ee),Math.cos(ee)),ae=new te(Math.sin(W),Math.cos(W));Vd(b,se,z),Vd(b,ae,V),Vd(A,le,J),r_(S,z,V,F,F,U),l.push(U.x,U.y,U.z),r_(z,S,V,F,k,X),l.push(X.x,X.y,X.z),r_(V,z,S,k,F,N),l.push(N.x,N.y,N.z),u.push(J.x,J.y,J.z),u.push(J.x,J.y,J.z),u.push(J.x,J.y,J.z),d.push(0,0),d.push(0,0),d.push(0,0);let ue=c++,fe=c++,K=c++;if(a.push(ue,fe,K),s>0){{let ye=z.clone().add(V).multiplyScalar(.5),be=S.clone().sub(ye).normalize(),Te=_.clone().sub(ye).normalize().add(be).normalize().multiplyScalar(-1),Le=N.clone().sub(X);Z(ye,Le,Te,E.angle())}let Q,he;{let ye=new R;Vd(I,ae,ye);let be=N.clone().add(U).multiplyScalar(.5);be=MQ(be,V,S);let Te=N.clone().sub(U);[Q,he]=Z(be,Te,ye,O,U.y)}{let ye=Q,be=ye.clone().setY(0).normalize(),Te=new R(0,-1,0),Le=be.clone().cross(Te);ne(ye,be,Te,Le)}{let ye=E.angle(),be=Math.PI-ye,Te=S.clone();Te.y-=s/Math.sin(ye-Math.PI/2);let Le=new R,ze=[];for(let nt=0;nt<o;nt++){let H=[],B=Math.PI/2-be*nt/o,ge=Math.cos(B),Pe=Math.sin(B),Oe=ee;for(let Be=0;Be<=nt;Be++){let ht=Math.cos(Oe),He=Math.sin(Oe);J.x=ge*He,J.y=Pe,J.z=ge*ht,Le.copy(Te).addScaledVector(J,s),l.push(Le.x,Le.y,Le.z),u.push(J.x,J.y,J.z),d.push(0,0),H.push(c++),Oe+=Math.PI*2/nt/n}ze.push(H)}he.reverse(),ze.push(he);let Ye=ze.length-1;for(let nt=0;nt<Ye;nt++){let H=ze[nt],B=ze[nt+1],ge=H.length-1;a.push(B[1],H[0],B[0]);for(let Pe=1;Pe<=ge;Pe++)a.push(H[Pe],H[Pe-1],B[Pe]),a.push(B[Pe+1],H[Pe],B[Pe])}}}}}this.setIndex(a),this.setAttribute("position",new De(l,3)),this.setAttribute("normal",new De(u,3)),this.setAttribute("uv",new De(d,2));function Z(J,z,V,U,X){let N=-U/2,q=(Math.PI-U)/2,Y=z.clone().normalize().cross(V);J.addScaledVector(V,-s/Math.sin(q));let ee=new R,W=new R,se=1,le=c,ae=[];for(let ue=0;ue<=o;ue++){let fe=N+ue/o*U;W.set(0,0,0),W.addScaledVector(Y,Math.sin(fe)),W.addScaledVector(V,Math.cos(fe));for(let K=0;K<=se;K++){let Q=K/se-.5;if(ee.copy(J),ee.addScaledVector(z,Q),ee.addScaledVector(W,s),X!=null){let he=Math.max(0,ee.y-X);ee.addScaledVector(z,-he/z.y)}l.push(ee.x,ee.y,ee.z),u.push(W.x,W.y,W.z),d.push(0,0),K===0&&ae.push(c),c++}}for(let ue=0;ue<o;ue++)for(let fe=0;fe<se;fe++){let K=le+fe+(se+1)*ue,Q=K+(se+1),he=Q+1,ye=K+1;a.push(K,Q,ye),a.push(Q,he,ye)}return[J.clone().addScaledVector(z,.5),ae]}function ne(J,z,V,U){let X=Math.PI/2,N=L.angle()-X,q=[],Y=new R,ee=new R;for(let se=0;se<=o;se++){let le=[],ae=se/o;for(let ue=0;ue<=se;ue++){let fe=((se?ue/se:0)-.5)*y,K=Math.cos(fe),Q=Math.sin(fe),he=Math.atan(Math.tan(N)*K),ye=(X+he)*ae,be=Math.cos(ye),Te=Math.sin(ye);Y.set(0,0,0),Y.addScaledVector(z,Te*K),Y.addScaledVector(V,be),Y.addScaledVector(U,Te*Q),ee.copy(J).addScaledVector(Y,s),l.push(ee.x,ee.y,ee.z),u.push(Y.x,Y.y,Y.z),d.push(0,0),le.push(c++)}q.push(le)}let W=q.length-1;for(let se=0;se<W;se++){let le=q[se],ae=q[se+1],ue=le.length-1;a.push(le[0],ae[1],ae[0]);for(let fe=1;fe<=ue;fe++)a.push(le[fe-1],le[fe],ae[fe]),a.push(le[fe],ae[fe+1],ae[fe])}}}},Vz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),i=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof In?t.shape:new In,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:i}}static build(t){let e=t.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,u={x:n*.5,y:i*.5},d={x:-u.x,y:-u.y},c={x:u.x,y:u.y};function h(b,T,E){return T>n&&E>i?Math.min(b*n/T,b*i/E):T>n?b*n/T:E>i?b*i/E:b}let m=[];m[0]=r[0]===0?0:h(r[0],r[0]+r[3],r[0]+r[1]),m[1]=r[1]===0?0:h(r[1],r[1]+r[2],r[1]+r[0]),m[2]=r[2]===0?0:h(r[2],r[2]+r[1],r[2]+r[3]),m[3]=r[3]===0?0:h(r[3],r[3]+r[0],r[3]+r[2]);let g=d.x,v=c.x,x=c.y,y=d.y;e.addPoint(e.createPoint(g,x)),e.addPoint(e.createPoint(v,x)),e.addPoint(e.createPoint(v,y)),e.addPoint(e.createPoint(g,y)),e.isClosed=!0;let _=!0;for(let b=0,T=e.points.length;b<T;b++)e.points[b].roundness=m[b],b>0&&m[b]!==m[b-1]&&(_=!1);_&&(e.roundness=m[0]),e.useCubicForRoundedCorners=s!==1,e.update();let S=Uu.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(S,{userData:{...t,type:"RectangleGeometry"}})}},AQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e=100,height:n=e,depth:i=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:u}=t.parameters,d=new Du(.5*e,r,s,o,a,l,u);return d.scale(1,n/e,i/e),Object.assign(d,{userData:{...t,type:"SphereGeometry"}})}},TQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(t){let{width:e=100,height:n=e,widthSegments:i=8,heightSegments:r=8}=t.parameters,s=new dl(e,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},CQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new PQ(e,n,i,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},PQ=class extends Ze{constructor(t=1,e=1,n=1,i=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],u=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-u,i),i*=Math.PI/180;let d=[],c=Math.PI/2,h=(se=0,le=0,ae=0)=>new R(se,le,ae),m=h(),g=h(),[v,x,y]=[e/2,t/2,n/2],_=-x,S=+x,[b,T,E]=[h(_,-v,+y),h(_,-v,-y),h(_,+v,-y)],L=(se,le=!1)=>Math.sin(se-Math.PI/(1+ +le)),A=(se,le=!1)=>Math.cos(se-Math.PI/(1+ +le));E.y=Math.sin(i)*e-v;let I=Math.cos(i)*e-y,P=b.z-u;i<=c?(E.z=Math.min(I,P),E.z==P&&(E.y-=(I-P)/Math.tan(c-i))):T.z=Math.min(T.z-I-y,b.z-u),m.subVectors(b,T),g.subVectors(E,T);let O=Math.min(m.length(),g.length())*r/100,k=O*Math.tan(i/2),F=O/Math.cos(i/2),G=m.clone().normalize().add(g.normalize()).setLength(F).add(T);m.set(0,L(i,!0),A(i,!0)),d.push([E,m.clone()]);let Z=(Math.PI-i)/s;for(let se=0;se<=s;se++){let le=c+i+se*Z;m.set(0,Math.sin(le)*k,Math.cos(le)*k),m.add(G),g.set(0,L(le),A(le)),d.push([m.clone(),g.clone()])}d.push([b,h(0,1,0)]);let ne=Math.sin(Z/2)*k*2,J=d.length-1,z=d[0][0].distanceTo(d[1][0]),V=d[J-1][0].distanceTo(d[J][0]),U=z+ne*s+V;d[0].push(1);for(let se=0;se<=s;se++)d[se+1].push(1-(z+se*ne)/U);d[J].push(0);let[X,N,q]=d[0],Y,ee,W;for(let se=1;se<d.length;se++)[Y,ee,W]=d[se],o.push(_,X.y,X.z,_,Y.y,Y.z,S,X.y,X.z,S,X.y,X.z,_,Y.y,Y.z,S,Y.y,Y.z),a.push(0,N.y,N.z,0,ee.y,ee.z,0,N.y,N.z,0,N.y,N.z,0,ee.y,ee.z,0,ee.y,ee.z),l.push(0,q,0,W,1,q,1,q,0,W,1,W),[X,N,q]=[Y,ee,W];this.setAttribute("position",new De(o,3)),this.setAttribute("normal",new De(a,3)),this.setAttribute("uv",new De(l,2))}},Gz=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof In?t.shape:new In,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}=t.parameters,d=t.shape,c=e*.5,h=n*.5,m=0,g=0,v=o*Math.PI/360/r,x=Math.PI/2*3*-1,y=c*i/100,_=h*i/100;if(r===3&&i===50){v=2*Math.PI/r;for(let b=0;b<r;b++){let T=v*b,E=m+Math.sin(T)*c,L=g+Math.cos(T)*h;d.addPoint(d.createPoint(E,L))}}else for(let b=0;b<r;b++){let T=m+Math.cos(x)*c,E=g+Math.sin(x)*h;d.addPoint(d.createPoint(T,E)),x+=v,T=m+Math.cos(x)*y,E=g+Math.sin(x)*_,d.addPoint(d.createPoint(T,E)),x+=v}d.isClosed=!0;for(let b=0,T=d.points.length;b<T;b++)d.points[b].roundness=s;d.roundness=s,d.update();let S=Uu.create({shape:d,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:u}});return Object.assign(S,{userData:{...t,type:"StarGeometry"}})}},LQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n}=t.parameters,i=new dl(e,n);return Object.assign(i,{userData:{...t,type:"TextFrameGeometry"}})}},IQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.round(Math.abs(n.depth??n.width*.25));return{parameters:Object.assign(n,{width:i,height:r,depth:s})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,u=DQ(e,n,i,e*.5,o,s,0,0,r,a,l);return u.scale(1,n/e,1),Object.assign(u,{userData:{...t,type:"TorusGeometry"}})}};function DQ(t,e,n,i,r,s,o,a,l,u,d){return[e,n]=[n,e],o=e/2,r/=2*Math.PI,r==1&&(u=0),new t2(!0,t,e,n,i,r,s,o,a,l,u,d)}var RQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??n.width*.125})}}static build(t){let{width:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==n&&(a-=n);let l=new Nh(a,n,i,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},OQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof In?t.shape:new In,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,u=e*.5,d=n*.5;a?(l.addPoint(l.createPoint(-u,d)),l.addPoint(l.createPoint(u,-d)),l.addPoint(l.createPoint(-u,-d))):(l.addPoint(l.createPoint(0,d)),l.addPoint(l.createPoint(u,-d)),l.addPoint(l.createPoint(-u,-d))),l.isClosed=!0;for(let h=0,m=l.points.length;h<m;h++)l.points[h].roundness=i;l.roundness=i,l.update();let c=Uu.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(c,{userData:{...t,type:"TriangleGeometry"}})}};function zQ(t,e){let n=2*Math.PI;return(t%n+n)%n===(e%n+n)%n}function NQ(t,e,n){let i=[new R,new R,new R],r=[new R,new R,new R];return t.extractBasis(i[0],i[1],i[2]),e.extractBasis(r[0],r[1],r[2]),i.forEach((s,o)=>{let a=r[o],l=Sn.lerp(s.length(),a.length(),n);s.lerp(a,n).setLength(l)}),new Fe().makeBasis(i[0],i[1],i[2])}var kQ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=(e==null?void 0:e.shapeData)??e2.create({parameters:WO}).userData.shape;return{path:t.path??hv.defaultData(),parameters:Object.assign(n,{width:i,height:r,depth:s,extrusion:{...jO,...n.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new BQ(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Ze,{userData:{...t,type:"PathGeometry"}})}},BQ=class extends Ze{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!zQ(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:n,offset:i}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(i*r),o=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],u=[];for(let P=0;P<a;P++){let O=this.inputs.path.isClosed?(P+s)%t.length:Math.min(P+s,t.length-1);l.push(t[O].clone()),u.push(e[O].clone())}let d=(P,O,k)=>{l[P]=l[P].clone().lerp(l[O],k),u[P]=NQ(u[P],u[O],k)},c=0,h=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(h||i===0)&&(c=h,d(0,1,c));let m=0,g=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&g&&(m=g,d(l.length-1,l.length-2,1-m)),n===0){let P=l.length-1;l[P].copy(l[0]),u[P].copy(u[0])}this._applyPathModifiers(u,c,m);let{regions:v,infos:x,vertices:y}=this._computeShapePoints(5),_=0,S=0;x.sort((P,O)=>P.start-O.start),x.forEach(P=>{P.verticesStart=_,P.verticesCount=P.continuous.reduce((O,k,F)=>O+(F===0||!k?2:1),0),S+=P.verticesCount,_=S});let b=S*a,T,E=0;this._isOpenEnded()&&(T=Fa({windingRule:Yt.ODD,elementType:jn.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:v}),E=T.vertexCount);let L=b+2*E,A={positions:new Float32Array(L*3),normals:new Float32Array(L*3),uvs:new Float32Array(L*2)},I=[];x.forEach(P=>{this._extrudeRegion(P,y,u,l,A,I,this._isGeometryClosed()&&!this._isOpenEnded())}),T&&(this._closeEnd(T,b,I,A,u[0],l[0],!1),this._closeEnd(T,b+E,I,A,u[u.length-1],l[l.length-1],!0)),this.setAttribute("position",new pt(A.positions,3)),this.setAttribute("normal",new pt(A.normals,3)),this.setAttribute("uv",new pt(A.uvs,2)),this.setIndex(I)}_extractPathPoints(){let t=Mz(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(n=>{e[e.length-1].distanceToSquared(n)>.001&&e.push(n)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],n=t.length,i=this.inputs.path.isClosed,r=new R,s=new R,o=new R,a=new R,l=new R(0,1,0);for(let g=0;g<n;g++){let v=t[g],x;g===0?x=i?t[t.length-2]:v.clone().multiplyScalar(2).sub(t[1]):x=t[g-1];let y;g===n-1?y=i?t[1]:v.clone().multiplyScalar(2).sub(t[g-1]):y=t[g+1];let _=v.clone().sub(x).normalize(),S=y.clone().sub(v).normalize(),b=_.clone().add(S).normalize();o.copy(b),g===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let T=l.clone().cross(b).normalize(),E=b.clone().cross(T).normalize();l.copy(E),a.copy(T),g===0&&(r.copy(E),s.copy(b));let L=new Fe().makeBasis(T,E,b);e.push(L)}let u=i?s:o,d=i?r:new R(0,1,0),c=u.clone().cross(a).normalize(),h=Math.acos(d.dot(c));if(isNaN(h))return e;let m=d.clone().cross(c);u.dot(m)>0&&(h*=-1);for(let g=1;g<e.length;g++){let v=new Fe().makeRotationZ(h*g/e.length);e[g].multiply(v)}return e}_applyPathModifiers(t,e,n){let i=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new Fe,u=new Fe;return t.forEach((d,c)=>{let h=c===0?0:c===i-1?1:(c-e)/(i-(n===0?0:1)-(e+(1-n)));l.makeRotationZ(Sn.lerp(r,r+s,h));let m=Sn.lerp(o,a,h);u.makeScale(m,m,m),d.multiply(l).multiply(u)}),t}_computeShapePoints(t=12,e=Yt.ODD){let n=this.inputs.shapeData,i=n.extractShapePointsToFlatArray([],t),r=n.shapeHoles.map(u=>{let d=u.extractShapePointsToFlatArray([],t),c=[];for(let h=d.length-1;h>=1;h-=2){let m=d[h-1],g=d[h-0];c.push(m,g)}return c}),s=Fa({windingRule:e,elementType:jn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]}),o=Fa({windingRule:Yt.ODD,elementType:jn.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]});if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let u=0;u<o.elements.length;u++){let d=o.elements[u],c=u%2===0?s.vertexCount:0;s.elements.push(d+c)}for(let u=0;u<o.vertexIndices.length;u++){let d=o.vertexIndices[u],c=s.vertexCount;s.vertexIndices.push(d+c)}for(let u=0;u<o.vertices.length;u++){let d=o.vertices[u];s.vertices.push(d)}}for(let u=0,d=s.vertexCount;u<d;u++){let c=u*2;s.vertices[c+0],s.vertices[c+1]}let l=[];for(let u=s.elementCount-1;u>=0;u--){let d=u>=a,c=u*2,h=s.elements[c+0],m=s.elements[c+1],g=h+m,v={start:h,count:m,normals:[],isHole:d,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let x=h,y=g-1,_=h+1,S=n.roundedCurves.length;do{let b=x-h;s.vertices[y*2+0],s.vertices[y*2+1];let T=s.vertices[x*2+0],E=s.vertices[x*2+1],L=s.vertices[_*2+0],A=s.vertices[_*2+1],I=T-L,P=E-A,O=Math.sqrt(I*I+P*P);I/=O,P/=O,v.normals[b*2+0]=-P,v.normals[b*2+1]=I;let k=s.vertexIndices[x];if(Array.isArray(k))v.continuous[b]=!1;else{let[F,G]=n.getCurveIndexFromVertexId(k-1,!0);if(G>0&&G<1)v.continuous[b]=!0;else{let Z=G===1?F+1:F-1;Z=(Z+S)%S;let ne=G===1?0:1,J=n.roundedCurves[F].getTangent(G),z=n.roundedCurves[Z].getTangent(ne);v.continuous[b]=J.dot(z)>.95}}d&&(v.normals[b*2+0]*=-1,v.normals[b*2+1]*=-1),[y,x,_]=[x,_,_+1],_>=g&&(_-=m)}while(_!==h+1)}return{regions:[i,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,n,i,r){let s=e*2,o=e*3;t.positions[o+0]=n.x,t.positions[o+1]=n.y,t.positions[o+2]=n.z,t.normals[o+0]=i.x,t.normals[o+1]=i.y,t.normals[o+2]=i.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,n,i,r,s,o){let a=new R,l=new R,u=new R,d=new R,c=new te;n.forEach((m,g)=>{let v=i[g],x=t.verticesStart*n.length+t.verticesCount*g;for(let y=0;y<t.count;y++){let _=(t.start+y)*2;if(a.set(e[_+0],e[_+1],0),u.copy(a).applyMatrix4(m).add(v),t.continuous[y])d.set(t.normals[y*2+0],t.normals[y*2+1],0);else{let S=y==0?(t.start+t.count-1)*2:_-2;l.set(e[S+0],e[S+1],0),d.copy(a).sub(l),d.set(-d.y,d.x,0),t.isHole||d.negate()}if(d.applyMatrix4(m).normalize(),c.set(y===0?1:y/t.count,g/(n.length-1)),this._insertVertex(r,x,u,d,c),x++,!t.continuous[y]||y===0){if(y===0)d.set(t.normals[y*2+0],t.normals[y*2+1],0),c.set(0,g/(n.length-1));else{let S=y===t.count-1?t.start*2:_+2;l.set(e[S+0],e[S+1],0),d.copy(l).sub(a),d.set(-d.y,d.x,0),t.isHole||d.negate()}d.applyMatrix4(m).normalize(),this._insertVertex(r,x,u,d,c),x++}}});let h=n.length-1;for(let m=0;m<h;m++){let g=t.verticesStart*n.length+t.verticesCount*m,v=t.verticesStart*n.length+t.verticesCount*(m+1),x=0;for(let y=0;y<t.count;y++){(!t.continuous[y]||y===0)&&x++;let _=y===t.count-1?0:x+1,S=g+x,b=g+_,T=v+_,E=v+x;t.isHole?s.push(S,T,b,S,E,T):s.push(S,b,T,S,T,E),x++}}}_closeEnd(t,e,n,i,r,s,o){let a=t.vertexCount,l=new R(0,0,o?-1:1).applyMatrix4(r),u=new R,d=new te;for(let h=0;h<a;h++){let m=2*h;u.set(t.vertices[m+0],t.vertices[m+1],0).applyMatrix4(r).add(s),this._insertVertex(i,e+h,u,l,d)}let c=t.elements;for(let h=0;h<t.elementCount;h++){let m=3*h,g=c[m+0]+e,v=c[m+(o?1:2)]+e,x=c[m+(o?2:1)]+e;n.push(g,v,x)}}};function UQ(){let t=new Ze;return t.setAttribute("position",new pt(new Float32Array([]),3)),t.setIndex(new pt(new Uint16Array([]),1)),t}var FQ=12,VQ=1,Hz=class extends Ze{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],this.userData={parameters:t,type:"TextGeometry"};let n=e.getFont(t.font);n!=null&&n.isLoaded?(this.font=n,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let n=e.getFont(t);n&&(this.font=n,await n.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,u=l===2?a.toUpperCase():l===3?a.toLowerCase():a,d=GQ(t,e,u),{shapes:c,charWidths:h,charCoords:m}=e.generateShapes(d,t),g=n*.5,v=i*.5,x=c.map(S=>new In().fromShape(S));this.vectorShapes=x;let y=x.map(S=>Uu.create({shape:S,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Yt.NONZERO:Yt.ODD,subdivisions:this.isLowResolution&&r>0?VQ:FQ}})),_=y.length?bO(y):UQ();_.translate(-g,v,0),this.dispose(),this.wrappedText=d,this.charCoords=m,this.charWidths=h,this.deleteAttribute("extrudeNormal"),Object.entries(_.attributes).forEach(([S,b])=>{this.setAttribute(S,b)}),this.setIndex(_.index),this.computeBoundingSphere()}clone(){let t=Mh(new Ze,Hz.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,n])=>{this.setAttribute(e,n)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function GQ(t,e,n){n=n??t.text;let i=[""],r="";for(let s of n)r+=s,s===" "||s===`
`?(i[i.length-1]+=r,r="",s===`
`&&i.push("")):e.getTextWidth(i[i.length-1]+r,t)>t.width&&(i[i.length-1].length&&i.push(""),e.getTextWidth(i[i.length-1]+r,t)>t.width&&(r.length===1?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}var Wz,n2=new Promise(t=>{Wz=t}),lP=!1;async function HQ(){if(lP)return;let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.269/build",[e,n]=await Promise.all([SO(()=>import("./process-10f79362.js"),[]),fetch(`${t}/process.wasm`).then(s=>s.arrayBuffer())]),i=e.default,r=await i({wasmBinary:n});Wz(r),lP=!0}function Mv(t,e,n){let i={parameters:t,type:t.type};if(t.type==="PathGeometry")i.path=t.path;else if(t.type==="VectorGeometry"){let s=In.createFromState(t.shape,t.width,t.height);i.shape=s}else if(t.type==="NonParametricGeometry")t.data.groups&&t.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),i.geometry=new ry().parse(t);else{if(t.type==="SubdivGeometry")return new Bi(t,n);if(t.type==="TextGeometry")return new Hz(t,e)}let r;try{r=fP(i)}catch(s){console.error(s)}if(!r){let s=In.createFromState(cv.defaultData(),100,100);i.shape=s,r=fP(i)}return r}var WQ=new Fe;function LS(t,e,n,i){let r=t.position.array,s=t.normal.array,o=WQ.makeScale(e,n,i).invert().elements,a,l,u;for(var d=0,c=r.length;d<c;d+=3)r[d]*=e,r[d+1]*=n,r[d+2]*=i,a=s[d],l=s[d+1],u=s[d+2],s[d]=o[0]*a+o[4]*l+o[8]*u,s[d+1]=o[1]*a+o[5]*l+o[9]*u,s[d+2]=o[2]*a+o[6]*l+o[10]*u;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var Wg=new ar,_c=new R,lt;n2.then(t=>{lt=t});var uP=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),cP=new Uint32Array([0,1,2,3]),hP=new Uint8Array([4]),Bi=class extends Ze{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let n=this.data.scaleBaked,i=Kc.div(e,n);this.subdividedGeometry&&LS(this.subdividedGeometry.attributes,...i),this.originalGeometry&&LS(this.originalGeometry.attributes,...i),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(_c.fromArray(i));let s=_c.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,n;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:n}=Bi.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new or(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(Bi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new Mr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;Wg.setFromBufferAttribute(e),Wg.getCenter(n),t.boundingSphere.radius=n.distanceTo(Wg.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Wg.getSize(_c);let i={width:_c.x,height:_c.y,depth:_c.z};return this.userData.parameters=i,i}static build(t,e,n,i){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;n===!1&&(a=-1),e&&(lt.free_bvh(e),lt.free_subdivision_surface(e));try{r=Bi.allocate(t,i)}catch(l){console.error(l,t),r=Bi.allocate({positionWASM:uP,indexWASM:cP,verticesPerFaceWASM:hP},i)}if(lt.set_destination_refinement_level(r,0),s=Bi.buildLevel(r,!0,a),t.subdivisions>0)try{lt.set_destination_refinement_level(r,t.subdivisions),o=Bi.buildLevel(r,!1,a)}catch{try{lt.set_destination_refinement_level(r,t.subdivisions-1),o=Bi.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,n){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let i;if(t.type==="TorusGeometry"&&t.arc===Math.PI*2){let{width:u,height:d,depth:c,arc:h,tubularSegments:m,radialSegments:g}=t;i=new t2(!0,u,c,d,u*.5,h/(2*Math.PI),m,c/2,0,g,0,0,!0)}else i=t.shape!==void 0?e.geometry:Mv(t,n,!1);let r,s,o,a;({positions:r,triIndices:a}=jz(i.getAttribute("position"),i.getIndex()));let l;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let u=t.radialSegments*t.heightSegments*3*2,d=u+t.radialSegments*3;l=[u,d]}return{indices:s,verticesPerFace:o}=$z(r,a,i,l),{positions:r,indices:s,verticesPerFace:o}}static allocate(t,e){var S;let n,i,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(n=t.positionWASM,i=t.indexWASM,r=t.verticesPerFaceWASM):(n=uP,i=cP,r=hP);let a=n.length,l=i.length,u=r.length,d=n.length+s.length+o.length,c=i.length+r.length,h=d*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,m=d*Float32Array.BYTES_PER_ELEMENT,g=lt._malloc(h),v=new Float32Array(lt.HEAPF32.buffer,g,d),x=new Uint32Array(lt.HEAPU32.buffer,g+m,c);v.set(n,0),v.set(s,n.length),v.set(o,n.length+s.length),x.set(i,0),x.set(r,i.length);let y;(S=t==null?void 0:t.scaleBaked)!=null&&S.some(b=>b!==1)&&(y=new Fe().makeScale(...t.scaleBaked)),e&&(y?y.premultiply(e):y=e);let _=y?lt.alloc_subdivision_surface2(g,a,g+m,l,g+m+i.length*Uint32Array.BYTES_PER_ELEMENT,u,y.elements):lt.alloc_subdivision_surface(g,a,g+m,l,g+m+i.length*Uint32Array.BYTES_PER_ELEMENT,u);return lt._free(g),_}static buildLevel(t,e,n,i,r){let s=r?lt.get_mesh_data2(t,e?lt.Level.CONTROL:lt.Level.REFINED,n,r.elements):lt.get_mesh_data(t,e?lt.Level.CONTROL:lt.Level.REFINED,n),o=8,a=lt.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),u=0,d=lt.HEAPU32[a[u]>>2],c=lt.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let h=lt.HEAPU32[a[u]>>2],m=lt.HEAPF32.subarray(h>>2,(h>>2)+l[u]);u++;let g=lt.HEAPU32[a[u]>>2],v=lt.HEAPU32.subarray(g>>2,(g>>2)+l[u]);u++;let x=lt.HEAPU32[a[u]>>2],y=lt.HEAPU32.subarray(x>>2,(x>>2)+l[u]);if(u++,i===void 0){let _=new Ze;if(_.setIndex(new Zc(y,1)),_.setAttribute("position",new De(c,3)),_.setAttribute("normal",new De(m,3)),e){_.setAttribute("faceMap",new Zc(v,1));let S=new Float32Array(m.length/3*4).fill(0);_.setAttribute("color",new pt(S,4))}return lt.free_mesh_data(s),_.userData.type="SubdivGeometry",_}i.getAttribute("position").copyArray(c),i.getAttribute("normal").copyArray(m),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,lt.free_mesh_data(s)}static freeSubdivPointer(t){lt.free_bvh(t),lt.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,n){let i=lt.get_wireframe_data_for_base_level(t),r=4,s=lt.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(2,2+2),a=0,l=lt.HEAPU32[s[a]>>2],u=lt.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let d=lt.HEAPU32[s[a]>>2],c=lt.HEAPU32.subarray(d>>2,(d>>2)+o[a]);if(e===void 0){let h=new Ze;h.setAttribute("position",new De(u,3));let m=new Float32Array(u.length);for(let g=0,v=u.length;g<v;)m[g++]=n.r,m[g++]=n.g,m[g++]=n.b;return h.setAttribute("color",new pt(m,3)),h.setIndex(new Zc(c,1)),lt.free_wireframe_data_for_base_level(i),h}e.getAttribute("position").copyArray(u),e.attributes.position.needsUpdate=!0,lt.free_wireframe_data_for_base_level(i)}static updateCollabMesh(t,e,n){let i=e===0;i||lt.set_destination_refinement_level(t,e);let r=n?lt.get_topological_data2(t,i?lt.Level.CONTROL:lt.Level.REFINED,n.elements):lt.get_topological_data(t,i?lt.Level.CONTROL:lt.Level.REFINED),s=6,o=lt.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,u=lt.HEAPU32[o[l]>>2],d=new Float32Array(lt.HEAPF32.subarray(u>>2,(u>>2)+a[l]));l++;let c=lt.HEAPU32[o[l]>>2],h=new Uint32Array(lt.HEAPU32.subarray(c>>2,(c>>2)+a[l]));l++;let m=lt.HEAPU32[o[l]>>2],g=new Uint8Array(lt.HEAPU32.subarray(m>>2,(m>>2)+a[l]));return lt.free_topological_data(r),{positions:d,indices:h,verticesPerFace:g}}},dP=["getX","getY","getZ"];function jz(t,e){let n={},i=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let u=0;u<i;u++){let d=e?e.getX(u):u,c="";for(let h=0;h<3;h++)c+=`${~~(t[dP[h]](d)*a)},`;if(c in n)s.push(n[c]);else{for(let h=0;h<3;h++)o.push(t[dP[h]](d));n[c]=r,s.push(r),r++}}let l=[];for(let u=0;u<s.length;u+=3)s[u]===s[u+1]||s[u]===s[u+2]||s[u+1]===s[u+2]||l.push(s[u],s[u+1],s[u+2]);return{positions:o,triIndices:l}}var jg=new R,s_=new R,o_=new R,a_=new R;function $z(t,e,n,i){let r=[],s=[];if(n.userData.shape!==void 0&&n.userData.parameters.depth===0&&n.userData.shape.shapeHoles.length===0){let o=n.userData.shape.extractShapePointsToFlatArray([]),a=n.userData.parameters.spikes;if(n.userData.type==="EllipseGeometry"&&a<=24&&a%4===0&&n.userData.parameters.angle>=360){let d=o.length/2/a;o=o.filter((c,h)=>Math.floor(h/2)%d===0)}let l=0;for(let d=0;d<o.length;d+=2)l+=(o[d]-o[(d===0?o.length:d)-2])*(o[d+1]+o[(d===0?o.length:d)-1]);t.length=0;let u=0;if(l<0)for(let d=0;d<o.length;d+=2)t.push(o[d],o[d+1],0),r.push(u++);else for(let d=o.length-2;d>=0;d-=2)t.push(o[d],o[d+1],0),r.push(u++);return s.push(u),{indices:r,verticesPerFace:s}}for(let o=0,a=n.capStartIndex??e.length;o<a;)if(e[o+1]===e[o+3]&&e[o+2]===e[o+5]||e[o+0]===e[o+3]&&e[o+2]===e[o+4]){jg.set(t[e[o]*3],t[e[o]*3+1],t[e[o]*3+2]),s_.set(t[e[o+1]*3],t[e[o+1]*3+1],t[e[o+1]*3+2]),o_.set(t[e[o+4]*3],t[e[o+4]*3+1],t[e[o+4]*3+2]),a_.set(t[e[o+5]*3],t[e[o+5]*3+1],t[e[o+5]*3+2]),s_.sub(jg).normalize(),o_.sub(jg).normalize(),a_.sub(jg).normalize();let l=s_.cross(o_).dot(a_);Math.abs(l)>.005||i&&i.some((u,d)=>d%2===1?!1:o>=i[d]&&o<i[d+1])?(r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3):(r.push(e[o],e[o+1],e[o+4],e[o+5]),s.push(4),o+=6)}else r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3;if(n.capStartIndex!==void 0){let o=[],a=[],l=0,u=new Float32Array([n.userData.parameters.depth])[0];for(let d=0,c=0;d<t.length;d+=3,c++)t[d+2]===0&&(o.push(c),l++),t[d+2]===u&&a.push(c);if(n.userData.parameters.extrudeBevelSize===0){let d=a[0];a[0]=a[1],a[1]=d}o.reverse(),r.push(...o,...a),s.push(l,l)}return{indices:r,verticesPerFace:s}}var Ta={};S9(Ta,{calcBoolean:()=>XQ,calcBooleanTopological:()=>qQ,freeMeshSet:()=>JQ,getMeshSet:()=>YQ,transformMeshSet:()=>ZQ});var jQ=new Promise(t=>{}),Ct,rh;jQ.then(t=>Ct=t);function $Q(t,e,n){let i,{positions:r,triIndices:s}=jz(t.getAttribute("position"),t.getIndex()),o;if(e&&n){let{indices:a,verticesPerFace:l}=$z(r,s,t);o=l.length,i=[];for(let u=0,d=0;u<o;u++){i.push(l[u]);for(let c=0;c<l[u];c++)i.push(a[d++])}}else{let a=s.length;i=Array(a+a/3),o=0;for(let l=0,u=0;u<i.length;)i[u++]=3,o++,i[u++]=s[l++],i[u++]=s[l++],i[u++]=s[l++]}return{positions:r,faceIndices:i,nFaces:o}}function qz(t){let e=t.length,n=e*Uint32Array.BYTES_PER_ELEMENT,i=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?n:i,s=Ct._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(Ct.HEAPU32.buffer,s,e):new Float32Array(Ct.HEAPF32.buffer,s,e)).set(t,0),s}function Xz(t){switch(t){case 0:return Ct.OP.UNION;case 1:return Ct.OP.INTERSECTION;case 2:return Ct.OP.A_MINUS_B;case 3:return Ct.OP.B_MINUS_A;case 4:return Ct.OP.SYMMETRIC_DIFFERENCE;case 5:return Ct.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function qQ(t,e){rh===void 0&&(rh=Ct.init_csg());let n=qz(t),i=Ct.csg_calc_topological(rh,n,t.length,Xz(e));Ct._free(n);let r=6,s=Ct.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(3,3+3),a=0,l=Ct.HEAPU32[s[a]>>2],u=new Float32Array(Ct.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let d=Ct.HEAPU32[s[a]>>2],c=new Uint32Array(Ct.HEAPU32.subarray(d>>2,(d>>2)+o[a]));a++;let h=Ct.HEAPU32[s[a]>>2],m=new Uint8Array(Ct.HEAPU32.subarray(h>>2,(h>>2)+o[a]));return Ct.free_mesh_data(i),{positions:u,indices:c,verticesPerFace:m}}function XQ(t,e,n,i){rh===void 0&&(rh=Ct.init_csg());let r=qz(t),s=Ct.csg_calc(rh,r,t.length,i,Xz(e));Ct._free(r);let o=5,a=Ct.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),u=0,d=Ct.HEAPU32[a[u]>>2],c=Ct.HEAPF32.subarray(d>>2,(d>>2)+l[u]);u++;let h=Ct.HEAPU32[a[u]>>2],m=Ct.HEAPF32.subarray(h>>2,(h>>2)+l[u]);u++;let g=l[u];n.setAttribute("position",new De(c,3)),n.setAttribute("normal",new De(m,3));let v=Ct.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return n.boundingSphere===null&&(n.boundingSphere=new Mr),n.boundingSphere.center.set(v[0],v[1],v[2]),n.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,n.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},Ct.free_mesh_data(s),g}function YQ(t,e,n){if(Ct===void 0)return-1;let i,r,s;if(e&&t.userData.positions!==void 0){let v=t.userData;s=v.verticesPerFace.length,i=v.positions,r=Array(v.verticesPerFace.reduce((x,y)=>x+y,0)+s);for(let x=0,y=0,_=0;x<v.verticesPerFace.length;x++){r[_++]=v.verticesPerFace[x];for(let S=0;S<v.verticesPerFace[x];S++)r[_++]=v.indices[y++]}}else({positions:i,faceIndices:r,nFaces:s}=$Q(t,e,n));let o=i.length,a=r.length,l=i.length,u=r.length,d=l*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,c=l*Float32Array.BYTES_PER_ELEMENT,h=Ct._malloc(d),m=new Float32Array(Ct.HEAPF32.buffer,h,l),g=new Uint32Array(Ct.HEAPU32.buffer,h+c,u);return m.set(i,0),g.set(r,0),Ct.get_csg_mesh(h,o,h+c,a,s)}function ZQ(t,e){Ct.transform_csg_mesh(t,e.elements)}function JQ(t){Ct.free_csg_mesh(t)}var KQ={ConeGeometry:RK,CubeGeometry:OK,CylinderGeometry:DK,DodecahedronGeometry:NK,EllipseGeometry:e2,HelixGeometry:fQ,IcosahedronGeometry:pQ,LatheGeometry:mQ,NonParametricGeometry:SQ,PolygonGeometry:Fz,PyramidGeometry:bQ,RectangleGeometry:Vz,SphereGeometry:AQ,PlaneGeometry:TQ,BackdropGeometry:CQ,StarGeometry:Gz,TextFrameGeometry:LQ,TorusGeometry:IQ,TorusKnotGeometry:RQ,TriangleGeometry:OQ,PathGeometry:kQ,VectorGeometry:Uu},fP=t=>KQ[t.type].create(t);function Gd(t){return t!==null&&"booleanOp"in t}var Yz=class extends Ez(li){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new Fe}updateVisible(){super.updateVisible(),this.visible=!Gd(this.parent)&&this.visible,Gd(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ta.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Gd(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof Yz&&(t.freeBooleanPointer(),Gd(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t){let e=super.updateTransformState(t);return e&&Gd(this.parent)&&this.invalidateDownstreamBooleanData(!0),e}},$g=new ar;function i2(t,e=0,n=t.count,i,r){let s=1/0,o=1/0,a=1/0,l=-1/0,u=-1/0,d=-1/0;for(let c=e;c<n;c++){let h=t.getX(c),m=t.getY(c),g=t.getZ(c);h<s&&(s=h),m<o&&(o=m),g<a&&(a=g),h>l&&(l=h),m>u&&(u=m),g>d&&(d=g)}$g.min.set(s,o,a),$g.max.set(l,u,d),$g.getCenter(i),$g.getSize(r).multiplyScalar(.5)}var QQ=new Ze,eee=new mo,rl=class extends Yz{constructor(t,e){super(QQ,eee),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?i2(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},pP=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},pl=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=Sn.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,n){return n=n??{},this.analyze(t,n),this.flow(t,e,n)}flow(t,e,n){n=n??{},t.addFlow(n.slot,n.cache,n.context);let i={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),i}build(t,e,n){e=e??this.getType(t,e);let i=t.getNodeData(n??this);return t.analyzing&&this.appendDepsNode(t,i,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,n)}updateFrame(t){}generateReadonly(t,e,n,i,r,s){return""}generate(t,e,n,i,r){return""}parse(t,e,n,i){}appendDepsNode(t,e,n){e.deps=(e.deps||0)+1;let i=t.getTypeLength(n);(i>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=i,e.output=n)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,n;for(e in this)n=this[e],n instanceof pl&&(t+='"'+e+'":'+n.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)e=this.hashProperties[i],n=this[e],t+='"'+e+'":"'+String(n)+'",';return t+='"id":"'+this.uuid+'"}',t}},tee=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,n){n=n!==void 0?n:!0,this.keywords[t]={callback:e,cache:n}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},Qi=new tee,nn=class extends pl{constructor(t,e){super(t),this.scope="",e=e??{},this.shared=e.shared!==void 0?e.shared:!0,this.unique=e.unique!==void 0?e.unique:!1}build(t,e,n,i){if(e=e??this.getType(t),this.getShared(t,e)){let r=this.getUnique(t,e);r&&this.uuid===void 0&&(this.uuid=Sn.generateUUID()),n=t.getUUID(n??this.getUUID(),!r);let s=t.getNodeData(n),o=s.output||this.getType(t);if(t.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(t,s,e),this.generate(t,e,n)):super.build(t,e,n);if(r)return s.name=s.name||super.build(t,e,n),s.name;if(!this.getLabel()&&(!this.getShared(t,o)||t.context.ignoreCache||s.deps===1))return super.build(t,e,n);n=this.getUUID(!1);let a=this.getTemp(t,n);if(a)return t.format(a,o,e);{a=super.generate(t,e,n,s.output,i);let l=this.generate(t,o,n);return t.addNodeCode(a+" = "+l+";"),t.format(a,o,e)}}return super.build(t,e,n)}getShared(t,e){return e!=="sampler2D"&&e!=="samplerCube"&&this.shared}getUnique(t,e){return this.unique}setLabel(t){return this.label=t,this}getLabel(){return this.label}getUUID(t){let e=this.uuid;return typeof this.scope=="string"&&(e=this.scope+"-"+e),e}getTemp(t,e){e=e||this.uuid;let n=t.getVars()[e];return n?n.name:void 0}generate(t,e,n,i,r){return this.getShared(t,e)||console.error("TempNode is not shared"),n=n??this.uuid,t.getTempVar(n,i??this.getType(t),r,this.getLabel()).name}},Tr=class extends nn{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}},$r=class extends Tr{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof te?t:new te(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,n,i,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",i,e)}},Hr=class extends Tr{constructor(t=0,e,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof R?t:new R(t,e,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,e)}},Rs=class extends Ge{constructor(t,e,n,i){super(t,e,n),this.isColorA=!0,this.a=i}setRGBA(t,e,n,i){super.setRGB(t,e,n),this.a=i}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let n;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(n=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let i,r=n[1],s=n[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(i[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(i[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},jl=class extends Tr{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof Rs?t:new Rs(t.r,t.g,t.b,t.a)}generateReadonly(t,e,n,i,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,e)}},nee=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,mP=/[a-z_0-9]+/gi,it=class extends nn{constructor(t,e,n,i,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(t,e,n,i)}getShared(t,e){return!this.isMethod}getType(t){return t.getTypeByFormat(this.type)}getInputByName(t){if(this.inputs){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}}getIncludeByName(t){if(this.includes){let e=this.includes.length;for(;e--;)if(this.includes[e].name===t)return this.includes[e]}}generate(t,e,n,i,r){let s,o=0,a=this.src;if(this.includes)for(let u=0;u<this.includes.length;u++)t.include(this.includes[u],this);for(let u in this.extensions)t.extensions[u]=!0;let l=[];for(;s=mP.exec(this.src);)l.push(s);for(let u=0;u<l.length;u++){let d=l[u],c=d[0],h=this.isMethod?!this.getInputByName(c):!0,m=c;if(this.keywords[c]||this.useKeywords&&h&&Qi.containsKeyword(c)){let g=this.keywords[c];if(!g){let v=Qi.getKeywordData(c);v.cache&&(g=t.keywords[c]),g=g||Qi.getKeyword(c,t),v.cache&&(t.keywords[c]=g)}m=g.build(t)}c!==m&&a[d.index+o-1]!=="."&&(a=a.substring(0,d.index+o)+m+a.substring(d.index+c.length+o),o+=m.length-c.length),this.getIncludeByName(m)===void 0&&Qi.contains(m)&&t.include(Qi.get(m))}return e==="source"?a:this.isMethod?(this.isInterface||t.include(this,void 0,a),this.name):t.format("( "+a+" )",this.getType(t),e)}parse(t,e,n,i){if(this.src=t||"",this.includes=e??[],this.extensions=n??{},this.keywords=i??{},this.isMethod){let r=nee.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(mP);if(s){let o=0;for(;o<s.length;){let a=s[o++],l;a==="in"||a==="out"||a==="inout"?l=s[o++]:(l=a,a="");let u=s[o++];this.inputs.push({name:u,type:l,qualifier:a})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},iee=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Zz=class extends nn{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||Zz.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,n,i,r){this.src=t||"";let s,o,a="",l=iee.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,n,i,r){return t.format(this.name,this.getType(t),e)}},Xt=Zz;Xt.PI="PI",Xt.PI2="PI2",Xt.RECIPROCAL_PI="RECIPROCAL_PI",Xt.RECIPROCAL_PI2="RECIPROCAL_PI2",Xt.LOG2="LOG2",Xt.EPSILON="EPSILON";var ree=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),see=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),Jz=class extends nn{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,n,i,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=ree.exec(t);if(e){let n=e[2],i;for(;i=see.exec(n);)this.inputs.push({type:i[1],name:i[2]});this.name=e[1]}else this.name="";this.type=this.name}},r2=class extends nn{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=t.isShader("vertex")?"uv"+n:"vUv"+n;return t.format(i,this.getType(t),e)}};Qi.addKeyword("uv",function(){return new r2});Qi.addKeyword("uv2",function(){return new r2(1)});var Ec=class extends nn{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??Ec.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case ls:return["Linear"];case jt:return["sRGB"];default:return[]}}generate(t,e){var o;let n=this.input.build(t,"v4"),i=this.getType(t),r=Ec.Nodes[this.method],s=t.include(r);if(s===Ec.LINEAR_TO_LINEAR)return t.format(n,i,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+n+", "+a+" )",i,e)}else return t.format(s+"( "+n+" )",i,e)}fromEncoding(t){let e=Ec.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=Ec.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},ao=Ec;ao.Nodes={LinearToLinear:new it(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new it(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new it(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},ao.LINEAR_TO_LINEAR="LinearToLinear",ao.SRGB_TO_LINEAR="sRGBToLinear",ao.LINEAR_TO_SRGB="LinearTosRGB";var un=class extends it{constructor(t="",e,n,i,r){super(t,r,i,n,e),this.nodeType="Expression"}},Va=class extends Tr{constructor(t=new gn,e,n,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=t,this.uv=e??new r2,this.bias=n,this.project=i!==void 0?i:!1}getTexture(t,e){return super.generate(t,e,this.value.uuid,"t")}generate(t,e){if(e==="sampler2D")return this.getTexture(t,e);let n=this.getTexture(t,e),i=this.uv.build(t,this.project?"v4":"v2"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s,o;this.project?s="texture2DProj":s=r?"tex2DBias":"tex2D",r?o=s+"( "+n+", "+i+", "+r+" )":o=s+"( "+n+", "+i+" )";let a={include:t.isShader("vertex"),ignoreCache:!0},l=this.getType(t);return t.addContext(a),this.colorSpace=this.colorSpace??new ao(new un("",l)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(o),o=this.colorSpace.build(t,l),t.removeContext(),t.format(o,l,e)}},Qe=class extends Tr{constructor(t){super("f"),this.nodeType="Float",this.value=t??0}generateReadonly(t,e,n,i,r,s){return t.format(this.value+(this.value%1?"":".0"),i,e)}},gP=class extends nn{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,n,i,r){i=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let u=s.inputs[l],d=this.inputs[l]||this.inputs[u.name];a.push(d.build(t,t.getTypeByFormat(u.type)))}o+=a.join(", ")+" )"}return t.format(o,i,e)}},Kz=class extends nn{constructor(t,e,n=Kz.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=n}getType(t){let e=this.a.getType(t),n=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(n)>t.getTypeLength(e)?n:e}generate(t,e){let n=this.getType(t);this.type=n;let i=this.a.build(t,n),r=this.b.build(t,n);return t.format("( "+i+" "+this.op+" "+r+" )",n,e)}},lo=Kz;lo.ADD="+",lo.SUB="-",lo.MUL="*",lo.DIV="/";var qt=class extends nn{constructor(t,e=qt.ABS,n,i){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:i=e,typeof n!="string"?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case qt.MIX:case qt.CLAMP:case qt.REFRACT:case qt.SMOOTHSTEP:case qt.FACEFORWARD:return 3;case qt.MIN:case qt.MAX:case qt.MOD:case qt.STEP:case qt.REFLECT:case qt.DISTANCE:case qt.DOT:case qt.CROSS:case qt.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),n=this.b?t.getTypeLength(this.b.getType(t)):0,i=this.c?t.getTypeLength(this.c.getType(t)):0;return e>n&&e>i?this.a.getType(t):n>i?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case qt.LENGTH:case qt.DISTANCE:case qt.DOT:return"f";case qt.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let n,i,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),u=this.getType(t);switch(this.type=u,this.method){case qt.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case qt.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case qt.CROSS:n=this.a.build(t,"v3"),i=this.b.build(t,"v3");break;case qt.STEP:n=this.a.build(t,s===1?"f":l),i=this.b.build(t,l);break;case qt.MIN:case qt.MAX:case qt.MOD:n=this.a.build(t,l),i=this.b.build(t,o===1?"f":l);break;case qt.REFRACT:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,"f");break;case qt.MIX:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:n=this.a.build(t,l),this.b&&(i=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let d=[];d.push(n),i&&d.push(i),r&&d.push(r);let c=this.getNumInputs(t);if(d.length!==c)throw Error(`Arguments not match used in "${this.method}". Require ${c}, currently ${d.length}.`);return t.format(this.method+"( "+d.join(", ")+" )",u,e)}},mt=qt;mt.RAD="radians",mt.DEG="degrees",mt.EXP="exp",mt.EXP2="exp2",mt.LOG="log",mt.LOG2="log2",mt.SQRT="sqrt",mt.INV_SQRT="inversesqrt",mt.FLOOR="floor",mt.CEIL="ceil",mt.NORMALIZE="normalize",mt.FRACT="fract",mt.SATURATE="saturate",mt.SIN="sin",mt.COS="cos",mt.TAN="tan",mt.ASIN="asin",mt.ACOS="acos",mt.ARCTAN="atan",mt.ABS="abs",mt.SIGN="sign",mt.LENGTH="length",mt.NEGATE="negate",mt.INVERT="invert",mt.MIN="min",mt.MAX="max",mt.MOD="mod",mt.STEP="step",mt.REFLECT="reflect",mt.DISTANCE="distance",mt.DOT="dot",mt.CROSS="cross",mt.POW="pow",mt.MIX="mix",mt.CLAMP="clamp",mt.REFRACT="refract",mt.SMOOTHSTEP="smoothstep",mt.FACEFORWARD="faceforward";var Qd=class extends nn{constructor(t,e,n){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=n}bilinearCubeUV(t,e,n,i){let r=new gP(Qd.Nodes.bilinearCubeUV,[e,n,i]);this.colorSpaceTL=this.colorSpaceTL??new ao(new un("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new ao(new un("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new ao(new un("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new ao(new un("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new un(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new un(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new un(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new un(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new un("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let n=this.uv,i=this.bias||t.context.roughness,r=new gP(Qd.Nodes.roughnessToMip,[i]),s=new mt(r,Qd.Nodes.m0,Qd.Nodes.cubeUV_maxMipLevel,mt.CLAMP),o=new mt(s,mt.FLOOR),a=new mt(s,mt.FRACT),l=this.bilinearCubeUV(t,this.value,n,o),u=this.bilinearCubeUV(t,this.value,n,new lo(o,new Qe(1).setReadonly(!0),lo.ADD)),d=new mt(l,u,a,mt.MIX);return t.format(d.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},IS=Qd;IS.Nodes=function(){let t=new Jz(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new Xt("float cubeUV_maxMipLevel 8.0",!0),n=new Xt("float cubeUV_minMipLevel 4.0",!0),i=new Xt("float cubeUV_maxTileSize 256.0",!0),r=new Xt("float cubeUV_minTileSize 16.0",!0),s=new it(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new it(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new it(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,n,i,r]);a.useKeywords=!1;let l=new Xt("float r0 1.0",!0),u=new Xt("float v0 0.339",!0),d=new Xt("float m0 -2.0",!0),c=new Xt("float r1 0.8",!0),h=new Xt("float v1 0.276",!0),m=new Xt("float m1 -1.0",!0),g=new Xt("float r4 0.4",!0),v=new Xt("float v4 0.046",!0),x=new Xt("float m4 2.0",!0),y=new Xt("float r5 0.305",!0),_=new Xt("float v5 0.016",!0),S=new Xt("float m5 3.0",!0),b=new Xt("float r6 0.21",!0),T=new Xt("float v6 0.0038",!0),E=new Xt("float m6 4.0",!0),L=[l,u,d,c,h,m,g,v,x,y,_,S,b,T,E],A=new it(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,L);return{bilinearCubeUV:a,roughnessToMip:A,m0:d,cubeUV_maxMipLevel:e}}();var Ac=class extends nn{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Ac.VIEW}getShared(){return this.scope===Ac.WORLD}build(t,e,n,i){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,n,i):super.build(t,e,n)}generate(t,e,n,i,r){let s;switch(this.scope){case Ac.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Ac.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case Ac.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},tr=Ac;tr.LOCAL="local",tr.WORLD="world",tr.VIEW="view",tr.NORMAL="normal";Qi.addKeyword("viewNormal",function(){return new tr(tr.VIEW)});Qi.addKeyword("localNormal",function(){return new tr(tr.NORMAL)});Qi.addKeyword("worldNormal",function(){return new tr(tr.WORLD)});var zo=class extends nn{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??zo.LOCAL}getType(){switch(this.scope){case zo.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case zo.LOCAL:case zo.WORLD:return!1}return!0}generate(t,e,n,i,r){let s;switch(this.scope){case zo.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case zo.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case zo.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case zo.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},As=zo;As.LOCAL="local",As.WORLD="world",As.VIEW="view",As.PROJECTION="projection";Qi.addKeyword("position",function(){return new As});Qi.addKeyword("worldPosition",function(){return new As(As.WORLD)});Qi.addKeyword("viewPosition",function(){return new As(As.VIEW)});var to=class extends nn{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??to.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case to.SPHERE:return"v2"}return this.type}generate(t,e){let n=this.getUnique(t);if(t.isShader("fragment")){let i;switch(this.scope){case to.VECTOR:{let r=new tr(tr.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new As(As.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,u=`reflect( -normalize( ${a} ), ${o} )`;l&&(u=`normalize( mix( ${u}, ${o}, ${l} * ${l} ) )`);let d=`inverseTransformDirection( ${u}, viewMatrix )`;n?(t.addNodeCode(`vec3 reflectVec = ${d};`),i="reflectVec"):i=d;break}case to.CUBE:{let r=new to(to.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";n?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case to.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new to(to.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),i="reflectSphereVec"):i=r;break}}return t.format(i,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},sh=to;sh.CUBE="cube",sh.SPHERE="sphere",sh.VECTOR="vector";var oee=class extends nn{constructor(t=new Va,e,n){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new IS(this.value,e??new sh(sh.VECTOR),n),this.irradianceNode=new IS(this.value,new tr(tr.WORLD),new Qe(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},aee=class extends Tr{constructor(t=new Lh,e,n){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new sh,this.bias=n}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let n=this.getTexture(t,e),i=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+n+", "+i+", "+r+" )":s="texCube( "+n+", "+i+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new ao(new un("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},vP=["x","y","z","w"],lee=["float","vec2","vec3","vec4"],uee={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},cee={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},hee=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.getIncludesCode=function(){function t(e,n){return e.deps.length-n.deps.length}return function(e,n){let i=this.getIncludes(e,n);if(!i)return"";let r="";i=i.sort(t);for(let s=0;s<i.length;s++)i[s].src&&(r+=i[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.buildShader("vertex",t),this.buildShader("fragment",e);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let i=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,n){return this.addSlot(t).addCache(e).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,n,i="varying",r="V",s=""){let o=this.getVars(i),a=o[t];if(!a){let l=o.length;a={name:n||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,n,i){return this.getVar(t,e,n,this.shader,"T",i)}getAttribute(t,e){if(!this.attributes[t]){let n=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let n="";for(let i=0,r=t.length;i<r;++i){let s=t[i],o=s.type,a=s.name,l=s.size,u=this.getFormatByType(o);if(u===void 0)throw new Error("Node pars "+u+" not found.");u.includes("[]")?n+=e+" "+u.substring(0,u.length-2)+" "+a+`[${l}];
`:n+=e+" "+u+" "+a+`;
`}return n}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof pl?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,n,i,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new pP({type:e,size:n.size,name:i||"nodeUA"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new pP({type:e,name:i||"nodeU"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,n,i,r){return this.createUniform("vertex",t,e,n,i,r)}createFragmentUniform(t,e,n,i,r){return this.createUniform("fragment",t,e,n,i,r)}include(t,e,n){var s;let i;if(t=typeof t=="string"?Qi.get(t):t,this.context.include===!1)return t.name;t instanceof it?i=this.includes.functions:t instanceof Xt?i=this.includes.consts:t instanceof Jz&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof it&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return n&&(o.src=n),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return lee[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!=null&&n.isNode)return n}}resolve(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!==void 0){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case ea:case ta:return new aee(n);case Cu:return new oee(new Va(n));default:return new Va(n)}else{if(n.isVector2)return new $r(n);if(n.isVector3)return new Hr(n);if(n.isVector4)return new jl(n)}}}}format(t,e,n){switch(this.colorToVector(n+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return uee[t]||t}getFormatByType(t){return cee[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return vP[t]}getIndexByElement(t){return vP.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=ls,e===ls&&this.context.gamma&&(e=jt),e}},Dn=class extends Tr{constructor(t=0,e,n,i){super("c"),this.nodeType="Color",this.value=t instanceof Rs?t:new Rs(t||0,e,n,i)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,e)}},Jt=class extends Tr{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,n,i,r,s){return t.format(this.value.toString(),i,e)}},Qz=class extends pl{constructor(){super("basic"),this.nodeType="Basic",this.color=new Dn(5855577),this.shadingAlpha=new Qe(1),this.shadingBlend=new Jt(0)}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(Pu.merge([ke.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{this.color===void 0&&(this.color=new Dn(5855577)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let n=this.color.flow(t,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=i!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let s=["#include <normal_fragment_begin>",n.code];i&&s.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),r?s.push(r.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${r.result}, 1.0, SPE_BLENDING_NORMAL);`):s.push(`vec3 finalColor = ${n.result};`),i?s.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} );`):s.push("gl_FragColor = vec4("+n.result+", 1.0 );"),s.push("#include <fog_fragment>","#include <dithering_fragment>"),e=s.join(`
`)}return e}},Ul=class extends Tr{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},qr={normalRenderTarget:new Va,normalRenderTargetDepth:new Va,transmissionRenderTarget:new Va,transmissionSize:new $r(2048,2048),transmissionRenderTargetDepth:new Va,pixelRatioNode:new Qe(1),resolution:new $r,penumbraSize:new Ul(5,.5)};for(let t of Object.values(qr))t.isRenderGlobal=!0;var dee=class extends pl{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Dn(5855577),this.emissive=new Dn(0),this.emissiveIntensity=new Qe(1),this.shadingAlpha=new Qe(1),this.shadingBlend=new Jt(0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(Pu.merge([ke.fog,ke.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qr.penumbraSize}),this.color===void 0&&(this.color=new Dn(5855577)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];u.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&u.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),u.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;"),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&u.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},fee=class extends pl{constructor(){super("phong"),this.nodeType="Phong",this.color=new Dn(5855577),this.specular=new Dn(1118481),this.shininess=new Qe(30),this.shadingAlpha=new Qe(1),this.shadingBlend=new Jt(0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(Pu.merge([ke.fog,ke.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qr.penumbraSize}),this.color===void 0&&(this.color=new Dn(5855577)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];u.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;"),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&u.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},pee=class extends pl{constructor(){super("standard"),this.nodeType="Standard",this.color=new Dn(5855577),this.roughness=new Qe(.3),this.metalness=new Qe(0),this.reflectivity=new Qe(.5),this.shadingAlpha=new Qe(1),this.shadingBlend=new Jt(0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(Pu.merge([ke.fog,ke.lights])),ke.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qr.penumbraSize});let n={gamma:!0};this.color===void 0&&(this.color=new Dn(5855577)),this.color.analyze(t,{slot:"color",context:n}),this.roughness.analyze(t),this.metalness.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let i=this.color.flow(t,"c",{slot:"color",context:n}),r=this.roughness.flow(t,"f"),s=this.metalness.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(t,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=u!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let c=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	float roughnessFactor = "+r.result+";",s.code,"	float metalnessFactor = "+s.result+";"),u&&c.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),c.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),c.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?c.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):c.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),c.push("#include <lights_fragment_begin>"),c.push("#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result}, ${a.result} );
				}
				`),l&&c.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),u?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},mee=class extends pl{constructor(){super("toon"),this.nodeType="Toon",this.color=new Dn(5855577),this.specular=new Dn(1118481),this.shininess=new Qe(30),this.shadingAlpha=new Qe(1),this.shadingBlend=new Jt(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(Pu.merge([ke.fog,ke.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:qr.penumbraSize}),this.color===void 0&&(this.color=new Dn(5855577)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];u.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&u.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},Hd=class extends Tr{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,n,i){return t.format(this.value?"true":"false",i,e)}},eN=class extends Tr{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new Jn}generateReadonly(t,e,n,i,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",i,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},Fl=class extends Tr{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof _t?new Array(t).fill(e):new Array(t).fill(new _t(0))}},s2=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t))(s2||{}),es=function(){let t=new it(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new it(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new Xt("float F3 0.3333333"),e.keywords.G3=new Xt("float G3 0.1666667");let n=new it(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),i=new it("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new it("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new it(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,r]),o=new it("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new it("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new it(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),u=new it(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);u.keywords.NUM_OCTAVES=new Xt("int NUM_OCTAVES 5");let d=new it("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),c=new it(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,r,d]);return{simplex:e,simplexFractal:n,simplexAshima:s,fbm:u,perlin:c}}(),tN=class extends nn{constructor(t,e,n,i,r,s,o,a,l,u,d,c){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=u,this.alpha=d,this.noiseType=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,n,i,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(s2)[this.noiseType.value],o=new it(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, float alpha, out float calpha) {
                vec3 st = position / size;
				st /= scale;
				vec3 q = vec3(${s}(st),
							  ${s}(st + vec3(1.0)),
							  ${s}(st + vec3(1.0)));
				vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
							  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
							  ${s}(st * q));
				float f = ${s}(st + r);
				vec4 color;
				color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
				color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
				color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));

                float lalpha = alpha * color.a;
                calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			    accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return clamp(color, 0.0, 1.0).rgb;
			}`,[es.simplex,es.simplexFractal,es.simplexAshima,es.fbm,es.perlin]),a=t.include(o),l=[];return l.push(this.scale.build(t,"f")),l.push(this.size.build(t,"v3")),l.push(this.move.build(t,"f")),l.push(this.fA.build(t,"v2")),l.push(this.fB.build(t,"v2")),l.push(this.distortion.build(t,"v2")),l.push(this.colorA.build(t,"v4")),l.push(this.colorB.build(t,"v4")),l.push(this.colorC.build(t,"v4")),l.push(this.colorD.build(t,"v4")),l.push(this.alpha.build(t,"f")),l.push(this.calpha),t.format(a+"("+l.join(",")+")",this.getType(t),e)}};tN.numOctaves=5;var nN=class extends nn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=n,this.intensity=i,this.factor=r,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(nN.Nodes.fresnel),i=[];return i.push(this.color.build(t,"c")),i.push(this.bias.build(t,"f")),i.push(this.scale.build(t,"f")),i.push(this.intensity.build(t,"f")),i.push(this.factor.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},iN=nN;iN.Nodes=function(){return{fresnel:new it(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, float alpha, int mode, out float calpha) {
				float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

				float lalpha = clamp( fresnel, 0.0, 1.0 ) * alpha;
				calpha = lalpha / clamp(lalpha + accumAlpha, 0.001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;
				return color;
			}`)}}();var rN=class extends nn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(rN.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(t,"f")),i.push(this.movement.build(t,"f")),i.push(this.wavelengths.build(t,"v3")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},sN=rN;sN.Nodes=function(){let t=new it(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[es.simplex]);return{rainbow:new it(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, float alpha, out float calpha) {
                 vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

                 float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);
                 float lalpha = alpha * rainbowContribution;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

                 return res;
             }`,[t])}}();var oN=class extends nn{constructor(t,e,n,i,r,s,o,a,l,u,d,c,h,m,g,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=u,this.compensation=d,this.resolution=c,this.normalMap=h,this.depthMap=m,this.pixelRatio=g,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.firstTime){let n=this.outlineWidth.build(t,"f"),i=this.resolution.build(t,"v2"),r=this.compensation.build(t,"b"),s=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(n,"uniform float"),t.addVertexParsVariable(i,"uniform vec2"),t.addVertexParsVariable(r,"uniform bool"),t.addVertexParsVariable(s,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float");let o=`g${this.uuid.toString().replace(/-/g,"")}`;t.addVertexFinalCode(`
                vID = randomColor.r;
                if (${r}) {
                    vec4 ${o}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${o}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    vec2 ${o}_offset = normalize(${o}_clipNormal.xy) / ${i} * (${n} / 2.0) * ${o}_clipPosition.w * 2.0 * ${s};
                    ${o}_clipPosition.xy += ${o}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${o}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(oN.Nodes.outline),i=[];return i.push(this.outlineColor.build(t,"c")),i.push(this.contourColor.build(t,"c")),i.push(this.outlineWidth.build(t,"f")),i.push(this.contourWidth.build(t,"f")),i.push(this.contourThreshold.build(t,"f")),i.push(this.outlineThreshold.build(t,"f")),i.push(this.contourFrequency.build(t,"f")),i.push(this.outlineSmoothing.build(t,"f")),i.push(this.contourDirection.build(t,"v3")),i.push(this.positionalLines.build(t,"b")),i.push(this.resolution.build(t,"v2")),i.push(this.normalMap.getTexture(t,"t")),i.push(this.depthMap.getTexture(t,"t")),i.push(this.pixelRatio.build(t,"f")),i.push(this.compensation.build(t,"b")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),this.firstTime=!this.firstTime,t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},aN=oN;aN.Nodes=function(){let t=new it(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 texelSize = (vec2(1.0) / resolution) * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -texelSize.x, -texelSize.y);
	uvSamples[1] = uv + vec2(0.0, -texelSize.y);
	uvSamples[2] = uv + vec2(  texelSize.x, -texelSize.y);
	uvSamples[3] = uv + vec2( -texelSize.x, 0.0);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  texelSize.x, 0.0);
	uvSamples[6] = uv + vec2( -texelSize.x, texelSize.y);
	uvSamples[7] = uv + vec2(0.0, texelSize.y);
	uvSamples[8] = uv + vec2(  texelSize.x, texelSize.y);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec4 sobel_edge_h = normalSamples[2] + (2.0*normalSamples[5]) + normalSamples[8] - (normalSamples[0] + (2.0*normalSamples[3]) + normalSamples[6]);
  	vec4 sobel_edge_v = normalSamples[0] + (2.0*normalSamples[1]) + normalSamples[2] - (normalSamples[6] + (2.0*normalSamples[7]) + normalSamples[8]);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new it(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return result;
             }`,[t])}}();var lN=class extends nn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",30),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let n=t.include(lN.Nodes.transmission),i=[];return i.push(this.thickness.build(t,"f")),i.push(this.ior.build(t,"f")),i.push(this.roughness.build(t,"f")),i.push(this.transmissionSamplerSize.build(t,"v2")),i.push(this.transmissionSamplerMap.getTexture(t,"t")),i.push(this.transmissionDepthMap.getTexture(t,"t")),i.push(this.aspectRatio.build(t,"v2")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},uN=lN;uN.Nodes=function(){let t=new it(`
            float gaussian(vec2 i) {
                const float sigma = float(NUM_SAMPLES) * .25;
                return exp( -.5* dot(i/=sigma,i) ) / ( 6.28 * sigma*sigma );
            }`),e=new it(`
            vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

                const int LOD = 2;
                const int sLOD = 4; // tile size = 2^LOD

                vec3 O = vec3(0);
                float a = 0.0;
                const int s = NUM_SAMPLES/sLOD;
                for ( int i = 0; i < s*s; i++ ) {
                    int modulo = (i)-((i)/(s))*(s);
                    vec2 d = vec2(float(modulo), float(i/s))*float(sLOD) - float(NUM_SAMPLES)/2.;
                    vec2 uv = U + (scale * aspectRatio) * d;
                    // What is the depth of the opaque object we're trying to sample
                    float opaqueDepth = unpackRGBAToDepth(texture2D(dm, uv));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU + ((scale * min(lod / 2., 1.)) * aspectRatio) * d;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    float gaussian = gaussian(d);
		            #ifdef TEXTURE_LOD_EXT
                    O += gaussian * texture2DLodEXT( sp, uv, lod).rgb;
                    #else
                    O += gaussian * textureLod( sp, uv, lod).rgb;
                    #endif
                    a += gaussian;
                }
                return O / a;
            }`,[t]),n=new it(`
            vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        // Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		        // The thickness is specified in local space.
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new it(`
float applyIorToRoughness( float roughness, float ior ) {
		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	} `),r=new it(`
vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
        float lod = applyIorToRoughness(roughness, ior);

        return blur(transmissionSamplerMap, fragCoord, vec2(lod / (transmissionSamplerSize.x / 2.)), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
	}`,[i,e]),s=new it(`
vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
        vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
        vec3 refractedRayExit = position + transmissionRay;

        // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
        vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
        vec2 refractionCoords = ndcPos.xy / ndcPos.w;
        refractionCoords += 1.0;
        refractionCoords /= 2.0;

        vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
        vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
        unrefractedCoords += 1.0;
        unrefractedCoords /= 2.0;

        // Sample framebuffer to get pixel the refracted ray hits.
        return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    }`,[r,n]);return{transmission:new it(`
            vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                float lalpha = alpha;

                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return transmission;
            }`,[s])}}();var ef=class extends nn{constructor(t,e,n,i,r,s,o,a,l,u,d){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=u,this.alpha=d,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new it(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${n}_IS_VECTOR
                   #ifdef ${n}_LINEAR
                       #ifdef ${n}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${n}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${n}_SMOOTH
				for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a;
               calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			   accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
               return color.rgb;
			}`,[ef.Nodes.vectorLinearWorldSpaceDepth,ef.Nodes.vectorLinearObjectSpaceDepth,ef.Nodes.vectorSphericalObjectSpaceDepth,ef.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${n}_SMOOTH`),this.isVector.value>.5&&t.define(`${n}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${n}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(i),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},cN=ef;cN.Nodes=function(){let t=new it(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new it(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),n=new it(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new it(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:n,vectorSphericalObjectSpaceDepth:i}}();var yP=class extends nn{constructor(t,e,n,i){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=n,this.mode=i}generate(t,e){if(t.isShader("fragment")){let n=[];return n.push(this.a.build(t,"c")),n.push(this.b.build(t,"c")),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),t.format("spe_blend("+n.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},DS=(t=>(t.NOISE="noise",t.MAP="map",t))(DS||{}),hN=class extends nn{constructor(t,e,n,i,r){super("v3"),this.displacementTypeIndex=new Jt(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(DS)[this.displacementTypeIndex.value]==="map"&&(this.mat=new eN(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=i,this.noiseFunctionIndex=r}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(DS)[this.displacementTypeIndex.value]){case"map":{n=t.include(hN.Nodes.map),i.push(this.movementOrTexture.getTexture(t,"t")),i.push("uv"),i.push(this.cropOrOffset.build(t,"f")),this.mat&&i.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(s2)[this.noiseFunctionIndex.value],s=new it(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=new it(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement) {
							return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
						}`,[es.simplex,es.simplexFractal,es.simplexAshima,es.fbm,es.perlin]),a=new it(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);n=t.include(a),i.push(this.scale.build(t,"f")),i.push(this.cropOrOffset.build(t,"v3")),i.push(this.movementOrTexture.build(t,"f"));break}}return i.push(this.intensity.build(t,"f")),i.push("displaced_normal"),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},dN=hN;dN.Nodes=function(){let t=new it(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new it(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new it(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var fN=class extends nn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(fN.Nodes.gradient),i=[];return i.push(this.gradientType.build(t,"i")),i.push(this.smooth.build(t,"b")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.offset.build(t,"v2")),i.push(this.morph.build(t,"v2")),i.push(this.angle.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},pN=fN;pN.Nodes=function(){return{gradient:new it(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return color.xyz;
			}`)}}();var T0=class extends nn{constructor(t,e,n,i,r,s,o,a,l,u){super("v3"),this.nodeType="CustomTexture",this.firstTime=!0,this.texture=t,this.textureSize=e,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=o,this.mat=a,this.alpha=l,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let n=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=t.include(T0.Nodes.cylindrical);break;case 2:i=t.include(T0.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=new it(`
		vec3 ${n}_planarTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( (${n}_vCustomUv * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);i=t.include(o);break;default:i=t.include(T0.Nodes.uv);break}if(this.projection.value===1&&this.firstTime){t.addVertexParsCode(`varying vec2 ${n}_vCustomUv;`),t.addFragmentParsCode(`varying vec2 ${n}_vCustomUv;`);let s=["zy","xz","xy"][this.axis.value];t.addVertexFinalCode(`${n}_vCustomUv = (1. + (transformed.${s})) / 2.;`)}t.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(i+"("+r.join(",")+")",this.getType(t),e)}},mN=T0;mN.Nodes=function(){let t=new it(`
vec3 cylindricalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),e=new it(`
vec3 sphericalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),n=new it(`vec3 uvTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);return{cylindrical:t,spherical:e,uv:n}}();var gN=class extends nn{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e}generate(t,e){if(t.isShader("fragment")){let n=t.include(gN.Nodes.customNormal),i=[];return i.push(this.cnormal.build(t,"v3")),i.push("normal"),i.push(this.alpha.build(t,"f")),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},vN=gN;vN.Nodes=function(){return{customNormal:new it(`vec3 customNormal(vec3 cnormal, vec3 norm, float alpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return normal;
			}`)}}();function yr(t,e){return e.color(t)}function gee(t,e){switch(t.type){case"fresnel":return xee(t,e);case"gradient":return _ee(t);case"depth":return wee(t);case"normal":return See(t);case"noise":return bee(t,e);case"rainbow":return Mee(t);case"toon":return Eee(t,e);case"outline":return Aee(t,e);case"transmission":return Tee(t);case"color":return yee(t,e)}}function vee(t){return{type:t.type}}function vo(t){let{alpha:e,mode:n}=t;return{...vee(t),alpha:e,mode:n}}function yee(t,e){return{...vo(t),color:yr(t.color,e)}}function xee(t,e){let{bias:n,scale:i,intensity:r,factor:s,color:o}=t;return{...vo(t),color:yr(o,e),bias:n,scale:i,intensity:r,factor:s}}function _ee(t){let{gradientType:e,smooth:n,colors:i,steps:r,angle:s,offset:o,morph:a}=t;return{...vo(t),gradientType:e,smooth:n,colors:i.map(l=>new _t(l[0],l[1],l[2],l[3])),num:i.length,steps:r,offset:new te(...o),morph:new te(...a),angle:s}}function wee(t){let{gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:u,smooth:d}=t;return{...vo(t),gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:new R(...o),direction:a?new R(...a):new R(1,0,0),colors:l.map(c=>c!==void 0?new _t(c[0],c[1],c[2],c[3]):new _t(0,0,0,0)),steps:u.slice(0,l.length),smooth:d}}function See(t){let{cnormal:e}=t;return{...vo(t),cnormal:new R(e[0],e[1],e[2])}}function bee(t,e){return{...vo(t),scale:t.scale,move:t.move,fA:new te(...t.fA),fB:new te(...t.fB),size:new R(...t.size),distortion:new te(...t.distortion),colorA:yr(t.colorA,e),colorB:yr(t.colorB,e),colorC:yr(t.colorC,e),colorD:yr(t.colorD,e),noiseType:t.noiseType}}function Mee(t){return{...vo(t),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new R(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new R(...t.offset)}}function Eee(t,e){return{...vo(t),positioning:t.positioning,colors:t.colors.map(n=>new _t(n[0],n[1],n[2],n[3])),num:t.colors.length,steps:t.steps,source:new R(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:yr(t.shadowColor,e),offset:new R(...t.offset)}}function Aee(t,e){return{...vo(t),outlineColor:yr(t.outlineColor,e),contourColor:yr(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new R(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function Tee(t,e){return{...vo(t),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}var Ev=class extends Rs{},Cee=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),n=this.cache.get(t);return n===void 0?(n={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,n)):(n.time=e,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},Pee=class extends Cee{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},l_;function Lee(t){return typeof t=="string"?t:(l_||(l_=new Pee),l_.load(t))}var Iee=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},Dee=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},yN=class extends Iee{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type=="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let r of i){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var n=new FileReader;n.readAsDataURL(new Blob([t],{type:"video/mp4"}));let i;await new Promise(r=>{n.onloadend=s=>{var o;i=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=i}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=Lee(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let n;return this.isVideo?n=new yR(this.img,void 0,t,t):n=new gn(this.img,void 0,t,t),this.loaded&&(n.needsUpdate=!0),this[t]=n,n}}disposeTextures(){var t,e,n;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(n=this[1002])==null||n.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},tu=class extends yN{},o2=class extends Tr{},xN={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],depth:["smooth","isWorldSpace","gradientType","isVector"]},_N={depth:["colors"]};function Ree(t,e,n){var s,o;let i=xN[t.type],r=_N[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==n.length)return!0}}return i!==void 0?i.includes(e):!1}function wN(t,e,n){let i=n.uniforms[`f${n.id}_texture`];if(!i)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=i;l.image instanceof tu||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=i;l.image instanceof tu||l.image.deref(),l.image=a}if("wrapping"in s){let o=i;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=n.uniforms[`f${n.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function Oee(t,e,n,i){let r=!1;for(let[s,o]of Object.entries(t)){if(!s||o===void 0)continue;if(TN(s,n,i)){s==="visible"&&n.type==="light"&&(r=!0);continue}n.visible=i.visible;let a=n.uniforms[`f${n.id}_${s}`];if(a&&!(a instanceof o2))switch(r=r||Ree(n,s,o),a.constructor){case Dn:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof Ev?a.value=new Rs(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case jl:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof Ev?a.value=new Rs(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case $r:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Hr:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case Va:{wN(o,e,n);break}case Fl:{a.value=o.map(l=>new _t(...l));break}default:{a.value=o;break}}}return r}var SN=class extends nn{constructor(t,e,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.alpha=e,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(SN.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let i=[];return i.push(this.texture.generate(t,"t")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},bN=SN;bN.Nodes=function(){return{matcap:new it(`vec3 matcap(sampler2D matcapTex, vec3 normal, float alpha, int mode, out float calpha) {
                vec3 viewDir = normalize( vViewPosition );
                vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
                vec3 y = cross( viewDir, x );
                vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
                vec4 matcapColor = texture2D( matcapTex, uv );

                calpha =  alpha / clamp( alpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;
                
                return matcapColor.rgb;
            }
            `)}}();var RS=class extends o2{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},zee=class extends o2{constructor(t){super("v3"),this.image=t,this._value=new R}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},MN=class extends nn{constructor(t,e,n,i,r,s,o,a,l,u){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let n=t.include(MN.Nodes.toon),i=[];return i.push(this.positioning.build(t,"i")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.source.build(t,"v3")),i.push(this.isWorldSpace.build(t,"b")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.shadowColor.build(t,"v4")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},EN=MN;EN.Nodes=function(){let t=new it(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new it(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),n=new it(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),i=new it(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new it(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new it(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[es.simplex,t,n,r])}}();function xP(t,e,n){t.setUvTransform(n[0],n[1],e[0],e[1],0,0,0)}var Nee=class extends eN{constructor(t,e){super(new Jn),this.repeat=t,this.offset=e,xP(this.value,t,e)}updateMatrix(){xP(this.value,this.repeat,this.offset)}},du=class{constructor(t,e,n,i){this.id=t,this.uuid=e,this.data=n,this.uniforms={};for(let r in i)this.uniforms[`f${this.id}_${r}`]=i[r];for(let r in n)TN(r,this,n)}get type(){return this.data.type}static create(t,e,n,i){if(n.type==="light")return Hc.createLigherLayer(t,e,n,i);if(n.type==="texture"||n.type==="video"){let r=n.type==="texture"?i.image(n.texture.image):i.video(n.texture.video),s=new RS(r,n.texture.wrapping),o=new zee(r),a=new Nee(n.texture.repeat,n.texture.offset),l=new Qe(n.crop?1:0),u=new Jt(n.projection??0),d=new Jt(["x","y","z"].indexOf(n.axis)??0),c=new Jt(n.side??0),h=new $r(n.size?new te(n.size[0],n.size[1]):new te(100,100)),m=new Qe(n.alpha??1),g=new Jt(n.mode??0),v=new mN(s,o,l,u,d,c,h,a,m,g),x=new un(v.calpha,"f");return new di(t,e,n,{texture:s,textureSize:o,crop:l,projection:u,axis:d,side:c,size:h,mat:a,alpha:m,mode:g},v,g,x)}else if(n.type==="matcap"){let r=i.image(n.texture.image),s=new RS(r,n.texture.wrapping),o=new Qe(n.alpha??1),a=new Jt(n.mode??0),l=new bN(s,o,a),u=new un(l.calpha,"f");return new di(t,e,n,{texture:s,alpha:o,mode:a},l,a,u)}else if(n.type==="displace")if(n.displacementType==="noise"){let r=new Hr(new R(...n.offset)),s=new Qe(n.scale??10),o=new Qe(n.intensity??8),a=new Qe(n.movement??1),l=new Jt(n.noiseType??0),u=new dN(o,a,r,s,l);return new AN(t,e,n,{offset:r,scale:s,intensity:o,movement:a,noiseType:l},u)}else throw new Error;else return Uee(t,e,n,i)}updateByOp(t,e,n){var r;let i=t;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props?((r=n.scene)==null||r.markNeedsUpdateRendererDirty(),!0):Oee(i.props,n.shared,this,e)}else if(i.path[0]==="texture")return"texture"in e||"video"in e?wN(i.props,n.shared,this):!0;return!1}dispose(){if(kee(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof tu||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let n=`f${this.id}_${t}`;this.hasValueByKey(n)&&e!==void 0&&(this.uniforms[n].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let n=this.getName(e);n&&t.push(n)}return t}},di=class extends du{constructor(t,e,n,i,r,s,o){super(t,e,n,i),this.params=i,this.color=r,this.mode=s,this.alpha=o}},AN=class extends du{constructor(t,e,n,i,r){super(t,e,n,i),this.position=r}},Hc=class extends du{constructor(t,e,n,i,r){super(t,e,n,r),this.node=i}static createLigherLayer(t,e,n,i){let r,s=new Qe(n.alpha),o=new Jt(n.mode),a;if(!n.visible)r=new Qz,a={};else if(n.category==="lambert"){r=new dee;let l=new Dn(i.color(n.emissive)??0);a={emissive:l},r.emissive=l}else if(n.category==="toon"){r=new mee;let l=new Qe(n.shininess??30),u=new Dn(i.color(n.specular)??1118481);a={shininess:l,specular:u},r.shininess=l,r.specular=u}else if(n.category==="physical"){r=new pee;let l=new Qe(n.roughness??.3),u=new Qe(n.metalness??0),d=new Qe(n.reflectivity??.5);a={roughness:l,metalness:u,reflectivity:d},r.roughness=l,r.metalness=u,r.reflectivity=d}else{r=new fee;let l=new Qe(n.shininess??30),u=new Dn(n.specular!==void 0?i.color(n.specular)??1118481:1118481);a={shininess:l,specular:u},r.shininess=l,r.specular=u}return r.alpha=new Qe(1),r.shadingAlpha=s,r.shadingBlend=o,a.alpha=r.shadingAlpha,a.mode=r.shadingBlend,new Hc(t,e,n,r,a)}get category(){return this.node.category}};function kee(t){let e=t instanceof du?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function Bee(t,e,n,i){switch(t.type){case"color":{let r=new Dn(i.color??5855577),s=new Qe(i.alpha??1),o=new un("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new Jt(i.mode??0);return r.alpha=s,new di(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}case"fresnel":{let r=new Dn(i.color??16777215),s=new Qe(i.bias??.1),o=new Qe(i.scale??1),a=new Qe(i.intensity??2),l=new Qe(i.factor??1),u=new Qe(i.alpha??1),d=new Jt(i.mode??0),c=new iN(r,s,o,a,l,u,d),h=new un(c.calpha,"f");return new di(e,n,t,{color:r,bias:s,scale:o,intensity:a,factor:l,alpha:u,mode:d},c,d,h)}case"rainbow":{let r=new Qe(i.filmThickness??30),s=new Qe(i.movement??0),o=new Hr(i.wavelengths??new R(0,0,0)),a=new Qe(i.noiseStrength??0),l=new Qe(i.noiseScale??1),u=new Hr(i.offset??new R(0,0,0)),d=new Qe(i.alpha??1),c=new sN(r,s,o,a,l,u,d),h=new un(c.calpha,"f"),m=new Jt(i.mode??0);return new di(e,n,t,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:u,alpha:d,mode:m},c,m,h)}case"transmission":{let r=new Qe(i.thickness??10),s=new Qe(i.ior??1.5),o=new Qe(i.roughness??.5),a=qr.transmissionSize,l=qr.transmissionRenderTarget,u=qr.transmissionRenderTargetDepth,d=window.innerWidth,c=window.innerHeight,h=d>=c?new $r(c/d,1):new $r(1,d/c),m=new Qe(i.alpha??1),g=new uN(r,s,o,a,l,u,h,m),v=new un(g.calpha,"f"),x=new Jt(i.mode??0);return new di(e,n,t,{thickness:r,ior:s,roughness:o,aspectRatio:h,alpha:m,mode:x},g,x,v)}case"toon":{let r=new Jt(i.positioning??0),s;i.colors?s=new Fl(i.colors.length,i.colors):(s=new Fl(10,new _t(0,0,0,1)),s.value[1]=new _t(1,1,1,1));let o;i.steps?o=new Ul(i.steps.length,i.steps):(o=new Ul(10,1),o.value[0]=0);let a=new Hr(i.source??new R(0,0,0)),l=new Hd(i.isWorldSpace??!0),u=new Qe(i.noiseStrength??0),d=new Qe(i.noiseScale??1),c=new jl(i.shadowColor),h=new Hr(i.offset??new R(0,0,0)),m=new Qe(i.alpha??1),g=new EN(r,s,o,a,l,u,d,c,h,m),v=new un(g.calpha,"f"),x=new Jt(i.mode??0);return new di(e,n,t,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:u,noiseScale:d,shadowColor:c,offset:h,alpha:m,mode:x},g,x,v)}case"outline":{let r=new Dn(i.outlineColor??16777215),s=new Dn(i.contourColor??16777215),o=new Qe(i.outlineWidth??.1),a=new Qe(i.contourWidth??.1),l=new Qe(i.outlineThreshold??.1),u=new Qe(i.contourThreshold??.1),d=new Qe(i.outlineSmoothing??.1),c=new Qe(i.contourFrequency??.1),h=new Hr(i.contourDirection??new R(0,1,0)),m=new Hd(i.positionalLines??!1),g=new Hd(i.compensation??!0),v=qr.normalRenderTarget,x=qr.normalRenderTargetDepth,y=qr.pixelRatioNode,_=qr.resolution,S=new Qe(i.alpha??1),b=new aN(r,s,o,a,l,u,d,c,h,m,g,_,v,x,y,S),T=new un(b.calpha,"f"),E=new Jt(i.mode??0);return new di(e,n,t,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:u,outlineSmoothing:d,contourFrequency:c,contourDirection:h,positionalLines:m,compensation:g,alpha:S,mode:E},b,E,T)}case"depth":{let r=new Jt(i.gradientType??0),s=new Hd(i.smooth??!1),o=new Qe(i.near??50),a=new Qe(i.far??200),l=new Qe(i.isVector??1),u=new Qe(i.isWorldSpace??0),d=new Hr(i.origin??new R),c=new Hr(i.direction??new R),h;i.colors?h=new Fl(i.colors.length,i.colors):(h=new Fl(2,new _t(0,0,0,1)),h.value[1]=new _t(1,1,1,1));let m;i.steps?m=new Ul(i.steps.length,i.steps):(m=new Ul(2,1),m.value[0]=0);let g=new Qe(i.alpha??1),v=new Jt(i.mode??0),x=new cN(r,s,o,a,l,u,d,c,h,m,g),y=new un(x.calpha,"f");return new di(e,n,t,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:u,origin:d,direction:c,colors:h,steps:m,alpha:g,mode:v},x,v,y)}case"noise":{let r=new Qe(i.scale??1),s=new Hr(i.size??new R(100,100,100)),o=new Qe(i.move??1),a=new $r(i.fA??new te(1.7,9.2)),l=new $r(i.fB??new te(8.3,2.8)),u=new $r(i.distortion??new te(1,1)),d=new jl(i.colorA),c=new jl(i.colorB),h=new jl(i.colorC),m=new jl(i.colorD),g=new Qe(i.alpha??1),v=new Jt(i.mode??0),x=new Jt(i.noiseType??0),y=new tN(r,s,o,a,l,u,d,c,h,m,g,x),_=new un(y.calpha,"f");return new di(e,n,t,{scale:r,size:s,move:o,fA:a,fB:l,distortion:u,colorA:d,colorB:c,colorC:h,colorD:m,alpha:g,mode:v,noiseType:x},y,v,_)}case"normal":{let r=new Hr(i.cnormal??new R(1,1,1)),s=new Qe(i.alpha??1),o=new Jt(i.mode??0),a=new vN(r,s),l=new un("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");return l.keywords.alpha=s,new di(e,n,t,{cnormal:r,alpha:s,mode:o},a,o,l)}case"gradient":{let r=new Jt(i.gradientType??0),s=new Hd(i.smooth??!1),o;i.colors?o=new Fl(i.colors.length,i.colors):(o=new Fl(10,new _t(0,0,0,1)),o.value[1]=new _t(1,1,1,1));let a;i.steps?a=new Ul(i.steps.length,i.steps):(a=new Ul(10,1),a.value[0]=0);let l=new $r(i.offset??new te(0,0)),u=new $r(i.morph??new te(0,0)),d=new Qe(i.angle??0),c=new Qe(i.alpha??1),h=new Jt(i.mode??0),m=new pN(r,s,o,a,l,u,d,c),g=new un(m.calpha,"f");return new di(e,n,t,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:u,angle:d,alpha:c,mode:h},m,h,g)}default:{let r=new Dn(1,0,0,1),s=new Qe(1),o=new un("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new Jt(0);return r.alpha=s,new di(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}}}function Uee(t,e,n,i){let r=gee(n,i);return Bee(n,t,e,r)}function TN(t,e,n){if(n.type==="displace"&&(t==="intensity"||t==="visible")){let i=e.uniforms[`f${e.id}_intensity`];return i?(i.value=n.intensity*(n.visible?1:0),i):void 0}if(n.type!=="displace"&&(t==="alpha"||t==="visible")){let i=e.uniforms[`f${e.id}_alpha`];if(!i)return;if(i.value=n.alpha*(n.visible?1:0),n.type==="outline"&&t==="visible"){let r=e.uniforms[`f${e.id}_compensation`];r&&(r.value=n.compensation&&n.visible)}return i}}function _P(t,e){let n=0;for(let i of t.layers)if(i.data.type!=="displace"&&"alpha"in i.data&&i.data.type!=="light"&&i.data.type!=="fresnel"&&i.data.type!=="texture"&&i.data.type!=="matcap"&&i.data.type!=="rainbow"&&i.data.type!=="outline"){let r=i.data.visible?i.data.alpha:0;if(r===1&&i.data.type==="depth"||i.data.type==="gradient"){for(let s of i.data.colors)if(s[3]<1){r=s[3];break}}else if(r===1&&i.data.type==="noise"){let s=e.color(i.data.colorA).a,o=e.color(i.data.colorB).a,a=e.color(i.data.colorC).a,l=e.color(i.data.colorD).a,u=Math.min(s,Math.min(o,Math.min(a,l)));u<1&&(r=u)}n+=(1-n)*r}return n<1}var sl=class extends zs{constructor(){super(void 0),this.flatShading=!1,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},Fee=class extends sl{constructor(t,e,n,i){super(),this.flatShading=t,this.side=e,this.wireframe=n,this.root=i}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}getFlavor(t,e,n){return this.root.getFlavor(t,e,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,n){this.root.updateByOp(t,e,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},CN=class extends sl{constructor(t,e){super(),this.data=t,this.layerIdGen=0,this.flavors=[],this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,n){let i=n?6:(t?3:0)+e;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let r=this.flavors[i];return r===void 0&&(r=new Fee(t,e,n,this),this.flavors[i]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let n=t.layers??fo.defaultTwoLayerData("phong").layers;this.layers=n.map(i=>du.create(this.layerIdGen++,i.id,i.data,e.shared)),this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(),this.transparent=_P(t,e.shared)}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof Hc),this.lightLayer===void 0&&(this.lightLayer=new Hc(0,"",{...Jr.defaultData("light","phong"),visible:!1},new Qz,{})),this.dispose(),this.needsUpdate=!0,this.blendColors(),this.blendAfterColors(),this.blendPositions()}updateByOp(t,e,n){var i,r,s;if(this.data=e,this.transparent=_P(e,n.shared),t.path[0]==="layers"){this.data=e;let o=n.shared,a=t.path[1];if(a===void 0){if(this.layers.reverse(),t.type===4){let l=du.create(this.layerIdGen++,t.id,t.data,n.shared);this.layers.splice(t.localIndex,0,l),(i=n.scene)==null||i.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),(r=n.scene)==null||r.markNeedsUpdateRendererDirty();else if(t.type===6){let l=this.layers.findIndex(d=>d.uuid===t.id),u=this.layers[l];this.layers.splice(l,1),this.layers.splice(t.localIndex,0,u),(s=n.scene)==null||s.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{let l=this.layers.find(u=>u.uuid===a);if(l){let u=e.layers.data(a);if(l.updateByOp({...t,path:t.path.slice(2)},u,n)){let d=du.create(this.layerIdGen++,a,u,o);this.layers.splice(this.layers.findIndex(c=>c.uuid===a),1,d),this.onUpdate()}}}}else this.reset(e,n)}blendColors(){let t=this.layers.findIndex(n=>n instanceof di),e=this.layers.findIndex(n=>n instanceof Hc);if(t!==-1&&t<e){let n=this.layers[t].color;for(let i=t+1;i<e;++i){let r=this.layers[i];r instanceof di&&(n=new yP(n,r.color,r.alpha,r.mode))}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let t=new un("outgoingLight","f"),e=this.layers.findIndex(n=>n instanceof Hc);if(this.layers.length>e+1){for(let n=e+1;n<this.layers.length;++n){let i=this.layers[n];i instanceof di&&(t=new yP(t,i.color,i.alpha,i.mode))}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof AN);if(t.length>0){let e=t[0].position;for(let n=1;n<t.length;++n)t[n]&&(e=new lo(e,t[n].position,lo.ADD),e=new lo(e,new Qe(.5).setReadonly(!0),lo.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let n=(i,r,s)=>Math.min(Math.max(i,r),s);for(let i of this.layers)if(i.type==="displace"){let r=n(i.uniforms[`f${i.id}_intensity`].value,t,e);i.uniforms[`f${i.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let n=(xN[e.type]??[]).map(s=>e[s]),i=(_N[e.type]??[]).map(s=>{var o;return((o=e[s])==null?void 0:o.length)??0}),r=[...n,...i];r.length?t+=`["${e.type}", "${r.join('","')}"],`:t+=`"${e.type}",`}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new hee;this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof di){let e=t.params.texture;if(e instanceof RS&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(sl.prototype,{properties:{get:function(){return this.fragment.properties}}});var OS=class extends CN{},Vee=oy(A9()),wP=new Map;function Gee(t){if(typeof t=="string")return t;let e=wP.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},wP.set(t,e)),e.url}var qg=class{constructor({src:t,volume:e,delay:n,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:Gee(t),format:"wav"},this.sound=new Vee.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),n!==void 0&&(this.delay=n),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,n){this.sound.on(t,e,n)}off(t,e,n){this.sound.off(t,e,n)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},Hee=class{constructor(){this.type="ShapePath",this.color=new Ge,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new wu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var n;return(n=this.currentPath)==null||n.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function n(m,g,v,x){let y=m.x,_=g.x,S=v.x,b=x.x,T=m.y,E=g.y,L=v.y,A=x.y,I=(b-S)*(T-L)-(A-L)*(y-S),P=(_-y)*(T-L)-(E-T)*(y-S),O=(A-L)*(_-y)-(b-S)*(E-T),k=I/O,F=P/O;if(O===0&&I!==0||k<=0||k>=1||F<0||F>1)return null;if(I===0&&O===0){for(let G=0;G<2;G++)if(i(G===0?v:x,m,g),e.loc===t.ORIGIN){let Z=G===0?v:x;return{x:Z.x,y:Z.y,t:e.t}}else if(e.loc===t.BETWEEN){let Z=+(y+e.t*(_-y)).toPrecision(10),ne=+(T+e.t*(E-T)).toPrecision(10);return{x:Z,y:ne,t:e.t}}return null}else{for(let ne=0;ne<2;ne++)if(i(ne===0?v:x,m,g),e.loc===t.ORIGIN){let J=ne===0?v:x;return{x:J.x,y:J.y,t:e.t}}let G=+(y+k*(_-y)).toPrecision(10),Z=+(T+k*(E-T)).toPrecision(10);return{x:G,y:Z,t:k}}}function i(m,g,v){let x=v.x-g.x,y=v.y-g.y,_=m.x-g.x,S=m.y-g.y,b=x*S-_*y;if(m.x===g.x&&m.y===g.y){e.loc=t.ORIGIN,e.t=0;return}if(m.x===v.x&&m.y===v.y){e.loc=t.DESTINATION,e.t=1;return}if(b<-Number.EPSILON){e.loc=t.LEFT;return}if(b>Number.EPSILON){e.loc=t.RIGHT;return}if(x*_<0||y*S<0){e.loc=t.BEHIND;return}if(Math.sqrt(x*x+y*y)<Math.sqrt(_*_+S*S)){e.loc=t.BEYOND;return}let T;x!==0?T=_/x:T=S/y,e.loc=t.BETWEEN,e.t=T}function r(m,g){let v=[],x=[];for(let y=1;y<m.length;y++){let _=m[y-1],S=m[y];for(let b=1;b<g.length;b++){let T=g[b-1],E=g[b],L=n(_,S,T,E);L!==null&&v.find(A=>A.t<=L.t+Number.EPSILON&&A.t>=L.t-Number.EPSILON)===void 0&&(v.push(L),x.push(new te(L.x,L.y)))}}return x}function s(m,g,v){let x=new te;g.getCenter(x);let y=[];return v.forEach(_=>{_.boundingBox.containsPoint(x)&&r(m,_.points).forEach(S=>{y.push({identifier:_.identifier,isCW:_.isCW,point:S})})}),y.sort((_,S)=>_.point.x-S.point.x),y}function o(m,g,v,x,y){(y==null||y==="")&&(y="nonzero");let _=new te;m.boundingBox.getCenter(_);let S=[new te(v,_.y),new te(x,_.y)],b=s(S,m.boundingBox,g);b.sort((P,O)=>P.point.x-O.point.x);let T=[],E=[];b.forEach(P=>{P.identifier===m.identifier?T.push(P):E.push(P)});let L=T[0].point.x,A=[],I=0;for(;I<E.length&&E[I].point.x<L;)A.length>0&&A[A.length-1]===E[I].identifier?A.pop():A.push(E[I].identifier),I++;if(A.push(m.identifier),y==="evenodd"){let P=A.length%2===0,O=A[A.length-2];return{identifier:m.identifier,isHole:P,for:O}}else if(y==="nonzero"){let P=!0,O=null,k=null;for(let F=0;F<A.length;F++){let G=A[F];g[G]&&(P?(k=g[G].isCW,P=!1,O=G):k!==g[G].isCW&&(k=g[G].isCW,P=!0))}return{identifier:m.identifier,isHole:P,for:O}}else console.warn('fill-rule: "'+y+'" is currently not implemented.')}let a=0,l=999999999,u=-999999999,d=[];this.subPaths.forEach(m=>{let g=m.getPoints(),v=-999999999,x=999999999,y=-999999999,_=999999999;for(let S=0;S<g.length;S++){let b=g[S];b.y>v&&(v=b.y),b.y<x&&(x=b.y),b.x>y&&(y=b.x),b.x<_&&(_=b.x)}u<=y&&(u=y+1),l>=_&&(l=_-1),g.length&&d.push({curves:m.curves,points:g,isCW:Is.isClockWise(g),identifier:a++,boundingBox:new $R(new te(_,x),new te(y,v))})});let c=d.map(m=>{var g;return o(m,d,l,u,(g=this.userData)==null?void 0:g.style.fillRule)}),h=[];return d.forEach(m=>{let g=c[m.identifier];if(g&&!g.isHole){let v=new Ls;v.curves=m.curves,c.filter(x=>(x==null?void 0:x.isHole)&&x.for===m.identifier).forEach(x=>{if(x){let y=d[x.identifier],_=new wu;_.curves=y.curves,v.holes.push(_)}}),h.push(v)}}),h}},PN,SP=new Promise(t=>{PN=t}),bP=!1;async function Wee(){if(bP)return;let t=await SO(()=>import("./opentype-fc28cde9.js"),[]);PN(t),bP=!0}var jee=class{async load(t,e,n=()=>{}){let{load:i}=await SP;i(t,(r,s)=>{r||!s?n(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:n}=await SP;try{let i=e(t),r=new n,s=o=>i.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(i){console.error(i)}}};async function $ee(t){return await(await fetch(t)).arrayBuffer()}var qee=new jee;async function MP(t){let e,n,i=!1;if(t.url?(e=await $ee(t.url),n=t.url,i=t.url.startsWith("/")):t.data&&(e=t.data.buffer),e){let r=await qee.parse(e);if(r)return{font:r.font,url:n,intercepted:i,arr:e,bidi:r.bidi}}}function Xee(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var Yee=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=MP(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=MP(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(e);let r=i.tokenizer.tokens,s=[],o=0,a=n.length===r.length;for(let l=0;l<n.length;l++){let u=n[l].index,d=String.fromCharCode(n[l].unicode),c=r[o];if(Xee(u,c)||a)s.push({char:d,index:u,replacements:[c.state.glyphIndex],replacementChars:[c.char]}),o++;else{let h=c.char,m="",g=[c.state.glyphIndex],v=[],x=!1;for(;!x;)o++,m=e.charAt(o),h+=m,g.push(t.charToGlyphIndex(m)),v=t.stringToGlyphs(h),v.length===1&&v[0].index===u&&(x=!0),o>e.length&&(x=!0);s.push({char:d,index:u,replacements:g,replacementChars:Array.from(h)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let n=this.font,i=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(y=>this.getTextWidth(y,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,u=this.computeSpaceWidthForLine(t,0,e),d=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),c=this.getLineInitialOffsetY(r,t.length,e.height,i,e.verticalAlign),h=[],m=t.map(y=>[]),g=t.map(y=>[]),v;for(let y=0;y<t.length;y++){let _=t[y],S={features:{liga:!0}},b=[];try{b=n.stringToGlyphs(_,S)}catch(E){console.warn(E)}d=this.getLineInitialOffsetX(s[y],o,e.horizontalAlign,_,a);let T=[];try{T=this.reverseLigaturesTable(n,_,b)}catch(E){console.warn(E)}u=this.computeSpaceWidthForLine(t,y,e);for(let E=0;E<b.length;E++){let L=b[E],A=L.index===0?`
`:L.unicode?String.fromCharCode(L.unicode):void 0,I=T[E],P=0,O=0;E===0&&e.horizontalAlign===2&&L.leftSideBearing!==void 0&&(O=-L.leftSideBearing*i),v&&(P=n.getKerningValue(L,v)*i),d+=O+P;let k=0;if(A===`
`)k=l;else if(A===" ")k=u;else{let F=this.createPath(L,i,d,c,e);F&&(k=F.offsetX-(P+O),h.push(F.path))}if(I.replacements.length===1)g[y].push([d,c]),m[y].push(k);else{let F=I.replacements.map(J=>(n.glyphs.get(J).advanceWidth??0)*i),G=F.reduce((J,z)=>J+=z,0),Z=F.map(J=>J/G),ne=d;for(let J=0;J<Z.length;J++){let z=k*Z[J];g[y].push([ne,c]),m[y].push(z),ne+=z}}d+=k,v=L}c-=r}let x=[];for(let y=0,_=h.length;y<_;y++)x.push(...h[y].toShapes());return{shapes:x,charWidths:m,lineWidths:s,charCoords:g}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,n,i,r){return(n===3||n===2)&&i.indexOf(`
`)>=0&&(t-=r),n===3?e*.5-t*.5:n===2?e-t:0}getLineInitialOffsetY(t,e,n,i,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*i,a=t-o,l=-this.ascender*i-a/2;return r===3?-(n-s-l):r===2?-(n*.5-s*.5-l):l}createPath(t,e,n,i,r){var l;let s=t.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new Hee,a=(t.advanceWidth??1)*e;if(t)for(let u of s.commands){let d=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(d&&u.type!=="Z"&&d.x===u.x&&-d.y===u.y))switch(u.type){case"M":o.moveTo(u.x,-u.y);break;case"L":o.lineTo(u.x,-u.y);break;case"Q":o.quadraticCurveTo(u.x1,-u.y1,u.x,-u.y);break;case"C":o.bezierCurveTo(u.x1,-u.y1,u.x2,-u.y2,u.x,-u.y);break}}return o.subPaths.forEach(u=>{let d=Zee(u.curves);d!==void 0&&u.currentPoint.distanceTo(d)>0&&u.lineTo(d.x,d.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,n){let i=this.getCharWidth(" ",n),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(n.horizontalAlign===4&&e<t.length-1&&s){let o=n.width,a=this.getTextWidth(r,n);return(o-(a-s*i))/s}}return i}countSpaces(t){return(t.match(/ /g)||[]).length}};function Zee(t){if(t.length){let e=t[0];if(e instanceof rs)return e.v1;if(e instanceof ns||e instanceof ra)return e.v0}}var Jee=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e){let n=this.objects.get(t);return n===void 0?(n=this.createObject(t,e),this.objects.set(t,n)):n.isShared=!0,n}mutateIfUnique(t,e){let n=this.objects.get(t);if(n&&n.isShared!==!0)return this.objects.delete(t),this.objects.set(e,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let n=this.objects.get(t);e===n&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},EP=class extends Jee{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e){let n=Mv(t,e,this.flatShading);return n.computeBoundingSphere(),n}},Kee={find(t){},markNeedsUpdateRendererDirty:function(){},markGeometryCacheDirty:function(){},addPendingExpandCloner:function(t){},addPendingUpdateCloner(t){},addPendingCommand(t){}},Qee=class extends Dee{constructor(t){super(),this.shared=t}create(t){return new yN(t,this.shared)}},a2=class{constructor(t,e={}){if(this.geometryCache=new EP(!0),this.geometryCache2=new EP(!1),this.imageHolderCache=new Qee(this),this.thisContext={scene:Kee,shared:this},this.deletedMaterial=new OS(fo.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new tu(gv.emptyImage,this),this.deletedVideo=new tu(uv.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.penumbraSize=[],this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[n,i]of Object.entries(e.images))this.addImage(n,i);if(e.videos)for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);if(e.audios)for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i.data);this.reset(t)}setRequestRender(t){this._requestRender=t}reset(t){for(let[e,n]of Object.entries(t.images))this.addImage(e,n);for(let[e,n]of Object.entries(t.videos))this.addVideo(e,n);for(let[e,n]of Object.entries(t.colors))this.addColor(e,n);for(let[e,n]of Object.entries(t.materials))this.addMaterial(e,new OS(n,this.thisContext));for(let[e,n]of Object.entries(t.audios))this.addAudio(e,n.data);for(let[e,n]of Object.entries(t.fonts))this.addFont(e,n);this.penumbraSize=t.penumbraSize}addMaterial(t,e){e.uuid=t,this.materials[t]=e}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):new CN(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new tu(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new tu(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new Ev(e.r,e.g,e.b,e.a):this.colors[t]=new Ev(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[t];return this.colors[t].r=e.r??n.r,this.colors[t].g=e.g??n.g,this.colors[t].b=e.b??n.b,this.colors[t].a=e.a??n.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let n=this.getColor(t);n?e=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new Rs(0,0,0,0))}else return"a"in t?new Rs(t.r,t.g,t.b,t.a):new Rs(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof qg)return e;{let n=new qg({src:e});return this.audios[t]=n,n}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof qg&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new Yee(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof qg&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}},ete=new a2(gS.emptyData()),Rp=class extends rl{updateByPatchedOp(t,e,n){if(super.updateByPatchedOp(t,e,n),U9(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[i,r]of Object.entries(t.props)){let s=n.shared.material(r);this.material[Number(i)]=s}else if(La(t.path,["material"])&&this.material instanceof sl)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(vr.drop(t,1),e.material,n);else if(La(t.path,["materials","*"])&&Array.isArray(this.material)){let i=t.path[1];if("materials"in e&&i<this.material.length){let r=e.materials[i];typeof r!="string"&&this.material[i].updateByOp(vr.drop(t,2),r,n)}}}updateState(t,e){var i,r,s,o,a;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let n=this.dataPatched;if(((i=t.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe),(r=e.scene)==null||r.markNeedsUpdateRendererDirty()),((s=t.geometry)==null?void 0:s.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(l=>e.shared.material(l).getFlavor(n.flatShading,n.side,n.wireframe)),(o=e.scene)==null||o.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe)],(a=e.scene)==null||a.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let l=0;l<this.material.length;l++)this.material[l]=this.material[l].getFlavor(n.flatShading,n.side,n.wireframe);else this.material=this.material.getFlavor(n.flatShading,n.side,n.wireframe)}disposeMaterial(){this.material&&$O(this.material).forEach(t=>{t instanceof sl&&(t instanceof OS||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},ol=class extends Rp{constructor(t,e,n){super(t,e),this.data=e,this.localGeometry=void 0}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Ze&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof a2){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return dv.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return dv.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),La(t.path,["geometry"])&&this.updateByPatchedOpGeometry(vr.drop(t,1),e.geometry,n)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var i;this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if(n==="NonParametricGeometry"||n==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let u={...this.data.geometry,...r};this.localGeometry=Mv(u,e,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&LS(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=Mv(r,e,this.data.flatShading)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,n){var r;let i=!1;t.type===0&&t.path.length===0&&wz(["scaleBaked"],Object.keys(t.props))&&this.geometryCreateDeleyed instanceof Bi&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),i||((r=n.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;this.is2DType?t.set(0,0,n.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}};function tte(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,n=t.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let u=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=new R(r[l],r[l+1],r[l+2]);e.has(u)?(o=e.get(u))==null||o.normals.push(d):e.set(u,{normals:[d],result:new R})}e.forEach((l,u)=>{for(let d of l.normals)l.result.add(d);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let u=`${i[l]}_${i[l+1]}_${i[l+2]}`,d=(a=e.get(u))==null?void 0:a.result;d&&(s[l]=d.x,s[l+1]=d.y,s[l+2]=d.z)}t.geometry.setAttribute("extrudeNormal",new De(s,3))}function nte(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=new R;for(let r=0;r<e.length;r+=3)i.set(e[r],e[r+1],e[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;t.geometry.setAttribute("extrudeNormal",new De(n,3))}function l2(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof sl)||t.material.getLayersOfType("outline").length===0)return;t instanceof ol&&t.is2DAndNoDepth?nte(t):tte(t)}function u2(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=parseInt(t.uuid.replace(/\D/g,"")),r=[Sn.seededRandom(i),Sn.seededRandom(i+1e4),Sn.seededRandom(i+2e4)];for(let s=0;s<e.length;s++)n[s]=r[s%3];t.geometry.setAttribute("randomColor",new pt(n,3))}n2.then(t=>{});var Qs=new ar,Wd=new R;function ite(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var zS=class extends ol{constructor(t,e,n){super(t,e,n),this.data=e,this.hiddenMatrixOld=new Fe,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:n,subdividedGeometry:i,subdivPointer:r}=Bi.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,n!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=n),i!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,l2(this),u2(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let n=this.material;this.material=n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){Bi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&Bi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=Bi.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=Bi.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,rl.prototype.raycast.call(this,t,e),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new Mr,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;Qs.setFromBufferAttribute(e),Qs.getCenter(n),t.boundingSphere.radius=n.distanceTo(Qs.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Qs.getSize(Wd),this.hasNonUniformScale&&Wd.divide(this.scale);let i={width:Wd.x,height:Wd.y,depth:Wd.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(t){let e=this.originalGeometry;Qs.min.set(t[0],t[2],t[4]),Qs.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(Qs.min.applyMatrix4(this.shearScaleInv),Qs.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new Mr);let n=e.boundingSphere.center;Qs.getCenter(n),e.boundingSphere.radius=n.distanceTo(Qs.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(Bi.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,n){super.updateByPatchedOpGeometry(t,e,n),this.localGeometry&&this.createGeometryByControls(e)}},AP=-1,rte=1,ste={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},ote={polygon_center:0,edge:1,vertex:2},Xg=(t,e)=>(n,i)=>!e||n===0||t===0?0:t*i/100,vt=(t,e)=>{let n=Math.abs(e),i=n*-1;return(t-AP)*(n-i)/(rte-AP)+i};function ate(t){let e=[],n={};for(var i=0,r=t.length;i<r;i++){var s=JSON.stringify(t[i].pos.map(o=>Math.round(o*1e4)/1e4));n[s]||(e.push(t[i]),n[s]=!0)}return e}var lte=new R,Yg=new R,ute=new R,cte=new R;function oh(t,e){let n=ute.fromArray(t),i=cte.fromArray(e);Yg.copy(i).sub(n);let r=Yg.length();return Yg.normalize().multiplyScalar(r*.5),lte.copy(n).add(Yg).toArray()}var Kr=new Ui,Zg=new R,Av=new R,$l=new R;function hte(t){let e=[];for(let n=0;n<=t.index.count;n++)if(Zg.fromArray(t.index.array,n*3),Kr.setFromAttributeAndIndices(t.attributes.position,Zg.x,Zg.y,Zg.z),Kr.getNormal(Av),Kr.getMidpoint($l),!(isNaN($l.x)||isNaN($l.y)||isNaN($l.z))){let{a:i,b:r,c:s}=Kr,o=i.toArray(),a=r.toArray(),l=s.toArray(),u=i.distanceTo(r),d=r.distanceTo(s),c=s.distanceTo(i),h=oh(o,a),m=oh(a,l),g=oh(l,o),v=[u,d,c],x=Math.max(...v),y=v.filter(b=>Math.round(b)===Math.round(x)).length>1,_=[],S=Kr.getMidpoint($l).toArray();x===u&&!y&&(_=[m,g,g],S=h),x===d&&!y&&(_=[h,g,g],S=m),x===c&&!y&&(_=[h,m,m],S=g),y&&(_=[h,m,g]),e.push({vertices:[o,a,l],faceCenters:_,midpoint:S,norm:Kr.getNormal(Av).toArray()})}return e}function dte(t){let e=[],{position:n}=t.attributes;for(let i=0;i<n.count;i++){Kr.setFromAttributeAndIndices(n,i*3,i*3+1,i*3+2),Kr.getNormal(Av),Kr.getMidpoint($l);let r=Kr.a.toArray(),s=Kr.b.toArray(),o=Kr.c.toArray();e.push({vertices:[r,s,o],faceCenters:[oh(r,s),oh(s,o),oh(o,r)],midpoint:$l.toArray(),norm:Av.toArray()})}return e}var fte=4,pte=.5,u_=t=>.5*(1-Math.cos(t*Math.PI)),mte=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,n=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let x=0;x<4095+1;x++)this.perlin[x]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),n<0&&(n=-n);let i=Math.floor(t),r=Math.floor(e),s=Math.floor(n),o=t-i,a=e-r,l=n-s,u,d,c=0,h=.5,m,g,v;for(let x=0;x<fte;x++){let y=i+(r<<4)+(s<<8);u=u_(o),d=u_(a),m=this.perlin[y&4095],m+=u*(this.perlin[y+1&4095]-m),g=this.perlin[y+16&4095],g+=u*(this.perlin[y+16+1&4095]-g),m+=d*(g-m),y+=256,g=this.perlin[y&4095],g+=u*(this.perlin[y+1&4095]-g),v=this.perlin[y+16&4095],v+=u*(this.perlin[y+16+1&4095]-v),g+=d*(v-g),m+=u_(l)*(g-m),c+=m*h,h*=pte,i<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(i++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return c}noiseSeed(t){let e=(()=>{let n,i;return{setSeed(r){i=n=(r??Math.random()*4294967296)>>>0},getSeed(){return n},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let n=0;n<4095+1;n++)this.perlin[n]=e.rand()}},gte=mte,TP=new R,CP=new Fe,PP=new hl;function vte(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(e=!0)}),e}var LN=class extends ol{constructor(t,e,n){super(t,e,n),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:n}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(CP.copy(n).invert(),PP.copy(t.ray).applyMatrix4(CP),PP.intersectBox(this.singleBBox,TP))){let i=TP.applyMatrix4(n),r=t.ray.origin.distanceTo(i);e.push({distance:r,point:i.clone(),object:this})}}},zi=1e-4,eo,IN,DN,RN,LP=new R,IP=new R;n2.then(t=>{eo=t,IN=[eo.get_face_center,eo.get_edge_midpoint,eo.get_vertex_position],DN=[eo.get_face_normal,eo.get_edge_normal,eo.get_vertex_normal],RN=[eo.face_count,eo.edge_count,eo.vertex_count]});var yte=new Fe,xte=new Fe,Ma=new R,Ol=new R,jd=new R,c_=new R,_te=new R,wte=new R,Oo=new gte,ON=class extends ZM(Pt){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof Jd&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof Jd&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,r=this.children.length;i<r;++i)this.remove(this.children[0]);let n=this.children;if(n.length===e)return;if(n.length<e)for(let i=0,r=e-n.length;i<r;++i){let s=new Jd(this.object);s.expand(),this.add(s)}else for(let i=0,r=n.length-e;i<r;++i)this.remove(n[i])}else{if(this.children.length===e)return;if(this.children.length<e)for(let n=0,i=e-this.children.length;n<i;++n){let r=new Jd(this.object);r.expand(),this.add(r)}else for(let n=0,i=this.children.length-e;n<i;++n)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,n=e.start*Sn.DEG2RAD,i=e.end*Sn.DEG2RAD,r=n-i,s=new qo(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new R(0,0,1);break;case"y":o=new R(0,1,0);break;default:case"x":o=new R(1,0,0);break}let a=t.randomnessObject??Ba.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";Oo.noiseSeed(a.seed);let u=Xx((0,Nd.default)(a.seed)),d=Xg(a.strength,this.parameters.randomness);for(let[c,h]of this.children.entries()){let m=c*(a.freqScale/10)+a.movement,g=l?Oo.noise(m):u(m,m);h.scale.x=e.scale[0]+d(c,vt(g,a.scale[0]))||zi,h.scale.y=e.scale[1]+d(c,vt(g,a.scale[1]))||zi,h.scale.z=e.scale[2]+d(c,vt(g,a.scale[2]))||zi,h.position.setScalar(0);let v=r/t.count*c-n;switch(e.axis){case"x":h.rotation.set(0,v,0);break;case"y":h.rotation.set(0,0,v);break;case"z":h.rotation.set(v,0,0);break}h.translateOnAxis(o,e.radius),h.position.x+=e.position[0]+d(c,vt(g,a.position[0])),h.position.y+=e.position[1]+d(c,vt(g,a.position[1])),h.position.z+=e.position[2]+d(c,vt(g,a.position[2]));let x=d(c,vt(g,a.rotation[0])),y=d(c,vt(g,a.rotation[1])),_=d(c,vt(g,a.rotation[2]));e.alignment===!0?(h.rotation.x+=s.x+x,h.rotation.y+=s.y+y,h.rotation.z+=s.z+_):h.rotation.set(s.x+x,s.y+y,s.z+_)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,n=new qo(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??Ba.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Oo.noiseSeed(i.seed);let s=Xx((0,Nd.default)(i.seed)),o=Xg(i.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let u=a*(i.freqScale/10)+i.movement,d=r?Oo.noise(u):s(u,u),c=o(a,vt(d,i.rotation[0])),h=o(a,vt(d,i.rotation[1])),m=o(a,vt(d,i.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(a,vt(d,i.scale[0]))||zi,l.scale.y=1+(e.scale[1]-1)*a+o(a,vt(d,i.scale[1]))||zi,l.scale.z=1+(e.scale[2]-1)*a+o(a,vt(d,i.scale[2]))||zi,l.rotation.x=n.x*a+c,l.rotation.y=n.y*a+h,l.rotation.z=n.z*a+m,l.position.x=e.position[0]*a+o(a,vt(d,i.position[0])),l.position.y=e.position[1]*a+o(a,vt(d,i.position[1])),l.position.z=e.position[2]*a+o(a,vt(d,i.position[2]))}}_updateGrid(t){let e=0,n=t.grid,i=t.randomnessObject??Ba.defaultData([1,1,1]).randomnessObject,r=Xg(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";Oo.noiseSeed(i.seed);let o=wK((0,Nd.default)(i.seed));if(n.useCenter===!0){let a={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},l=new R(n.size[0]*(n.count[0]-a.x)*.5,n.size[1]*(n.count[1]-a.y)*.5,n.size[2]*(n.count[2]-a.z)*.5);for(let u=0;u<n.count[0];u++)for(let d=0;d<n.count[1];d++)for(let c=0;c<n.count[2];c++){let h=[(u+1)*(i.freqScale/10)+i.movement,(d+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],m=s?Oo.noise(...h):o(...h),g=this.children[e++];g.scale.x=1+r(e,vt(m,i.scale[0]))||zi,g.scale.y=1+r(e,vt(m,i.scale[1]))||zi,g.scale.z=1+r(e,vt(m,i.scale[2]))||zi;let v=r(e,vt(m,i.rotation[0])),x=r(e,vt(m,i.rotation[1])),y=r(e,vt(m,i.rotation[2]));g.rotation.set(v,x,y),g.position.x=n.size[0]*u-l.x+r(e,vt(m,i.position[0])),g.position.y=n.size[1]*d-l.y+r(e,vt(m,i.position[1])),g.position.z=n.size[2]*c-l.z+r(e,vt(m,i.position[2]))}}else for(let a=0;a<n.count[0];a++)for(let l=0;l<n.count[1];l++)for(let u=0;u<n.count[2];u++){let d=[(a+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],c=s?Oo.noise(...d):o(...d),h=this.children[e++];h.scale.x=1+r(e,vt(c,i.scale[0]))||zi,h.scale.y=1+r(e,vt(c,i.scale[1]))||zi,h.scale.z=1+r(e,vt(c,i.scale[2]))||zi;let m=r(e,vt(c,i.rotation[0])),g=r(e,vt(c,i.rotation[1])),v=r(e,vt(c,i.rotation[2]));h.rotation.set(m,g,v),h.position.x=n.size[0]*a+r(e,vt(c,i.position[0])),h.position.y=-n.size[1]*l+r(e,vt(c,i.position[1])),h.position.z=-n.size[2]*u+r(e,vt(c,i.position[2]))}}_updateToObject(t){var v;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,n=new qo(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??Ba.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Oo.noiseSeed(i.seed);let s=Xx((0,Nd.default)(i.seed)),o=Xg(i.strength,this.parameters.randomness);if(!e.object){for(let[,x]of this.children.entries())x.position.set(0,0,0),x.scale.setScalar(1),x.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof LN)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],u=x=>{let y=x.length,_=x.map(T=>T[0]).reduce((T,E)=>T+E,0),S=x.map(T=>T[1]).reduce((T,E)=>T+E,0),b=x.map(T=>T[2]).reduce((T,E)=>T+E,0);return[_/y,S/y,b/y]},d=x=>Math.round(x*1e6)/1e6;a.forEach(x=>{let y=a.filter(_=>d(x.pos[0])===d(_.pos[0])&&d(x.pos[1])===d(_.pos[1])&&d(x.pos[2])===d(_.pos[2]));y.length>1?l.push({pos:x.pos,norm:u(y.map(_=>_.norm))}):l.push(x)});let c=ate(l);if(a.length>0){let x=Math.round(c.length*e.count/100);this._updateCount(x)}this.objectForSample.updateMatrixWorld();let h=new SK(this.objectForSample).build(),m=ste[e.axis],g=this.children;h.setRandomGenerator((0,Nd.default)(this.object.uuid+e.seed));for(let[x,y]of g.entries()){let _=x*(i.freqScale/10)+i.movement,S=r?Oo.noise(_):s(_,_),b=o(x,vt(S,i.rotation[0])),T=o(x,vt(S,i.rotation[1])),E=o(x,vt(S,i.rotation[2]));e.spreadType==="random"?h.sample(jd,c_):(c.length&&(jd.fromArray(c[x].pos),c_.fromArray(c[x].norm)),this.objectForSample instanceof zS&&jd.applyMatrix4(yte.copy(this.objectForSample.matrixWorld).invert())),jd.applyMatrix4(this.object.hiddenMatrix.clone().invert()),y.position.copy(jd),Ma.fromArray(m);let L=e.align==="normal"?c_:this.object.getWorldDirection(wte),A=Ol.fromArray(e.position);Ol.x+=Ol.x+o(x,vt(S,i.position[0])),Ol.y+=Ol.y+o(x,vt(S,i.position[1])),Ol.z+=Ol.z+o(x,vt(S,i.position[2]));let I=Math.acos(L.dot(Ma)),P=_te.crossVectors(Ma,L).normalize(),O=xte.makeRotationAxis(P,I),k=L.clone().cross(this.object.up).normalize(),F=k.clone().cross(L).normalize(),G=new Fe().makeBasis(k,L,F),Z=new R(Ma.y,Ma.z,Ma.x).normalize(),ne=Z.clone().cross(Ma).normalize(),J=new Fe().makeBasis(Z,Ma,ne).invert(),z=new Fe().multiplyMatrices(G,J);y.rotation.setFromRotationMatrix(z),A.applyMatrix4(O),y.position.add(A),y.rotation.x=y.rotation.x+n.x+b,y.rotation.y=y.rotation.y+n.y+T,y.rotation.z=y.rotation.z+n.z+E,y.scale.setScalar(1),y.scale.x=y.scale.x+e.scale[0]+o(x,vt(S,i.scale[0]))||zi,y.scale.y=y.scale.y+e.scale[1]+o(x,vt(S,i.scale[1]))||zi,y.scale.z=y.scale.z+e.scale[2]+o(x,vt(S,i.scale[2]))||zi,y.scale.multiply(this.object.scale),y.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof zS){let e=this.objectForSample,n=ote[t],i=RN[n],r=IN[n],s=DN[n],o=[],a=i(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let u=r(e.subdivPointerNew,l),d=s(e.subdivPointerNew,l);LP.fromArray(u).applyMatrix4(e.matrixWorld),IP.fromArray(d),o.push({pos:LP.toArray(),norm:IP.toArray()})}return o}else return(this.objectForSample.geometry.index?hte(this.objectForSample.geometry):dte(this.objectForSample.geometry)).map((e,n)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var n;if(this.parameters=vy(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=e.find(this.parameters.toObject.object);i instanceof rl?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new Fe,this.hiddenMatrix=new Fe,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},Op=t=>{var e;return e=class extends t{},e.geometryHelper=new or(30,30,30),e},Jg=new hl,h_=new Mr,DP=new Fe,zp=(t,e,n,i,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),h_.copy(s.boundingSphere),h_.applyMatrix4(o),n.ray.intersectsSphere(h_)===!1||(DP.copy(o).invert(),Jg.copy(n.ray).applyMatrix4(DP),s.boundingBox!==null&&Jg.intersectsBox(s.boundingBox)===!1))return;let a,l,u,d,c=s.index,h=s.attributes.position,m=s.drawRange,g,v;if(r===!1){let y=Math.max(0,m.start),_=Math.min(c.count,m.start+m.count);for(g=y,v=_;g<v;g+=3)if(l=c.getX(g),u=c.getX(g+1),d=c.getX(g+2),a=x(t,n,Jg,h,l,u,d),a){a.faceIndex=Math.floor(g/3),i.push(a);return}}else{let y=s.attributes.position,_=new R,S=new R,b=new R,T=new R,E=2,L=1/((t.scale.x+t.scale.y+t.scale.z)/3),A=L*L,I=Math.max(0,m.start),P=Math.min(y.count,m.start+m.count);for(let O=I,k=P-1;O<k;O+=E){if(_.fromBufferAttribute(y,O),S.fromBufferAttribute(y,O+1),Jg.distanceSqToSegment(_,S,T,b)>A)continue;T.applyMatrix4(t.matrixWorld);let F=n.ray.origin.distanceTo(T);F<n.near||F>n.far||i.push({distance:F,point:b.clone().applyMatrix4(t.matrixWorld),object:t})}}function x(y,_,S,b,T,E,L){let A=new R,I=new R,P=new R,O=new R,k=new R;if(A.fromBufferAttribute(b,T),I.fromBufferAttribute(b,E),P.fromBufferAttribute(b,L),S.intersectTriangle(A,I,P,!1,O)===null)return null;k.copy(O),k.applyMatrix4(y.matrixWorld);let F=_.ray.origin.distanceTo(k);return F<_.near||F>_.far?null:{faceIndex:1,distance:F,point:k.clone(),object:y}}},Kg=new R,Gr=new Lu,Ste=class extends ks{constructor(t){let e=new Ze,n=new Li({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},o=new Ge(15711266),a=new Ge(15711266),l=new Ge(2857471);u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",a),u("p","n2",a),u("p","n3",a),u("p","n4",a),u("u1","u2",l),u("u2","u3",l),u("u3","u1",l);function u(c,h,m){d(c,m),d(h,m)}function d(c,h){i.push(0,0,0),r.push(h.r,h.g,h.b),s[c]===void 0&&(s[c]=[]),s[c].push(i.length/3-1)}e.setAttribute("position",new De(i,3)),e.setAttribute("color",new De(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;Gr.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=1,i=1,r=.8;ws("n1",e,t,Gr,-n,-i,r),ws("n2",e,t,Gr,n,-i,r),ws("n3",e,t,Gr,-n,i,r),ws("n4",e,t,Gr,n,i,r);let s=r;ws("f1",e,t,Gr,-n,-i,s),ws("f2",e,t,Gr,n,-i,s),ws("f3",e,t,Gr,-n,i,s),ws("f4",e,t,Gr,n,i,s);let o=s,a=.5;ws("u1",e,t,Gr,n*.7*a,i*1.1,o),ws("u2",e,t,Gr,-n*.7*a,i*1.1,o),ws("u3",e,t,Gr,0,i*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function ws(t,e,n,i,r,s,o){Kg.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let u=0,d=a.length;u<d;u++)l.setXYZ(a[u],Kg.x,Kg.y,Kg.z)}}var bte=class extends Op(Ste){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){zp(this.object,this.geometry,t,e,!0)}},NS;(t=>t.is=e=>"objectHelper"in e)(NS||(NS={}));var xy=(t,e)=>class extends Ez(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(n,i){this.objectHelper.raycast(n,i)}showGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof rp&&(i.visible=!0)}}updateEntityBoxSize(n,i){this.objectHelper.visible&&this.geometryHelper instanceof or?(n.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(n,i)}hideGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof rp&&(i.visible=!1)}}},d_=790,wc=new R,f_=new R,Tv=class extends xy(Lu,bte){constructor(t="",e={...fv.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=lp.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.super_Entity(t,e),this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;if(e.orthographic.autoZoom){let r=e.orthographic.autoZoomFrustumSize??d_,s=n/i,o=n>i?s:1,a=n>i?1:s;this.orthoCamera=new ia(-r*.5*o,r*.5*o,r*.5*(1/a),-r*.5*(1/a),-5e4,1e4)}else this.orthoCamera=new ia(n*-.5,n*.5,i*.5,i*-.5,-5e4,1e4);this.perspCamera=new Un(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,n){typeof t=="number"&&(t=new R(t,e,n)),super.lookAt(t),this.getWorldPosition(wc),this.targetOffset=wc.distanceTo(t)}getTarget(t=new R){return this.getWorldDirection(f_),this.getWorldPosition(wc),f_.multiplyScalar(this.targetOffset),t.copy(wc).add(f_),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(wc),wc.distanceTo(t)}updateUp(){let t=this.getWorldQuaternion(new Ti),e=new R(0,0,1).applyQuaternion(t),n=new R().copy(Pt.DEFAULT_UP);this.isUpVectorFlipped&&n.negate(),n.applyQuaternion(t);let i=new R().copy(Pt.DEFAULT_UP).projectOnPlane(e),r=new R().crossVectors(i,n).dot(e)>=0?1:-1;this.angleOffsetFromUp=i.angleTo(n)*r}updateTransformState(t){let e=super.updateTransformState(t);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),e}getViewFrontToObject(t){let e=t.getWorldPosition(new R),n=t.getWorldDirection(new R).multiplyScalar(this.targetOffset);return{position:e.clone().add(n),target:e}}getViewToObject(t){let e=t.getWorldPosition(new R),n=this.getWorldDirection(new R).multiplyScalar(this.targetOffset);return{position:e.clone().sub(n),target:e}}setViewplaneSize(t,e){if(this.aspect=t/e,this.data.type==="OrthographicCamera"&&this.data.orthographic.autoZoom){let n=this.data.orthographic.autoZoomFrustumSize??d_,i=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-n*.5*i,this.right=n*.5*i,this.top=n*.5*(1/r),this.bottom=-n*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,n,i,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,n,i,r,s):this.orthoCamera.setViewOffset(t,e,n,i,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom,autoZoom:!0,autoZoomFrustumSize:d_},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return SS(e,t)}updateCameraSubtype(t,e){let n=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(n,e.zoom),e.near!==void 0&&this.setNear(n,e.near),e.fov!==void 0&&n==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},RP=new Fe,Ah=class extends Rp{constructor(t,e,n){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Ze,this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var i;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof Ah&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof rl&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ta.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;Ta.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1}else s instanceof Ah&&s.needsTransformForDownstream===!0?(Ta.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(RP.multiplyMatrices(s.matrix,s.booleanMatrixInvOld),Ta.transformMeshSet(s.booleanMeshSetAddress,RP),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1);this.meshSetAddresses.push(s.booleanMeshSetAddress)}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new QD([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return Ta.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new Ze,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=Ta.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,l2(this),u2(this)}dispose(){super.dispose(),this.geometry.dispose()}},OP;(t=>{function e(n){return hn.is(n)&&n instanceof la}t.is=e})(OP||(OP={}));var c2=(t,e)=>class extends xy(t,e){updateState_Light(n,i){this.updateState_Entity(n,i),n.color!==void 0&&(this.color=i.shared.color(n.color)),n.intensity!==void 0&&(this.intensity=n.intensity),n.depth!==void 0&&(this.shadow.camera.far=n.depth,this.shadow.needsUpdate=!0),n.shadows!==void 0&&(this.castShadow=n.shadows)}},Qg=t=>t instanceof rl,e0=t=>t!==null&&t instanceof Ah,Mte=t=>t instanceof Tv,Ete=t=>NS.is(t),h2=class extends Op(KR){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}raycast(t,e){zp(this.object,h2.geometryHelper,t,e)}update(){}},zP=class extends xy(Oa,h2){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},zN=class extends Op(JR){constructor(t,e=15,n=10066329){super(t,e,n),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){zp(this.object,zN.geometryHelper,t,e)}},NN=class extends Op(ZR){constructor(t,e=15,n=6710886){super(t,e,n),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){zp(this.object,NN.geometryHelper,t,e)}},kS=class extends Op(XR){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){zp(this.object,kS.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=kS._vector,e=this.object.distance?this.object.distance:1e3,n=e*Math.tan(this.object.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},kN=kS;kN._vector=new R;function Ate(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var Tte=class extends c2(fM,zN){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new ip(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof ip&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let n=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&Ate(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),n&&this.update()}},Cte=class extends c2(dM,NN){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new R(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new R(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new ar(r,s),a=new rp(o,new Ge(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof rp){let n=this.shadow.camera,i=new R(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),r=new R(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);e.box.set(i,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},NP=new R,kP=new R,BP=new Ti,Pte=class extends c2(hM,kN){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=Sn.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new ip(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof ip&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),kP.setFromMatrixPosition(this.matrixWorld),BP.setFromRotationMatrix(this.matrixWorld),NP.copy(this.up).applyQuaternion(BP).negate().multiplyScalar(this.distance),this.target.position.copy(kP).add(NP),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},Lte=class extends ol{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?i2(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},BN=class extends ol{constructor(t,e,n){super(t,e,n),this._shapeId=null,this._context=n}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var i;let t=this.data.geometry.extrusion.shape,e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(i=s.geometry.userData)==null?void 0:i.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=Vz;break;case"Ellipse":r=e2;break;case"Polygon":r=Fz;break;case"Star":r=Gz;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t){return super.updateTransformState(t)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?i2(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},_f=class extends xy(Oa,h2){constructor(t,e,n){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,n)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let n=e.scene.data.objects.get(t.component);if(n){let i,r;for(let s of bh.rootOverrideProps)t[s]===void 0?(i===void 0&&(i={...t}),i[s]=n.data[s]):(r===void 0&&(r={}),r[s]=t[s]);return this.overrideData=r,i??t}return t}updateByOp(t,e,n,i){let r;if(this.isInstanceRoot&&!i&&(e=this.transformAssignData(e,n),t.type===0&&t.path.length===0&&this.component))for(let s of bh.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);super.updateByOp(r??t,e,n,i)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){this.component=t.scene.find(e.component)??null;let n=!1;if(this.component!==this.oldComponent){if(this.oldComponent){let i=0;for(let r of this.children)if(hn.is(r))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),d2(r),i+=1;else break;this.children.splice(0,i)}n=!0}this.component&&UN(t,[this.uuid],e.overrides,this,this.component,this.component,0,n),this.oldComponent=this.component}}};function d2(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let n of t.children)hn.is(n)&&d2(n)}}function UP(t,e,n,i){return t.component===e&&wz(t.identity,i)?t.overrideData===n?2:1:0}function UN(t,e,n,i,r,s,o,a){if(o>50)return!1;if(i.component!==r){if(i.component){let u=i.component.instances.indexOf(i);u>=0&&i.component.instances.splice(u,1)}r.instances.push(i),i.component=r}r instanceof _f&&r.isInstanceRoot&&r.expandInstanceChildren(t);let l=0;for(let u of r.children)if(hn.is(u)){let d=[...e,...typeof u.identity=="string"?[u.identity]:u.identity],c=pv.resolve(n,d,1),h=null,m;if(!a){let g=i.children[l];if(h=hn.is(g)?g:null,h!==null){let v=UP(h,u,c,d);m=v>=1?h.stateSelection:void 0,v!==2&&(h=null)}if(h===null&&(h=t.scene.findInstance(d)??null,h!==null)){let v=UP(h,u,c,d);if(m=v>=1?h.stateSelection:void 0,v!==2)h=null;else{let x=h.parent.children.indexOf(h);h.parent.children.splice(x,1),i.children.splice(l,0,h),h.parent===i?x<=l&&console.error("not possible"):(h.parent=i,h.matrixWorldNeedsUpdate=!0,h.resetBBoxNeedsUpdate(),h.updateVisible(),t.pendingDeletes.delete(h))}}}if(h===null){let g=c?cu.apply(u.data,c):u.data;Mu.is(g.type)&&(g={...g,type:"Empty"}),h=Ua.createEntity(d,g,t),h.overrideData=c,i.add(h),i.children.splice(i.children.length-1,1),i.children.splice(l,0,h),h.updateState(h.data,t),m&&h.changeSelectedState(m,t),t.scene.registerInstanceAndSetUuid(h)}l+=1,UN(t,e,n,h,u,s,o+1,a)}if(!a){let u=l;for(;;){let d=i.children[l];if(hn.is(d))t.pendingDeletes.add(d);else break;l+=1}i.children.splice(u,l-u)}return!0}function Ite(t,e,n){let i;return e.geometry.type==="TextGeometry"?new LN(t,e,n):(e.geometry.type==="SubdivGeometry"?i=new zS(t,e,n):e.geometry.type==="PathGeometry"?i=new BN(t,e,n):e.geometry.type==="VectorGeometry"?i=new Lte(t,e,n):e.geometry.type==="BooleanGeometry"?i=new Ah(t,e,n):i=new ol(t,e,n),i)}function f2(t,e,n){return e.type==="Mesh"?Ite(t,e,n):e.type==="Empty"?new zP(t,e):e.type==="PointLight"?new Cte(t,e,n):e.type==="SpotLight"?new Pte(t,e,n):e.type==="DirectionalLight"?new Tte(t,e,n):e.type==="Component"||e.type==="Instance"?new _f(t,e,n):Mu.is(e.type)?new Tv(t,e):(console.error(e),new zP(t,e))}Ua.createEntity=f2;function Dte(t,e,n){let i=f2(t.identity,e,n),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,u=t.overrideData,d=t.uuid,c=t.stateSelection;t.dispose();for(let h of Object.keys(t))delete t[h];Object.setPrototypeOf(t,Object.getPrototypeOf(i));for(let h of Object.keys(i))t[h]=i[h];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=d,t.overrideData=u,t.updateState(t.data,n),c&&t.changeSelectedState(c,n),t.resetBBoxNeedsUpdate()}Ua.changeEntityProptotype=Dte;Ua.Cloner=ON;function Rte(t,e,n,i){t.updateByOp(e,n,i,!1)}function FP(t,e){let n=!1,i=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),i.length>0&&t.layers.enable(3),n=!0,u2(t),l2(t)),i.length===0&&r.length===0&&t.layers.set(0),n}function VP(t,e){if(!e.layers)return!1;let n=!1,i=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return i.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),n=!0),i.length===0&&r.length===0&&t.layers.set(0),n}function Ote(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof Rp)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)FP(n,n.material[i])&&(e=!0);else FP(n,n.material)&&(e=!0)}),e}function zte(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof Rp)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)VP(n,n.material[i])&&(e=!0);else VP(n,n.material)&&(e=!0)}),e}var Nte=new xM,kte=new Fe,Bte=new hl;function Ute(t,e,n){let i=t.cloner;if(i)for(let r of i.children){let s=kte.copy(r.matrixWorld).invert(),o=Bte.copy(e.ray).applyMatrix4(s),a=t.matrixWorld;o.applyMatrix4(a);let l=Nte;l.set(o.origin,o.direction),l.near=e.near,l.far=e.far,l.intersectObject(t,!1).length>0&&n.push({object:t})}}var Fte=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let n=t;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===e)return!0;return!1}},Vte=new mo;Vte.wireframe=!0;var GP=new R,FN=class extends Yf{constructor(t,e){super(),this.data=t,this.backupFog=new yp(16777215,.1,2e3),this.fogUseBGColor=!1,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.bgColor=new Rs(1,1,1,1),this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new Fte,this.needsRecomputeInstances=!1,this.ambientLight=new uM(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.personalCamera=this.createPersonalCamera(),this.activeCamera=this.personalCamera,this.postprocessing=t.postprocessing,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=zte(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=Ote(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),n=this.entityIdentityToEntity[e];n&&(t.uuid=n.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let n=[],i=e;for(;i!==this;){let r=i;i=i.parent;let s=i.children.indexOf(r);n.splice(0,0,s)}return{entity:e,sortKey:n}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push(i)}return e.sort((n,i)=>aj(n.sortKey,i.sortKey)),e.map(n=>n.entity)}nonExistOrDescendantOf(t,e){let n=this.find(t);if(n===void 0)return!0;for(;n;){if(n.uuid===e)return!0;n=n.parent}return!1}find(t){if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateTreeByOp(t,e){var n;if(t.path.length===0&&t.type===7){let i=t.parent===null?this:this.find(t.parent);if(i===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,i,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),Qg(r)&&e0(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r)}else if(t.path.length===0&&t.type===8){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(i),i.parent.remove(i),e0(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Qg(i)&&(i.freeBooleanPointer(),r instanceof Ah&&r.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof BN&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid)}else if(t.path.length===0&&t.type===9){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),(n=i.cloner)==null||n.resetOnMove(),this.markToExpandCloner(i);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),Qg(i)&&(i.invalidateUpstreamBooleanData(),e0(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof Ah&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}updateEntityByOp(t,e,n,i){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),e.path.includes("overrides")&&"states"in e.props){let{states:s,rest:o}=e.props;e={...e,props:o},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{Rte(r,e,n,{scene:this,shared:i}),r instanceof ol&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get enableFog(){return this.fog!==null}set enableFog(t){this.fog=t===!0?this.backupFog:null}init(t,e){if(this.createChildrenObjects(t.objects,this,e),this.personalCamera.removeFromParent(),this.add(this.personalCamera),this.ambientLight.removeFromParent(),this.add(this.ambientLight),this.setBackgroundColor(yr(t.backgroundColor,e)),this.updateFog(t.fog,e),this.updateAmbientLight(t.environment.ambientLight,e),this.activeCamera=this.personalCamera,t.publish.playCamera!==null){let n=this.find(t.publish.playCamera);n instanceof Tv&&this.switchActiveCamera(n)}this.expandInstances(e,!0),this.traverseEntity(n=>{e0(n)&&n.recomputeBoolean()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){hn.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{hn.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,n,i,r,s,o){t&&t!==i.uuid&&i.find(t)&&r.forInstancesRec(a=>{a.isInstanceRoot||(a.data=ov(a.data,l=>{let u=l.events.data(o.id),d=a.goUp(s);if(d){let c=[...$O(d.identity),t].join("-"),h=this.entityIdentityToEntity[c];if(h){let m=h.uuid;ho.zoom(u,e)[n]=m}else console.warn("cannot find instance")}}).data)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof _f&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,n)=>{e.data.events.forEach(i=>{i.data.type==="GameControl"?e.forInstancesRec(r=>{r.isInstanceRoot||(r.data=ov(r.data,s=>{s.events.delete(i.id)}).data)}):i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",t,e,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",t,e,n,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",t,e,n,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,n,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,n,i)),i.data.inActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["inActions",r.id],"object",t,e,n,i)}),i.data.outActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["outActions",r.id],"object",t,e,n,i)})):"actions"in i.data&&i.data.actions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["actions",r.id],"object",t,e,n,i)})})}),!0})}expandInstances(t,e){let n=new Set;this.traverseEntity(i=>{if(i instanceof _f&&i.isInstanceRoot)return i.expandInstanceChildren({scene:this,shared:t,pendingDeletes:n}),e||i.resetBBoxNeedsUpdate(),!0});for(let i of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),d2(i)}recomputeInstances(t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(e=>{e instanceof _f&&e.isInstanceRoot&&(e.component=void 0)}),this.expandInstances(t,!1))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let n=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[n]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[n]),e.dispose()})}clearScene(){for(let t of this.children)hn.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}createPersonalCamera(){let t=new Tv(FN.PERSONAL_CAMERA_ID,{...fv.defaultData,name:"Personal Camera"});return t.objectHelper.visible=!1,this.registerObjectCreatedInLegacy(t),t}raycast(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;hn.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((Qg(r)||Ete(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),Ute(r,t,e)),n(r))}};return n(this),e}forEachEntity(t){for(let e of this.children)hn.is(e)&&t(e)}traverseEntity(t){for(let e of this.children)hn.is(e)&&e.traverseEntity(t)}traverseObject(t){for(let e of this.children)Sv.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)hn.is(e)&&e.visible&&e.traverseVisibleEntity(t)}updateFog(t,e){this.enableFog=t.enabled,this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=yr(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}dispose(){this.clearScene()}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=yr(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.groundColor!==void 0&&(this.ambientLight.groundColor=yr(t.groundColor,e)),t.enabled!==void 0&&(this.ambientLight.visible=t.enabled)}switchActiveCamera(t){this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}createChildrenObjects(t,e,n){let i=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,i,n),i+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,n,i,r,s){var l;let o={scene:this,shared:s},a=f2(t,e,o);return a&&(this.entityByUuid[t]=a,i.add(a),i.children.splice(r,0,i.children.pop()),n.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,a,s)),a.updateState(e,o),a instanceof ol&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),a}getCenter(t){let e=[];for(let i=0,r=t.length;i<r;++i){let{id:s,recursive:o}=t[i],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let n=new ar;return n.setFromPoints(e),n.getCenter(GP),GP}copyMatrixWorld(t,e){if(t===null){e.identity();return}let n=this.find(t);n?e.copy(n.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var i;if(t===null){e.identity();return}let n=(i=this.find(t))==null?void 0:i.parent;n?e.copy(n.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof rl)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)e.material[n]instanceof sl&&t(e.material[n]);else e.material instanceof sl&&t(e.material)})}updateCanvasSize(t,e){this.activeCamera.setViewplaneSize(t,e);let n,i;t>=e?(n=e/t,i=1):(n=1,i=t/e),this.traverseMaterial(r=>{r.getLayersOfType("transmission").forEach(s=>{s.uniforms[`f${s.id}_aspectRatio`].value.x=n,s.uniforms[`f${s.id}_aspectRatio`].value.y=i})})}},VN=FN;VN.PERSONAL_CAMERA_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera";var Ga;function Gte(){return Ga||(Ga=new m9,Ga.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),Ga.decoderPending}async function Hte(t){if(Ga){let e={attributeIDs:Ga.defaultAttributeIDs,attributeTypes:Ga.defaultAttributeTypes,useUniqueIDs:!1},n;try{n=await Ga.decodeGeometry(new Int8Array(t).buffer,e)}catch(i){console.error(i)}if(n)return{index:n.index?{array:n.index.array}:void 0,attributes:Object.entries(n.attributes).map(([i,r])=>({name:i,itemSize:r.itemSize,array:r.array}))}}return null}async function Wte(t,e){let[n,i]=IO(rS.deserialize(new Uint8Array(t)));yK(n);let r=[];n.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await Gte();for(let s of r){let o=await Hte(Ci(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:u,itemSize:d})=>{a[l]={array:u,itemSize:d,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(n),i.result().data}function jte(t){let e;if(t.index)for(let n=0;n<t.index.array.length;n+=3)e=t.index.array[n],t.index.array[n]=t.index.array[n+2],t.index.array[n+2]=e}function $te(t){let e=new Set;return t.traverse(n=>{if(n instanceof Rp)if(Ns(n.material))n.material.forEach(i=>{let r=i;e.has(r)||e.add(r)});else{let i=n.material;e.has(i)||e.add(i)}}),e.forEach(n=>{if(n instanceof Array)return;let i=n.onBeforeCompile.bind(n);if(qte(n)){Object.assign(n,{isMeshStandardMaterial:!0,isMeshPhysicalMaterial:!0,transmission:1,attenuationColor:new Ge,specularColor:new Ge});let r=0;n.onBeforeCompile=(s,o)=>{i&&i(s,o),s.uniforms=Object.assign({},Zr.physical.uniforms,s.uniforms),n.getLayersOfType("transmission").forEach(a=>{if(s.uniforms.transmissionSamplerMap.value){let l=a.color;l&&(l.transmissionSamplerMap.value=s.uniforms.transmissionSamplerMap.value,l.transmissionSamplerSize.value=s.uniforms.transmissionSamplerSize.value)}else r++,r<2&&(n.needsUpdate=!0)})}}else Xte(n)||(n.onBeforeCompile=(r,s)=>{i&&i(r,s),n.transparent=!1})}),t}function qte(t){return t.getLayersOfType("transmission").length>0}function Xte(t){let e=0;return t.layers.forEach(n=>{if(n.type!=="light"&&n.type!=="fresnel"){let i=n.uniforms["f"+n.id+"_alpha"];i&&(e+=(1-e)*i.value)}}),e<1}function Yte(t){return t.traverse(e=>{if(e.type==="Camera"){let n=e;n.type=n.cameraType}}),t}function Zte(t){let e=[],n=(i,r=0)=>{let s=r>0?i+r:i;return e.includes(s)?n(i,r+1):s};return t.traverse(i=>{if(e.includes(i.name)){let r=i.name,s=n(i.name);if(i.name=s,i.isMesh){let o=i;o.material instanceof Array?o.material.forEach(a=>{a.name=a.name.replace(r,s)}):o.material.isAsset||(o.material.name=o.material.name.replace(r,s))}}e.push(i.name)}),t}function Jte(t){let e=[];return t.traverse(n=>{n instanceof ON&&e.push(n)}),e.forEach(n=>{let i=n.object,r=n.children.map(o=>{o.updateMatrix();let a=o.geometry.clone().applyMatrix4(o.matrix);return o.matrix.determinant()<0&&jte(a),a}),s=bO(n.parameters.hideBase?r:[i instanceof rl?i.geometry:[],...r]);i instanceof rl&&(i.geometry=s),n.removeFromParent(),i.setFromClonerState(null,{scene:t,shared:ete})}),t}function Kte(t){return t.traverse(e=>{e.matrixAutoUpdate=!0}),t}function Qte(t){Object.values(t.shared.materials).forEach(e=>{p_(e)}),t.scene.objects.traverse((e,n)=>{"material"in n?p_(n.material):"materials"in n&&n.materials.forEach(i=>{p_(i)})})}function p_(t){if(typeof t=="string")return;let e=[];t.layers.forEach((n,i)=>{n.type==="outline"&&e.push(i)}),e.reverse().forEach(n=>{t.layers.delete(n)}),e.length&&console.warn("The Spline Loader currently does not support the outline layer.")}var ene=oy(T9(),1),HP="The SplineLoader only accepts .splinecode files that are generated from Spline export panel.",tne=class extends Wi{load(t,e,n,i=console.error){let r=new cs(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),t.endsWith(".spline")?console.warn(HP+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(HP),r.load(t,async s=>{try{if(typeof s=="string")throw new Error("The .spline file is not binary!");let o=await this.parse(s);e(o)}catch(o){i(o)}},n,i)}async parse(t){let e=await Wte(t,Qte);e.version&&(0,ene.default)(e.version,"0.9.269")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/loader to the latest version."),await Promise.all([ite(e)&&HQ(),vte(e)&&Wee()].filter(Boolean));let n=new a2(e.shared);Object.values(n.getMaterials()).forEach(s=>Object.assign(s,{isAsset:!0}));let i=new VN(e.scene,n);i.remove(i.personalCamera),e.scene.environment.ambientLight.enabled||i.remove(i.ambientLight);let r=e.scene.publish.playCamera;if(r){let s=i.find(r);s&&Mte(s)&&Object.assign(s,{makeDefault:!0})}return i=Jte(i),i=$te(i),i=Yte(i),i=Zte(i),i=Kte(i),i}};function nne(t){const e=wM(tne,t);return DW(e)}var GN={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},WP=nu.createContext&&nu.createContext(GN),Qa=globalThis&&globalThis.__assign||function(){return Qa=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},Qa.apply(this,arguments)},ine=globalThis&&globalThis.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function HN(t){return t&&t.map(function(e,n){return nu.createElement(e.tag,Qa({key:n},e.attr),HN(e.child))})}function rne(t){return function(e){return nu.createElement(sne,Qa({attr:Qa({},t.attr)},e),HN(t.child))}}function sne(t){var e=function(n){var i=t.attr,r=t.size,s=t.title,o=ine(t,["attr","size","title"]),a=r||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),nu.createElement("svg",Qa({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,o,{className:l,style:Qa(Qa({color:t.color||n.color},n.style),t.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),s&&nu.createElement("title",null,s),t.children)};return WP!==void 0?nu.createElement(WP.Consumer,null,function(n){return e(n)}):e(GN)}function one(t){return rne({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M3.29227 0.048984C3.47033 -0.032338 3.67946 -0.00228214 3.8274 0.125891L12.8587 7.95026C13.0134 8.08432 13.0708 8.29916 13.0035 8.49251C12.9362 8.68586 12.7578 8.81866 12.5533 8.82768L9.21887 8.97474L11.1504 13.2187C11.2648 13.47 11.1538 13.7664 10.9026 13.8808L8.75024 14.8613C8.499 14.9758 8.20255 14.8649 8.08802 14.6137L6.15339 10.3703L3.86279 12.7855C3.72196 12.934 3.50487 12.9817 3.31479 12.9059C3.1247 12.8301 3 12.6461 3 12.4414V0.503792C3 0.308048 3.11422 0.130306 3.29227 0.048984ZM4 1.59852V11.1877L5.93799 9.14425C6.05238 9.02363 6.21924 8.96776 6.38319 8.99516C6.54715 9.02256 6.68677 9.12965 6.75573 9.2809L8.79056 13.7441L10.0332 13.178L8.00195 8.71497C7.93313 8.56376 7.94391 8.38824 8.03072 8.24659C8.11753 8.10494 8.26903 8.01566 8.435 8.00834L11.2549 7.88397L4 1.59852Z",fill:"currentColor"}}]})(t)}function ane({...t}){const{nodes:e,materials:n}=nne("https://prod.spline.design/sWRIBGh4Z0MRliYj/scene.splinecode"),i=Ce.useRef(),r=Ce.useRef(),s=Ce.useRef();function o(a){const l=a.match(/^(\d+|\d*\.\d+)(px)?$/);return l?parseFloat(l[1]):-1}return Ce.useState(0),Ce.useState(0),Ce.useEffect(()=>{const a=[{x:0},{y:0}];let l=0,u=0,d=0,c=0;document.addEventListener("touchstart",h=>{if(h.target==i.current){const m=localStorage.getItem("touchData")?JSON.parse(localStorage.getItem("touchData")):a;l=h.touches[0].clientX,u=m[0].x,d=h.touches[0].clientY,c=m[1].y,console.log(m)}}),document.addEventListener("touchmove",h=>{if(h.target==i.current){let m=o(r.current.style.left);o(r.current.style.left),m=h.touches[0].clientX-l,r.current.style.left=`${u+m}px`;let g=o(r.current.style.left);g=h.touches[0].clientY-d,r.current.style.top=`${c+g}px`}}),document.addEventListener("touchend",h=>{if(h.target==i.current){const m=[{x:0},{y:0}];console.log("touchend"),m[0].x=o(r.current.style.left),m[1].y=o(r.current.style.top),localStorage.setItem("touchData",JSON.stringify(m))}})},[i]),Fr(sk,{children:[Ve(kT,{children:Ve("div",{className:"screen",ref:s,children:Ve("div",{className:"screenWrapper",children:Ve("span",{className:"",ref:r,children:Ve(one,{})})})})}),Ve("color",{attach:"background",args:["#7a6c89"]}),Fr("group",{...t,dispose:null,position:[0,0,0],children:[Ve("mesh",{name:"Rectangle 2",geometry:e["Rectangle 2"].geometry,material:n["Rectangle 2 Material"],castShadow:!0,receiveShadow:!0,position:[40,50.5,0]}),Ve("mesh",{name:"Rectangle",geometry:e.Rectangle.geometry,material:n["Rectangle Material"],castShadow:!0,receiveShadow:!0,position:[0,-400.01,20.52],rotation:[-1.46,0,0],scale:1}),Fr("group",{name:"Macbook Pro M1 Max 14 Inch",position:[40,200.34,283.42],rotation:[-3.02,0,3.14],scale:.25,children:[Ve("pointLight",{name:"Point Light 3",intensity:1.9,distance:2e3,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":100,"shadow-camera-far":2500,color:"#d590fe",position:[-260.19,737.2,1655.59],rotation:[-Math.PI,0,-Math.PI],scale:2.07}),Ve("pointLight",{name:"Point Light 4",intensity:1.9,distance:2e3,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":100,"shadow-camera-far":2500,color:"#feb9f7",position:[-285.4,-58.2,-10.11],rotation:[-Math.PI,0,-Math.PI],scale:2.07}),Ve("pointLight",{name:"Point Light",intensity:1.9,distance:2e3,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":100,"shadow-camera-far":2500,color:"#b76afe",position:[0,-58.2,-10.11],rotation:[-Math.PI,0,-Math.PI],scale:2.07}),Fr("group",{name:"screen",position:[-1.27,-435.4,-56.55],rotation:[.54,0,0],scale:1,children:[Fr("group",{name:"logo_apple",position:[-6.96,478.11,16.32],rotation:[0,0,0],scale:[1.96,1.96,108962113e-2],children:[Ve("mesh",{name:"logo_apple1",geometry:e.logo_apple1.geometry,material:n.logo_apple,castShadow:!0,receiveShadow:!0,position:[-22.72,24.79,0],rotation:[0,0,0],scale:[.09,.09,0]}),Ve("mesh",{name:"logo_apple2",geometry:e.logo_apple2.geometry,material:n.logo_apple,castShadow:!0,receiveShadow:!0,position:[.14,47.16,0],rotation:[0,0,0],scale:[.09,.09,0]})]}),Ve("mesh",{name:"connector",geometry:e.connector.geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[1.27,-20.52,-5.61],rotation:[-Math.PI,0,-Math.PI],scale:2.07}),Ve("mesh",{name:"screen1",geometry:e.screen1.geometry,material:n.screen,castShadow:!0,receiveShadow:!0,position:[669.2,44.16,.66],rotation:[-Math.PI,0,-Math.PI],scale:.9}),Ve("mesh",{name:"green_light",geometry:e.green_light.geometry,material:n["green_light Material"],castShadow:!0,receiveShadow:!0,position:[-25.41,906.02,.61],rotation:[-Math.PI,0,-Math.PI],scale:[.82,.81,.92]}),Ve("mesh",{name:"black_border_notch_screen",geometry:e.black_border_notch_screen.geometry,material:n["black_border_notch_screen Material"],castShadow:!0,receiveShadow:!0,position:[691.33,915.76,.97],rotation:[-Math.PI,0,Math.PI],scale:[.9,.9,1]}),Ve("mesh",{name:"grey_border_creen",geometry:e.grey_border_creen.geometry,material:n["grey_border_creen Material"],castShadow:!0,receiveShadow:!0,position:[.45,448.36,9.16],rotation:[-Math.PI,0,-Math.PI],scale:[.9,.9,1]}),Ve("mesh",{name:"Rectangle1",geometry:e.Rectangle1.geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[0,448.36,15.07],rotation:[-Math.PI,0,-Math.PI],scale:[.9,.9,1]}),Ve("mesh",{name:"metalic_screen",geometry:e.metalic_screen.geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[0,448.36,10.17],rotation:[-Math.PI,0,-Math.PI],scale:[.9,.9,1]}),Ve("mesh",{name:"camera",geometry:e.camera.geometry,material:n["camera Material"],castShadow:!0,receiveShadow:!0,position:[-3.46,906.02,.61],rotation:[-Math.PI,0,-Math.PI],scale:[.82,.81,.92]}),Ve("mesh",{name:"border_black_camera",geometry:e.border_black_camera.geometry,material:n["connector&screen"],castShadow:!0,receiveShadow:!0,position:[-3.46,906.02,.84],rotation:[-Math.PI,0,-Math.PI],scale:[.82,.81,.92]})]}),Fr("group",{name:"base",position:[-56.34,-457.52,-546.11],rotation:[0,0,0],scale:[1,1,.95],children:[Ve("mesh",{name:"Cube",geometry:e.Cube.geometry,material:n.Sound,castShadow:!0,receiveShadow:!0,position:[56.34,17.75,516.41],rotation:[-Math.PI,0,-Math.PI],scale:2.07}),Ve("group",{name:"base1",position:[5.42,-7.13,-.41],rotation:[-Math.PI,0,-Math.PI],scale:1,children:Ve("mesh",{name:"base2",geometry:e.base2.geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[10.98,13.35,134.94],rotation:[0,0,0]})}),Fr("group",{name:"sound",position:[1.28,32.07,180.03],rotation:[-Math.PI,0,-Math.PI],scale:1,children:[Ve("mesh",{name:"Rectangle 21",geometry:e["Rectangle 21"].geometry,material:n.Sound,castShadow:!0,receiveShadow:!0,position:[585.27,.3,-16.44],rotation:[-Math.PI/2,0,-Math.PI],scale:1}),Ve("mesh",{name:"Rectangle2",geometry:e.Rectangle2.geometry,material:n.Sound,castShadow:!0,receiveShadow:!0,position:[-697.58,.3,-16.44],rotation:[-Math.PI/2,0,-Math.PI],scale:1})]}),Fr("group",{name:"feet",position:[51.91,-18.23,-11.95],rotation:[-Math.PI,0,-Math.PI],scale:1,children:[Ve("mesh",{name:"Subdiv 3",geometry:e["Subdiv 3"].geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[466.78,3.42,-412.46],rotation:[0,0,-Math.PI],scale:[-1.09,1.15,1.13]}),Ve("mesh",{name:"Subdiv 31",geometry:e["Subdiv 31"].geometry,material:n["Subdiv 31 Material"],castShadow:!0,receiveShadow:!0,position:[466.78,-2.64,-412.46],rotation:[0,0,-Math.PI],scale:[-1,1.05,1.03]}),Ve("mesh",{name:"Subdiv 32",geometry:e["Subdiv 32"].geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[-466.78,3.42,-412.46],rotation:[0,0,-Math.PI],scale:[-1.09,1.15,1.13]}),Ve("mesh",{name:"Subdiv 33",geometry:e["Subdiv 33"].geometry,material:n["Subdiv 33 Material"],castShadow:!0,receiveShadow:!0,position:[-464,-3.76,-412.39],rotation:[0,0,-Math.PI],scale:[-1,1.05,1.03]}),Ve("mesh",{name:"Subdiv 2",geometry:e["Subdiv 2"].geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[466.78,3.42,326.82],rotation:[0,0,-Math.PI],scale:[-1.09,1.15,1.13]}),Ve("mesh",{name:"Subdiv 21",geometry:e["Subdiv 21"].geometry,material:n["Subdiv 21 Material"],castShadow:!0,receiveShadow:!0,position:[466.78,-2.64,326.82],rotation:[0,0,-Math.PI],scale:[-1,1.05,1.03]}),Ve("mesh",{name:"Subdiv",geometry:e.Subdiv.geometry,material:n.metalic,castShadow:!0,receiveShadow:!0,position:[-466.78,3.42,326.82],rotation:[0,0,-Math.PI],scale:[-1.09,1.15,1.13]}),Ve("mesh",{name:"Cylinder",geometry:e.Cylinder.geometry,material:n["Cylinder Material"],castShadow:!0,receiveShadow:!0,position:[-466.78,-2.64,326.82],rotation:[0,0,-Math.PI],scale:[-1,1.05,1.03]})]}),Fr("group",{name:"keyboard",position:[57.79,37.67,198.94],rotation:[-Math.PI,0,-Math.PI],scale:1,children:[Ve("mesh",{name:"Torus",geometry:e.Torus.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[542.48,-3.08,-197.92],rotation:[-Math.PI/2,0,0],scale:1.17}),Ve("mesh",{name:"keybord_lign",geometry:e.keybord_lign.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[306.67,-9.04,198.69],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign1",geometry:e.keybord_lign1.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-550.66,-9.04,198.69],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign2",geometry:e.keybord_lign2.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-364.4,-9.04,120.03],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign3",geometry:e.keybord_lign3.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-405.8,-9.04,40.69],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign4",geometry:e.keybord_lign4.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-429.33,-9.04,-40.64],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 6",geometry:e["Rectangle 6"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-39.25,-9.04,198.26],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 7",geometry:e["Rectangle 7"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[214.76,-9.04,198.26],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 5",geometry:e["Rectangle 5"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-293.93,-9.04,198.26],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 14",geometry:e["Rectangle 14"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[466.16,-8.97,180.77],rotation:[-Math.PI/2,0,0],scale:[1,1,2.67]}),Ve("mesh",{name:"Rectangle 13",geometry:e["Rectangle 13"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[466.16,-8.97,215.5],rotation:[-Math.PI/2,0,0],scale:[1,1,2.67]}),Ve("mesh",{name:"Rectangle 12",geometry:e["Rectangle 12"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[548.77,-8.97,215.5],rotation:[-Math.PI/2,0,0],scale:[1,1,2.67]}),Ve("mesh",{name:"Rectangle 11",geometry:e["Rectangle 11"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[386.57,-8.97,215.5],rotation:[-Math.PI/2,0,0],scale:[1,1,2.67]}),Ve("mesh",{name:"Rectangle 8",geometry:e["Rectangle 8"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[494.68,-9.04,120.42],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 4",geometry:e["Rectangle 4"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-499.8,-9.04,120.42],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 9",geometry:e["Rectangle 9"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[513.92,-9.04,40.9],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 3",geometry:e["Rectangle 3"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-519.3,-9.04,40.9],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 10",geometry:e["Rectangle 10"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[523.26,-9.04,-119.43],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle 22",geometry:e["Rectangle 22"].geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-530.8,-9.04,-40.8],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"Rectangle3",geometry:e.Rectangle3.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-529.3,-9.04,-196.64],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign5",geometry:e.keybord_lign5.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-429.33,-9.04,-196.64],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keybord_lign6",geometry:e.keybord_lign6.geometry,material:n.keyboard_2,castShadow:!0,receiveShadow:!0,position:[-549.33,-9.04,-118.99],rotation:[-Math.PI/2,0,0]}),Ve("mesh",{name:"keyboard1",geometry:e.keyboard1.geometry,material:n.keyboard,castShadow:!0,receiveShadow:!0,position:[0,-7.7,0],rotation:[-Math.PI/2,0,0],scale:[1,1,2.16]})]}),Fr("group",{name:"trackpad",position:[-88.53,-620.26,-620.56],rotation:[2,0,-Math.PI],scale:[2.48,14.81,2.48],children:[Ve(kT,{children:Ve("div",{className:"trackpad",ref:i})}),Ve("mesh",{name:"trackpad_top",geometry:e.trackpad_top.geometry,material:n.trackpad,castShadow:!0,receiveShadow:!0,position:[-61.19,-1.67,-41.26],rotation:[-Math.PI/2,0,0],scale:[.83,.83,5],on:!0}),Ve("mesh",{name:"trackpad_border",geometry:e.trackpad_border.geometry,material:n.keyboard,castShadow:!0,receiveShadow:!0,position:[-61.19,-2.48,-41.26],rotation:[-Math.PI/2,0,0],scale:[.83,.83,5]})]}),Fr("group",{name:"button_right",position:[-633.05,12.57,270.94],rotation:[-Math.PI,0,-Math.PI],scale:1,children:[Ve("mesh",{name:"Rectangle 91",geometry:e["Rectangle 91"].geometry,material:n["Rectangle 91 Material"],castShadow:!0,receiveShadow:!0,position:[-2.05,-20.27,425.43],rotation:[Math.PI/2,1.28,-Math.PI/2],scale:1}),Ve("mesh",{name:"Rectangle 101",geometry:e["Rectangle 101"].geometry,material:n["Rectangle 101 Material"],castShadow:!0,receiveShadow:!0,position:[0,0,-105.07],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Rectangle 92",geometry:e["Rectangle 92"].geometry,material:n["Rectangle 92 Material"],castShadow:!0,receiveShadow:!0,position:[0,2.5,-26.07],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Rectangle 81",geometry:e["Rectangle 81"].geometry,material:n["Rectangle 81 Material"],castShadow:!0,receiveShadow:!0,position:[0,2.94,79.57],rotation:[0,Math.PI/2,0]})]}),Fr("group",{name:"button_left",position:[745.73,14.04,293.61],children:[Ve("mesh",{name:"Rectangle 82",geometry:e["Rectangle 82"].geometry,material:n["Rectangle 82 Material"],castShadow:!0,receiveShadow:!0,position:[-1.38,-18.91,-448.11],rotation:[Math.PI/2,1.23,-Math.PI/2],scale:1}),Ve("mesh",{name:"Rectangle 31",geometry:e["Rectangle 31"].geometry,material:n["Rectangle 31 Material"],castShadow:!0,receiveShadow:!0,position:[.77,1.08,84],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Ellipse",geometry:e.Ellipse.geometry,material:n["Ellipse Material"],castShadow:!0,receiveShadow:!0,position:[.48,-.08,-113.5],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Rectangle 61",geometry:e["Rectangle 61"].geometry,material:n["Rectangle 61 Material"],castShadow:!0,receiveShadow:!0,position:[.48,.57,-58.94],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Rectangle 51",geometry:e["Rectangle 51"].geometry,material:n["Rectangle 51 Material"],castShadow:!0,receiveShadow:!0,position:[.48,.57,5.16],rotation:[0,Math.PI/2,0]}),Ve("mesh",{name:"Rectangle 41",geometry:e["Rectangle 41"].geometry,material:n["Rectangle 41 Material"],castShadow:!0,receiveShadow:!0,position:[.48,1.08,84],rotation:[0,Math.PI/2,0]})]})]})]}),Ve(d9,{name:"Default Camera",makeDefault:!0,far:5e4,near:-5e4,position:[40.96,1.22,1e3],rotation:[0,0,0],children:Ve("directionalLight",{name:"Default Directional Light",intensity:.6,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":-1e4,"shadow-camera-far":1e5,position:[85e4,13e5,1e6]})})]})]})}function lne(){return Ve(Ce.Suspense,{fallback:null,children:Ve(QW,{shadows:!0,flat:!0,linear:!0,children:Ve(ane,{})})})}const une=document.getElementById("root"),cne=Db(une);cne.render(Ve(Ce.StrictMode,{children:Ve(lne,{})}))});export default hne();
